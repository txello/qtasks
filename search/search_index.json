{"config":{"lang":["en","ru"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"QTasks \u2014 Task Queue Framework","text":"<p>QTasks is a modern task processing framework designed with an emphasis on simplicity, flexibility, and extensibility. It integrates easily into projects of any scale and is suitable for both beginners and experienced developers.</p>"},{"location":"#links","title":"Links","text":"<ul> <li>PyPI: https://pypi.org/project/qtasks/</li> <li>GitHub: https://github.com/txello/qtasks/</li> </ul>"},{"location":"#features","title":"Features","text":"<ul> <li>Simple \u2014 Easy to configure and quick to learn. Intuitive API and clear project structure.</li> <li>Customizable \u2014 Each component can be replaced or adapted to suit your needs. You control the execution logic.</li> <li>Extensible \u2014 Support for plugins and modules makes it easy to add new features and integrations.</li> </ul>"},{"location":"blog/","title":"Under development","text":""},{"location":"changelog/","title":"Update History","text":""},{"location":"changelog/#v173-2026-02-17","title":"v1.7.3 2026-02-17","text":"<ul> <li>Fixed handling of retry tasks.</li> <li>Fixed handling of functions for <code>Depends()</code>.</li> </ul>"},{"location":"changelog/#documentation","title":"Documentation","text":"<ul> <li>Changed the <code>site_url</code> parameter in <code>mkdocs</code> to <code>docs.qtasks.tech</code>.</li> <li>Added links to the changelog.</li> </ul>"},{"location":"changelog/#v172-2026-02-05","title":"v1.7.2 2026-02-05","text":"<ul> <li>Update Russian language link in mkdocs.yml for correct routing</li> </ul>"},{"location":"changelog/#v171-2026-02-05","title":"v1.7.1 2026-02-05","text":"<ul> <li>The translation of the code from Russian to English has been corrected.</li> </ul>"},{"location":"changelog/#v170-2026-02-05","title":"v1.7.0 2026-02-05","text":"<ul> <li>Added <code>(A)syncTaskUtils</code> and <code>(A)syncChain</code>.</li> <li>Added the ability to get settings for <code>QueueConfig</code> from <code>os.environ</code>.</li> <li>Added <code>(A)syncTaskCls</code>.</li> <li>Added <code>(A)syncgRPCPlugin</code>.</li> <li>Added plugin systems for <code>(A)syncStats</code>.</li> <li>Added <code>stats_inspect</code> plugin trigger for <code>(A)syncStats</code>.</li> <li>Added ExitStack support for <code>Depends</code> and the <code>scope=</code> parameter for it.</li> <li>Added <code>plugin_cache=</code> for plugin triggers.</li> <li>All code translated into English.</li> <li><code>Router</code> changed to <code>(A)syncRouter</code>.</li> <li>Updated debug output.</li> <li>Updated refactoring settings for E, W, F, B, I, and UP.</li> <li>Fixed typing in <code>(A)syncRouter.task</code>.</li> <li>Fixed parameter in the <code>autodiscover_tasks</code> function.</li> <li>Fixed <code>Config</code> and <code>Task</code> models.</li> <li>Fixed plugin calls.</li> <li>Code refactoring.</li> </ul>"},{"location":"changelog/#documentation_1","title":"Documentation","text":"<ul> <li>Added English as the default language.</li> <li>Added the <code>Architecture</code> section.</li> <li>Translated all pages into English.</li> <li>Fixed support for <code>mermaid</code> diagrams.</li> <li>Updated page texts.</li> </ul>"},{"location":"changelog/#v160-2025-09-20","title":"v1.6.0 2025-09-20","text":"<ul> <li>Added <code>(A)syncSocketBroker</code>.</li> <li>Added <code>(A)syncStats</code>, <code>InspectStats</code>, and <code>UtilsInspectStats</code>.</li> <li>Added <code>(A)StatePlugin</code> plugin.</li> <li>Added <code>description</code> and <code>max_time</code> parameters for tasks.</li> <li>Added <code>autodiscover_tasks()</code> function for integration with Django.</li> <li>Added <code>result_time_interval</code> setting to specify the execution time for <code>(A)syncResult</code>.</li> <li>Added <code>HTTP+QTasks</code> request analytics via the <code>Locust+FastAPI plugin</code> to tests.</li> <li>Added testing via <code>tox</code> on versions <code>py310</code>, <code>py311</code>, <code>py312</code>, and <code>py313</code> in synchronous and asynchronous modes.</li> <li>Changed the way plugins work.</li> <li>Changed the <code>add_task</code> request method from <code>args=()</code> and <code>kwargs={}</code> to <code>*args</code> and <code>**kwargs</code>.</li> <li>Changed the <code>middlewares</code> parameter to <code>middlewares_before</code> and <code>middlewares_after</code>.</li> <li>Changed the <code>logs_default_level</code> parameter to <code>logs_default_level_server</code> and <code>logs_default_level_client</code>.</li> <li>Changed the <code>app.init_*</code> functions to <code>app.events.on.*</code>.</li> <li>Changed the task error logging level from <code>warning</code> to <code>error</code>.</li> <li>Changed testing from <code>unittest</code> to <code>pytest</code>.</li> <li>Changed the broker in testing from Redis to Socket.</li> <li>Changed testing functions.</li> <li>Fixed data transfers for plugins.</li> <li>Fixed data transfer errors between components.</li> <li>Fixed schema declarations.</li> <li>Fixed <code>(A)syncDependsPlugin</code>.</li> <li>Refactored code.</li> </ul>"},{"location":"changelog/#v151-2025-07-17","title":"v1.5.1 2025-07-17","text":"<ul> <li>Fixed <code>pydantic</code> dependency.</li> </ul>"},{"location":"changelog/#v150-2025-07-16","title":"v1.5.0 2025-07-16","text":"<ul> <li>Added <code>AsyncPluginMixin</code>.</li> <li>Added plugin triggers.</li> <li>Added <code>Retry</code> status via the built-in <code>(A)syncRetryPlugin</code> plugin.</li> <li>Added <code>**kwargs</code> parameters as <code>extra</code> for <code>@app.task()</code>.</li> <li>Added <code>tags</code> and <code>decode</code> parameters for <code>@app.task()</code>.</li> <li>Added support for <code>pydantic</code> via the built-in plugin <code>(A)syncPydanticWrapperPlugin</code>.</li> <li>Added support for <code>ArgMeta</code> to work with task function parameters.</li> <li>Added <code>(A)syncTestPlugin</code> as an optional plugin.</li> <li>Added examples to <code>examples/</code>.</li> <li>Added parameters for calling plugin triggers <code>_plugin_trigger()</code>.</li> <li>Added <code>TaskPluginTriggerError</code> exception.</li> <li>Fixed execution methods for <code>(A)syncRedisCommandQueue</code>.</li> <li>Fixed data transfer errors between components.</li> <li>Code refactoring.</li> </ul>"},{"location":"changelog/#v140-2025-06-12","title":"v1.4.0 2025-06-12","text":"<ul> <li>Added support for generators for tasks.</li> <li>Added <code>Cancel</code> status for tasks and support in the code.</li> <li>Added <code>SyncContext</code> and <code>AsyncContext</code>.</li> <li>Added <code>SyncRetryPlugin</code> and <code>AsyncRetryPlugin</code>.</li> <li>Added <code>BaseQueueTasks</code>.</li> <li>Added parameters <code>retry=</code>, <code>retry_on_exc=</code>, <code>generate_handler=</code>, <code>executor=</code>, <code>middlewares=</code> for task decorators <code>task()</code>  and <code>shared_task()</code>.</li> <li>Added <code>extra=</code> parameter for <code>broker.add</code> and <code>storage.add</code>.</li> <li>Added <code>broker.default_sleep</code>.</li> <li>Added dynamic variable processing for dataclass.</li> <li>Added functions for working with plugins.</li> <li>Added functions for testing.</li> <li>Added <code>subcribe</code> to <code>QueueConfig</code>.</li> <li>Added examples to <code>examples/</code>.</li> <li>Fixed task parameters.</li> <li>Fixed <code>Router</code>.</li> <li>Removed <code>ConfigObserver</code> from <code>QueueTasks.config</code>, returned <code>QueueConfig</code>.</li> </ul>"},{"location":"changelog/#v130-2025-05-30","title":"v1.3.0 2025-05-30","text":"<ul> <li>Added <code>Logger</code> and changed <code>print()</code> outputs to the appropriate method.</li> <li>Added <code>SyncTaskExecutor</code> and <code>AsyncTaskExecutor</code> and added to <code>Worker</code>.</li> <li>Added <code>SyncRedisCommandQueue</code>  and <code>AsyncRedisCommandQueue</code>.</li> <li>Added <code>SyncKafkaBroker</code>.</li> <li>Added <code>ConfigObserver</code> and replaced it in <code>QueueTasks.config</code>.</li> <li>Added <code>BaseMiddleware</code> and <code>TaskMiddleware</code>.</li> <li>Added <code>ping()</code>.</li> <li>Added <code>flush_all()</code>.</li> <li>Added the <code>echo=</code> parameter for the [<code>task()</code>](api/queuetasks.md#qtasks.qtasks.QueueTasks.task  and <code>shared_task()</code>.</li> <li>Added <code>awaiting=</code> parameter for <code>shared_task()</code> task decorators.</li> <li>Added <code>log=</code> parameter for <code>QueueTasks</code>.</li> <li>Added the <code>broker_url=</code> parameter for <code>QueueTasks</code>.</li> <li>Added an example of concurrent task performance.</li> <li>Changed the <code>storage.start()</code>  function to add server startup status with TTL. Added corresponding config.</li> <li>Changed test classes.</li> <li>Fixed default component calls.</li> </ul>"},{"location":"changelog/#v120-2025-05-20","title":"v1.2.0 2025-05-20","text":"<ul> <li>Added <code>SyncResult</code>/<code>AsyncResult</code>  for receiving real-time tasks.</li> <li>Added <code>SyncTask</code>/<code>AsyncTask</code>  to replace the function with a decorator.</li> <li>Added <code>qtasks._state.app_main</code>  to store a duplicate of the <code>QueueTasks</code> application.</li> <li>Added <code>SyncRedisGlobalConfig</code>.</li> <li>Added examples to <code>examples/</code>.</li> <li>Replaced <code>aiounittest</code> with <code>unittest.IsolatedAsyncioTestCase</code>.</li> <li>Fixed component launches.</li> </ul>"},{"location":"changelog/#v110-2025-04-21","title":"v1.1.0 - 2025-04-21","text":"<ul> <li>Added <code>TestCase</code>/<code>AsyncTestCase</code>.</li> <li>Added base classes for testing.</li> <li>Added <code>global_config</code> parameter for <code>BaseStorage</code>.</li> <li>Added <code>TaskStatusEnum</code>.</li> <li>Fixed <code>QueueConfig</code> settings.</li> <li>Fixed <code>BaseWorker</code>.</li> </ul>"},{"location":"changelog/#v101-2025-04-15","title":"v1.0.1 \u2013 2025-04-15","text":"<ul> <li>Added description.</li> <li>Fixed mkdocs error.</li> </ul>"},{"location":"changelog/#v100-2025-04-15","title":"v1.0.0 \u2013 2025-04-15","text":"<ul> <li>Added first version of <code>QTasks</code>.</li> </ul>"},{"location":"components/","title":"QueueTasks Components","text":"<p>The framework is built on a component-based architecture: each element of the system is responsible for its own part of the work and can be replaced, extended, or redefined. This page provides an overview of all the main and additional components, without going into depth on the internal logic.</p>"},{"location":"components/#main-components","title":"Main components","text":""},{"location":"components/#queuetasks","title":"QueueTasks","text":"<p>The central object of the framework. It manages task registration, configures the execution environment, and connects the other components.</p> <p>When an instance of <code>QueueTasks()</code> is created, the following are automatically formed:</p> <ul> <li>Broker (Redis by default)</li> <li>Storage (Redis)</li> <li>GlobalConfig (Redis)</li> <li>Worker (SyncThreadWorker or AsyncWorker)</li> <li>Starter (SyncStarter or AsyncStarter)</li> </ul> <pre><code>from qtasks import QueueTasks\n\napp = QueueTasks()\n\n@app.task(name=\"test\")\ndef sample_task(id: int):\n    return f\"User {id} recorded\"\n</code></pre> <p>QueueTasks can accept connection URLs (<code>broker_url</code>, <code>storage_url</code>) as well as fully custom components.</p>"},{"location":"components/#broker-incoming-task-handler","title":"Broker \u2014 incoming task handler","text":"<p>Responsible for receiving tasks and passing them to the worker. By default, a Redis broker is used.</p> <pre><code>from qtasks.asyncio import QueueTasks\nfrom qtasks.brokers import AsyncRedisBroker\n\nbroker = AsyncRedisBroker(url=\"redis://localhost:6379/2\")\n\napp = QueueTasks(broker=broker)\n</code></pre> <p>The broker uses Storage and, if necessary, GlobalConfig.</p>"},{"location":"components/#worker-task-executor","title":"Worker \u2014 task executor","text":"<p>Executes tasks received from the broker. Supports synchronous (<code>SyncThreadWorker</code>) and asynchronous (<code>AsyncWorker</code>) modes.</p> <pre><code>from qtasks.asyncio import QueueTasks\nfrom qtasks.workers import AsyncWorker\nfrom qtasks.brokers import AsyncRedisBroker\n\nbroker = AsyncRedisBroker(url=\"redis://localhost:6379/2\")\nworker = AsyncWorker(broker=broker)\n\napp = QueueTasks(broker=broker, worker=worker)\n</code></pre> <p>The worker interacts with the task context, retry logic, middleware, and plugins.</p>"},{"location":"components/#storage-task-data-storage","title":"Storage \u2014 task data storage","text":"<p>Stores information about tasks:</p> <ul> <li>status,</li> <li>result,</li> <li>errors,</li> <li>execution time.</li> </ul> <p>It is a mandatory component, but can be replaced. Broker contains a link to Storage inside itself.</p> <pre><code>```py\nfrom qtasks.asyncio import QueueTasks\nfrom qtasks.storages import AsyncRedisStorage\nfrom qtasks.brokers import AsyncRedisBroker\n\nstorage = AsyncRedisStorage(url=\"redis://localhost:6379/2\")\nbroker = AsyncRedisBroker(url=\"redis://localhost:6379/2\", storage=storage)\n\napp = QueueTasks(broker=broker)\n</code></pre> <p>The storage also contains a link to GlobalConfig.</p>"},{"location":"components/#starter-controls-the-launch-of-components","title":"Starter \u2014 controls the launch of components","text":"<p>Starter is responsible for launching and stopping all components. QueueTasks uses Starter by default.</p> <p>Starter can also control the execution flow scenarios of components.</p> <pre><code>from qtasks.asyncio import QueueTasks\nfrom qtasks.starters import AsyncStarter\n\nstarter = AsyncStarter(name=\"QueueTasks\")\napp = QueueTasks()\n\nif __name__ == \"__main__\":\n    app.run_forever(starter=starter)\n</code></pre>"},{"location":"components/#additional-components","title":"Additional components","text":""},{"location":"components/#globalconfig-global-configuration","title":"GlobalConfig \u2014 global configuration","text":"<p>Storage of global variables and settings available to all components. Used, for example, when working with WebView: the interface can connect to Redis without launching the application.</p> <pre><code>from qtasks.asyncio import QueueTasks\nfrom qtasks.configs import AsyncRedisGlobalConfig\n\nconfig = AsyncRedisGlobalConfig(url=\"redis://localhost:6379/2\")\napp = QueueTasks(global_config=config)\n</code></pre> <p>GlobalConfig is available as:</p> <pre><code>app.broker.storage.global_config\n</code></pre> <p>and can be <code>None</code>.</p>"},{"location":"components/#plugins-extending-functionality","title":"Plugins \u2014 extending functionality","text":"<p>Plugins allow you to connect any additional logic: logging, modification of task arguments, integrations.</p> <p>All available triggers are described here: Triggers</p> <p>Example:</p> <pre><code>from qtasks import QueueTasks\nfrom qtasks.plugins import BasePlugin\n\napp = QueueTasks()\n\nclass TestPlugin(BasePlugin):\n    def __init__(self):\n        super().__init__()\n        self.handlers = {\n            \"task_executor_args_replace\": self.replace\n        }\n\n    def replace(self, **kwargs):\n        print(\"ARGS:\", kwargs)\n        return None\n\napp.add_plugin(\n    TestPlugin(),\n    trigger_names=[\"task_executor_args_replace\"],\n    component=\"worker\")\n</code></pre>"},{"location":"components/#timer-running-tasks-on-a-schedule","title":"Timer \u2014 running tasks on a schedule","text":"<p>A separate component that allows you to use cron-like schedules. Uses APScheduler (<code>CronTrigger</code>).</p> <pre><code>from qtasks import QueueTasks\nfrom qtasks.timers import AsyncTimer\nfrom apscheduler.triggers.cron import CronTrigger\n\napp = QueueTasks()\n\n@app.task\ndef test():\n    print(\"Running test task\")\n\n\ntrigger = CronTrigger(second=\"*/10\")\ntimer = AsyncTimer(app=app)\ntimer.add_task(\"test\", trigger=trigger)\n\ntimer.run_forever()\n</code></pre>"},{"location":"components/#webview-visual-interface","title":"WebView \u2014 visual interface","text":"<p>A separate library for viewing the list of tasks, results, and statistics. Installation:</p> <pre><code>pip install qtasks_webview\n</code></pre> <p>WebView works directly with Redis and does not require the application to be running.</p>"},{"location":"components/#complete-example-of-manual-assembly-of-all-components","title":"Complete example of manual assembly of all components","text":"<pre><code>import asyncio\nfrom qtasks.asyncio import QueueTasks\nfrom qtasks.configs import AsyncRedisGlobalConfig\nfrom qtasks.storages import AsyncRedisStorage\nfrom qtasks.brokers import AsyncRedisBroker\nfrom qtasks.workers import AsyncWorker\nfrom qtasks.starters import AsyncStarter\n\n# GlobalConfig \u2014 global variables and settings\nglobal_config = AsyncRedisGlobalConfig(\n    name=\"QueueTasks\",\n    url=\"redis://localhost:6379/2\"\n)\n\n# Storage \u2014 task storage\nstorage = AsyncRedisStorage(\n    name=\"QueueTasks\",\n    global_config=global_config,\n    url=\"redis://localhost:6379/2\")\n\n\n# Broker \u2014 incoming task handler\nbroker = AsyncRedisBroker(\n    name=\"QueueTasks\",\n    storage=storage,\n    url=\"redis://localhost:6379/2\")\n\n\n# Worker \u2014 task executor\nworker = AsyncWorker(\n    name=\"QueueTasks\",\n    broker=broker\n)\n\n# QueueTasks \u2014 main object\napp = QueueTasks(\n    name=\"QueueTasks\",\n    broker=broker,\n    worker=worker)\n\n\n# Application settings\napp.config.max_tasks_process = 10\napp.config.running_older_tasks = True\napp.config.delete_finished_tasks = True\n\n\n@app.task(name=\"test\")\nasync def sample_task(id: int):\n    result = f\"User {id} recorded\"\n    await asyncio.sleep(id)\n    return result\n\n\nif __name__ == \"__main__\":\n    starter = AsyncStarter(\n        name=\"QueueTasks\",\n        worker=worker,\n        broker=broker\n    )\n    app.run_forever(starter=starter)\n</code></pre>"},{"location":"console/","title":"Working with the console via <code>qtasks.__main__</code>","text":"<p>The <code>qtasks.__main__</code> module provides a command line interface for launching and managing QTasks applications. The CLI is suitable for automation, production work, and integration with external tools.</p> <p>Available commands include:</p> <ul> <li>launching an application;</li> <li>viewing statistics via <code>(A)syncStats</code>;</li> <li>launching an experimental web interface (will be   migrated to the <code>qtasks_webview</code> library).</li> </ul>"},{"location":"console/#main-cli-features","title":"Main CLI features","text":"<ul> <li>launching the application with the specified <code>QueueTasks</code> instance;</li> <li>calling component statistics (via <code>stats inspect</code>);</li> <li>launching the experimental web interface;</li> <li>specifying the application via <code>-A</code> or <code>--app</code> in the format <code>module:variable</code>;</li> <li>configuring the web interface port.</li> </ul> <p>The command is called in the general form:</p> <pre><code>qtasks [options] &lt;command&gt; [options]\n</code></pre>"},{"location":"console/#run-command","title":"<code>run</code> command","text":"<p>Starts the QTasks application with the specified <code>QueueTasks</code> instance.</p> <pre><code>qtasks -A &lt;path_to_module:variable_name&gt; run\n</code></pre> <p>Example:</p> <pre><code>qtasks -A based_async_app:app run\n</code></pre> <p><code>-A</code> and <code>--app</code> are completely equivalent.</p>"},{"location":"console/#stats-command","title":"<code>stats</code> command","text":"<p>Used to retrieve data from <code>(A)syncStats</code>. Only the <code>inspect</code> subcommand is available in the current version.</p> <pre><code>qtasks -A &lt;module:app&gt; stats inspect &lt;target&gt; [parameters]\n</code></pre> <p>Where <code>target</code> is the statistics object:</p> <ul> <li><code>app</code> \u2014 information about the application;</li> <li><code>tasks</code> \u2014 information about tasks.</li> </ul> <p>Example:</p> <pre><code>qtasks -A based_async_app:app stats inspect app json=true\n</code></pre> <p>The <code>json=true</code> parameter is passed as a positional argument to the <code>inspect</code> function and enables output in JSON format.</p> <p>The subcommands <code>inspect app</code> and <code>inspect tasks</code> directly call the methods:</p> <ul> <li><code>(A)syncStats().inspect().app(json=True)</code></li> <li><code>(A)syncStats().inspect().tasks(json=True)</code></li> </ul> <p>The list of targets can be extended (<code>inspect workers</code>, <code>inspect broker</code>, etc.) without changing the CLI.</p>"},{"location":"console/#web-command-experimental","title":"<code>web</code> command (experimental)","text":"<p>Launches an experimental web interface (will be moved to the <code>qtasks_webview</code>).</p> <pre><code>qtasks web -A &lt;module:app&gt; --port &lt;port&gt;\n</code></pre> <p>Example:</p> <pre><code>qtasks web -A based_async_app:app --port 8000\n</code></pre> <p>If no port is specified, the default value of <code>8000</code> is used.</p>"},{"location":"console/#cli-parameters","title":"CLI parameters","text":""},{"location":"console/#-a-app","title":"<code>-A</code>, <code>--app</code>","text":"<p>The path to the application in the format:</p> <pre><code>module:variable_name\n</code></pre> <p>Example:</p> <pre><code>based_async_app:app\n</code></pre> <p>The CLI does not determine the application automatically \u2014 this behaviour is intentional, as the developer may not use the global variable <code>app</code>.</p>"},{"location":"console/#-port","title":"<code>--port</code>","text":"<p>Used only by the <code>web</code> command. Specifies the web interface port.</p>"},{"location":"console/#command-help","title":"Command help","text":"<p>For a complete list of parameters and help:</p> <pre><code>qtasks --help\n</code></pre> <p>For help on a command:</p> <pre><code>qtasks &lt;command&gt; --help\n</code></pre>"},{"location":"console/#example","title":"Example","text":"<pre><code>qtasks -A based_async_app:app run\nqtasks -A based_async_app:app stats inspect tasks json=true\nqtasks web -A based_async_app:app --port 8000\n</code></pre>"},{"location":"getting_started/","title":"Getting started with QTasks","text":""},{"location":"getting_started/#quick-start-your-first-task-in-a-couple-of-minutes","title":"Quick start: your first task in a couple of minutes","text":"<p>Below is a minimal example of setting up and running QTasks for synchronous tasks, as well as a brief guide on how to use the asynchronous version.</p>"},{"location":"getting_started/#1-creating-an-application-instance","title":"1. Creating an application instance","text":"<pre><code>from qtasks import QueueTasks\n# for the asynchronous version:\n# from qtasks.asyncio import QueueTasks\n\napp = QueueTasks()\n</code></pre> <p>Info</p> <p>By default, Redis at <code>redis://localhost:6379/0</code> is used as the broker and storage.</p>"},{"location":"getting_started/#2-registering-tasks","title":"2. Registering tasks","text":"<p>Tasks are registered using the <code>@app.task</code> decorator.</p> <pre><code>@app.task(name=\u201cmytest\u201d)  # Regular task\ndef mytest(text: str):\n    print(text)\n    return text\n\n\n@app.task(name=\u201cerror_zero\u201d)  # Task with an error\ndef error_zero():\n    result = 1 / 0\n    return\n</code></pre> <p>Info</p> <p>If the task name is not explicitly specified (<code>name</code> parameter), the function name is used.</p> <p>Tip</p> <p>The task name can be anything, but it must be unique within the application. If a task with that name already exists, an exception will be raised during registration.</p>"},{"location":"getting_started/#3-running-the-task-handler","title":"3. Running the task handler","text":"<p>There are two ways to start the task handler.</p>"},{"location":"getting_started/#option-1-via-run_forever","title":"Option 1: via <code>run_forever()</code>","text":"<pre><code>if __name__ == \u201c__main__\u201d:\n    app.run_forever()\n</code></pre>"},{"location":"getting_started/#option-2-via-cli","title":"Option 2: via CLI","text":"<pre><code>qtasks -A app:app run\n</code></pre> <p>Where <code>app:app</code> is <code>module:variable</code>, i.e. the module with the application and the variable that stores the <code>QueueTasks</code> instance.</p>"},{"location":"getting_started/#4-complete-example-of-a-file-with-tasks","title":"4. Complete example of a file with tasks","text":"<pre><code># file: app.py\nfrom qtasks import QueueTasks\n\n\napp = QueueTasks()\n\n\n@app.task(name=\u201cmytest\u201d)  # Example of a normal task\ndef mytest(text: str):\n    print(text)\n    return text\n\n\n@app.task(name=\u201cerror_zero\u201d)  # Example of a task with an error\ndef error_zero():\n    result = 1 / 0\n    return\n\n\nif __name__ == \u201c__main__\u201d:\n    app.run_forever()\n</code></pre>"},{"location":"getting_started/#5-adding-tasks-to-the-queue","title":"5. Adding tasks to the queue","text":"<p>After starting the task handler, you can add tasks from another file or from the interactive Python interpreter:</p> <pre><code># file: add_tasks.py\nfrom app import app, mytest\n\n# Adding a task by name via an application instance\napp.add_task(\u201cmytest\u201d, \u201cTest\u201d)\n\n# Calling via a registered task function\nmytest.add_task(\u201cTest\u201d)\n\n# Adding a task with a timeout (in seconds)\nmytest.add_task(\u201cTest\u201d, timeout=50)\n\n# Adding a task that will result in an error\napp.add_task(\u201cerror_zero\u201d)\n</code></pre> <p>The <code>add_task</code> method supports positional and named arguments (<code>*args</code>, <code>**kwargs</code>) that will be passed to the task function.</p>"},{"location":"getting_started/#6-asynchronous-option-briefly","title":"6. Asynchronous option (briefly)","text":"<p>The asynchronous option is configured similarly, but using <code>qtasks.asyncio.QueueTasks</code> and <code>async</code> functions:</p> <pre><code>from qtasks.asyncio import QueueTasks\n\n\napp = QueueTasks()\n\n\n@app.task(name=\u201cmytest_async\u201d)\nasync def mytest_async(text: str):\n    print(text)\n    return text\n\n\nif __name__ == \u201c__main__\u201d:\n    app.run_forever()\n</code></pre> <p>More about asynchronous tasks, <code>AsyncTask</code>, and the execution context:</p> <ul> <li> <p> (A)syncTask</p> <p>Learn more about converting @app.task</p> <p> Task decorator</p> </li> <li> <p> Task Context</p> <p>Understand task execution context and its application</p> <p> Task context</p> </li> </ul>"},{"location":"install/","title":"Installation","text":"<p><code>QTasks</code> can be installed via PyPI or used directly from the source code. The framework does not restrict the choice of infrastructure and supports multiple message brokers. Redis is used by default.</p>"},{"location":"install/#installation-via-pypi","title":"Installation via PyPI","text":""},{"location":"install/#basic-installation-redis-by-default","title":"Basic installation (Redis by default)","text":"<pre><code>pip install qtasks\n</code></pre>"},{"location":"install/#webview-installation-optional","title":"WebView installation (optional)","text":"<p>The <code>QTasks WebView</code> component provides a web interface for monitoring tasks.</p> <pre><code>pip install qtasks_webview\n</code></pre>"},{"location":"install/#installation-with-support-for-other-brokers","title":"Installation with support for other brokers","text":"<p>Info</p> <p>Before installing, make sure that the selected broker is deployed and accessible to your application.</p>"},{"location":"install/#rabbitmq","title":"RabbitMQ","text":"<pre><code>pip install qtasks[rabbitmq]\n</code></pre>"},{"location":"install/#kafka","title":"Kafka","text":"<pre><code>pip install qtasks [kafka]\n</code></pre>"},{"location":"install/#installation-from-source-code-github","title":"Installation from source code (GitHub)","text":"<p>Use the source repository if you need the latest version or if you plan to make changes:</p> <pre><code>git clone https://github.com/txello/qtasks.git\ncd qtasks/\npip install .\n</code></pre>"},{"location":"next/","title":"What's next?","text":"<ul> <li> <p> Exploring the possibilities</p> <p>Learn more about the possibilities of QTasks.</p> <p> Features</p> </li> <li> <p> Writing plugins</p> <p>Write your own plugins that integrate smoothly into the system.</p> <p> How to write plugins</p> </li> <li> <p> Integrating</p> <p>Integrate QTasks into your project with just a few lines of code.</p> <p> Integration</p> </li> <li> <p> Analyze</p> <p>Analyze usage, review tasks, and apply them to your work.</p> <p> Analytics</p> </li> </ul>"},{"location":"schemas/","title":"Diagrams","text":""},{"location":"schemas/#background-diagram-of-framework-connections","title":"Background diagram of framework connections","text":"<pre><code>sequenceDiagram\n  autonumber\n  participant QueueTasks\n  participant Starter\n  participant Worker\n  participant Broker\n  participant Storage\n  participant GlobalConfig\n\n  QueueTasks-&gt;&gt;Starter: Initialization / configuration\n  Starter-&gt;&gt;Worker: Start\n  Starter-&gt;&gt;Broker: Start\n  Broker-&gt;&gt;Storage: Initialization / start\n  Storage-&gt;&gt;GlobalConfig: Initialization (if any)\n\n  GlobalConfig--&gt;&gt;Storage: Stop\n  Storage--&gt;&gt;Broker: Stop\n  Broker--&gt;&gt;Worker: Stop\n  Starter--&gt;&gt;QueueTasks: Termination</code></pre> <p>This diagram shows the relationship between components and the correct startup order:</p> <ul> <li>Starter starts only Worker and Broker.</li> <li>Broker starts Storage.</li> <li>Storage starts GlobalConfig, if present.</li> <li>Shutdown occurs in reverse order.</li> </ul>"},{"location":"schemas/#task-processing-by-the-server","title":"Task processing by the server","text":"<pre><code>sequenceDiagram\n  autonumber\n  participant Storage\n  participant Broker\n  participant Worker\n  participant TaskExecutor\n\n  Broker-&gt;&gt;Storage: Save new task\n  Broker-&gt;&gt;Worker: Transfer task\n  Worker-&gt;&gt;TaskExecutor: Execute task\n  TaskExecutor--&gt;&gt;Worker: Execution result\n  Worker-&gt;&gt;Storage: Save result</code></pre> <p>This diagram reflects the actual process:</p> <ol> <li>The task is saved in Storage.</li> <li>The broker transfers the task to the worker.</li> <li>Worker calls TaskExecutor \u2014 a replaceable task execution component.</li> <li>TaskExecutor executes the task function, calls middlewares_before/middlewares_after, handles errors and retries.</li> <li>The result is transferred to the worker and saved in Storage.</li> </ol>"},{"location":"schemas/#task-creation-by-the-client","title":"Task creation by the client","text":"<pre><code>sequenceDiagram\n  autonumber\n  participant AT as (A)syncTask.add_task()\n  participant QT as QueueTasks.add_task()\n  participant Broker\n\n  AT-&gt;&gt;QT: Preparing task parameters\n  QT-&gt;&gt;Broker: Registering a new task</code></pre> <p>The process looks like this:</p> <ol> <li><code>(A)syncTask.add_task()</code> or <code>TaskCls().__call__().add_task()</code> prepares the parameters.</li> <li>Internally, everything is translated to <code>QueueTasks.add_task()</code>.</li> <li>The broker accepts the task and saves it via Storage.</li> </ol>"},{"location":"schemas/#receiving-the-task-result-by-the-client","title":"Receiving the task result by the client","text":"<pre><code>sequenceDiagram\n  autonumber\n  participant AT as (A)syncTask.add_task()\n  participant AR as (A)syncResult.result()\n  participant QT as QueueTasks\n  participant Broker\n  participant Storage\n\n  AT-&gt;&gt;AR: Create result object\n  AR-&gt;&gt;QT: Request result\n  QT-&gt;&gt;Broker: Proxy request\n  Broker-&gt;&gt;Storage: Read result\n  Storage--&gt;&gt;Broker: Data\n  Broker--&gt;&gt;QT: Result\n  QT--&gt;&gt;AR: Return result</code></pre> <p>Steps:</p> <ol> <li><code>(A)syncTask.add_task()</code> creates <code>(A)syncResult</code>.</li> <li><code>(A)syncResult.result()</code> calls <code>QueueTasks</code>, which proxies the request.</li> <li><code>QueueTasks.get()</code> is redirected to <code>Broker.get()</code>.</li> <li>Broker requests data from Storage.</li> <li>Storage returns the result.</li> <li>The result is sent back through Broker \u2192 QueueTasks \u2192 (A)syncResult.</li> </ol>"},{"location":"tests/","title":"Testing","text":"<p>QTasks supports testing tasks and components in both synchronous and asynchronous modes. You can use standard Python tools (<code>unittest</code>, <code>pytest</code>) and asynchronous add-ons (<code>pytest-asyncio</code>), as well as the framework's built-in test cases.</p>"},{"location":"tests/#quick-test-launch","title":"Quick test launch","text":"<p>Minimal example for launching tests directly:</p>"},{"location":"tests/#quick-test-execution","title":"Quick test execution","text":"<p>A minimal example of running tests directly:</p> <pre><code>py tests/main.py\n</code></pre> <p>When using <code>pytest</code>:</p> <pre><code>pytest -v\n</code></pre> <p>When using <code>tox</code> (for multiple Python versions):</p> <pre><code>tox\n</code></pre> <p>Specific environment:</p> <pre><code>tox -e py312\n</code></pre>"},{"location":"tests/#supported-frameworks","title":"Supported frameworks","text":"<ul> <li>\u2705 <code>unittest</code> \u2014 Python's basic standard framework.</li> <li>\u2705 <code>pytest</code> \u2014 a flexible and extensible testing system.</li> <li>\u2705 <code>pytest-asyncio</code> \u2014 adds support for <code>async</code> tests for <code>pytest</code>.</li> <li>\u2705 <code>SyncTestCase</code> / <code>AsyncTestCase</code> \u2014 built-in QTasks cases for fine-tuning the testing environment.</li> </ul> <p>Asynchronous libraries such as <code>aiounittest</code> can be used as desired, but the main focus of the examples is on <code>unittest</code> and <code>pytest</code>.</p>"},{"location":"tests/#basic-examples","title":"Basic examples","text":""},{"location":"tests/#unittest-synchronous","title":"<code>unittest</code> (synchronous)","text":"<pre><code>import unittest\nfrom app import app\n\n\nclass TestTasks(unittest.TestCase):\n    def setUp(self):\n        # Add a task to the queue\n        self._result = app.add_task(\u201ctest\u201d, 5)\n\n    def test_task_get_result(self):\n        uuid = self._result.uuid\n        result = app.get(uuid=uuid)\n        self.assertIsNotNone(result)\n</code></pre> <p>Here, <code>app.get()</code> is a public method that proxies the request to the broker and then to the storage (<code>app.broker.get()</code>, <code>app.broker.storage.get()</code>).</p>"},{"location":"tests/#unittest-asynchronously","title":"<code>unittest</code> (asynchronously)","text":"<pre><code>import unittest\nfrom app import app\n\n\nclass TestAsyncTasks(unittest.IsolatedAsyncioTestCase):\n    async def _add_task(self):\n        return await app.add_task(\u201ctest\u201d, 5)\n\n    async def test_task_get_result(self):\n        task = await self._add_task()\n        result = await app.get(uuid=task.uuid)\n        self.assertIsNotNone(result)\n</code></pre> <p>Asynchronous tests use <code>IsolatedAsyncioTestCase</code>, available in the standard Python 3.8+ library.</p>"},{"location":"tests/#built-in-qtasks-test-cases","title":"Built-in QTasks test cases","text":"<p>QTasks provides its own test wrappers <code>SyncTestCase</code> and <code>AsyncTestCase</code>, which allow you to:</p> <ul> <li>replace application components (broker, worker, storage) with test implementations depending on <code>TestConfig</code>;</li> <li>run tasks without a separate server;</li> <li>test logic with different environment configurations.</li> </ul> <p>For more information about <code>TestConfig</code>, see: API/Schemas/TestConfig.</p>"},{"location":"tests/#synctestcase","title":"<code>SyncTestCase</code>","text":"<pre><code>import unittest\n\nfrom qtasks.tests import SyncTestCase\nfrom qtasks.schemas.test import TestConfig\nfrom app import app\n\n\nclass TestTasks(unittest.TestCase):\n    def setUp(self):\n        self.case = SyncTestCase(app=app)\n        # Enable full test config\n        self.case.settings(TestConfig.full())\n\n    def test_task_add(self):\n        task = self.case.add_task(\u201ctest\u201d, 5)\n        self.assertIsNotNone(task)\n</code></pre>"},{"location":"tests/#asynctestcase","title":"<code>AsyncTestCase</code>","text":"<pre><code>import unittest\n\nfrom qtasks.tests import AsyncTestCase\nfrom qtasks.schemas.test import TestConfig\nfrom app import app\n\n\nclass TestAsyncQTasks(unittest.IsolatedAsyncioTestCase):\n    def setUp(self):\n        self.case = AsyncTestCase(app=app)\n        self.case.settings(TestConfig.full())\n\n    async def _add_task(self):\n        return await self.case.add_task(\u201ctest\u201d, 5, timeout=10)\n\n    async def test_add_task(self):\n        task = await self._add_task()\n        self.assertIsNotNone(task)\n</code></pre> <p>Depending on the <code>TestConfig</code> settings, application components can be replaced with test (empty) classes, which allows you to isolate the logic being tested.</p>"},{"location":"tests/#example-with-pytest-and-pytest-asyncio","title":"Example with <code>pytest</code> and <code>pytest-asyncio</code>","text":""},{"location":"tests/#installation","title":"Installation","text":"<pre><code>pip install pytest pytest-asyncio\n</code></pre>"},{"location":"tests/#example-of-the-teststest_async_taskpy-file","title":"Example of the <code>tests/test_async_task.py</code> file","text":"<pre><code>import pytest\nfrom uuid import uuid4\n\nfrom qtasks.tests import AsyncTestCase\nfrom qtasks.schemas.test import TestConfig\nfrom qtasks.enums.task_status import TaskStatusEnum\n\nfrom tests.apps.app_async import app\n\n@pytest.fixture()\ndef test_case():\n    case = AsyncTestCase(app=app)\n    case.settings(TestConfig.full())\n    return case\n\n@pytest.mark.asyncio\nasync def test_task_get_result(test_case):\n    task = await test_case.add_task(\u201ctest\u201d, 5)\n    result = await app.get(uuid=task.uuid)\n    assert result is not None\n\n@pytest.mark.asyncio\nasync def test_task_returns_expected_result(test_case):\n    task = await test_case.add_task(\u201ctest\u201d, 5, timeout=10)\n    # Check that the task returned the expected value\n    assert task.returning is not None\n\n@pytest.mark.asyncio\nasync def test_task_error_handling(test_case):\n    task = await test_case.add_task(\u201cerror_task\u201d, timeout=10)\n    assert task.status == TaskStatusEnum.ERROR.value\n\n@pytest.mark.asyncio\nasync def test_task_not_found():\n    # UUID missing from storage\n    result = await app.get(uuid=str(uuid4()))\n    assert result is None\n</code></pre>"},{"location":"tests/#running-tests","title":"Running tests","text":"<pre><code>pytest tests/test_async_task.py -v\n</code></pre> <p>These examples demonstrate the basic approach to testing tasks, configurations, and errors in QTasks. More advanced scenarios (testing plugins, middleware, task chains, etc.) are described in specialized sections of the documentation.</p>"},{"location":"api/exceptions/","title":"\u0418\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f","text":"<p>Task exceptions.</p> <p>Plugins exceptions.</p>"},{"location":"api/exceptions/#qtasks.exc.task.TaskCancelError","title":"<code>TaskCancelError</code>","text":"<p>               Bases: <code>RuntimeError</code></p> <p>The exception thrown when a task is canceled.</p> <pre><code>Can be intercepted in Worker to handle task cancellations.\n</code></pre> Source code in <code>src/qtasks/exc/task.py</code> <pre><code>class TaskCancelError(RuntimeError):\n    \"\"\"\n    The exception thrown when a task is canceled.\n\n        Can be intercepted in Worker to handle task cancellations.\n    \"\"\"\n\n    def __init__(self, *args):\n        \"\"\"Initializing an exception.\"\"\"\n        super().__init__(*args)\n</code></pre>"},{"location":"api/exceptions/#qtasks.exc.task.TaskCancelError.__init__","title":"<code>__init__(*args)</code>","text":"<p>Initializing an exception.</p> Source code in <code>src/qtasks/exc/task.py</code> <pre><code>def __init__(self, *args):\n    \"\"\"Initializing an exception.\"\"\"\n    super().__init__(*args)\n</code></pre>"},{"location":"api/exceptions/#qtasks.exc.plugins.TaskPluginTriggerError","title":"<code>TaskPluginTriggerError</code>","text":"<p>               Bases: <code>Exception</code></p> <p>The exception thrown when the plugin trigger fires.</p> <pre><code>Can be intercepted in Worker to process triggers.\n</code></pre> Source code in <code>src/qtasks/exc/plugins.py</code> <pre><code>class TaskPluginTriggerError(Exception):\n    \"\"\"\n    The exception thrown when the plugin trigger fires.\n\n        Can be intercepted in Worker to process triggers.\n    \"\"\"\n\n    def __init__(self, *args, **kwargs):\n        \"\"\"Initializing an exception.\"\"\"\n        super().__init__(*args)\n        self.kwargs = kwargs\n</code></pre>"},{"location":"api/exceptions/#qtasks.exc.plugins.TaskPluginTriggerError.__init__","title":"<code>__init__(*args, **kwargs)</code>","text":"<p>Initializing an exception.</p> Source code in <code>src/qtasks/exc/plugins.py</code> <pre><code>def __init__(self, *args, **kwargs):\n    \"\"\"Initializing an exception.\"\"\"\n    super().__init__(*args)\n    self.kwargs = kwargs\n</code></pre>"},{"location":"api/logs/","title":"\u041b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435","text":"<p>Logging.</p>"},{"location":"api/logs/#qtasks.logs.Logger","title":"<code>Logger</code>","text":"<p><code>Logger</code> - Logging class, used by all components.</p>"},{"location":"api/logs/#qtasks.logs.Logger--example","title":"Example","text":"<pre><code>from qtasks import QueueTasks\nfrom qtasks.logs import Logger\n\nlogger = Logger(name=\"QueueTasks\", subname=\"Global\")\napp = QueueTasks(log=logger)\n\napp.log.debug(\"Test\") # asctime [QueueTasks: DEBUG] (QueueTasks) Test\n</code></pre> Source code in <code>src/qtasks/logs.py</code> <pre><code>class Logger:\n    \"\"\"`Logger` - Logging class, used by all components.\n\n    ## Example\n\n    ```python\n    from qtasks import QueueTasks\n    from qtasks.logs import Logger\n\n    logger = Logger(name=\"QueueTasks\", subname=\"Global\")\n    app = QueueTasks(log=logger)\n\n    app.log.debug(\"Test\") # asctime [QueueTasks: DEBUG] (QueueTasks) Test\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Name. Used in the `%(name)s` pattern.\n                    \"\"\"),\n        ],\n        subname: Annotated[\n            str | None,\n            Doc(\"\"\"\n                    Component name.\n\n                    Default: None.\n                    \"\"\"),\n        ] = None,\n        default_level: Annotated[\n            int,\n            Doc(\"\"\"\n                    Level by default.\n\n                    Default: `logging.INFO`.\n                    \"\"\"),\n        ] = logging.INFO,\n        format: Annotated[\n            str | None,\n            Doc(\"\"\"\n                    Logging format.\n\n                    Default: `%(asctime)s [%(name)s: %(levelname)s] (%(subname)s) %(message)s`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Logger instance.\n\n        Args:\n            name (str): Name. Used in the `%(name)s` pattern.\n            subname (str, optional): Component name. Default: `None`.\n            default_level (int, optional): Default level. Default: `logging.DEBUG`.\n            format (str, optional): Logging format.\n        \"\"\"\n        self.name = name\n        self.name = name\n        self.subname = subname or \"-\"\n        self.format = format\n        self.default_level = default_level\n        self.logger = logging.getLogger(name)\n\n        formatter = logging.Formatter(\n            self.format\n            or \"%(asctime)s [%(name)s: %(levelname)s] (%(subname)s) %(message)s\"\n        )\n\n        if not self.logger.handlers:\n            handler = logging.StreamHandler()\n            handler.setFormatter(formatter)\n            self.logger.addHandler(handler)\n\n        self.logger.setLevel(default_level)\n\n    def critical(self, *args, **kwargs):\n        \"\"\"Critical.\"\"\"\n        self._log(logging.CRITICAL, *args, **kwargs)\n\n    def error(self, *args, **kwargs):\n        \"\"\"Error.\"\"\"\n        self._log(logging.ERROR, *args, **kwargs)\n\n    def warning(self, *args, **kwargs):\n        \"\"\"Warning.\"\"\"\n        self._log(logging.WARNING, *args, **kwargs)\n\n    def info(self, *args, **kwargs):\n        \"\"\"Info.\"\"\"\n        self._log(logging.INFO, *args, **kwargs)\n\n    def debug(self, *args, **kwargs):\n        \"\"\"Debug.\"\"\"\n        self._log(logging.DEBUG, *args, **kwargs)\n\n    def with_subname(\n        self,\n        new_subname: str,\n        default_level: int | None = None,\n        format: str | None = None,\n    ) -&gt; Logger:\n        \"\"\"\n        Update `subname`.\n\n        Args:\n            new_subname (str): New `subname`.\n            default_level (int, optional): New logging level. Default: `None`.\n            format (str, optional): New logging format. Default: `None`.\n\n        Returns:\n            Logger: New `Logger`.\n        \"\"\"\n        return Logger(\n            self.name,\n            new_subname,\n            default_level=default_level or self.default_level,\n            format=format or self.format,\n        )\n\n    def update_logger(self, **kwargs) -&gt; Logger:\n        \"\"\"\n        Update `Logger`.\n\n        Args:\n            kwargs (dict): New task data.\n\n        Returns:\n            Logger: New `Logger`.\n        \"\"\"\n        name = kwargs.get(\"name\") or self.name\n        subname = kwargs.get(\"subname\") or self.subname\n        default_level = kwargs.get(\"default_level\") or self.default_level\n        format = kwargs.get(\"format\") or self.format\n        return Logger(\n            name=name, subname=subname, default_level=default_level, format=format\n        )\n\n    def _log(self, level, msg, *args, **kwargs):\n        extra = kwargs.pop(\"extra\", {})\n        if \"subname\" not in extra:\n            extra[\"subname\"] = self.subname\n        self.logger.log(level, msg, *args, extra=extra, **kwargs)\n</code></pre>"},{"location":"api/logs/#qtasks.logs.Logger.__init__","title":"<code>__init__(name, subname=None, default_level=logging.INFO, format=None)</code>","text":"<p>Logger instance.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Name. Used in the <code>%(name)s</code> pattern.</p> required <code>subname</code> <code>str</code> <p>Component name. Default: <code>None</code>.</p> <code>None</code> <code>default_level</code> <code>int</code> <p>Default level. Default: <code>logging.DEBUG</code>.</p> <code>INFO</code> <code>format</code> <code>str</code> <p>Logging format.</p> <code>None</code> Source code in <code>src/qtasks/logs.py</code> <pre><code>def __init__(\n    self,\n    name: Annotated[\n        str,\n        Doc(\"\"\"\n                Name. Used in the `%(name)s` pattern.\n                \"\"\"),\n    ],\n    subname: Annotated[\n        str | None,\n        Doc(\"\"\"\n                Component name.\n\n                Default: None.\n                \"\"\"),\n    ] = None,\n    default_level: Annotated[\n        int,\n        Doc(\"\"\"\n                Level by default.\n\n                Default: `logging.INFO`.\n                \"\"\"),\n    ] = logging.INFO,\n    format: Annotated[\n        str | None,\n        Doc(\"\"\"\n                Logging format.\n\n                Default: `%(asctime)s [%(name)s: %(levelname)s] (%(subname)s) %(message)s`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    Logger instance.\n\n    Args:\n        name (str): Name. Used in the `%(name)s` pattern.\n        subname (str, optional): Component name. Default: `None`.\n        default_level (int, optional): Default level. Default: `logging.DEBUG`.\n        format (str, optional): Logging format.\n    \"\"\"\n    self.name = name\n    self.name = name\n    self.subname = subname or \"-\"\n    self.format = format\n    self.default_level = default_level\n    self.logger = logging.getLogger(name)\n\n    formatter = logging.Formatter(\n        self.format\n        or \"%(asctime)s [%(name)s: %(levelname)s] (%(subname)s) %(message)s\"\n    )\n\n    if not self.logger.handlers:\n        handler = logging.StreamHandler()\n        handler.setFormatter(formatter)\n        self.logger.addHandler(handler)\n\n    self.logger.setLevel(default_level)\n</code></pre>"},{"location":"api/logs/#qtasks.logs.Logger.critical","title":"<code>critical(*args, **kwargs)</code>","text":"<p>Critical.</p> Source code in <code>src/qtasks/logs.py</code> <pre><code>def critical(self, *args, **kwargs):\n    \"\"\"Critical.\"\"\"\n    self._log(logging.CRITICAL, *args, **kwargs)\n</code></pre>"},{"location":"api/logs/#qtasks.logs.Logger.debug","title":"<code>debug(*args, **kwargs)</code>","text":"<p>Debug.</p> Source code in <code>src/qtasks/logs.py</code> <pre><code>def debug(self, *args, **kwargs):\n    \"\"\"Debug.\"\"\"\n    self._log(logging.DEBUG, *args, **kwargs)\n</code></pre>"},{"location":"api/logs/#qtasks.logs.Logger.error","title":"<code>error(*args, **kwargs)</code>","text":"<p>Error.</p> Source code in <code>src/qtasks/logs.py</code> <pre><code>def error(self, *args, **kwargs):\n    \"\"\"Error.\"\"\"\n    self._log(logging.ERROR, *args, **kwargs)\n</code></pre>"},{"location":"api/logs/#qtasks.logs.Logger.info","title":"<code>info(*args, **kwargs)</code>","text":"<p>Info.</p> Source code in <code>src/qtasks/logs.py</code> <pre><code>def info(self, *args, **kwargs):\n    \"\"\"Info.\"\"\"\n    self._log(logging.INFO, *args, **kwargs)\n</code></pre>"},{"location":"api/logs/#qtasks.logs.Logger.update_logger","title":"<code>update_logger(**kwargs)</code>","text":"<p>Update <code>Logger</code>.</p> <p>Parameters:</p> Name Type Description Default <code>kwargs</code> <code>dict</code> <p>New task data.</p> <code>{}</code> <p>Returns:</p> Name Type Description <code>Logger</code> <code>Logger</code> <p>New <code>Logger</code>.</p> Source code in <code>src/qtasks/logs.py</code> <pre><code>def update_logger(self, **kwargs) -&gt; Logger:\n    \"\"\"\n    Update `Logger`.\n\n    Args:\n        kwargs (dict): New task data.\n\n    Returns:\n        Logger: New `Logger`.\n    \"\"\"\n    name = kwargs.get(\"name\") or self.name\n    subname = kwargs.get(\"subname\") or self.subname\n    default_level = kwargs.get(\"default_level\") or self.default_level\n    format = kwargs.get(\"format\") or self.format\n    return Logger(\n        name=name, subname=subname, default_level=default_level, format=format\n    )\n</code></pre>"},{"location":"api/logs/#qtasks.logs.Logger.warning","title":"<code>warning(*args, **kwargs)</code>","text":"<p>Warning.</p> Source code in <code>src/qtasks/logs.py</code> <pre><code>def warning(self, *args, **kwargs):\n    \"\"\"Warning.\"\"\"\n    self._log(logging.WARNING, *args, **kwargs)\n</code></pre>"},{"location":"api/logs/#qtasks.logs.Logger.with_subname","title":"<code>with_subname(new_subname, default_level=None, format=None)</code>","text":"<p>Update <code>subname</code>.</p> <p>Parameters:</p> Name Type Description Default <code>new_subname</code> <code>str</code> <p>New <code>subname</code>.</p> required <code>default_level</code> <code>int</code> <p>New logging level. Default: <code>None</code>.</p> <code>None</code> <code>format</code> <code>str</code> <p>New logging format. Default: <code>None</code>.</p> <code>None</code> <p>Returns:</p> Name Type Description <code>Logger</code> <code>Logger</code> <p>New <code>Logger</code>.</p> Source code in <code>src/qtasks/logs.py</code> <pre><code>def with_subname(\n    self,\n    new_subname: str,\n    default_level: int | None = None,\n    format: str | None = None,\n) -&gt; Logger:\n    \"\"\"\n    Update `subname`.\n\n    Args:\n        new_subname (str): New `subname`.\n        default_level (int, optional): New logging level. Default: `None`.\n        format (str, optional): New logging format. Default: `None`.\n\n    Returns:\n        Logger: New `Logger`.\n    \"\"\"\n    return Logger(\n        self.name,\n        new_subname,\n        default_level=default_level or self.default_level,\n        format=format or self.format,\n    )\n</code></pre>"},{"location":"api/queuetasks/","title":"QueueTasks sync","text":"<p>QTasks - Main module for the QueueTasks framework.</p>"},{"location":"api/queuetasks/#qtasks.qtasks.QueueTasks","title":"<code>QueueTasks</code>","text":"<p>               Bases: <code>BaseQueueTasks</code>, <code>SyncPluginMixin</code></p> <p><code>QueueTasks</code> - Framework for task queues.</p> <p>Read more: First steps.</p>"},{"location":"api/queuetasks/#qtasks.qtasks.QueueTasks--example","title":"Example","text":"<pre><code>from qtasks import QueueTasks\n\napp = QueueTasks()\n</code></pre> Source code in <code>src/qtasks/qtasks.py</code> <pre><code>class QueueTasks(BaseQueueTasks, SyncPluginMixin):\n    \"\"\"\n    `QueueTasks` - Framework for task queues.\n\n    Read more:\n    [First steps](https://txello.github.io/qtasks/getting_started/).\n\n    ## Example\n\n    ```python\n    from qtasks import QueueTasks\n\n    app = QueueTasks()\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Project name. This name is also used by components (Worker, Broker, etc.)\n\n                    Default: `QueueTasks`.\n                    \"\"\"),\n        ] = \"QueueTasks\",\n        broker_url: Annotated[\n            str | None,\n            Doc(\"\"\"\n                    Broker URL. Used by the Broker by default via the url parameter.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        broker: Annotated[\n            Optional[BaseBroker],\n            Doc(\"\"\"\n                    Broker. Stores processing from task queues and data storage.\n\n                    Default: `qtasks.brokers.SyncRedisBroker`.\n                    \"\"\"),\n        ] = None,\n        worker: Annotated[\n            Optional[BaseWorker],\n            Doc(\"\"\"\n                    Worker. Stores task processing.\n\n                    Default: `qtasks.workers.SyncWorker`.\n                    \"\"\"),\n        ] = None,\n        log: Annotated[\n            Logger | None,\n            Doc(\"\"\"\n                    Logger.\n\n                    Default: `qtasks.logs.Logger`.\n                    \"\"\"),\n        ] = None,\n        config: Annotated[\n            QueueConfig | None,\n            Doc(\"\"\"\n                    Config.\n\n                    Default: `qtasks.configs.QueueConfig`.\n                    \"\"\"),\n        ] = None,\n        events: Annotated[\n            Optional[BaseEvents],\n            Doc(\"\"\"\n                    Events.\n\n                    Default: `qtasks.events.SyncEvents`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Initializing QueueTasks.\n\n        Args:\n            name (str): Project name. Default: `QueueTasks`.\n            broker_url (str, optional): URL for the Broker. Used by the Broker by default via the url parameter. Default: `None`.\n            broker (Type[BaseBroker], optional): Broker. Stores processing from task queues and data storage. Default: `qtasks.brokers.AsyncRedisBroker`.\n            worker (Type[BaseWorker], optional): Worker. Stores task processing. Default: `qtasks.workers.AsyncWorker`.\n            log (Logger, optional): Logger. Default: `qtasks.logs.Logger`.\n            config (QueueConfig, optional): Config. Default: `qtasks.configs.QueueConfig`.\n            events (BaseEvents, optional): Events. Default: `qtasks.events.SyncEvents`.\n        \"\"\"\n        broker = broker or SyncRedisBroker(\n            name=name, url=broker_url, log=log, config=config, events=events\n        )\n        worker = worker or SyncThreadWorker(\n            name=name, broker=broker, log=log, config=config, events=events\n        )\n        events = events or SyncEvents()\n\n        super().__init__(\n            name=name,\n            broker=broker,\n            worker=worker,\n            log=log,\n            config=config,\n            events=events,\n        )\n\n        self._method = \"sync\"\n\n        self.broker: BaseBroker[Literal[False]]\n        self.worker: BaseWorker[Literal[False]]\n\n        self.starter: BaseStarter[Literal[False]] | None = None\n\n        self._registry_tasks()\n\n        self._set_state()\n\n    @overload\n    def add_task(\n        self,\n        task_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        *args: Annotated[\n            Any,\n            Doc(\"\"\"\n                    args of the task.\n\n                    Default: `()`.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int | None,\n            Doc(\"\"\"\n                    The task has priority.\n\n                    Default: Task priority value.\n                    \"\"\"),\n        ] = None,\n        timeout: Annotated[\n            float,\n            Doc(\"\"\"\n                    Task timeout.\n\n                    If specified, the task is returned via `qtasks.results.AsyncTask`.\n                    \"\"\"),\n        ] = 0.0,\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    kwargs tasks.\n\n                    Default: `{}`.\n                    \"\"\"),\n        ],\n    ) -&gt; Optional[Task]: ...\n\n    @overload\n    def add_task(\n        self,\n        task_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        *args: Annotated[\n            Any,\n            Doc(\"\"\"\n                    args of the task.\n\n                    Default: `()`.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int | None,\n            Doc(\"\"\"\n                    The task has priority.\n\n                    Default: Task priority value.\n                    \"\"\"),\n        ] = None,\n        timeout: Annotated[\n            None,\n            Doc(\"\"\"\n                    Task timeout.\n\n                    If specified, the task is returned via `qtasks.results.AsyncTask`.\n                    \"\"\"),\n        ] = None,\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    kwargs tasks.\n\n                    Default: `{}`.\n                    \"\"\"),\n        ],\n    ) -&gt; Task: ...\n\n    @overload\n    def add_task(\n        self,\n        task_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        *args: Annotated[\n            Any,\n            Doc(\"\"\"\n                    args of the task.\n\n                    Default: `()`.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int | None,\n            Doc(\"\"\"\n                    The task has priority.\n\n                    Default: Task priority value.\n                    \"\"\"),\n        ] = None,\n        timeout: Annotated[\n            float | None,\n            Doc(\"\"\"\n                    Task timeout.\n\n                    If specified, the task is returned via `qtasks.results.AsyncTask`.\n                    \"\"\"),\n        ] = None,\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    kwargs tasks.\n\n                    Default: `{}`.\n                    \"\"\"),\n        ],\n    ) -&gt; Optional[Task]: ...\n\n    def add_task(\n        self,\n        task_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        *args: Annotated[\n            Any,\n            Doc(\"\"\"\n                    args of the task.\n\n                    Default: `()`.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int | None,\n            Doc(\"\"\"\n                    The task has priority.\n\n                    Default: Task priority value.\n                    \"\"\"),\n        ] = None,\n        timeout: Annotated[\n            float | None,\n            Doc(\"\"\"\n                    Task timeout.\n\n                    If specified, the task is returned via `qtasks.results.AsyncTask`.\n                    \"\"\"),\n        ] = None,\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    kwargs tasks.\n\n                    Default: `{}`.\n                    \"\"\"),\n        ],\n    ) -&gt; Union[Task, Optional[Task]]:\n        \"\"\"\n        Add a task.\n\n        Args:\n            task_name (str): The name of the task.\n            priority (int, optional): Task priority. Default: Task priority value.\n            args (tuple, optional): Task args. Defaults to `()`.\n            kwargs (dict, optional): Kwargs tasks. Defaults to `{}`.\n\n            timeout (float, optional): Task timeout. If specified, the task is returned via `qtasks.results.SyncResult`.\n\n        Returns:\n            Task|None: `schemas.task.Task` or `None`.\n        \"\"\"\n        if priority is None:\n            task_registry = self.tasks.get(task_name, 0)\n            priority = (\n                task_registry.priority\n                if isinstance(task_registry, TaskExecSchema)\n                else 0\n            )\n\n        extra = None\n\n        new_args = self._plugin_trigger(\n            \"qtasks_add_task_before_broker\",\n            qtasks=self,\n            broker=self.broker,\n            task_name=task_name,\n            priority=priority,\n            args=args,\n            kw=kwargs,\n            return_last=True,\n        )\n\n        task_priority: int = priority\n\n        if new_args:\n            task_name = new_args.get(\"task_name\", task_name)\n            task_priority = new_args.get(\"priority\", task_priority)\n            extra = new_args.get(\"extra\", extra)\n            args = new_args.get(\"args\", args)\n            kwargs = new_args.get(\"kw\", kwargs)\n\n        task = self.broker.add(\n            task_name=task_name,\n            priority=task_priority,\n            extra=extra,\n            args=args,\n            kwargs=kwargs,\n        )\n\n        self._plugin_trigger(\n            \"qtasks_add_task_after_broker\",\n            qtasks=self,\n            broker=self.broker,\n            task_name=task_name,\n            priority=task_priority,\n            args=args,\n            kwargs=kwargs,\n            return_last=True,\n        )\n        if timeout is not None:\n            return SyncResult(uuid=task.uuid, app=self, log=self.log).result(\n                timeout=timeout\n            )\n        return task\n\n    def get(\n        self,\n        uuid: Annotated[\n            UUID | str,\n            Doc(\"\"\"\n                    UUID of the task.\n                    \"\"\"),\n        ],\n    ) -&gt; Union[Task, None]:\n        \"\"\"\n        Get a task.\n\n        Args:\n            uuid (UUID|str): UUID of the Task.\n\n        Returns:\n            Task|None: Task data or None.\n        \"\"\"\n        if isinstance(uuid, str):\n            uuid = UUID(uuid)\n        result = self.broker.get(uuid=uuid)\n        new_result = self._plugin_trigger(\n            \"qtasks_get\", qtasks=self, broker=self.broker, task=result, return_last=True\n        )\n        if new_result:\n            result = new_result.get(\"task\", result)\n        return result\n\n    def run_forever(\n        self,\n        starter: Annotated[\n            Optional[BaseStarter],\n            Doc(\"\"\"\n                    Update Starter.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        num_workers: Annotated[\n            int,\n            Doc(\"\"\"\n                    Number of running workers.\n\n                    Default: `4`.\n                    \"\"\"),\n        ] = 4,\n        reset_config: Annotated[\n            bool,\n            Doc(\"\"\"\n                    Update the config of the worker and broker.\n\n                    Default: `True`.\n                    \"\"\"),\n        ] = True,\n    ) -&gt; None:\n        \"\"\"\n        Run synchronously Application.\n\n        Args:\n            starter (BaseStarter, optional): Starter. Default: `qtasks.starters.SyncStarter`.\n            num_workers (int, optional): Number of workers running. Default: `4`.\n            reset_config (bool, optional): Update the config of the worker and broker. Default: `True`.\n        \"\"\"\n        self.starter = starter or SyncStarter(\n            name=self.name,\n            worker=self.worker,\n            broker=self.broker,\n            log=self.log,\n            config=self.config,\n            events=self.events,\n        )\n\n        plugins_hash = {}\n        for plugins in [\n            self.plugins,\n            self.worker.plugins,\n            self.broker.plugins,\n            self.broker.storage.plugins,\n        ]:\n            plugins_hash.update(plugins)\n\n        self._set_state()\n\n        self.starter.start(\n            num_workers=num_workers, reset_config=reset_config, plugins=plugins_hash\n        )\n\n    def stop(self):\n        \"\"\"Stops all components.\"\"\"\n        self._plugin_trigger(\"qtasks_stop\", qtasks=self, starter=self.starter)\n        if self.starter:\n            self.starter.stop()\n\n    def ping(self,\n             server: Annotated[\n            bool,\n            Doc(\n                \"\"\"\n                    Verification via server.\n\n                    Default: `True`.\n                    \"\"\"\n            ),\n        ] = True,\n        ) -&gt; bool:\n        \"\"\"\n        Checking server startup.\n\n        Args:\n            server (bool, optional): Verification via server. Default: `True`.\n\n        Returns:\n            bool: True - Works, False - Doesn't work.\n        \"\"\"\n        self._plugin_trigger(\n            \"qtasks_ping\", qtasks=self, global_config=self.broker.storage.global_config\n        )\n        if server and self.broker.storage.global_config:\n            status = self.broker.storage.global_config.get(\"main\", \"status\")\n            return status is not None\n        return True\n\n    def flush_all(self) -&gt; None:\n        \"\"\"Delete all data.\"\"\"\n        self._plugin_trigger(\"qtasks_flush_all\", qtasks=self)\n        self.broker.flush_all()\n</code></pre>"},{"location":"api/queuetasks/#qtasks.qtasks.QueueTasks.__init__","title":"<code>__init__(name='QueueTasks', broker_url=None, broker=None, worker=None, log=None, config=None, events=None)</code>","text":"<p>Initializing QueueTasks.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Project name. Default: <code>QueueTasks</code>.</p> <code>'QueueTasks'</code> <code>broker_url</code> <code>str</code> <p>URL for the Broker. Used by the Broker by default via the url parameter. Default: <code>None</code>.</p> <code>None</code> <code>broker</code> <code>Type[BaseBroker]</code> <p>Broker. Stores processing from task queues and data storage. Default: <code>qtasks.brokers.AsyncRedisBroker</code>.</p> <code>None</code> <code>worker</code> <code>Type[BaseWorker]</code> <p>Worker. Stores task processing. Default: <code>qtasks.workers.AsyncWorker</code>.</p> <code>None</code> <code>log</code> <code>Logger</code> <p>Logger. Default: <code>qtasks.logs.Logger</code>.</p> <code>None</code> <code>config</code> <code>QueueConfig</code> <p>Config. Default: <code>qtasks.configs.QueueConfig</code>.</p> <code>None</code> <code>events</code> <code>BaseEvents</code> <p>Events. Default: <code>qtasks.events.SyncEvents</code>.</p> <code>None</code> Source code in <code>src/qtasks/qtasks.py</code> <pre><code>def __init__(\n    self,\n    name: Annotated[\n        str,\n        Doc(\"\"\"\n                Project name. This name is also used by components (Worker, Broker, etc.)\n\n                Default: `QueueTasks`.\n                \"\"\"),\n    ] = \"QueueTasks\",\n    broker_url: Annotated[\n        str | None,\n        Doc(\"\"\"\n                Broker URL. Used by the Broker by default via the url parameter.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    broker: Annotated[\n        Optional[BaseBroker],\n        Doc(\"\"\"\n                Broker. Stores processing from task queues and data storage.\n\n                Default: `qtasks.brokers.SyncRedisBroker`.\n                \"\"\"),\n    ] = None,\n    worker: Annotated[\n        Optional[BaseWorker],\n        Doc(\"\"\"\n                Worker. Stores task processing.\n\n                Default: `qtasks.workers.SyncWorker`.\n                \"\"\"),\n    ] = None,\n    log: Annotated[\n        Logger | None,\n        Doc(\"\"\"\n                Logger.\n\n                Default: `qtasks.logs.Logger`.\n                \"\"\"),\n    ] = None,\n    config: Annotated[\n        QueueConfig | None,\n        Doc(\"\"\"\n                Config.\n\n                Default: `qtasks.configs.QueueConfig`.\n                \"\"\"),\n    ] = None,\n    events: Annotated[\n        Optional[BaseEvents],\n        Doc(\"\"\"\n                Events.\n\n                Default: `qtasks.events.SyncEvents`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    Initializing QueueTasks.\n\n    Args:\n        name (str): Project name. Default: `QueueTasks`.\n        broker_url (str, optional): URL for the Broker. Used by the Broker by default via the url parameter. Default: `None`.\n        broker (Type[BaseBroker], optional): Broker. Stores processing from task queues and data storage. Default: `qtasks.brokers.AsyncRedisBroker`.\n        worker (Type[BaseWorker], optional): Worker. Stores task processing. Default: `qtasks.workers.AsyncWorker`.\n        log (Logger, optional): Logger. Default: `qtasks.logs.Logger`.\n        config (QueueConfig, optional): Config. Default: `qtasks.configs.QueueConfig`.\n        events (BaseEvents, optional): Events. Default: `qtasks.events.SyncEvents`.\n    \"\"\"\n    broker = broker or SyncRedisBroker(\n        name=name, url=broker_url, log=log, config=config, events=events\n    )\n    worker = worker or SyncThreadWorker(\n        name=name, broker=broker, log=log, config=config, events=events\n    )\n    events = events or SyncEvents()\n\n    super().__init__(\n        name=name,\n        broker=broker,\n        worker=worker,\n        log=log,\n        config=config,\n        events=events,\n    )\n\n    self._method = \"sync\"\n\n    self.broker: BaseBroker[Literal[False]]\n    self.worker: BaseWorker[Literal[False]]\n\n    self.starter: BaseStarter[Literal[False]] | None = None\n\n    self._registry_tasks()\n\n    self._set_state()\n</code></pre>"},{"location":"api/queuetasks/#qtasks.qtasks.QueueTasks.add_task","title":"<code>add_task(task_name, *args, priority=None, timeout=None, **kwargs)</code>","text":"<pre><code>add_task(task_name: Annotated[str, Doc('\\n                    Task name.\\n                    ')], *args: Annotated[Any, Doc('\\n                    args of the task.\\n\\n                    Default: `()`.\\n                    ')], priority: Annotated[int | None, Doc('\\n                    The task has priority.\\n\\n                    Default: Task priority value.\\n                    ')] = None, timeout: Annotated[float, Doc('\\n                    Task timeout.\\n\\n                    If specified, the task is returned via `qtasks.results.AsyncTask`.\\n                    ')] = 0.0, **kwargs: Annotated[Any, Doc('\\n                    kwargs tasks.\\n\\n                    Default: `{}`.\\n                    ')]) -&gt; Optional[Task]\n</code></pre><pre><code>add_task(task_name: Annotated[str, Doc('\\n                    Task name.\\n                    ')], *args: Annotated[Any, Doc('\\n                    args of the task.\\n\\n                    Default: `()`.\\n                    ')], priority: Annotated[int | None, Doc('\\n                    The task has priority.\\n\\n                    Default: Task priority value.\\n                    ')] = None, timeout: Annotated[None, Doc('\\n                    Task timeout.\\n\\n                    If specified, the task is returned via `qtasks.results.AsyncTask`.\\n                    ')] = None, **kwargs: Annotated[Any, Doc('\\n                    kwargs tasks.\\n\\n                    Default: `{}`.\\n                    ')]) -&gt; Task\n</code></pre><pre><code>add_task(task_name: Annotated[str, Doc('\\n                    Task name.\\n                    ')], *args: Annotated[Any, Doc('\\n                    args of the task.\\n\\n                    Default: `()`.\\n                    ')], priority: Annotated[int | None, Doc('\\n                    The task has priority.\\n\\n                    Default: Task priority value.\\n                    ')] = None, timeout: Annotated[float | None, Doc('\\n                    Task timeout.\\n\\n                    If specified, the task is returned via `qtasks.results.AsyncTask`.\\n                    ')] = None, **kwargs: Annotated[Any, Doc('\\n                    kwargs tasks.\\n\\n                    Default: `{}`.\\n                    ')]) -&gt; Optional[Task]\n</code></pre> <p>Add a task.</p> <p>Parameters:</p> Name Type Description Default <code>task_name</code> <code>str</code> <p>The name of the task.</p> required <code>priority</code> <code>int</code> <p>Task priority. Default: Task priority value.</p> <code>None</code> <code>args</code> <code>tuple</code> <p>Task args. Defaults to <code>()</code>.</p> <code>()</code> <code>kwargs</code> <code>dict</code> <p>Kwargs tasks. Defaults to <code>{}</code>.</p> <code>{}</code> <code>timeout</code> <code>float</code> <p>Task timeout. If specified, the task is returned via <code>qtasks.results.SyncResult</code>.</p> <code>None</code> <p>Returns:</p> Type Description <code>Union[Task, Optional[Task]]</code> <p>Task|None: <code>schemas.task.Task</code> or <code>None</code>.</p> Source code in <code>src/qtasks/qtasks.py</code> <pre><code>def add_task(\n    self,\n    task_name: Annotated[\n        str,\n        Doc(\"\"\"\n                Task name.\n                \"\"\"),\n    ],\n    *args: Annotated[\n        Any,\n        Doc(\"\"\"\n                args of the task.\n\n                Default: `()`.\n                \"\"\"),\n    ],\n    priority: Annotated[\n        int | None,\n        Doc(\"\"\"\n                The task has priority.\n\n                Default: Task priority value.\n                \"\"\"),\n    ] = None,\n    timeout: Annotated[\n        float | None,\n        Doc(\"\"\"\n                Task timeout.\n\n                If specified, the task is returned via `qtasks.results.AsyncTask`.\n                \"\"\"),\n    ] = None,\n    **kwargs: Annotated[\n        Any,\n        Doc(\"\"\"\n                kwargs tasks.\n\n                Default: `{}`.\n                \"\"\"),\n    ],\n) -&gt; Union[Task, Optional[Task]]:\n    \"\"\"\n    Add a task.\n\n    Args:\n        task_name (str): The name of the task.\n        priority (int, optional): Task priority. Default: Task priority value.\n        args (tuple, optional): Task args. Defaults to `()`.\n        kwargs (dict, optional): Kwargs tasks. Defaults to `{}`.\n\n        timeout (float, optional): Task timeout. If specified, the task is returned via `qtasks.results.SyncResult`.\n\n    Returns:\n        Task|None: `schemas.task.Task` or `None`.\n    \"\"\"\n    if priority is None:\n        task_registry = self.tasks.get(task_name, 0)\n        priority = (\n            task_registry.priority\n            if isinstance(task_registry, TaskExecSchema)\n            else 0\n        )\n\n    extra = None\n\n    new_args = self._plugin_trigger(\n        \"qtasks_add_task_before_broker\",\n        qtasks=self,\n        broker=self.broker,\n        task_name=task_name,\n        priority=priority,\n        args=args,\n        kw=kwargs,\n        return_last=True,\n    )\n\n    task_priority: int = priority\n\n    if new_args:\n        task_name = new_args.get(\"task_name\", task_name)\n        task_priority = new_args.get(\"priority\", task_priority)\n        extra = new_args.get(\"extra\", extra)\n        args = new_args.get(\"args\", args)\n        kwargs = new_args.get(\"kw\", kwargs)\n\n    task = self.broker.add(\n        task_name=task_name,\n        priority=task_priority,\n        extra=extra,\n        args=args,\n        kwargs=kwargs,\n    )\n\n    self._plugin_trigger(\n        \"qtasks_add_task_after_broker\",\n        qtasks=self,\n        broker=self.broker,\n        task_name=task_name,\n        priority=task_priority,\n        args=args,\n        kwargs=kwargs,\n        return_last=True,\n    )\n    if timeout is not None:\n        return SyncResult(uuid=task.uuid, app=self, log=self.log).result(\n            timeout=timeout\n        )\n    return task\n</code></pre>"},{"location":"api/queuetasks/#qtasks.qtasks.QueueTasks.flush_all","title":"<code>flush_all()</code>","text":"<p>Delete all data.</p> Source code in <code>src/qtasks/qtasks.py</code> <pre><code>def flush_all(self) -&gt; None:\n    \"\"\"Delete all data.\"\"\"\n    self._plugin_trigger(\"qtasks_flush_all\", qtasks=self)\n    self.broker.flush_all()\n</code></pre>"},{"location":"api/queuetasks/#qtasks.qtasks.QueueTasks.get","title":"<code>get(uuid)</code>","text":"<p>Get a task.</p> <p>Parameters:</p> Name Type Description Default <code>uuid</code> <code>UUID | str</code> <p>UUID of the Task.</p> required <p>Returns:</p> Type Description <code>Union[Task, None]</code> <p>Task|None: Task data or None.</p> Source code in <code>src/qtasks/qtasks.py</code> <pre><code>def get(\n    self,\n    uuid: Annotated[\n        UUID | str,\n        Doc(\"\"\"\n                UUID of the task.\n                \"\"\"),\n    ],\n) -&gt; Union[Task, None]:\n    \"\"\"\n    Get a task.\n\n    Args:\n        uuid (UUID|str): UUID of the Task.\n\n    Returns:\n        Task|None: Task data or None.\n    \"\"\"\n    if isinstance(uuid, str):\n        uuid = UUID(uuid)\n    result = self.broker.get(uuid=uuid)\n    new_result = self._plugin_trigger(\n        \"qtasks_get\", qtasks=self, broker=self.broker, task=result, return_last=True\n    )\n    if new_result:\n        result = new_result.get(\"task\", result)\n    return result\n</code></pre>"},{"location":"api/queuetasks/#qtasks.qtasks.QueueTasks.ping","title":"<code>ping(server=True)</code>","text":"<p>Checking server startup.</p> <p>Parameters:</p> Name Type Description Default <code>server</code> <code>bool</code> <p>Verification via server. Default: <code>True</code>.</p> <code>True</code> <p>Returns:</p> Name Type Description <code>bool</code> <code>bool</code> <p>True - Works, False - Doesn't work.</p> Source code in <code>src/qtasks/qtasks.py</code> <pre><code>def ping(self,\n         server: Annotated[\n        bool,\n        Doc(\n            \"\"\"\n                Verification via server.\n\n                Default: `True`.\n                \"\"\"\n        ),\n    ] = True,\n    ) -&gt; bool:\n    \"\"\"\n    Checking server startup.\n\n    Args:\n        server (bool, optional): Verification via server. Default: `True`.\n\n    Returns:\n        bool: True - Works, False - Doesn't work.\n    \"\"\"\n    self._plugin_trigger(\n        \"qtasks_ping\", qtasks=self, global_config=self.broker.storage.global_config\n    )\n    if server and self.broker.storage.global_config:\n        status = self.broker.storage.global_config.get(\"main\", \"status\")\n        return status is not None\n    return True\n</code></pre>"},{"location":"api/queuetasks/#qtasks.qtasks.QueueTasks.run_forever","title":"<code>run_forever(starter=None, num_workers=4, reset_config=True)</code>","text":"<p>Run synchronously Application.</p> <p>Parameters:</p> Name Type Description Default <code>starter</code> <code>BaseStarter</code> <p>Starter. Default: <code>qtasks.starters.SyncStarter</code>.</p> <code>None</code> <code>num_workers</code> <code>int</code> <p>Number of workers running. Default: <code>4</code>.</p> <code>4</code> <code>reset_config</code> <code>bool</code> <p>Update the config of the worker and broker. Default: <code>True</code>.</p> <code>True</code> Source code in <code>src/qtasks/qtasks.py</code> <pre><code>def run_forever(\n    self,\n    starter: Annotated[\n        Optional[BaseStarter],\n        Doc(\"\"\"\n                Update Starter.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    num_workers: Annotated[\n        int,\n        Doc(\"\"\"\n                Number of running workers.\n\n                Default: `4`.\n                \"\"\"),\n    ] = 4,\n    reset_config: Annotated[\n        bool,\n        Doc(\"\"\"\n                Update the config of the worker and broker.\n\n                Default: `True`.\n                \"\"\"),\n    ] = True,\n) -&gt; None:\n    \"\"\"\n    Run synchronously Application.\n\n    Args:\n        starter (BaseStarter, optional): Starter. Default: `qtasks.starters.SyncStarter`.\n        num_workers (int, optional): Number of workers running. Default: `4`.\n        reset_config (bool, optional): Update the config of the worker and broker. Default: `True`.\n    \"\"\"\n    self.starter = starter or SyncStarter(\n        name=self.name,\n        worker=self.worker,\n        broker=self.broker,\n        log=self.log,\n        config=self.config,\n        events=self.events,\n    )\n\n    plugins_hash = {}\n    for plugins in [\n        self.plugins,\n        self.worker.plugins,\n        self.broker.plugins,\n        self.broker.storage.plugins,\n    ]:\n        plugins_hash.update(plugins)\n\n    self._set_state()\n\n    self.starter.start(\n        num_workers=num_workers, reset_config=reset_config, plugins=plugins_hash\n    )\n</code></pre>"},{"location":"api/queuetasks/#qtasks.qtasks.QueueTasks.stop","title":"<code>stop()</code>","text":"<p>Stops all components.</p> Source code in <code>src/qtasks/qtasks.py</code> <pre><code>def stop(self):\n    \"\"\"Stops all components.\"\"\"\n    self._plugin_trigger(\"qtasks_stop\", qtasks=self, starter=self.starter)\n    if self.starter:\n        self.starter.stop()\n</code></pre>"},{"location":"api/router/","title":"\u0420\u043e\u0443\u0442\u0435\u0440","text":"<p>Router for task execution.</p> <p>Router for task execution.</p>"},{"location":"api/router/#qtasks.routers.async_router.AsyncRouter","title":"<code>AsyncRouter</code>","text":"<p>               Bases: <code>AsyncPluginMixin</code></p> <p>A router that stores tasks that the main <code>QueueTasks</code> connects to itself.</p>"},{"location":"api/router/#qtasks.routers.async_router.AsyncRouter--example","title":"Example","text":"<pre><code>from qtasks import QueueTasks, AsyncRouter\n\napp = QueueTasks()\n\nrouter = AsyncRouter()\n\n@router.task()\nasync def test():\n    pass\n\napp.include_router(router)\n</code></pre> Source code in <code>src/qtasks/routers/async_router.py</code> <pre><code>class AsyncRouter(AsyncPluginMixin):\n    \"\"\"\n    A router that stores tasks that the main `QueueTasks` connects to itself.\n\n    ## Example\n\n    ```python\n    from qtasks import QueueTasks, AsyncRouter\n\n    app = QueueTasks()\n\n    router = AsyncRouter()\n\n    @router.task()\n    async def test():\n        pass\n\n    app.include_router(router)\n    ```\n    \"\"\"\n\n    def __init__(self) -&gt; None:\n        \"\"\"Initializing the router.\"\"\"\n        self.tasks: Annotated[\n            dict[str, TaskExecSchema],\n            Doc(\"\"\"\n                Tasks, type `{task_name:qtasks.schemas.TaskExecSchema}`.\n\n                Default: `Empty dictionary`.\n                \"\"\"),\n        ] = {}\n\n        self.plugins: dict[str, list[BasePlugin]] = {}\n\n    def task(\n        self,\n        name: Annotated[\n            str | Callable | None,\n            Doc(\"\"\"\n                    Task name.\n\n                    Default: `func.__name__`.\n                    \"\"\"),\n        ] = None,\n        *,\n        priority: Annotated[\n            int | None,\n            Doc(\"\"\"\n                    The task has priority by default.\n\n                    Default: `config.task_default_priority`.\n                    \"\"\"),\n        ] = None,\n        echo: Annotated[\n            bool,\n            Doc(\"\"\"\n                    Add (A)syncTask as the first parameter.\n\n                    Default: `False`.\n                    \"\"\"),\n        ] = False,\n        max_time: Annotated[\n            float | None,\n            Doc(\"\"\"\n                    The maximum time it takes to complete a task in seconds.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        retry: Annotated[\n            int | None,\n            Doc(\"\"\"\n                    The number of attempts to retry the task.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        retry_on_exc: Annotated[\n            list[type[Exception]] | None,\n            Doc(\"\"\"\n                    Exceptions under which the task will be re-executed.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        decode: Annotated[\n            Callable | None,\n            Doc(\"\"\"\n                    Task result decoder.\n\n                    Default: `None`.\n                \"\"\"),\n        ] = None,\n        tags: Annotated[\n            list[str] | None,\n            Doc(\"\"\"\n                    Task tags.\n\n                    Default: `None`.\n                \"\"\"),\n        ] = None,\n        description: Annotated[\n            str | None,\n            Doc(\"\"\"\n                    Description of the task.\n\n                    Default: `None`.\n                \"\"\"),\n        ] = None,\n        generate_handler: Annotated[\n            Callable | None,\n            Doc(\"\"\"\n                    Handler generator.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        executor: Annotated[\n            type[BaseTaskExecutor] | None,\n            Doc(\"\"\"\n                    Class `BaseTaskExecutor`.\n\n                    Default: `SyncTaskExecutor`.\n                    \"\"\"),\n        ] = None,\n        middlewares_before: Annotated[\n            list[type[TaskMiddleware]] | None,\n            Doc(\"\"\"\n                    Middleware that will be executed before the task.\n\n                    Default: `Empty array`.\n                    \"\"\"),\n        ] = None,\n        middlewares_after: Annotated[\n            list[type[TaskMiddleware]] | None,\n            Doc(\"\"\"\n                    Middleware that will be executed after the task.\n\n                    Default: `Empty array`.\n                    \"\"\"),\n        ] = None,\n        **kwargs,\n    ) -&gt; AsyncTask[P, R] | Callable[[Callable[P, R]], AsyncTask[P, R]]:\n        \"\"\"\n        Decorator for registering tasks.\n\n        Args:\n            name (str, optional): Name of the task. Default: `func.__name__`.\n            priority (int, optional): The task's default priority. Default: `config.task_default_priority`.\n            echo (bool, optional): Add (A)syncTask as the first parameter. Default: `False`.\n            max_time (float, optional): The maximum time the task will take to complete in seconds. Default: `None`.\n            retry (int, optional): Number of attempts to retry the task. Default: `None`.\n            retry_on_exc (List[Type[Exception]], optional): Exceptions under which the task will be re-executed. Default: `None`.\n            decode (Callable, optional): Decoder of the task result. Default: `None`.\n            tags (List[str], optional): Task tags. Default: `None`.\n            description (str, optional): Description of the task. Default: `None`.\n            generate_handler (Callable, optional): Handler generator. Default: `None`.\n            executor (Type[\"BaseTaskExecutor\"], optional): Class `BaseTaskExecutor`. Default: `SyncTaskExecutor`.\n            middlewares_before (List[Type[\"TaskMiddleware\"]], optional): Middleware that will be executed before the task. Default: `Empty array`.\n            middlewares_after (List[Type[\"TaskMiddleware\"]], optional): Middleware that will be executed after the task. Default: `Empty array`.\n\n        Raises:\n            ValueError: If a task with the same name is already registered.\n\n        Returns:\n            SyncTask: Decorator for registering a task.\n        \"\"\"\n\n        def wrapper(func: Callable[P, R]):\n            nonlocal priority, middlewares_before, middlewares_after\n\n            task_name = name or func.__name__ if not callable(name) else name.__name__\n            if task_name in self.tasks:\n                raise ValueError(f\"Task with name {task_name} is already registered!\")\n\n            if priority is None:\n                priority = 0\n\n            generating = False\n            if inspect.isgeneratorfunction(func):\n                generating = \"sync\"\n            if inspect.isasyncgenfunction(func):\n                generating = \"async\"\n\n            middlewares_before = middlewares_before or []\n            middlewares_after = middlewares_after or []\n\n            model = TaskExecSchema(\n                name=task_name,\n                priority=priority,\n                func=func,\n                awaiting=inspect.iscoroutinefunction(func),\n                generating=generating,\n                echo=echo,\n                max_time=max_time,\n                retry=retry,\n                retry_on_exc=retry_on_exc,\n                decode=decode,\n                tags=tags,\n                description=description,\n                generate_handler=generate_handler,\n                executor=executor,\n                middlewares_before=middlewares_before,\n                middlewares_after=middlewares_after,\n                extra=kwargs,\n            )\n\n            self.tasks[task_name] = model\n\n            return AsyncTask(\n                task_name=model.name,\n                priority=model.priority,\n                echo=model.echo,\n                max_time=model.max_time,\n                retry=model.retry,\n                retry_on_exc=model.retry_on_exc,\n                decode=model.decode,\n                tags=model.tags,\n                description=model.description,\n                generate_handler=model.generate_handler,\n                executor=model.executor,\n                middlewares_before=model.middlewares_before,\n                middlewares_after=model.middlewares_after,\n            )\n\n        return wrapper\n</code></pre>"},{"location":"api/router/#qtasks.routers.async_router.AsyncRouter.__init__","title":"<code>__init__()</code>","text":"<p>Initializing the router.</p> Source code in <code>src/qtasks/routers/async_router.py</code> <pre><code>def __init__(self) -&gt; None:\n    \"\"\"Initializing the router.\"\"\"\n    self.tasks: Annotated[\n        dict[str, TaskExecSchema],\n        Doc(\"\"\"\n            Tasks, type `{task_name:qtasks.schemas.TaskExecSchema}`.\n\n            Default: `Empty dictionary`.\n            \"\"\"),\n    ] = {}\n\n    self.plugins: dict[str, list[BasePlugin]] = {}\n</code></pre>"},{"location":"api/router/#qtasks.routers.async_router.AsyncRouter.task","title":"<code>task(name=None, *, priority=None, echo=False, max_time=None, retry=None, retry_on_exc=None, decode=None, tags=None, description=None, generate_handler=None, executor=None, middlewares_before=None, middlewares_after=None, **kwargs)</code>","text":"<p>Decorator for registering tasks.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Name of the task. Default: <code>func.__name__</code>.</p> <code>None</code> <code>priority</code> <code>int</code> <p>The task's default priority. Default: <code>config.task_default_priority</code>.</p> <code>None</code> <code>echo</code> <code>bool</code> <p>Add (A)syncTask as the first parameter. Default: <code>False</code>.</p> <code>False</code> <code>max_time</code> <code>float</code> <p>The maximum time the task will take to complete in seconds. Default: <code>None</code>.</p> <code>None</code> <code>retry</code> <code>int</code> <p>Number of attempts to retry the task. Default: <code>None</code>.</p> <code>None</code> <code>retry_on_exc</code> <code>List[Type[Exception]]</code> <p>Exceptions under which the task will be re-executed. Default: <code>None</code>.</p> <code>None</code> <code>decode</code> <code>Callable</code> <p>Decoder of the task result. Default: <code>None</code>.</p> <code>None</code> <code>tags</code> <code>List[str]</code> <p>Task tags. Default: <code>None</code>.</p> <code>None</code> <code>description</code> <code>str</code> <p>Description of the task. Default: <code>None</code>.</p> <code>None</code> <code>generate_handler</code> <code>Callable</code> <p>Handler generator. Default: <code>None</code>.</p> <code>None</code> <code>executor</code> <code>Type['BaseTaskExecutor']</code> <p>Class <code>BaseTaskExecutor</code>. Default: <code>SyncTaskExecutor</code>.</p> <code>None</code> <code>middlewares_before</code> <code>List[Type['TaskMiddleware']]</code> <p>Middleware that will be executed before the task. Default: <code>Empty array</code>.</p> <code>None</code> <code>middlewares_after</code> <code>List[Type['TaskMiddleware']]</code> <p>Middleware that will be executed after the task. Default: <code>Empty array</code>.</p> <code>None</code> <p>Raises:</p> Type Description <code>ValueError</code> <p>If a task with the same name is already registered.</p> <p>Returns:</p> Name Type Description <code>SyncTask</code> <code>AsyncTask[P, R] | Callable[[Callable[P, R]], AsyncTask[P, R]]</code> <p>Decorator for registering a task.</p> Source code in <code>src/qtasks/routers/async_router.py</code> <pre><code>def task(\n    self,\n    name: Annotated[\n        str | Callable | None,\n        Doc(\"\"\"\n                Task name.\n\n                Default: `func.__name__`.\n                \"\"\"),\n    ] = None,\n    *,\n    priority: Annotated[\n        int | None,\n        Doc(\"\"\"\n                The task has priority by default.\n\n                Default: `config.task_default_priority`.\n                \"\"\"),\n    ] = None,\n    echo: Annotated[\n        bool,\n        Doc(\"\"\"\n                Add (A)syncTask as the first parameter.\n\n                Default: `False`.\n                \"\"\"),\n    ] = False,\n    max_time: Annotated[\n        float | None,\n        Doc(\"\"\"\n                The maximum time it takes to complete a task in seconds.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    retry: Annotated[\n        int | None,\n        Doc(\"\"\"\n                The number of attempts to retry the task.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    retry_on_exc: Annotated[\n        list[type[Exception]] | None,\n        Doc(\"\"\"\n                Exceptions under which the task will be re-executed.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    decode: Annotated[\n        Callable | None,\n        Doc(\"\"\"\n                Task result decoder.\n\n                Default: `None`.\n            \"\"\"),\n    ] = None,\n    tags: Annotated[\n        list[str] | None,\n        Doc(\"\"\"\n                Task tags.\n\n                Default: `None`.\n            \"\"\"),\n    ] = None,\n    description: Annotated[\n        str | None,\n        Doc(\"\"\"\n                Description of the task.\n\n                Default: `None`.\n            \"\"\"),\n    ] = None,\n    generate_handler: Annotated[\n        Callable | None,\n        Doc(\"\"\"\n                Handler generator.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    executor: Annotated[\n        type[BaseTaskExecutor] | None,\n        Doc(\"\"\"\n                Class `BaseTaskExecutor`.\n\n                Default: `SyncTaskExecutor`.\n                \"\"\"),\n    ] = None,\n    middlewares_before: Annotated[\n        list[type[TaskMiddleware]] | None,\n        Doc(\"\"\"\n                Middleware that will be executed before the task.\n\n                Default: `Empty array`.\n                \"\"\"),\n    ] = None,\n    middlewares_after: Annotated[\n        list[type[TaskMiddleware]] | None,\n        Doc(\"\"\"\n                Middleware that will be executed after the task.\n\n                Default: `Empty array`.\n                \"\"\"),\n    ] = None,\n    **kwargs,\n) -&gt; AsyncTask[P, R] | Callable[[Callable[P, R]], AsyncTask[P, R]]:\n    \"\"\"\n    Decorator for registering tasks.\n\n    Args:\n        name (str, optional): Name of the task. Default: `func.__name__`.\n        priority (int, optional): The task's default priority. Default: `config.task_default_priority`.\n        echo (bool, optional): Add (A)syncTask as the first parameter. Default: `False`.\n        max_time (float, optional): The maximum time the task will take to complete in seconds. Default: `None`.\n        retry (int, optional): Number of attempts to retry the task. Default: `None`.\n        retry_on_exc (List[Type[Exception]], optional): Exceptions under which the task will be re-executed. Default: `None`.\n        decode (Callable, optional): Decoder of the task result. Default: `None`.\n        tags (List[str], optional): Task tags. Default: `None`.\n        description (str, optional): Description of the task. Default: `None`.\n        generate_handler (Callable, optional): Handler generator. Default: `None`.\n        executor (Type[\"BaseTaskExecutor\"], optional): Class `BaseTaskExecutor`. Default: `SyncTaskExecutor`.\n        middlewares_before (List[Type[\"TaskMiddleware\"]], optional): Middleware that will be executed before the task. Default: `Empty array`.\n        middlewares_after (List[Type[\"TaskMiddleware\"]], optional): Middleware that will be executed after the task. Default: `Empty array`.\n\n    Raises:\n        ValueError: If a task with the same name is already registered.\n\n    Returns:\n        SyncTask: Decorator for registering a task.\n    \"\"\"\n\n    def wrapper(func: Callable[P, R]):\n        nonlocal priority, middlewares_before, middlewares_after\n\n        task_name = name or func.__name__ if not callable(name) else name.__name__\n        if task_name in self.tasks:\n            raise ValueError(f\"Task with name {task_name} is already registered!\")\n\n        if priority is None:\n            priority = 0\n\n        generating = False\n        if inspect.isgeneratorfunction(func):\n            generating = \"sync\"\n        if inspect.isasyncgenfunction(func):\n            generating = \"async\"\n\n        middlewares_before = middlewares_before or []\n        middlewares_after = middlewares_after or []\n\n        model = TaskExecSchema(\n            name=task_name,\n            priority=priority,\n            func=func,\n            awaiting=inspect.iscoroutinefunction(func),\n            generating=generating,\n            echo=echo,\n            max_time=max_time,\n            retry=retry,\n            retry_on_exc=retry_on_exc,\n            decode=decode,\n            tags=tags,\n            description=description,\n            generate_handler=generate_handler,\n            executor=executor,\n            middlewares_before=middlewares_before,\n            middlewares_after=middlewares_after,\n            extra=kwargs,\n        )\n\n        self.tasks[task_name] = model\n\n        return AsyncTask(\n            task_name=model.name,\n            priority=model.priority,\n            echo=model.echo,\n            max_time=model.max_time,\n            retry=model.retry,\n            retry_on_exc=model.retry_on_exc,\n            decode=model.decode,\n            tags=model.tags,\n            description=model.description,\n            generate_handler=model.generate_handler,\n            executor=model.executor,\n            middlewares_before=model.middlewares_before,\n            middlewares_after=model.middlewares_after,\n        )\n\n    return wrapper\n</code></pre>"},{"location":"api/router/#qtasks.routers.sync_router.SyncRouter","title":"<code>SyncRouter</code>","text":"<p>               Bases: <code>SyncPluginMixin</code></p> <p>A router that stores tasks that the main <code>QueueTasks</code> connects to itself.</p>"},{"location":"api/router/#qtasks.routers.sync_router.SyncRouter--example","title":"Example","text":"<p>```python from qtasks import QueueTasks, SyncRouter</p> <p>app = QueueTasks()</p> <p>router = SyncRouter()</p> <p>@router.task() def test():     pass</p> <p>app.include_router(router)     ```</p> Source code in <code>src/qtasks/routers/sync_router.py</code> <pre><code>class SyncRouter(SyncPluginMixin):\n    \"\"\"\n    A router that stores tasks that the main `QueueTasks` connects to itself.\n\n    ## Example\n\n    ```python\n    from qtasks import QueueTasks, SyncRouter\n\n    app = QueueTasks()\n\n    router = SyncRouter()\n\n    @router.task()\n    def test():\n        pass\n\n    app.include_router(router)\n        ```\n    \"\"\"\n\n    def __init__(self) -&gt; None:\n        \"\"\"Initializing the router.\"\"\"\n        self.tasks: Annotated[\n            dict[str, TaskExecSchema],\n            Doc(\"\"\"\n                Tasks, type `{task_name:qtasks.schemas.TaskExecSchema}`.\n\n                Default: `Empty dictionary`.\n                \"\"\"),\n        ] = {}\n\n        self.plugins: dict[str, list[BasePlugin]] = {}\n\n    def task(\n        self,\n        name: Annotated[\n            str | Callable | None,\n            Doc(\"\"\"\n                    Task name.\n\n                    Default: `func.__name__`.\n                    \"\"\"),\n        ] = None,\n        *,\n        priority: Annotated[\n            int | None,\n            Doc(\"\"\"\n                    The task has priority by default.\n\n                    Default: `config.task_default_priority`.\n                    \"\"\"),\n        ] = None,\n        echo: Annotated[\n            bool,\n            Doc(\"\"\"\n                    Add (A)syncTask as the first parameter.\n\n                    Default: `False`.\n                    \"\"\"),\n        ] = False,\n        max_time: Annotated[\n            float | None,\n            Doc(\"\"\"\n                    The maximum time it takes to complete a task in seconds.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        retry: Annotated[\n            int | None,\n            Doc(\"\"\"\n                    The number of attempts to retry the task.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        retry_on_exc: Annotated[\n            list[type[Exception]] | None,\n            Doc(\"\"\"\n                    Exceptions under which the task will be re-executed.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        decode: Annotated[\n            Callable | None,\n            Doc(\"\"\"\n                    Task result decoder.\n\n                    Default: `None`.\n                \"\"\"),\n        ] = None,\n        tags: Annotated[\n            list[str] | None,\n            Doc(\"\"\"\n                    Task tags.\n\n                    Default: `None`.\n                \"\"\"),\n        ] = None,\n        description: Annotated[\n            str | None,\n            Doc(\"\"\"\n                    Description of the task.\n\n                    Default: `None`.\n                \"\"\"),\n        ] = None,\n        generate_handler: Annotated[\n            Callable | None,\n            Doc(\"\"\"\n                    Handler generator.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        executor: Annotated[\n            type[BaseTaskExecutor] | None,\n            Doc(\"\"\"\n                    Class `BaseTaskExecutor`.\n\n                    Default: `SyncTaskExecutor`.\n                    \"\"\"),\n        ] = None,\n        middlewares_before: Annotated[\n            list[type[TaskMiddleware]] | None,\n            Doc(\"\"\"\n                    Middleware that will be executed before the task.\n\n                    Default: `Empty array`.\n                    \"\"\"),\n        ] = None,\n        middlewares_after: Annotated[\n            list[type[TaskMiddleware]] | None,\n            Doc(\"\"\"\n                    Middleware that will be executed after the task.\n\n                    Default: `Empty array`.\n                    \"\"\"),\n        ] = None,\n        **kwargs,\n    ) -&gt; SyncTask[P, R] | Callable[[Callable[P, R]], SyncTask[P, R]]:\n        \"\"\"\n        Decorator for registering tasks.\n\n        Args:\n            name (str, optional): Name of the task. Default: `func.__name__`.\n            priority (int, optional): The task's default priority. Default: `config.task_default_priority`.\n            echo (bool, optional): Add (A)syncTask as the first parameter. Default: `False`.\n            max_time (float, optional): The maximum time the task will take to complete in seconds. Default: `None`.\n            retry (int, optional): Number of attempts to retry the task. Default: `None`.\n            retry_on_exc (List[Type[Exception]], optional): Exceptions under which the task will be re-executed. Default: `None`.\n            decode (Callable, optional): Decoder of the task result. Default: `None`.\n            tags (List[str], optional): Task tags. Default: `None`.\n            description (str, optional): Description of the task. Default: `None`.\n            generate_handler (Callable, optional): Handler generator. Default: `None`.\n            executor (Type[\"BaseTaskExecutor\"], optional): Class `BaseTaskExecutor`. Default: `SyncTaskExecutor`.\n            middlewares_before (List[Type[\"TaskMiddleware\"]], optional): Middleware that will be executed before the task. Default: `Empty array`.\n            middlewares_after (List[Type[\"TaskMiddleware\"]], optional): Middleware that will be executed after the task. Default: `Empty array`.\n\n        Raises:\n            ValueError: If a task with the same name is already registered.\n\n        Returns:\n            SyncTask: Decorator for registering a task.\n        \"\"\"\n\n        def wrapper(func: Callable[P, R]):\n            nonlocal priority, middlewares_before, middlewares_after\n\n            task_name = name or func.__name__ if not callable(name) else name.__name__\n            if task_name in self.tasks:\n                raise ValueError(f\"Task with name {task_name} is already registered!\")\n\n            if priority is None:\n                priority = 0\n\n            generating = False\n            if inspect.isgeneratorfunction(func):\n                generating = \"sync\"\n            if inspect.isasyncgenfunction(func):\n                generating = \"async\"\n\n            middlewares_before = middlewares_before or []\n            middlewares_after = middlewares_after or []\n\n            model = TaskExecSchema(\n                name=task_name,\n                priority=priority,\n                func=func,\n                awaiting=inspect.iscoroutinefunction(func),\n                generating=generating,\n                echo=echo,\n                max_time=max_time,\n                retry=retry,\n                retry_on_exc=retry_on_exc,\n                decode=decode,\n                tags=tags,\n                description=description,\n                generate_handler=generate_handler,\n                executor=executor,\n                middlewares_before=middlewares_before,\n                middlewares_after=middlewares_after,\n                extra=kwargs,\n            )\n\n            self.tasks[task_name] = model\n\n            return SyncTask(\n                task_name=model.name,\n                priority=model.priority,\n                echo=model.echo,\n                max_time=model.max_time,\n                retry=model.retry,\n                retry_on_exc=model.retry_on_exc,\n                decode=model.decode,\n                tags=model.tags,\n                description=model.description,\n                generate_handler=model.generate_handler,\n                executor=model.executor,\n                middlewares_before=model.middlewares_before,\n                middlewares_after=model.middlewares_after,\n            )\n\n        return wrapper\n</code></pre>"},{"location":"api/router/#qtasks.routers.sync_router.SyncRouter.__init__","title":"<code>__init__()</code>","text":"<p>Initializing the router.</p> Source code in <code>src/qtasks/routers/sync_router.py</code> <pre><code>def __init__(self) -&gt; None:\n    \"\"\"Initializing the router.\"\"\"\n    self.tasks: Annotated[\n        dict[str, TaskExecSchema],\n        Doc(\"\"\"\n            Tasks, type `{task_name:qtasks.schemas.TaskExecSchema}`.\n\n            Default: `Empty dictionary`.\n            \"\"\"),\n    ] = {}\n\n    self.plugins: dict[str, list[BasePlugin]] = {}\n</code></pre>"},{"location":"api/router/#qtasks.routers.sync_router.SyncRouter.task","title":"<code>task(name=None, *, priority=None, echo=False, max_time=None, retry=None, retry_on_exc=None, decode=None, tags=None, description=None, generate_handler=None, executor=None, middlewares_before=None, middlewares_after=None, **kwargs)</code>","text":"<p>Decorator for registering tasks.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Name of the task. Default: <code>func.__name__</code>.</p> <code>None</code> <code>priority</code> <code>int</code> <p>The task's default priority. Default: <code>config.task_default_priority</code>.</p> <code>None</code> <code>echo</code> <code>bool</code> <p>Add (A)syncTask as the first parameter. Default: <code>False</code>.</p> <code>False</code> <code>max_time</code> <code>float</code> <p>The maximum time the task will take to complete in seconds. Default: <code>None</code>.</p> <code>None</code> <code>retry</code> <code>int</code> <p>Number of attempts to retry the task. Default: <code>None</code>.</p> <code>None</code> <code>retry_on_exc</code> <code>List[Type[Exception]]</code> <p>Exceptions under which the task will be re-executed. Default: <code>None</code>.</p> <code>None</code> <code>decode</code> <code>Callable</code> <p>Decoder of the task result. Default: <code>None</code>.</p> <code>None</code> <code>tags</code> <code>List[str]</code> <p>Task tags. Default: <code>None</code>.</p> <code>None</code> <code>description</code> <code>str</code> <p>Description of the task. Default: <code>None</code>.</p> <code>None</code> <code>generate_handler</code> <code>Callable</code> <p>Handler generator. Default: <code>None</code>.</p> <code>None</code> <code>executor</code> <code>Type['BaseTaskExecutor']</code> <p>Class <code>BaseTaskExecutor</code>. Default: <code>SyncTaskExecutor</code>.</p> <code>None</code> <code>middlewares_before</code> <code>List[Type['TaskMiddleware']]</code> <p>Middleware that will be executed before the task. Default: <code>Empty array</code>.</p> <code>None</code> <code>middlewares_after</code> <code>List[Type['TaskMiddleware']]</code> <p>Middleware that will be executed after the task. Default: <code>Empty array</code>.</p> <code>None</code> <p>Raises:</p> Type Description <code>ValueError</code> <p>If a task with the same name is already registered.</p> <p>Returns:</p> Name Type Description <code>SyncTask</code> <code>SyncTask[P, R] | Callable[[Callable[P, R]], SyncTask[P, R]]</code> <p>Decorator for registering a task.</p> Source code in <code>src/qtasks/routers/sync_router.py</code> <pre><code>def task(\n    self,\n    name: Annotated[\n        str | Callable | None,\n        Doc(\"\"\"\n                Task name.\n\n                Default: `func.__name__`.\n                \"\"\"),\n    ] = None,\n    *,\n    priority: Annotated[\n        int | None,\n        Doc(\"\"\"\n                The task has priority by default.\n\n                Default: `config.task_default_priority`.\n                \"\"\"),\n    ] = None,\n    echo: Annotated[\n        bool,\n        Doc(\"\"\"\n                Add (A)syncTask as the first parameter.\n\n                Default: `False`.\n                \"\"\"),\n    ] = False,\n    max_time: Annotated[\n        float | None,\n        Doc(\"\"\"\n                The maximum time it takes to complete a task in seconds.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    retry: Annotated[\n        int | None,\n        Doc(\"\"\"\n                The number of attempts to retry the task.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    retry_on_exc: Annotated[\n        list[type[Exception]] | None,\n        Doc(\"\"\"\n                Exceptions under which the task will be re-executed.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    decode: Annotated[\n        Callable | None,\n        Doc(\"\"\"\n                Task result decoder.\n\n                Default: `None`.\n            \"\"\"),\n    ] = None,\n    tags: Annotated[\n        list[str] | None,\n        Doc(\"\"\"\n                Task tags.\n\n                Default: `None`.\n            \"\"\"),\n    ] = None,\n    description: Annotated[\n        str | None,\n        Doc(\"\"\"\n                Description of the task.\n\n                Default: `None`.\n            \"\"\"),\n    ] = None,\n    generate_handler: Annotated[\n        Callable | None,\n        Doc(\"\"\"\n                Handler generator.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    executor: Annotated[\n        type[BaseTaskExecutor] | None,\n        Doc(\"\"\"\n                Class `BaseTaskExecutor`.\n\n                Default: `SyncTaskExecutor`.\n                \"\"\"),\n    ] = None,\n    middlewares_before: Annotated[\n        list[type[TaskMiddleware]] | None,\n        Doc(\"\"\"\n                Middleware that will be executed before the task.\n\n                Default: `Empty array`.\n                \"\"\"),\n    ] = None,\n    middlewares_after: Annotated[\n        list[type[TaskMiddleware]] | None,\n        Doc(\"\"\"\n                Middleware that will be executed after the task.\n\n                Default: `Empty array`.\n                \"\"\"),\n    ] = None,\n    **kwargs,\n) -&gt; SyncTask[P, R] | Callable[[Callable[P, R]], SyncTask[P, R]]:\n    \"\"\"\n    Decorator for registering tasks.\n\n    Args:\n        name (str, optional): Name of the task. Default: `func.__name__`.\n        priority (int, optional): The task's default priority. Default: `config.task_default_priority`.\n        echo (bool, optional): Add (A)syncTask as the first parameter. Default: `False`.\n        max_time (float, optional): The maximum time the task will take to complete in seconds. Default: `None`.\n        retry (int, optional): Number of attempts to retry the task. Default: `None`.\n        retry_on_exc (List[Type[Exception]], optional): Exceptions under which the task will be re-executed. Default: `None`.\n        decode (Callable, optional): Decoder of the task result. Default: `None`.\n        tags (List[str], optional): Task tags. Default: `None`.\n        description (str, optional): Description of the task. Default: `None`.\n        generate_handler (Callable, optional): Handler generator. Default: `None`.\n        executor (Type[\"BaseTaskExecutor\"], optional): Class `BaseTaskExecutor`. Default: `SyncTaskExecutor`.\n        middlewares_before (List[Type[\"TaskMiddleware\"]], optional): Middleware that will be executed before the task. Default: `Empty array`.\n        middlewares_after (List[Type[\"TaskMiddleware\"]], optional): Middleware that will be executed after the task. Default: `Empty array`.\n\n    Raises:\n        ValueError: If a task with the same name is already registered.\n\n    Returns:\n        SyncTask: Decorator for registering a task.\n    \"\"\"\n\n    def wrapper(func: Callable[P, R]):\n        nonlocal priority, middlewares_before, middlewares_after\n\n        task_name = name or func.__name__ if not callable(name) else name.__name__\n        if task_name in self.tasks:\n            raise ValueError(f\"Task with name {task_name} is already registered!\")\n\n        if priority is None:\n            priority = 0\n\n        generating = False\n        if inspect.isgeneratorfunction(func):\n            generating = \"sync\"\n        if inspect.isasyncgenfunction(func):\n            generating = \"async\"\n\n        middlewares_before = middlewares_before or []\n        middlewares_after = middlewares_after or []\n\n        model = TaskExecSchema(\n            name=task_name,\n            priority=priority,\n            func=func,\n            awaiting=inspect.iscoroutinefunction(func),\n            generating=generating,\n            echo=echo,\n            max_time=max_time,\n            retry=retry,\n            retry_on_exc=retry_on_exc,\n            decode=decode,\n            tags=tags,\n            description=description,\n            generate_handler=generate_handler,\n            executor=executor,\n            middlewares_before=middlewares_before,\n            middlewares_after=middlewares_after,\n            extra=kwargs,\n        )\n\n        self.tasks[task_name] = model\n\n        return SyncTask(\n            task_name=model.name,\n            priority=model.priority,\n            echo=model.echo,\n            max_time=model.max_time,\n            retry=model.retry,\n            retry_on_exc=model.retry_on_exc,\n            decode=model.decode,\n            tags=model.tags,\n            description=model.description,\n            generate_handler=model.generate_handler,\n            executor=model.executor,\n            middlewares_before=model.middlewares_before,\n            middlewares_after=model.middlewares_after,\n        )\n\n    return wrapper\n</code></pre>"},{"location":"api/states/","title":"\u0413\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435","text":""},{"location":"api/states/#qtasks._state.app_main","title":"<code>app_main = None</code>  <code>module-attribute</code>","text":"<p><code>app_main</code> - Contains the main application <code>QueueTasks</code>.</p> <p>Variable is updated upon initialization of <code>QueueTasks</code> and/or before calling <code>self.starter.start()</code> inside <code>app.run_forever()</code>.</p>"},{"location":"api/states/#qtasks._state.log_main","title":"<code>log_main = Logger(name='QueueTasks', subname='_state')</code>  <code>module-attribute</code>","text":"<p><code>log_main</code> - Contains the main logging component <code>Logger</code>. Variable is updated upon initialization of <code>QueueTasks</code>.</p> <p>Default: Logger(name=\"QueueTasks\", subname=\"_state\")</p>"},{"location":"api/webview/","title":"Under development","text":""},{"location":"api/asyncio/queuetasks/","title":"QueueTasks async","text":"<p>qtasks.py - Main asyncio module for the QueueTasks framework.</p>"},{"location":"api/asyncio/queuetasks/#qtasks.asyncio.qtasks.QueueTasks","title":"<code>QueueTasks</code>","text":"<p>               Bases: <code>BaseQueueTasks[Literal[True]]</code>, <code>AsyncPluginMixin</code></p> <p><code>QueueTasks</code> - Framework for task queues.</p> <p>Read more: First steps.</p>"},{"location":"api/asyncio/queuetasks/#qtasks.asyncio.qtasks.QueueTasks--example","title":"Example","text":"<pre><code>from qtasks import QueueTasks\n\napp = QueueTasks()\n</code></pre> Source code in <code>src/qtasks/asyncio/qtasks.py</code> <pre><code>class QueueTasks(BaseQueueTasks[Literal[True]], AsyncPluginMixin):\n    \"\"\"\n    `QueueTasks` - Framework for task queues.\n\n    Read more:\n    [First steps](https://txello.github.io/qtasks/getting_started/).\n\n    ## Example\n\n    ```python\n    from qtasks import QueueTasks\n\n    app = QueueTasks()\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Project name. This name is also used by components (Worker, Broker, etc.)\n\n                    Default: `QueueTasks`.\n                    \"\"\"),\n        ] = \"QueueTasks\",\n        broker_url: Annotated[\n            str | None,\n            Doc(\"\"\"\n                    Broker URL. Used by the Broker by default via the url parameter.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        broker: Annotated[\n            Optional[BaseBroker],\n            Doc(\"\"\"\n                    Broker. Stores processing from task queues and data storage.\n\n                    Default: `qtasks.brokers.AsyncRedisBroker`.\n                    \"\"\"),\n        ] = None,\n        worker: Annotated[\n            Optional[BaseWorker],\n            Doc(\"\"\"\n                    Worker. Stores task processing.\n\n                    Default: `qtasks.workers.AsyncWorker`.\n                    \"\"\"),\n        ] = None,\n        log: Annotated[\n            Logger | None,\n            Doc(\"\"\"\n                    Logger.\n\n                    Default: `qtasks.logs.Logger`.\n                    \"\"\"),\n        ] = None,\n        config: Annotated[\n            QueueConfig | None,\n            Doc(\"\"\"\n                    Config.\n\n                    Default: `qtasks.configs.QueueConfig`.\n                    \"\"\"),\n        ] = None,\n        events: Annotated[\n            Optional[BaseEvents],\n            Doc(\"\"\"\n                    Events.\n\n                    Default: `qtasks.events.AsyncEvents`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Initializing QueueTasks.\n\n        Args:\n            name (str): Project name. Default: `QueueTasks`.\n            broker_url (str, optional): URL for the Broker. Used by the Broker by default via the url parameter. Default: `None`.\n            broker (Type[BaseBroker], optional): Broker. Stores processing from task queues and data storage. Default: `qtasks.brokers.AsyncRedisBroker`.\n            worker (Type[BaseWorker], optional): Worker. Stores task processing. Default: `qtasks.workers.AsyncWorker`.\n            log (Logger, optional): Logger. Default: `qtasks.logs.Logger`.\n            config (QueueConfig, optional): Config. Default: `qtasks.configs.QueueConfig`.\n            events (BaseEvents, optional): Events. Default: `qtasks.events.AsyncEvents`.\n        \"\"\"\n        broker = broker or AsyncRedisBroker(\n            name=name, url=broker_url, log=log, config=config, events=events\n        )\n        worker = worker or AsyncWorker(\n            name=name, broker=broker, log=log, config=config, events=events\n        )\n\n        events = events or AsyncEvents()\n\n        super().__init__(\n            name=name,\n            broker=broker,\n            worker=worker,\n            log=log,\n            config=config,\n            events=events,\n        )\n\n        self._method = \"async\"\n\n        self.broker: BaseBroker[Literal[True]]\n        self.worker: BaseWorker[Literal[True]]\n\n        self.starter: BaseStarter[Literal[True]] | None = None\n\n        self._global_loop: Annotated[\n            asyncio.AbstractEventLoop | None,\n            Doc(\"\"\"\n                Asynchronous loop, can be specified.\n\n                Default: `None`.\n                \"\"\"),\n        ] = None\n\n        self._registry_tasks()\n\n        self._set_state()\n\n    @overload\n    async def add_task(\n        self,\n        task_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        *args: Annotated[\n            Any,\n            Doc(\"\"\"\n                    args of the task.\n\n                    Default: `()`.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int | None,\n            Doc(\"\"\"\n                    The task has priority.\n\n                    Default: Task priority value.\n                    \"\"\"),\n        ] = None,\n        timeout: Annotated[\n            float,\n            Doc(\"\"\"\n                    Task timeout.\n\n                    If specified, the task is returned via `qtasks.results.AsyncTask`.\n                    \"\"\"),\n        ] = 0.0,\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    kwargs tasks.\n\n                    Default: `{}`.\n                    \"\"\"),\n        ],\n    ) -&gt; Optional[Task]: ...\n\n    @overload\n    async def add_task(\n        self,\n        task_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        *args: Annotated[\n            Any,\n            Doc(\"\"\"\n                    args of the task.\n\n                    Default: `()`.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int | None,\n            Doc(\"\"\"\n                    The task has priority.\n\n                    Default: Task priority value.\n                    \"\"\"),\n        ] = None,\n        timeout: Annotated[\n            None,\n            Doc(\"\"\"\n                    Task timeout.\n\n                    If specified, the task is returned via `qtasks.results.AsyncTask`.\n                    \"\"\"),\n        ] = None,\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    kwargs tasks.\n\n                    Default: `{}`.\n                    \"\"\"),\n        ],\n    ) -&gt; Task: ...\n\n    @overload\n    async def add_task(\n        self,\n        task_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        *args: Annotated[\n            Any,\n            Doc(\"\"\"\n                    args of the task.\n\n                    Default: `()`.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int | None,\n            Doc(\"\"\"\n                    The task has priority.\n\n                    Default: Task priority value.\n                    \"\"\"),\n        ] = None,\n        timeout: Annotated[\n            float | None,\n            Doc(\"\"\"\n                    Task timeout.\n\n                    If specified, the task is returned via `qtasks.results.AsyncTask`.\n                    \"\"\"),\n        ] = None,\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    kwargs tasks.\n\n                    Default: `{}`.\n                    \"\"\"),\n        ],\n    ) -&gt; Optional[Task]: ...\n\n    async def add_task(\n        self,\n        task_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        *args: Annotated[\n            Any,\n            Doc(\"\"\"\n                    args of the task.\n\n                    Default: `()`.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int | None,\n            Doc(\"\"\"\n                    The task has priority.\n\n                    Default: Task priority value.\n                    \"\"\"),\n        ] = None,\n        timeout: Annotated[\n            float | None,\n            Doc(\"\"\"\n                    Task timeout.\n\n                    If specified, the task is returned via `qtasks.results.AsyncTask`.\n                    \"\"\"),\n        ] = None,\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    kwargs tasks.\n\n                    Default: `{}`.\n                    \"\"\"),\n        ],\n    ) -&gt; Union[Task, Optional[Task]]:\n        \"\"\"\n        Add a task.\n\n        Args:\n            task_name (str): The name of the task.\n            priority (int, optional): Task priority. Default: Task priority value.\n            args (tuple, optional): Task args. Defaults to `()`.\n            kwargs (dict, optional): Kwargs tasks. Defaults to `{}`.\n\n            timeout (float, optional): Task timeout. If specified, the task is returned via `qtasks.results.AsyncResult`.\n\n        Returns:\n            Task|None: `schemas.task.Task` or `None`.\n        \"\"\"\n        if priority is None:\n            task_registry = self.tasks.get(task_name, 0)\n            priority = (\n                task_registry.priority\n                if isinstance(task_registry, TaskExecSchema)\n                else 0\n            )\n\n        args, kwargs = args or (), kwargs or {}\n        extra = None\n\n        new_args = await self._plugin_trigger(\n            \"qtasks_add_task_before_broker\",\n            qtasks=self,\n            broker=self.broker,\n            task_name=task_name,\n            priority=priority,\n            args=args,\n            kw=kwargs,\n            return_last=True,\n        )\n\n        task_priority: int = priority\n\n        if new_args:\n            task_name = new_args.get(\"task_name\", task_name)\n            task_priority = new_args.get(\"priority\", task_priority)\n            extra = new_args.get(\"extra\", extra)\n            args = new_args.get(\"args\", args)\n            kwargs = new_args.get(\"kw\", kwargs)\n\n        task = await self.broker.add(\n            task_name=task_name,\n            priority=task_priority,\n            extra=extra,\n            args=args,\n            kwargs=kwargs,\n        )\n\n        await self._plugin_trigger(\n            \"qtasks_add_task_after_broker\",\n            qtasks=self,\n            broker=self.broker,\n            task_name=task_name,\n            priority=task_priority,\n            args=args,\n            kwargs=kwargs,\n        )\n\n        if timeout is not None:\n            return await AsyncResult(uuid=task.uuid, app=self, log=self.log).result(\n                timeout=timeout\n            )\n        return task\n\n    async def get(\n        self,\n        uuid: Annotated[\n            UUID | str,\n            Doc(\"\"\"\n                    UUID of the task.\n                    \"\"\"),\n        ],\n    ) -&gt; Union[Task, None]:\n        \"\"\"\n        Get a task.\n\n        Args:\n            uuid (UUID|str): UUID of the Task.\n\n        Returns:\n            Task|None: Task data or None.\n        \"\"\"\n        if isinstance(uuid, str):\n            uuid = UUID(uuid)\n\n        result = await self.broker.get(uuid=uuid)\n        new_result = await self._plugin_trigger(\n            \"qtasks_get\", qtasks=self, broker=self.broker, task=result, return_last=True\n        )\n        if new_result:\n            result = new_result.get(\"task\", result)\n        return result\n\n    def run_forever(\n        self,\n        loop: Annotated[\n            asyncio.AbstractEventLoop | None,\n            Doc(\"\"\"\n                    Asynchronous loop.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        starter: Annotated[\n            Optional[BaseStarter],\n            Doc(\"\"\"\n                    Starter. Stores methods for launching components.\n\n                    Default: `qtasks.starters.AsyncStarter`.\n                    \"\"\"),\n        ] = None,\n        num_workers: Annotated[\n            int,\n            Doc(\"\"\"\n                    Number of running workers.\n\n                    Default: `4`.\n                    \"\"\"),\n        ] = 4,\n        reset_config: Annotated[\n            bool,\n            Doc(\"\"\"\n                    Update the config of the worker and broker.\n\n                    Default: `True`.\n                    \"\"\"),\n        ] = True,\n    ) -&gt; None:\n        \"\"\"\n        Launch asynchronously Application.\n\n        Args:\n            loop (asyncio.AbstractEventLoop, optional): async loop. Default: `None`.\n            starter (BaseStarter, optional): Starter. Default: `qtasks.starters.AsyncStarter`.\n            num_workers (int, optional): Number of workers running. Default: `4`.\n            reset_config (bool, optional): Update the config of the worker and broker. Default: `True`.\n        \"\"\"\n        self.starter = starter or AsyncStarter(\n            name=self.name,\n            worker=self.worker,\n            broker=self.broker,\n            log=self.log,\n            config=self.config,\n            events=self.events,\n        )\n\n        plugins_hash = {}\n        for plugins in [\n            self.plugins,\n            self.worker.plugins,\n            self.broker.plugins,\n            self.broker.storage.plugins,\n        ]:\n            plugins_hash.update(plugins)\n\n        self._set_state()\n\n        self.starter.start(\n            loop=loop,\n            num_workers=num_workers,\n            reset_config=reset_config,\n            plugins=plugins_hash,\n        )\n\n    async def stop(self):\n        \"\"\"Stops all components.\"\"\"\n        await self._plugin_trigger(\"qtasks_stop\", qtasks=self, starter=self.starter)\n        if self.starter:\n            await self.starter.stop()\n\n    async def ping(\n        self,\n        server: Annotated[\n            bool,\n            Doc(\n                \"\"\"\n                    Verification via server.\n\n                    Default: `True`.\n                    \"\"\"\n            ),\n        ] = True,\n    ) -&gt; bool:\n        \"\"\"\n        Checking server startup.\n\n        Args:\n            server (bool, optional): Verification via server. Default: `True`.\n\n        Returns:\n            bool: True - Works, False - Doesn't work.\n        \"\"\"\n        await self._plugin_trigger(\n            \"qtasks_ping\", qtasks=self, global_config=self.broker.storage.global_config\n        )\n        if server and self.broker.storage.global_config:\n            loop = asyncio.get_running_loop()\n            asyncio_atexit.register(self.broker.storage.global_config.stop, loop=loop)\n            status = await self.broker.storage.global_config.get(\"main\", \"status\")\n            return status is not None\n        return True\n\n    async def flush_all(self) -&gt; None:\n        \"\"\"Delete all data.\"\"\"\n        await self._plugin_trigger(\"qtasks_flush_all\", qtasks=self, broker=self.broker)\n        await self.broker.flush_all()\n</code></pre>"},{"location":"api/asyncio/queuetasks/#qtasks.asyncio.qtasks.QueueTasks.__init__","title":"<code>__init__(name='QueueTasks', broker_url=None, broker=None, worker=None, log=None, config=None, events=None)</code>","text":"<p>Initializing QueueTasks.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Project name. Default: <code>QueueTasks</code>.</p> <code>'QueueTasks'</code> <code>broker_url</code> <code>str</code> <p>URL for the Broker. Used by the Broker by default via the url parameter. Default: <code>None</code>.</p> <code>None</code> <code>broker</code> <code>Type[BaseBroker]</code> <p>Broker. Stores processing from task queues and data storage. Default: <code>qtasks.brokers.AsyncRedisBroker</code>.</p> <code>None</code> <code>worker</code> <code>Type[BaseWorker]</code> <p>Worker. Stores task processing. Default: <code>qtasks.workers.AsyncWorker</code>.</p> <code>None</code> <code>log</code> <code>Logger</code> <p>Logger. Default: <code>qtasks.logs.Logger</code>.</p> <code>None</code> <code>config</code> <code>QueueConfig</code> <p>Config. Default: <code>qtasks.configs.QueueConfig</code>.</p> <code>None</code> <code>events</code> <code>BaseEvents</code> <p>Events. Default: <code>qtasks.events.AsyncEvents</code>.</p> <code>None</code> Source code in <code>src/qtasks/asyncio/qtasks.py</code> <pre><code>def __init__(\n    self,\n    name: Annotated[\n        str,\n        Doc(\"\"\"\n                Project name. This name is also used by components (Worker, Broker, etc.)\n\n                Default: `QueueTasks`.\n                \"\"\"),\n    ] = \"QueueTasks\",\n    broker_url: Annotated[\n        str | None,\n        Doc(\"\"\"\n                Broker URL. Used by the Broker by default via the url parameter.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    broker: Annotated[\n        Optional[BaseBroker],\n        Doc(\"\"\"\n                Broker. Stores processing from task queues and data storage.\n\n                Default: `qtasks.brokers.AsyncRedisBroker`.\n                \"\"\"),\n    ] = None,\n    worker: Annotated[\n        Optional[BaseWorker],\n        Doc(\"\"\"\n                Worker. Stores task processing.\n\n                Default: `qtasks.workers.AsyncWorker`.\n                \"\"\"),\n    ] = None,\n    log: Annotated[\n        Logger | None,\n        Doc(\"\"\"\n                Logger.\n\n                Default: `qtasks.logs.Logger`.\n                \"\"\"),\n    ] = None,\n    config: Annotated[\n        QueueConfig | None,\n        Doc(\"\"\"\n                Config.\n\n                Default: `qtasks.configs.QueueConfig`.\n                \"\"\"),\n    ] = None,\n    events: Annotated[\n        Optional[BaseEvents],\n        Doc(\"\"\"\n                Events.\n\n                Default: `qtasks.events.AsyncEvents`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    Initializing QueueTasks.\n\n    Args:\n        name (str): Project name. Default: `QueueTasks`.\n        broker_url (str, optional): URL for the Broker. Used by the Broker by default via the url parameter. Default: `None`.\n        broker (Type[BaseBroker], optional): Broker. Stores processing from task queues and data storage. Default: `qtasks.brokers.AsyncRedisBroker`.\n        worker (Type[BaseWorker], optional): Worker. Stores task processing. Default: `qtasks.workers.AsyncWorker`.\n        log (Logger, optional): Logger. Default: `qtasks.logs.Logger`.\n        config (QueueConfig, optional): Config. Default: `qtasks.configs.QueueConfig`.\n        events (BaseEvents, optional): Events. Default: `qtasks.events.AsyncEvents`.\n    \"\"\"\n    broker = broker or AsyncRedisBroker(\n        name=name, url=broker_url, log=log, config=config, events=events\n    )\n    worker = worker or AsyncWorker(\n        name=name, broker=broker, log=log, config=config, events=events\n    )\n\n    events = events or AsyncEvents()\n\n    super().__init__(\n        name=name,\n        broker=broker,\n        worker=worker,\n        log=log,\n        config=config,\n        events=events,\n    )\n\n    self._method = \"async\"\n\n    self.broker: BaseBroker[Literal[True]]\n    self.worker: BaseWorker[Literal[True]]\n\n    self.starter: BaseStarter[Literal[True]] | None = None\n\n    self._global_loop: Annotated[\n        asyncio.AbstractEventLoop | None,\n        Doc(\"\"\"\n            Asynchronous loop, can be specified.\n\n            Default: `None`.\n            \"\"\"),\n    ] = None\n\n    self._registry_tasks()\n\n    self._set_state()\n</code></pre>"},{"location":"api/asyncio/queuetasks/#qtasks.asyncio.qtasks.QueueTasks.add_task","title":"<code>add_task(task_name, *args, priority=None, timeout=None, **kwargs)</code>  <code>async</code>","text":"<pre><code>add_task(task_name: Annotated[str, Doc('\\n                    Task name.\\n                    ')], *args: Annotated[Any, Doc('\\n                    args of the task.\\n\\n                    Default: `()`.\\n                    ')], priority: Annotated[int | None, Doc('\\n                    The task has priority.\\n\\n                    Default: Task priority value.\\n                    ')] = None, timeout: Annotated[float, Doc('\\n                    Task timeout.\\n\\n                    If specified, the task is returned via `qtasks.results.AsyncTask`.\\n                    ')] = 0.0, **kwargs: Annotated[Any, Doc('\\n                    kwargs tasks.\\n\\n                    Default: `{}`.\\n                    ')]) -&gt; Optional[Task]\n</code></pre><pre><code>add_task(task_name: Annotated[str, Doc('\\n                    Task name.\\n                    ')], *args: Annotated[Any, Doc('\\n                    args of the task.\\n\\n                    Default: `()`.\\n                    ')], priority: Annotated[int | None, Doc('\\n                    The task has priority.\\n\\n                    Default: Task priority value.\\n                    ')] = None, timeout: Annotated[None, Doc('\\n                    Task timeout.\\n\\n                    If specified, the task is returned via `qtasks.results.AsyncTask`.\\n                    ')] = None, **kwargs: Annotated[Any, Doc('\\n                    kwargs tasks.\\n\\n                    Default: `{}`.\\n                    ')]) -&gt; Task\n</code></pre><pre><code>add_task(task_name: Annotated[str, Doc('\\n                    Task name.\\n                    ')], *args: Annotated[Any, Doc('\\n                    args of the task.\\n\\n                    Default: `()`.\\n                    ')], priority: Annotated[int | None, Doc('\\n                    The task has priority.\\n\\n                    Default: Task priority value.\\n                    ')] = None, timeout: Annotated[float | None, Doc('\\n                    Task timeout.\\n\\n                    If specified, the task is returned via `qtasks.results.AsyncTask`.\\n                    ')] = None, **kwargs: Annotated[Any, Doc('\\n                    kwargs tasks.\\n\\n                    Default: `{}`.\\n                    ')]) -&gt; Optional[Task]\n</code></pre> <p>Add a task.</p> <p>Parameters:</p> Name Type Description Default <code>task_name</code> <code>str</code> <p>The name of the task.</p> required <code>priority</code> <code>int</code> <p>Task priority. Default: Task priority value.</p> <code>None</code> <code>args</code> <code>tuple</code> <p>Task args. Defaults to <code>()</code>.</p> <code>()</code> <code>kwargs</code> <code>dict</code> <p>Kwargs tasks. Defaults to <code>{}</code>.</p> <code>{}</code> <code>timeout</code> <code>float</code> <p>Task timeout. If specified, the task is returned via <code>qtasks.results.AsyncResult</code>.</p> <code>None</code> <p>Returns:</p> Type Description <code>Union[Task, Optional[Task]]</code> <p>Task|None: <code>schemas.task.Task</code> or <code>None</code>.</p> Source code in <code>src/qtasks/asyncio/qtasks.py</code> <pre><code>async def add_task(\n    self,\n    task_name: Annotated[\n        str,\n        Doc(\"\"\"\n                Task name.\n                \"\"\"),\n    ],\n    *args: Annotated[\n        Any,\n        Doc(\"\"\"\n                args of the task.\n\n                Default: `()`.\n                \"\"\"),\n    ],\n    priority: Annotated[\n        int | None,\n        Doc(\"\"\"\n                The task has priority.\n\n                Default: Task priority value.\n                \"\"\"),\n    ] = None,\n    timeout: Annotated[\n        float | None,\n        Doc(\"\"\"\n                Task timeout.\n\n                If specified, the task is returned via `qtasks.results.AsyncTask`.\n                \"\"\"),\n    ] = None,\n    **kwargs: Annotated[\n        Any,\n        Doc(\"\"\"\n                kwargs tasks.\n\n                Default: `{}`.\n                \"\"\"),\n    ],\n) -&gt; Union[Task, Optional[Task]]:\n    \"\"\"\n    Add a task.\n\n    Args:\n        task_name (str): The name of the task.\n        priority (int, optional): Task priority. Default: Task priority value.\n        args (tuple, optional): Task args. Defaults to `()`.\n        kwargs (dict, optional): Kwargs tasks. Defaults to `{}`.\n\n        timeout (float, optional): Task timeout. If specified, the task is returned via `qtasks.results.AsyncResult`.\n\n    Returns:\n        Task|None: `schemas.task.Task` or `None`.\n    \"\"\"\n    if priority is None:\n        task_registry = self.tasks.get(task_name, 0)\n        priority = (\n            task_registry.priority\n            if isinstance(task_registry, TaskExecSchema)\n            else 0\n        )\n\n    args, kwargs = args or (), kwargs or {}\n    extra = None\n\n    new_args = await self._plugin_trigger(\n        \"qtasks_add_task_before_broker\",\n        qtasks=self,\n        broker=self.broker,\n        task_name=task_name,\n        priority=priority,\n        args=args,\n        kw=kwargs,\n        return_last=True,\n    )\n\n    task_priority: int = priority\n\n    if new_args:\n        task_name = new_args.get(\"task_name\", task_name)\n        task_priority = new_args.get(\"priority\", task_priority)\n        extra = new_args.get(\"extra\", extra)\n        args = new_args.get(\"args\", args)\n        kwargs = new_args.get(\"kw\", kwargs)\n\n    task = await self.broker.add(\n        task_name=task_name,\n        priority=task_priority,\n        extra=extra,\n        args=args,\n        kwargs=kwargs,\n    )\n\n    await self._plugin_trigger(\n        \"qtasks_add_task_after_broker\",\n        qtasks=self,\n        broker=self.broker,\n        task_name=task_name,\n        priority=task_priority,\n        args=args,\n        kwargs=kwargs,\n    )\n\n    if timeout is not None:\n        return await AsyncResult(uuid=task.uuid, app=self, log=self.log).result(\n            timeout=timeout\n        )\n    return task\n</code></pre>"},{"location":"api/asyncio/queuetasks/#qtasks.asyncio.qtasks.QueueTasks.flush_all","title":"<code>flush_all()</code>  <code>async</code>","text":"<p>Delete all data.</p> Source code in <code>src/qtasks/asyncio/qtasks.py</code> <pre><code>async def flush_all(self) -&gt; None:\n    \"\"\"Delete all data.\"\"\"\n    await self._plugin_trigger(\"qtasks_flush_all\", qtasks=self, broker=self.broker)\n    await self.broker.flush_all()\n</code></pre>"},{"location":"api/asyncio/queuetasks/#qtasks.asyncio.qtasks.QueueTasks.get","title":"<code>get(uuid)</code>  <code>async</code>","text":"<p>Get a task.</p> <p>Parameters:</p> Name Type Description Default <code>uuid</code> <code>UUID | str</code> <p>UUID of the Task.</p> required <p>Returns:</p> Type Description <code>Union[Task, None]</code> <p>Task|None: Task data or None.</p> Source code in <code>src/qtasks/asyncio/qtasks.py</code> <pre><code>async def get(\n    self,\n    uuid: Annotated[\n        UUID | str,\n        Doc(\"\"\"\n                UUID of the task.\n                \"\"\"),\n    ],\n) -&gt; Union[Task, None]:\n    \"\"\"\n    Get a task.\n\n    Args:\n        uuid (UUID|str): UUID of the Task.\n\n    Returns:\n        Task|None: Task data or None.\n    \"\"\"\n    if isinstance(uuid, str):\n        uuid = UUID(uuid)\n\n    result = await self.broker.get(uuid=uuid)\n    new_result = await self._plugin_trigger(\n        \"qtasks_get\", qtasks=self, broker=self.broker, task=result, return_last=True\n    )\n    if new_result:\n        result = new_result.get(\"task\", result)\n    return result\n</code></pre>"},{"location":"api/asyncio/queuetasks/#qtasks.asyncio.qtasks.QueueTasks.ping","title":"<code>ping(server=True)</code>  <code>async</code>","text":"<p>Checking server startup.</p> <p>Parameters:</p> Name Type Description Default <code>server</code> <code>bool</code> <p>Verification via server. Default: <code>True</code>.</p> <code>True</code> <p>Returns:</p> Name Type Description <code>bool</code> <code>bool</code> <p>True - Works, False - Doesn't work.</p> Source code in <code>src/qtasks/asyncio/qtasks.py</code> <pre><code>async def ping(\n    self,\n    server: Annotated[\n        bool,\n        Doc(\n            \"\"\"\n                Verification via server.\n\n                Default: `True`.\n                \"\"\"\n        ),\n    ] = True,\n) -&gt; bool:\n    \"\"\"\n    Checking server startup.\n\n    Args:\n        server (bool, optional): Verification via server. Default: `True`.\n\n    Returns:\n        bool: True - Works, False - Doesn't work.\n    \"\"\"\n    await self._plugin_trigger(\n        \"qtasks_ping\", qtasks=self, global_config=self.broker.storage.global_config\n    )\n    if server and self.broker.storage.global_config:\n        loop = asyncio.get_running_loop()\n        asyncio_atexit.register(self.broker.storage.global_config.stop, loop=loop)\n        status = await self.broker.storage.global_config.get(\"main\", \"status\")\n        return status is not None\n    return True\n</code></pre>"},{"location":"api/asyncio/queuetasks/#qtasks.asyncio.qtasks.QueueTasks.run_forever","title":"<code>run_forever(loop=None, starter=None, num_workers=4, reset_config=True)</code>","text":"<p>Launch asynchronously Application.</p> <p>Parameters:</p> Name Type Description Default <code>loop</code> <code>AbstractEventLoop</code> <p>async loop. Default: <code>None</code>.</p> <code>None</code> <code>starter</code> <code>BaseStarter</code> <p>Starter. Default: <code>qtasks.starters.AsyncStarter</code>.</p> <code>None</code> <code>num_workers</code> <code>int</code> <p>Number of workers running. Default: <code>4</code>.</p> <code>4</code> <code>reset_config</code> <code>bool</code> <p>Update the config of the worker and broker. Default: <code>True</code>.</p> <code>True</code> Source code in <code>src/qtasks/asyncio/qtasks.py</code> <pre><code>def run_forever(\n    self,\n    loop: Annotated[\n        asyncio.AbstractEventLoop | None,\n        Doc(\"\"\"\n                Asynchronous loop.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    starter: Annotated[\n        Optional[BaseStarter],\n        Doc(\"\"\"\n                Starter. Stores methods for launching components.\n\n                Default: `qtasks.starters.AsyncStarter`.\n                \"\"\"),\n    ] = None,\n    num_workers: Annotated[\n        int,\n        Doc(\"\"\"\n                Number of running workers.\n\n                Default: `4`.\n                \"\"\"),\n    ] = 4,\n    reset_config: Annotated[\n        bool,\n        Doc(\"\"\"\n                Update the config of the worker and broker.\n\n                Default: `True`.\n                \"\"\"),\n    ] = True,\n) -&gt; None:\n    \"\"\"\n    Launch asynchronously Application.\n\n    Args:\n        loop (asyncio.AbstractEventLoop, optional): async loop. Default: `None`.\n        starter (BaseStarter, optional): Starter. Default: `qtasks.starters.AsyncStarter`.\n        num_workers (int, optional): Number of workers running. Default: `4`.\n        reset_config (bool, optional): Update the config of the worker and broker. Default: `True`.\n    \"\"\"\n    self.starter = starter or AsyncStarter(\n        name=self.name,\n        worker=self.worker,\n        broker=self.broker,\n        log=self.log,\n        config=self.config,\n        events=self.events,\n    )\n\n    plugins_hash = {}\n    for plugins in [\n        self.plugins,\n        self.worker.plugins,\n        self.broker.plugins,\n        self.broker.storage.plugins,\n    ]:\n        plugins_hash.update(plugins)\n\n    self._set_state()\n\n    self.starter.start(\n        loop=loop,\n        num_workers=num_workers,\n        reset_config=reset_config,\n        plugins=plugins_hash,\n    )\n</code></pre>"},{"location":"api/asyncio/queuetasks/#qtasks.asyncio.qtasks.QueueTasks.stop","title":"<code>stop()</code>  <code>async</code>","text":"<p>Stops all components.</p> Source code in <code>src/qtasks/asyncio/qtasks.py</code> <pre><code>async def stop(self):\n    \"\"\"Stops all components.\"\"\"\n    await self._plugin_trigger(\"qtasks_stop\", qtasks=self, starter=self.starter)\n    if self.starter:\n        await self.starter.stop()\n</code></pre>"},{"location":"api/brokers/async_kafkabroker/","title":"AsyncKafkaBroker","text":"<p>Async Kafka Broker.</p>"},{"location":"api/brokers/async_kafkabroker/#qtasks.brokers.async_kafka.AsyncKafkaBroker","title":"<code>AsyncKafkaBroker</code>","text":"<p>               Bases: <code>BaseBroker</code>, <code>AsyncPluginMixin</code></p> <p>A broker that listens to Kafka and adds tasks to the queue.</p>"},{"location":"api/brokers/async_kafkabroker/#qtasks.brokers.async_kafka.AsyncKafkaBroker--example","title":"Example","text":"<pre><code>from qtasks.asyncio import QueueTasks\nfrom qtasks.brokers import AsyncKafkaBroker\n\nbroker = AsyncKafkaBroker(name=\"QueueTasks\", url=\"localhost:9092\")\n\napp = QueueTasks(broker=broker)\n</code></pre> Source code in <code>src/qtasks/brokers/async_kafka.py</code> <pre><code>class AsyncKafkaBroker(BaseBroker, AsyncPluginMixin):\n    \"\"\"\n    A broker that listens to Kafka and adds tasks to the queue.\n\n    ## Example\n\n    ```python\n    from qtasks.asyncio import QueueTasks\n    from qtasks.brokers import AsyncKafkaBroker\n\n    broker = AsyncKafkaBroker(name=\"QueueTasks\", url=\"localhost:9092\")\n\n    app = QueueTasks(broker=broker)\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Project name. This name is also used by the broker.\n\n                    Default: `QueueTasks`.\n                    \"\"\"),\n        ] = \"QueueTasks\",\n        url: Annotated[\n            str,\n            Doc(\"\"\"\n                    URL to connect to Kafka.\n\n                    Default: `localhost:9092`.\n                    \"\"\"),\n        ] = \"localhost:9092\",\n        storage: Annotated[\n            Optional[BaseStorage],\n            Doc(\"\"\"\n                    Storage.\n\n                    Default: `AsyncRedisStorage`.\n                    \"\"\"),\n        ] = None,\n        topic: Annotated[\n            str,\n            Doc(\"\"\"\n                    Kafka topic.\n\n                    Default: `task_queue`.\n                    \"\"\"),\n        ] = \"task_queue\",\n        log: Annotated[\n            Logger | None,\n            Doc(\"\"\"\n                    Logger.\n\n                    Default: `qtasks.logs.Logger`.\n                    \"\"\"),\n        ] = None,\n        config: Annotated[\n            QueueConfig | None,\n            Doc(\"\"\"\n                    Config.\n\n                    Default: `qtasks.configs.config.QueueConfig`.\n                    \"\"\"),\n        ] = None,\n        events: Annotated[\n            Optional[BaseEvents],\n            Doc(\"\"\"\n                    Events.\n\n                    Default: `qtasks.events.AsyncEvents`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Initializing AsyncKafkaBroker.\n\n        Args:\n            name (str, optional): Project name. Default: \"QueueTasks\".\n            url (str, optional): URL to connect to Kafka. Default: None.\n            storage (BaseStorage, optional): Storage. Default: None.\n            topic (str, optional): Kafka topic. Default: \"task_queue\".\n            log (Logger, optional): Logger. Default: None.\n            config (QueueConfig, optional): Config. Default: None.\n            events (BaseEvents, optional): Events. Default: `qtasks.events.AsyncEvents`.\n        \"\"\"\n        self.url = url\n\n        storage = storage or SyncRedisStorage(\n            name=name, log=log, config=config, events=events\n        )\n        super().__init__(\n            name=name, log=log, config=config, events=events, storage=storage\n        )\n\n        self.storage: BaseStorage[Literal[True]]\n\n        self.topic = f\"{self.name}_{topic}\"\n        self.events = self.events or AsyncEvents()\n\n        self.consumer = AIOKafkaConsumer(\n            self.topic,\n            loop=asyncio.get_event_loop(),\n            bootstrap_servers=self.url,\n            group_id=f\"{self.name}_group\",\n            auto_offset_reset=\"earliest\",\n            enable_auto_commit=True,\n            value_deserializer=lambda m: m.decode(\"utf-8\"),\n        )\n        self.producer = AIOKafkaProducer(\n            loop=asyncio.get_event_loop(),\n            bootstrap_servers=self.url,\n            auto_offset_reset=\"earliest\",\n            enable_auto_commit=True,\n            value_deserializer=lambda m: m.decode(\"utf-8\"),\n        )\n\n        self.running = False\n\n    async def listen(\n        self,\n        worker: Annotated[\n            BaseWorker[Literal[True]],\n            Doc(\"\"\"\n                    Worker class.\n                    \"\"\"),\n        ],\n    ):\n        \"\"\"\n        Listens to Kafka and transfers tasks to the worker.\n\n        Args:\n            worker (BaseWorker): Worker class.\n        \"\"\"\n        await self._plugin_trigger(\"broker_listen_start\", broker=self, worker=worker)\n        await self._consumer_start()\n        self.running = True\n        try:\n            async for msg in self.consumer:\n                task_data = msg.value\n                task_name, uuid, priority = task_data.split(\":\")\n                model_get = await self.get(uuid=uuid)\n                if not model_get:\n                    raise KeyError(f\"Task not found: {uuid}\")\n                args, kwargs, created_at = (\n                    model_get.args or (),\n                    model_get.kwargs or {},\n                    model_get.created_at.timestamp(),\n                )\n                if self.log:\n                    self.log.info(f\"Received new task: {uuid}\")\n                new_args = await self._plugin_trigger(\n                    \"broker_add_worker\",\n                    broker=self,\n                    worker=worker,\n                    task_name=task_name,\n                    uuid=uuid,\n                    priority=int(priority),\n                    args=args,\n                    kw=kwargs,\n                    created_at=created_at,\n                    return_last=True,\n                )\n                if new_args:\n                    task_name = new_args.get(\"task_name\", task_name)\n                    uuid = new_args.get(\"uuid\", uuid)\n                    priority = new_args.get(\"priority\", priority)\n                    args = new_args.get(\"args\", args)\n                    kwargs = new_args.get(\"kw\", kwargs)\n                    created_at = new_args.get(\"created_at\", created_at)\n\n                await worker.add(\n                    name=task_name,\n                    uuid=uuid,\n                    priority=int(priority),\n                    args=args,\n                    kwargs=kwargs,\n                    created_at=created_at,\n                )\n        finally:\n            await self.consumer.stop()\n\n    async def add(\n        self,\n        task_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int,\n            Doc(\"\"\"\n                    Task priority.\n\n                    Default: `0`.\n                    \"\"\"),\n        ] = 0,\n        extra: Annotated[\n            dict | None,\n            Doc(\"\"\"\n                    Additional task parameters.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        args: Annotated[\n            tuple | None,\n            Doc(\"\"\"\n                    Task arguments of type args.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        kwargs: Annotated[\n            dict | None,\n            Doc(\"\"\"\n                    Task arguments of type kwargs.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n    ) -&gt; Task:\n        \"\"\"\n        Adds a task to the broker.\n\n        Args:\n            task_name (str): The name of the task.\n            priority (int, optional): Task priority. By default: 0.\n            extra (dict, optional): Additional task parameters. Default: `None`.\n            args (tuple, optional): Task arguments of type args. Default: `None`.\n            kwargs (dict, optional): Task arguments of type kwargs. Default: `None`.\n\n        Returns:\n            Task: `schemas.task.Task`\n        \"\"\"\n        args, kwargs = args or (), kwargs or {}\n\n        uuid = uuid4()\n        uuid_str = str(uuid)\n        created_at = time()\n\n        model = TaskStatusNewSchema(\n            task_name=task_name,\n            priority=priority,\n            created_at=created_at,\n            updated_at=created_at,\n            args=str(args),\n            kwargs=str(kwargs),\n        )\n\n        if extra:\n            model = self._dynamic_model(model=model, extra=extra)\n\n        new_model = await self._plugin_trigger(\n            \"broker_add_before\",\n            broker=self,\n            storage=self.storage,\n            model=model,\n            return_last=True,\n        )\n        if new_model:\n            model = new_model.get(\"model\", model)\n\n        await self.storage.add(uuid=uuid, task_status=model)\n\n        task_data = f\"{task_name}:{uuid_str}:{priority}\"\n        await self._producer_start()\n        await self.producer.send_and_wait(self.topic, task_data)\n        await self.producer.stop()\n\n        await self._plugin_trigger(\n            \"broker_add_after\", broker=self, storage=self.storage, model=model\n        )\n        return Task(\n            status=TaskStatusEnum.NEW.value,\n            task_name=task_name,\n            uuid=uuid,\n            priority=priority,\n            args=args,\n            kwargs=kwargs,\n            created_at=datetime.fromtimestamp(created_at),\n            updated_at=datetime.fromtimestamp(created_at),\n        )\n\n    async def get(\n        self,\n        uuid: Annotated[\n            UUID | str,\n            Doc(\"\"\"\n                    UUID of the task.\n                    \"\"\"),\n        ],\n    ) -&gt; Task | None:\n        \"\"\"\n        Obtaining information about a task.\n\n        Args:\n            uuid (UUID|str): UUID of the task.\n\n        Returns:\n            Task|None: If there is task information, returns `schemas.task.Task`, otherwise `None`.\n        \"\"\"\n        if isinstance(uuid, str):\n            uuid = UUID(uuid)\n        task = await self.storage.get(uuid=uuid)\n        new_task = await self._plugin_trigger(\n            \"broker_get\", broker=self, task=task, return_last=True\n        )\n        if new_task:\n            task = new_task.get(\"task\", task)\n        return task\n\n    async def update(\n        self,\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    Update arguments for storage type kwargs.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Updates task information.\n\n        Args:\n            kwargs (dict, optional): task data of type kwargs.\n        \"\"\"\n        new_kw = await self._plugin_trigger(\n            \"broker_update\", broker=self, kw=kwargs, return_last=True\n        )\n        if new_kw:\n            kwargs = new_kw.get(\"kw\", kwargs)\n        return await self.storage.update(**kwargs)\n\n    async def start(\n        self,\n        worker: Annotated[\n            BaseWorker,\n            Doc(\"\"\"\n                    Worker class.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Launches the broker.\n\n        Args:\n            worker (BaseWorker): Worker class.\n        \"\"\"\n        await self._plugin_trigger(\"broker_start\", broker=self, worker=worker)\n        await self.storage.start()\n\n        if self.config.delete_finished_tasks:\n            await self.storage._delete_finished_tasks()\n\n        if self.config.running_older_tasks:\n            await self.storage._running_older_tasks(worker)\n\n        await self.listen(worker)\n\n    async def stop(self):\n        \"\"\"The broker stops.\"\"\"\n        await self._plugin_trigger(\"broker_stop\", broker=self)\n        self.running = False\n        await self.consumer.stop()\n        await self.producer.stop()\n\n    async def remove_finished_task(\n        self,\n        task_broker: Annotated[\n            TaskPrioritySchema,\n            Doc(\"\"\"\n                    Priority task diagram.\n                    \"\"\"),\n        ],\n        model: Annotated[\n            TaskStatusSuccessSchema | TaskStatusErrorSchema,\n            Doc(\"\"\"\n                    Model of the task result.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Updates storage data via the `self.storage.remove_finished_task` function.\n\n        Args:\n            task_broker (TaskPrioritySchema): The priority task schema.\n            model (TaskStatusSuccessSchema | TaskStatusErrorSchema): Model of the task result.\n        \"\"\"\n        new_model = await self._plugin_trigger(\n            \"broker_remove_finished_task\",\n            broker=self,\n            storage=self.storage,\n            model=model,\n            return_last=True,\n        )\n        if new_model:\n            model = new_model.get(\"model\", model)\n\n        await self.storage.remove_finished_task(task_broker, model)\n\n    async def _running_older_tasks(self, worker):\n        await self._plugin_trigger(\n            \"broker_running_older_tasks\", broker=self, worker=worker\n        )\n        return await self.storage._running_older_tasks(worker)\n\n    async def _consumer_start(self):\n        \"\"\"Runs Kafka Consumer.\"\"\"\n        loop = asyncio.get_running_loop()\n        self.consumer = AIOKafkaConsumer(\n            self.topic, bootstrap_servers=self.url, loop=loop\n        )\n        await self.consumer.start()\n\n    async def _producer_start(self):\n        \"\"\"Launches Kafka Producer.\"\"\"\n        loop = asyncio.get_running_loop()\n        self.producer = AIOKafkaProducer(\n            bootstrap_servers=self.url,\n            loop=loop,\n        )\n        await self.producer.start()\n\n    async def flush_all(self) -&gt; None:\n        \"\"\"Delete all data.\"\"\"\n        await self._plugin_trigger(\"broker_flush_all\", broker=self)\n        await self.storage.flush_all()\n</code></pre>"},{"location":"api/brokers/async_kafkabroker/#qtasks.brokers.async_kafka.AsyncKafkaBroker.__init__","title":"<code>__init__(name='QueueTasks', url='localhost:9092', storage=None, topic='task_queue', log=None, config=None, events=None)</code>","text":"<p>Initializing AsyncKafkaBroker.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Project name. Default: \"QueueTasks\".</p> <code>'QueueTasks'</code> <code>url</code> <code>str</code> <p>URL to connect to Kafka. Default: None.</p> <code>'localhost:9092'</code> <code>storage</code> <code>BaseStorage</code> <p>Storage. Default: None.</p> <code>None</code> <code>topic</code> <code>str</code> <p>Kafka topic. Default: \"task_queue\".</p> <code>'task_queue'</code> <code>log</code> <code>Logger</code> <p>Logger. Default: None.</p> <code>None</code> <code>config</code> <code>QueueConfig</code> <p>Config. Default: None.</p> <code>None</code> <code>events</code> <code>BaseEvents</code> <p>Events. Default: <code>qtasks.events.AsyncEvents</code>.</p> <code>None</code> Source code in <code>src/qtasks/brokers/async_kafka.py</code> <pre><code>def __init__(\n    self,\n    name: Annotated[\n        str,\n        Doc(\"\"\"\n                Project name. This name is also used by the broker.\n\n                Default: `QueueTasks`.\n                \"\"\"),\n    ] = \"QueueTasks\",\n    url: Annotated[\n        str,\n        Doc(\"\"\"\n                URL to connect to Kafka.\n\n                Default: `localhost:9092`.\n                \"\"\"),\n    ] = \"localhost:9092\",\n    storage: Annotated[\n        Optional[BaseStorage],\n        Doc(\"\"\"\n                Storage.\n\n                Default: `AsyncRedisStorage`.\n                \"\"\"),\n    ] = None,\n    topic: Annotated[\n        str,\n        Doc(\"\"\"\n                Kafka topic.\n\n                Default: `task_queue`.\n                \"\"\"),\n    ] = \"task_queue\",\n    log: Annotated[\n        Logger | None,\n        Doc(\"\"\"\n                Logger.\n\n                Default: `qtasks.logs.Logger`.\n                \"\"\"),\n    ] = None,\n    config: Annotated[\n        QueueConfig | None,\n        Doc(\"\"\"\n                Config.\n\n                Default: `qtasks.configs.config.QueueConfig`.\n                \"\"\"),\n    ] = None,\n    events: Annotated[\n        Optional[BaseEvents],\n        Doc(\"\"\"\n                Events.\n\n                Default: `qtasks.events.AsyncEvents`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    Initializing AsyncKafkaBroker.\n\n    Args:\n        name (str, optional): Project name. Default: \"QueueTasks\".\n        url (str, optional): URL to connect to Kafka. Default: None.\n        storage (BaseStorage, optional): Storage. Default: None.\n        topic (str, optional): Kafka topic. Default: \"task_queue\".\n        log (Logger, optional): Logger. Default: None.\n        config (QueueConfig, optional): Config. Default: None.\n        events (BaseEvents, optional): Events. Default: `qtasks.events.AsyncEvents`.\n    \"\"\"\n    self.url = url\n\n    storage = storage or SyncRedisStorage(\n        name=name, log=log, config=config, events=events\n    )\n    super().__init__(\n        name=name, log=log, config=config, events=events, storage=storage\n    )\n\n    self.storage: BaseStorage[Literal[True]]\n\n    self.topic = f\"{self.name}_{topic}\"\n    self.events = self.events or AsyncEvents()\n\n    self.consumer = AIOKafkaConsumer(\n        self.topic,\n        loop=asyncio.get_event_loop(),\n        bootstrap_servers=self.url,\n        group_id=f\"{self.name}_group\",\n        auto_offset_reset=\"earliest\",\n        enable_auto_commit=True,\n        value_deserializer=lambda m: m.decode(\"utf-8\"),\n    )\n    self.producer = AIOKafkaProducer(\n        loop=asyncio.get_event_loop(),\n        bootstrap_servers=self.url,\n        auto_offset_reset=\"earliest\",\n        enable_auto_commit=True,\n        value_deserializer=lambda m: m.decode(\"utf-8\"),\n    )\n\n    self.running = False\n</code></pre>"},{"location":"api/brokers/async_kafkabroker/#qtasks.brokers.async_kafka.AsyncKafkaBroker.add","title":"<code>add(task_name, priority=0, extra=None, args=None, kwargs=None)</code>  <code>async</code>","text":"<p>Adds a task to the broker.</p> <p>Parameters:</p> Name Type Description Default <code>task_name</code> <code>str</code> <p>The name of the task.</p> required <code>priority</code> <code>int</code> <p>Task priority. By default: 0.</p> <code>0</code> <code>extra</code> <code>dict</code> <p>Additional task parameters. Default: <code>None</code>.</p> <code>None</code> <code>args</code> <code>tuple</code> <p>Task arguments of type args. Default: <code>None</code>.</p> <code>None</code> <code>kwargs</code> <code>dict</code> <p>Task arguments of type kwargs. Default: <code>None</code>.</p> <code>None</code> <p>Returns:</p> Name Type Description <code>Task</code> <code>Task</code> <p><code>schemas.task.Task</code></p> Source code in <code>src/qtasks/brokers/async_kafka.py</code> <pre><code>async def add(\n    self,\n    task_name: Annotated[\n        str,\n        Doc(\"\"\"\n                Task name.\n                \"\"\"),\n    ],\n    priority: Annotated[\n        int,\n        Doc(\"\"\"\n                Task priority.\n\n                Default: `0`.\n                \"\"\"),\n    ] = 0,\n    extra: Annotated[\n        dict | None,\n        Doc(\"\"\"\n                Additional task parameters.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    args: Annotated[\n        tuple | None,\n        Doc(\"\"\"\n                Task arguments of type args.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    kwargs: Annotated[\n        dict | None,\n        Doc(\"\"\"\n                Task arguments of type kwargs.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n) -&gt; Task:\n    \"\"\"\n    Adds a task to the broker.\n\n    Args:\n        task_name (str): The name of the task.\n        priority (int, optional): Task priority. By default: 0.\n        extra (dict, optional): Additional task parameters. Default: `None`.\n        args (tuple, optional): Task arguments of type args. Default: `None`.\n        kwargs (dict, optional): Task arguments of type kwargs. Default: `None`.\n\n    Returns:\n        Task: `schemas.task.Task`\n    \"\"\"\n    args, kwargs = args or (), kwargs or {}\n\n    uuid = uuid4()\n    uuid_str = str(uuid)\n    created_at = time()\n\n    model = TaskStatusNewSchema(\n        task_name=task_name,\n        priority=priority,\n        created_at=created_at,\n        updated_at=created_at,\n        args=str(args),\n        kwargs=str(kwargs),\n    )\n\n    if extra:\n        model = self._dynamic_model(model=model, extra=extra)\n\n    new_model = await self._plugin_trigger(\n        \"broker_add_before\",\n        broker=self,\n        storage=self.storage,\n        model=model,\n        return_last=True,\n    )\n    if new_model:\n        model = new_model.get(\"model\", model)\n\n    await self.storage.add(uuid=uuid, task_status=model)\n\n    task_data = f\"{task_name}:{uuid_str}:{priority}\"\n    await self._producer_start()\n    await self.producer.send_and_wait(self.topic, task_data)\n    await self.producer.stop()\n\n    await self._plugin_trigger(\n        \"broker_add_after\", broker=self, storage=self.storage, model=model\n    )\n    return Task(\n        status=TaskStatusEnum.NEW.value,\n        task_name=task_name,\n        uuid=uuid,\n        priority=priority,\n        args=args,\n        kwargs=kwargs,\n        created_at=datetime.fromtimestamp(created_at),\n        updated_at=datetime.fromtimestamp(created_at),\n    )\n</code></pre>"},{"location":"api/brokers/async_kafkabroker/#qtasks.brokers.async_kafka.AsyncKafkaBroker.flush_all","title":"<code>flush_all()</code>  <code>async</code>","text":"<p>Delete all data.</p> Source code in <code>src/qtasks/brokers/async_kafka.py</code> <pre><code>async def flush_all(self) -&gt; None:\n    \"\"\"Delete all data.\"\"\"\n    await self._plugin_trigger(\"broker_flush_all\", broker=self)\n    await self.storage.flush_all()\n</code></pre>"},{"location":"api/brokers/async_kafkabroker/#qtasks.brokers.async_kafka.AsyncKafkaBroker.get","title":"<code>get(uuid)</code>  <code>async</code>","text":"<p>Obtaining information about a task.</p> <p>Parameters:</p> Name Type Description Default <code>uuid</code> <code>UUID | str</code> <p>UUID of the task.</p> required <p>Returns:</p> Type Description <code>Task | None</code> <p>Task|None: If there is task information, returns <code>schemas.task.Task</code>, otherwise <code>None</code>.</p> Source code in <code>src/qtasks/brokers/async_kafka.py</code> <pre><code>async def get(\n    self,\n    uuid: Annotated[\n        UUID | str,\n        Doc(\"\"\"\n                UUID of the task.\n                \"\"\"),\n    ],\n) -&gt; Task | None:\n    \"\"\"\n    Obtaining information about a task.\n\n    Args:\n        uuid (UUID|str): UUID of the task.\n\n    Returns:\n        Task|None: If there is task information, returns `schemas.task.Task`, otherwise `None`.\n    \"\"\"\n    if isinstance(uuid, str):\n        uuid = UUID(uuid)\n    task = await self.storage.get(uuid=uuid)\n    new_task = await self._plugin_trigger(\n        \"broker_get\", broker=self, task=task, return_last=True\n    )\n    if new_task:\n        task = new_task.get(\"task\", task)\n    return task\n</code></pre>"},{"location":"api/brokers/async_kafkabroker/#qtasks.brokers.async_kafka.AsyncKafkaBroker.listen","title":"<code>listen(worker)</code>  <code>async</code>","text":"<p>Listens to Kafka and transfers tasks to the worker.</p> <p>Parameters:</p> Name Type Description Default <code>worker</code> <code>BaseWorker</code> <p>Worker class.</p> required Source code in <code>src/qtasks/brokers/async_kafka.py</code> <pre><code>async def listen(\n    self,\n    worker: Annotated[\n        BaseWorker[Literal[True]],\n        Doc(\"\"\"\n                Worker class.\n                \"\"\"),\n    ],\n):\n    \"\"\"\n    Listens to Kafka and transfers tasks to the worker.\n\n    Args:\n        worker (BaseWorker): Worker class.\n    \"\"\"\n    await self._plugin_trigger(\"broker_listen_start\", broker=self, worker=worker)\n    await self._consumer_start()\n    self.running = True\n    try:\n        async for msg in self.consumer:\n            task_data = msg.value\n            task_name, uuid, priority = task_data.split(\":\")\n            model_get = await self.get(uuid=uuid)\n            if not model_get:\n                raise KeyError(f\"Task not found: {uuid}\")\n            args, kwargs, created_at = (\n                model_get.args or (),\n                model_get.kwargs or {},\n                model_get.created_at.timestamp(),\n            )\n            if self.log:\n                self.log.info(f\"Received new task: {uuid}\")\n            new_args = await self._plugin_trigger(\n                \"broker_add_worker\",\n                broker=self,\n                worker=worker,\n                task_name=task_name,\n                uuid=uuid,\n                priority=int(priority),\n                args=args,\n                kw=kwargs,\n                created_at=created_at,\n                return_last=True,\n            )\n            if new_args:\n                task_name = new_args.get(\"task_name\", task_name)\n                uuid = new_args.get(\"uuid\", uuid)\n                priority = new_args.get(\"priority\", priority)\n                args = new_args.get(\"args\", args)\n                kwargs = new_args.get(\"kw\", kwargs)\n                created_at = new_args.get(\"created_at\", created_at)\n\n            await worker.add(\n                name=task_name,\n                uuid=uuid,\n                priority=int(priority),\n                args=args,\n                kwargs=kwargs,\n                created_at=created_at,\n            )\n    finally:\n        await self.consumer.stop()\n</code></pre>"},{"location":"api/brokers/async_kafkabroker/#qtasks.brokers.async_kafka.AsyncKafkaBroker.remove_finished_task","title":"<code>remove_finished_task(task_broker, model)</code>  <code>async</code>","text":"<p>Updates storage data via the <code>self.storage.remove_finished_task</code> function.</p> <p>Parameters:</p> Name Type Description Default <code>task_broker</code> <code>TaskPrioritySchema</code> <p>The priority task schema.</p> required <code>model</code> <code>TaskStatusSuccessSchema | TaskStatusErrorSchema</code> <p>Model of the task result.</p> required Source code in <code>src/qtasks/brokers/async_kafka.py</code> <pre><code>async def remove_finished_task(\n    self,\n    task_broker: Annotated[\n        TaskPrioritySchema,\n        Doc(\"\"\"\n                Priority task diagram.\n                \"\"\"),\n    ],\n    model: Annotated[\n        TaskStatusSuccessSchema | TaskStatusErrorSchema,\n        Doc(\"\"\"\n                Model of the task result.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Updates storage data via the `self.storage.remove_finished_task` function.\n\n    Args:\n        task_broker (TaskPrioritySchema): The priority task schema.\n        model (TaskStatusSuccessSchema | TaskStatusErrorSchema): Model of the task result.\n    \"\"\"\n    new_model = await self._plugin_trigger(\n        \"broker_remove_finished_task\",\n        broker=self,\n        storage=self.storage,\n        model=model,\n        return_last=True,\n    )\n    if new_model:\n        model = new_model.get(\"model\", model)\n\n    await self.storage.remove_finished_task(task_broker, model)\n</code></pre>"},{"location":"api/brokers/async_kafkabroker/#qtasks.brokers.async_kafka.AsyncKafkaBroker.start","title":"<code>start(worker)</code>  <code>async</code>","text":"<p>Launches the broker.</p> <p>Parameters:</p> Name Type Description Default <code>worker</code> <code>BaseWorker</code> <p>Worker class.</p> required Source code in <code>src/qtasks/brokers/async_kafka.py</code> <pre><code>async def start(\n    self,\n    worker: Annotated[\n        BaseWorker,\n        Doc(\"\"\"\n                Worker class.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Launches the broker.\n\n    Args:\n        worker (BaseWorker): Worker class.\n    \"\"\"\n    await self._plugin_trigger(\"broker_start\", broker=self, worker=worker)\n    await self.storage.start()\n\n    if self.config.delete_finished_tasks:\n        await self.storage._delete_finished_tasks()\n\n    if self.config.running_older_tasks:\n        await self.storage._running_older_tasks(worker)\n\n    await self.listen(worker)\n</code></pre>"},{"location":"api/brokers/async_kafkabroker/#qtasks.brokers.async_kafka.AsyncKafkaBroker.stop","title":"<code>stop()</code>  <code>async</code>","text":"<p>The broker stops.</p> Source code in <code>src/qtasks/brokers/async_kafka.py</code> <pre><code>async def stop(self):\n    \"\"\"The broker stops.\"\"\"\n    await self._plugin_trigger(\"broker_stop\", broker=self)\n    self.running = False\n    await self.consumer.stop()\n    await self.producer.stop()\n</code></pre>"},{"location":"api/brokers/async_kafkabroker/#qtasks.brokers.async_kafka.AsyncKafkaBroker.update","title":"<code>update(**kwargs)</code>  <code>async</code>","text":"<p>Updates task information.</p> <p>Parameters:</p> Name Type Description Default <code>kwargs</code> <code>dict</code> <p>task data of type kwargs.</p> <code>{}</code> Source code in <code>src/qtasks/brokers/async_kafka.py</code> <pre><code>async def update(\n    self,\n    **kwargs: Annotated[\n        Any,\n        Doc(\"\"\"\n                Update arguments for storage type kwargs.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Updates task information.\n\n    Args:\n        kwargs (dict, optional): task data of type kwargs.\n    \"\"\"\n    new_kw = await self._plugin_trigger(\n        \"broker_update\", broker=self, kw=kwargs, return_last=True\n    )\n    if new_kw:\n        kwargs = new_kw.get(\"kw\", kwargs)\n    return await self.storage.update(**kwargs)\n</code></pre>"},{"location":"api/brokers/async_rabbitmqbroker/","title":"AsyncRabbitMQBroker","text":"<p>Async RabbitMQ Broker.</p>"},{"location":"api/brokers/async_rabbitmqbroker/#qtasks.brokers.async_rabbitmq.AsyncRabbitMQBroker","title":"<code>AsyncRabbitMQBroker</code>","text":"<p>               Bases: <code>BaseBroker</code>, <code>AsyncPluginMixin</code></p> <p>A broker that listens to RabbitMQ and adds tasks to the queue.</p>"},{"location":"api/brokers/async_rabbitmqbroker/#qtasks.brokers.async_rabbitmq.AsyncRabbitMQBroker--example","title":"Example","text":"<p>```python from qtasks import QueueTasks from qtasks.brokers import AsyncRabbitMQBroker</p> <p>broker = AsyncRabbitMQBroker(name=\"QueueTasks\", url=\"amqp://guest:guest@localhost/\")</p> <p>app = QueueTasks(broker=broker)     ```</p> Source code in <code>src/qtasks/brokers/async_rabbitmq.py</code> <pre><code>class AsyncRabbitMQBroker(BaseBroker, AsyncPluginMixin):\n    \"\"\"\n    A broker that listens to RabbitMQ and adds tasks to the queue.\n\n    ## Example\n\n    ```python\n    from qtasks import QueueTasks\n    from qtasks.brokers import AsyncRabbitMQBroker\n\n    broker = AsyncRabbitMQBroker(name=\"QueueTasks\", url=\"amqp://guest:guest@localhost/\")\n\n    app = QueueTasks(broker=broker)\n        ```\n    \"\"\"\n\n    def __init__(\n        self,\n        name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Project name. This name is also used by the broker.\n\n                    Default: `QueueTasks`.\n                    \"\"\"),\n        ] = \"QueueTasks\",\n        url: Annotated[\n            str,\n            Doc(\"\"\"\n                    URL to connect to RabbitMQ.\n\n                    Default: `amqp://guest:guest@localhost/`.\n                    \"\"\"),\n        ] = \"amqp://guest:guest@localhost/\",\n        storage: Annotated[\n            Optional[BaseStorage],\n            Doc(\"\"\"\n                    Storage.\n\n                    Default: `AsyncRedisStorage`.\n                    \"\"\"),\n        ] = None,\n        queue_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    The name of the task queue for RabbitMQ. The title is updated to: `name:queue_name`\n\n                    Default: `task_queue`.\n                    \"\"\"),\n        ] = \"task_queue\",\n        log: Annotated[\n            Logger | None,\n            Doc(\"\"\"\n                    Logger.\n\n                    Default: `qtasks.logs.Logger`.\n                    \"\"\"),\n        ] = None,\n        config: Annotated[\n            QueueConfig | None,\n            Doc(\"\"\"\n                    Config.\n\n                    Default: `qtasks.configs.config.QueueConfig`.\n                    \"\"\"),\n        ] = None,\n        events: Annotated[\n            Optional[BaseEvents],\n            Doc(\"\"\"\n                    Events.\n\n                    Default: `qtasks.events.AsyncEvents`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Initializing AsyncRabbitMQBroker.\n\n        Args:\n            name (str, optional): Project name. Default: `QueueTasks`.\n            url (str, optional): URL to connect to RabbitMQ. Default: `None`.\n            storage (BaseStorage, optional): Storage. Default: `None`.\n            queue_name (str, optional): RabbitMQ queue name. Default: `task_queue`.\n            log (Logger, optional): Logger. Default: `None`.\n            config (QueueConfig, optional): Config. Default: `None`.\n            events (BaseEvents, optional): Events. Default: `qtasks.events.AsyncEvents`.\n        \"\"\"\n        self.url = url\n\n        storage = storage or AsyncRedisStorage(\n            name=name, log=log, config=config, events=events\n        )\n        super().__init__(\n            name=name, log=log, config=config, events=events, storage=storage\n        )\n\n        self.storage: BaseStorage[Literal[True]]\n\n        self.queue_name = f\"{self.name}:{queue_name}\"\n        self.events = self.events or AsyncEvents()\n\n        self.connection = None\n        self.channel = None\n        self.running = False\n\n    async def connect(self):\n        \"\"\"Connecting to RabbitMQ is asynchronous.\"\"\"\n        self.connection = await aio_pika.connect_robust(self.url)\n        self.channel = await self.connection.channel()\n        await self.channel.set_qos(prefetch_count=1)\n\n        self.queue = await self.channel.declare_queue(self.queue_name, durable=True)\n\n    async def listen(\n        self,\n        worker: Annotated[\n            BaseWorker[Literal[True]],\n            Doc(\"\"\"\n                    Worker class.\n                    \"\"\"),\n        ],\n    ):\n        \"\"\"\n        Listens to the RabbitMQ queue and transfers tasks to the worker.\n\n        Args:\n            worker (BaseWorker): Worker class.\n        \"\"\"\n        await self._plugin_trigger(\"broker_listen_start\", broker=self, worker=worker)\n        if not self.channel:\n            await self.connect()\n\n        async with self.queue.iterator() as queue_iter:\n            self.running = True\n            async for message in queue_iter:\n                async with message.process():\n                    task_data = json.loads(message.body)\n                    task_name, uuid, priority = (\n                        task_data[\"task_name\"],\n                        task_data[\"uuid\"],\n                        task_data[\"priority\"],\n                    )\n                    args, kwargs = task_data.get(\"args\", ()), task_data.get(\n                        \"kwargs\", {}\n                    )\n                    created_at = task_data.get(\"created_at\", 0)\n\n                    await self.storage.add_process(\n                        f'{task_data[\"task_name\"]}:{task_data[\"uuid\"]}:{task_data[\"priority\"]}',\n                        task_data[\"priority\"],\n                    )\n                    if self.log:\n                        self.log.info(f\"Received new task: {task_data['uuid']}\")\n                    new_args = await self._plugin_trigger(\n                        \"broker_add_worker\",\n                        broker=self,\n                        worker=worker,\n                        task_name=task_name,\n                        uuid=uuid,\n                        priority=int(priority),\n                        args=args,\n                        kw=kwargs,\n                        created_at=created_at,\n                        return_last=True,\n                    )\n                    if new_args:\n                        task_name = new_args.get(\"task_name\", task_name)\n                        uuid = new_args.get(\"uuid\", uuid)\n                        priority = new_args.get(\"priority\", priority)\n                        args = new_args.get(\"args\", args)\n                        kwargs = new_args.get(\"kw\", kwargs)\n                        created_at = new_args.get(\"created_at\", created_at)\n\n                    await worker.add(\n                        name=task_name,\n                        uuid=uuid,\n                        priority=priority,\n                        args=args,\n                        kwargs=kwargs,\n                        created_at=created_at,\n                    )\n                if not self.running:\n                    break\n\n    async def add(\n        self,\n        task_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int,\n            Doc(\"\"\"\n                    Task priority.\n\n                    Default: `0`.\n                    \"\"\"),\n        ] = 0,\n        extra: Annotated[\n            dict | None,\n            Doc(\"\"\"\n                    Additional task parameters.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        args: Annotated[\n            tuple | None,\n            Doc(\"\"\"\n                    Task arguments of type args.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        kwargs: Annotated[\n            dict | None,\n            Doc(\"\"\"\n                    Task arguments of type kwargs.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n    ) -&gt; Task:\n        \"\"\"\n        Adds a task to the broker.\n\n        Args:\n            task_name (str): The name of the task.\n            priority (int, optional): Task priority. Default: `0`.\n            extra (dict, optional): Additional task parameters. Default: `None`.\n            args (tuple, optional): Task arguments of type args. Default: `None`.\n            kwargs (dict, optional): Task arguments of type kwargs. Default: `None`.\n\n        Returns:\n            Task: `schemas.task.Task`\n\n        Raises:\n            RuntimeError: self.channel is not defined. The server is not running!\n        \"\"\"\n        args, kwargs = args or (), kwargs or {}\n        if not self.channel:\n            await self.connect()\n        if not isinstance(self.channel, aio_pika.channel.Channel):\n            raise RuntimeError(\"self.channel is not defined. The server is not running!\")\n        self.channel: aio_pika.channel.Channel\n\n        uuid = uuid4()\n        uuid_str = str(uuid)\n        created_at = time()\n\n        model = TaskStatusNewSchema(\n            task_name=task_name,\n            priority=priority,\n            created_at=created_at,\n            updated_at=created_at,\n            args=str(args),\n            kwargs=str(kwargs),\n        )\n\n        if extra:\n            model = self._dynamic_model(model=model, extra=extra)\n\n        new_model = await self._plugin_trigger(\n            \"broker_add_before\",\n            broker=self,\n            storage=self.storage,\n            model=model,\n            return_last=True,\n        )\n        if new_model:\n            model = new_model.get(\"model\", model)\n\n        await self.storage.add(uuid=uuid, task_status=model)\n\n        task_data = {\n            \"uuid\": uuid_str,\n            \"task_name\": task_name,\n            \"priority\": priority,\n            \"args\": args,\n            \"kwargs\": kwargs,\n            \"created_at\": created_at,\n        }\n\n        await self.channel.default_exchange.publish(\n            aio_pika.Message(\n                body=json.dumps(task_data).encode(),\n                delivery_mode=aio_pika.DeliveryMode.PERSISTENT,\n            ),\n            routing_key=self.queue_name,\n        )\n\n        await self._plugin_trigger(\n            \"broker_add_after\", broker=self, storage=self.storage, model=model\n        )\n\n        return Task(\n            status=TaskStatusEnum.NEW.value,\n            task_name=task_name,\n            uuid=uuid,\n            priority=priority,\n            args=args,\n            kwargs=kwargs,\n            created_at=datetime.fromtimestamp(created_at),\n            updated_at=datetime.fromtimestamp(created_at),\n        )\n\n    async def get(\n        self,\n        uuid: Annotated[\n            UUID | str,\n            Doc(\"\"\"\n                    UUID of the task.\n                    \"\"\"),\n        ],\n    ) -&gt; Task | None:\n        \"\"\"\n        Obtaining information about a task.\n\n        Args:\n            uuid (UUID|str): UUID of the task.\n\n        Returns:\n            Task|None: If there is task information, returns `schemas.task.Task`, otherwise `None`.\n        \"\"\"\n        if isinstance(uuid, str):\n            uuid = UUID(uuid)\n        task = await self.storage.get(uuid=uuid)\n        new_task = await self._plugin_trigger(\n            \"broker_get\", broker=self, task=task, return_last=True\n        )\n        if new_task:\n            task = new_task.get(\"task\", task)\n        return task\n\n    async def update(\n        self,\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    Update arguments for storage type kwargs.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Updates task information.\n\n        Args:\n            kwargs (dict, optional): task data of type kwargs.\n        \"\"\"\n        new_kw = await self._plugin_trigger(\n            \"broker_update\", broker=self, kw=kwargs, return_last=True\n        )\n        if new_kw:\n            kwargs = new_kw.get(\"kw\", kwargs)\n        return await self.storage.update(**kwargs)\n\n    async def start(\n        self,\n        worker: Annotated[\n            BaseWorker,\n            Doc(\"\"\"\n                    Worker class.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Launches the broker.\n\n        Args:\n            worker (BaseWorker): Worker class.\n        \"\"\"\n        await self._plugin_trigger(\"broker_start\", broker=self, worker=worker)\n        await self.storage.start()\n\n        if self.config.delete_finished_tasks:\n            await self.storage._delete_finished_tasks()\n\n        if self.config.running_older_tasks:\n            await self.storage._running_older_tasks(worker)\n\n        await self.listen(worker)\n\n    async def stop(self):\n        \"\"\"The broker stops.\"\"\"\n        await self._plugin_trigger(\"broker_stop\", broker=self)\n        self.running = False\n        if self.connection:\n            await self.connection.close()\n            self.connection = None\n            self.channel = None\n\n    async def remove_finished_task(\n        self,\n        task_broker: Annotated[\n            TaskPrioritySchema,\n            Doc(\"\"\"\n                    Priority task diagram.\n                    \"\"\"),\n        ],\n        model: Annotated[\n            TaskStatusSuccessSchema | TaskStatusErrorSchema,\n            Doc(\"\"\"\n                    Model of the task result.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Updates storage data via the `self.storage.remove_finished_task` function.\n\n        Args:\n            task_broker (TaskPrioritySchema): The priority task schema.\n            model (TaskStatusSuccessSchema | TaskStatusErrorSchema): Model of the task result.\n        \"\"\"\n        new_model = await self._plugin_trigger(\n            \"broker_remove_finished_task\",\n            broker=self,\n            storage=self.storage,\n            model=model,\n            return_last=True,\n        )\n        if new_model:\n            model = new_model.get(\"model\", model)\n\n        return await self.storage.remove_finished_task(task_broker, model)\n\n    async def _running_older_tasks(self, worker):\n        await self._plugin_trigger(\n            \"broker_running_older_tasks\", broker=self, worker=worker\n        )\n        return await self.storage._running_older_tasks(worker)\n\n    async def flush_all(self) -&gt; None:\n        \"\"\"Delete all data.\"\"\"\n        await self._plugin_trigger(\"broker_flush_all\", broker=self)\n        await self.storage.flush_all()\n</code></pre>"},{"location":"api/brokers/async_rabbitmqbroker/#qtasks.brokers.async_rabbitmq.AsyncRabbitMQBroker.__init__","title":"<code>__init__(name='QueueTasks', url='amqp://guest:guest@localhost/', storage=None, queue_name='task_queue', log=None, config=None, events=None)</code>","text":"<p>Initializing AsyncRabbitMQBroker.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Project name. Default: <code>QueueTasks</code>.</p> <code>'QueueTasks'</code> <code>url</code> <code>str</code> <p>URL to connect to RabbitMQ. Default: <code>None</code>.</p> <code>'amqp://guest:guest@localhost/'</code> <code>storage</code> <code>BaseStorage</code> <p>Storage. Default: <code>None</code>.</p> <code>None</code> <code>queue_name</code> <code>str</code> <p>RabbitMQ queue name. Default: <code>task_queue</code>.</p> <code>'task_queue'</code> <code>log</code> <code>Logger</code> <p>Logger. Default: <code>None</code>.</p> <code>None</code> <code>config</code> <code>QueueConfig</code> <p>Config. Default: <code>None</code>.</p> <code>None</code> <code>events</code> <code>BaseEvents</code> <p>Events. Default: <code>qtasks.events.AsyncEvents</code>.</p> <code>None</code> Source code in <code>src/qtasks/brokers/async_rabbitmq.py</code> <pre><code>def __init__(\n    self,\n    name: Annotated[\n        str,\n        Doc(\"\"\"\n                Project name. This name is also used by the broker.\n\n                Default: `QueueTasks`.\n                \"\"\"),\n    ] = \"QueueTasks\",\n    url: Annotated[\n        str,\n        Doc(\"\"\"\n                URL to connect to RabbitMQ.\n\n                Default: `amqp://guest:guest@localhost/`.\n                \"\"\"),\n    ] = \"amqp://guest:guest@localhost/\",\n    storage: Annotated[\n        Optional[BaseStorage],\n        Doc(\"\"\"\n                Storage.\n\n                Default: `AsyncRedisStorage`.\n                \"\"\"),\n    ] = None,\n    queue_name: Annotated[\n        str,\n        Doc(\"\"\"\n                The name of the task queue for RabbitMQ. The title is updated to: `name:queue_name`\n\n                Default: `task_queue`.\n                \"\"\"),\n    ] = \"task_queue\",\n    log: Annotated[\n        Logger | None,\n        Doc(\"\"\"\n                Logger.\n\n                Default: `qtasks.logs.Logger`.\n                \"\"\"),\n    ] = None,\n    config: Annotated[\n        QueueConfig | None,\n        Doc(\"\"\"\n                Config.\n\n                Default: `qtasks.configs.config.QueueConfig`.\n                \"\"\"),\n    ] = None,\n    events: Annotated[\n        Optional[BaseEvents],\n        Doc(\"\"\"\n                Events.\n\n                Default: `qtasks.events.AsyncEvents`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    Initializing AsyncRabbitMQBroker.\n\n    Args:\n        name (str, optional): Project name. Default: `QueueTasks`.\n        url (str, optional): URL to connect to RabbitMQ. Default: `None`.\n        storage (BaseStorage, optional): Storage. Default: `None`.\n        queue_name (str, optional): RabbitMQ queue name. Default: `task_queue`.\n        log (Logger, optional): Logger. Default: `None`.\n        config (QueueConfig, optional): Config. Default: `None`.\n        events (BaseEvents, optional): Events. Default: `qtasks.events.AsyncEvents`.\n    \"\"\"\n    self.url = url\n\n    storage = storage or AsyncRedisStorage(\n        name=name, log=log, config=config, events=events\n    )\n    super().__init__(\n        name=name, log=log, config=config, events=events, storage=storage\n    )\n\n    self.storage: BaseStorage[Literal[True]]\n\n    self.queue_name = f\"{self.name}:{queue_name}\"\n    self.events = self.events or AsyncEvents()\n\n    self.connection = None\n    self.channel = None\n    self.running = False\n</code></pre>"},{"location":"api/brokers/async_rabbitmqbroker/#qtasks.brokers.async_rabbitmq.AsyncRabbitMQBroker.add","title":"<code>add(task_name, priority=0, extra=None, args=None, kwargs=None)</code>  <code>async</code>","text":"<p>Adds a task to the broker.</p> <p>Parameters:</p> Name Type Description Default <code>task_name</code> <code>str</code> <p>The name of the task.</p> required <code>priority</code> <code>int</code> <p>Task priority. Default: <code>0</code>.</p> <code>0</code> <code>extra</code> <code>dict</code> <p>Additional task parameters. Default: <code>None</code>.</p> <code>None</code> <code>args</code> <code>tuple</code> <p>Task arguments of type args. Default: <code>None</code>.</p> <code>None</code> <code>kwargs</code> <code>dict</code> <p>Task arguments of type kwargs. Default: <code>None</code>.</p> <code>None</code> <p>Returns:</p> Name Type Description <code>Task</code> <code>Task</code> <p><code>schemas.task.Task</code></p> <p>Raises:</p> Type Description <code>RuntimeError</code> <p>self.channel is not defined. The server is not running!</p> Source code in <code>src/qtasks/brokers/async_rabbitmq.py</code> <pre><code>async def add(\n    self,\n    task_name: Annotated[\n        str,\n        Doc(\"\"\"\n                Task name.\n                \"\"\"),\n    ],\n    priority: Annotated[\n        int,\n        Doc(\"\"\"\n                Task priority.\n\n                Default: `0`.\n                \"\"\"),\n    ] = 0,\n    extra: Annotated[\n        dict | None,\n        Doc(\"\"\"\n                Additional task parameters.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    args: Annotated[\n        tuple | None,\n        Doc(\"\"\"\n                Task arguments of type args.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    kwargs: Annotated[\n        dict | None,\n        Doc(\"\"\"\n                Task arguments of type kwargs.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n) -&gt; Task:\n    \"\"\"\n    Adds a task to the broker.\n\n    Args:\n        task_name (str): The name of the task.\n        priority (int, optional): Task priority. Default: `0`.\n        extra (dict, optional): Additional task parameters. Default: `None`.\n        args (tuple, optional): Task arguments of type args. Default: `None`.\n        kwargs (dict, optional): Task arguments of type kwargs. Default: `None`.\n\n    Returns:\n        Task: `schemas.task.Task`\n\n    Raises:\n        RuntimeError: self.channel is not defined. The server is not running!\n    \"\"\"\n    args, kwargs = args or (), kwargs or {}\n    if not self.channel:\n        await self.connect()\n    if not isinstance(self.channel, aio_pika.channel.Channel):\n        raise RuntimeError(\"self.channel is not defined. The server is not running!\")\n    self.channel: aio_pika.channel.Channel\n\n    uuid = uuid4()\n    uuid_str = str(uuid)\n    created_at = time()\n\n    model = TaskStatusNewSchema(\n        task_name=task_name,\n        priority=priority,\n        created_at=created_at,\n        updated_at=created_at,\n        args=str(args),\n        kwargs=str(kwargs),\n    )\n\n    if extra:\n        model = self._dynamic_model(model=model, extra=extra)\n\n    new_model = await self._plugin_trigger(\n        \"broker_add_before\",\n        broker=self,\n        storage=self.storage,\n        model=model,\n        return_last=True,\n    )\n    if new_model:\n        model = new_model.get(\"model\", model)\n\n    await self.storage.add(uuid=uuid, task_status=model)\n\n    task_data = {\n        \"uuid\": uuid_str,\n        \"task_name\": task_name,\n        \"priority\": priority,\n        \"args\": args,\n        \"kwargs\": kwargs,\n        \"created_at\": created_at,\n    }\n\n    await self.channel.default_exchange.publish(\n        aio_pika.Message(\n            body=json.dumps(task_data).encode(),\n            delivery_mode=aio_pika.DeliveryMode.PERSISTENT,\n        ),\n        routing_key=self.queue_name,\n    )\n\n    await self._plugin_trigger(\n        \"broker_add_after\", broker=self, storage=self.storage, model=model\n    )\n\n    return Task(\n        status=TaskStatusEnum.NEW.value,\n        task_name=task_name,\n        uuid=uuid,\n        priority=priority,\n        args=args,\n        kwargs=kwargs,\n        created_at=datetime.fromtimestamp(created_at),\n        updated_at=datetime.fromtimestamp(created_at),\n    )\n</code></pre>"},{"location":"api/brokers/async_rabbitmqbroker/#qtasks.brokers.async_rabbitmq.AsyncRabbitMQBroker.connect","title":"<code>connect()</code>  <code>async</code>","text":"<p>Connecting to RabbitMQ is asynchronous.</p> Source code in <code>src/qtasks/brokers/async_rabbitmq.py</code> <pre><code>async def connect(self):\n    \"\"\"Connecting to RabbitMQ is asynchronous.\"\"\"\n    self.connection = await aio_pika.connect_robust(self.url)\n    self.channel = await self.connection.channel()\n    await self.channel.set_qos(prefetch_count=1)\n\n    self.queue = await self.channel.declare_queue(self.queue_name, durable=True)\n</code></pre>"},{"location":"api/brokers/async_rabbitmqbroker/#qtasks.brokers.async_rabbitmq.AsyncRabbitMQBroker.flush_all","title":"<code>flush_all()</code>  <code>async</code>","text":"<p>Delete all data.</p> Source code in <code>src/qtasks/brokers/async_rabbitmq.py</code> <pre><code>async def flush_all(self) -&gt; None:\n    \"\"\"Delete all data.\"\"\"\n    await self._plugin_trigger(\"broker_flush_all\", broker=self)\n    await self.storage.flush_all()\n</code></pre>"},{"location":"api/brokers/async_rabbitmqbroker/#qtasks.brokers.async_rabbitmq.AsyncRabbitMQBroker.get","title":"<code>get(uuid)</code>  <code>async</code>","text":"<p>Obtaining information about a task.</p> <p>Parameters:</p> Name Type Description Default <code>uuid</code> <code>UUID | str</code> <p>UUID of the task.</p> required <p>Returns:</p> Type Description <code>Task | None</code> <p>Task|None: If there is task information, returns <code>schemas.task.Task</code>, otherwise <code>None</code>.</p> Source code in <code>src/qtasks/brokers/async_rabbitmq.py</code> <pre><code>async def get(\n    self,\n    uuid: Annotated[\n        UUID | str,\n        Doc(\"\"\"\n                UUID of the task.\n                \"\"\"),\n    ],\n) -&gt; Task | None:\n    \"\"\"\n    Obtaining information about a task.\n\n    Args:\n        uuid (UUID|str): UUID of the task.\n\n    Returns:\n        Task|None: If there is task information, returns `schemas.task.Task`, otherwise `None`.\n    \"\"\"\n    if isinstance(uuid, str):\n        uuid = UUID(uuid)\n    task = await self.storage.get(uuid=uuid)\n    new_task = await self._plugin_trigger(\n        \"broker_get\", broker=self, task=task, return_last=True\n    )\n    if new_task:\n        task = new_task.get(\"task\", task)\n    return task\n</code></pre>"},{"location":"api/brokers/async_rabbitmqbroker/#qtasks.brokers.async_rabbitmq.AsyncRabbitMQBroker.listen","title":"<code>listen(worker)</code>  <code>async</code>","text":"<p>Listens to the RabbitMQ queue and transfers tasks to the worker.</p> <p>Parameters:</p> Name Type Description Default <code>worker</code> <code>BaseWorker</code> <p>Worker class.</p> required Source code in <code>src/qtasks/brokers/async_rabbitmq.py</code> <pre><code>async def listen(\n    self,\n    worker: Annotated[\n        BaseWorker[Literal[True]],\n        Doc(\"\"\"\n                Worker class.\n                \"\"\"),\n    ],\n):\n    \"\"\"\n    Listens to the RabbitMQ queue and transfers tasks to the worker.\n\n    Args:\n        worker (BaseWorker): Worker class.\n    \"\"\"\n    await self._plugin_trigger(\"broker_listen_start\", broker=self, worker=worker)\n    if not self.channel:\n        await self.connect()\n\n    async with self.queue.iterator() as queue_iter:\n        self.running = True\n        async for message in queue_iter:\n            async with message.process():\n                task_data = json.loads(message.body)\n                task_name, uuid, priority = (\n                    task_data[\"task_name\"],\n                    task_data[\"uuid\"],\n                    task_data[\"priority\"],\n                )\n                args, kwargs = task_data.get(\"args\", ()), task_data.get(\n                    \"kwargs\", {}\n                )\n                created_at = task_data.get(\"created_at\", 0)\n\n                await self.storage.add_process(\n                    f'{task_data[\"task_name\"]}:{task_data[\"uuid\"]}:{task_data[\"priority\"]}',\n                    task_data[\"priority\"],\n                )\n                if self.log:\n                    self.log.info(f\"Received new task: {task_data['uuid']}\")\n                new_args = await self._plugin_trigger(\n                    \"broker_add_worker\",\n                    broker=self,\n                    worker=worker,\n                    task_name=task_name,\n                    uuid=uuid,\n                    priority=int(priority),\n                    args=args,\n                    kw=kwargs,\n                    created_at=created_at,\n                    return_last=True,\n                )\n                if new_args:\n                    task_name = new_args.get(\"task_name\", task_name)\n                    uuid = new_args.get(\"uuid\", uuid)\n                    priority = new_args.get(\"priority\", priority)\n                    args = new_args.get(\"args\", args)\n                    kwargs = new_args.get(\"kw\", kwargs)\n                    created_at = new_args.get(\"created_at\", created_at)\n\n                await worker.add(\n                    name=task_name,\n                    uuid=uuid,\n                    priority=priority,\n                    args=args,\n                    kwargs=kwargs,\n                    created_at=created_at,\n                )\n            if not self.running:\n                break\n</code></pre>"},{"location":"api/brokers/async_rabbitmqbroker/#qtasks.brokers.async_rabbitmq.AsyncRabbitMQBroker.remove_finished_task","title":"<code>remove_finished_task(task_broker, model)</code>  <code>async</code>","text":"<p>Updates storage data via the <code>self.storage.remove_finished_task</code> function.</p> <p>Parameters:</p> Name Type Description Default <code>task_broker</code> <code>TaskPrioritySchema</code> <p>The priority task schema.</p> required <code>model</code> <code>TaskStatusSuccessSchema | TaskStatusErrorSchema</code> <p>Model of the task result.</p> required Source code in <code>src/qtasks/brokers/async_rabbitmq.py</code> <pre><code>async def remove_finished_task(\n    self,\n    task_broker: Annotated[\n        TaskPrioritySchema,\n        Doc(\"\"\"\n                Priority task diagram.\n                \"\"\"),\n    ],\n    model: Annotated[\n        TaskStatusSuccessSchema | TaskStatusErrorSchema,\n        Doc(\"\"\"\n                Model of the task result.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Updates storage data via the `self.storage.remove_finished_task` function.\n\n    Args:\n        task_broker (TaskPrioritySchema): The priority task schema.\n        model (TaskStatusSuccessSchema | TaskStatusErrorSchema): Model of the task result.\n    \"\"\"\n    new_model = await self._plugin_trigger(\n        \"broker_remove_finished_task\",\n        broker=self,\n        storage=self.storage,\n        model=model,\n        return_last=True,\n    )\n    if new_model:\n        model = new_model.get(\"model\", model)\n\n    return await self.storage.remove_finished_task(task_broker, model)\n</code></pre>"},{"location":"api/brokers/async_rabbitmqbroker/#qtasks.brokers.async_rabbitmq.AsyncRabbitMQBroker.start","title":"<code>start(worker)</code>  <code>async</code>","text":"<p>Launches the broker.</p> <p>Parameters:</p> Name Type Description Default <code>worker</code> <code>BaseWorker</code> <p>Worker class.</p> required Source code in <code>src/qtasks/brokers/async_rabbitmq.py</code> <pre><code>async def start(\n    self,\n    worker: Annotated[\n        BaseWorker,\n        Doc(\"\"\"\n                Worker class.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Launches the broker.\n\n    Args:\n        worker (BaseWorker): Worker class.\n    \"\"\"\n    await self._plugin_trigger(\"broker_start\", broker=self, worker=worker)\n    await self.storage.start()\n\n    if self.config.delete_finished_tasks:\n        await self.storage._delete_finished_tasks()\n\n    if self.config.running_older_tasks:\n        await self.storage._running_older_tasks(worker)\n\n    await self.listen(worker)\n</code></pre>"},{"location":"api/brokers/async_rabbitmqbroker/#qtasks.brokers.async_rabbitmq.AsyncRabbitMQBroker.stop","title":"<code>stop()</code>  <code>async</code>","text":"<p>The broker stops.</p> Source code in <code>src/qtasks/brokers/async_rabbitmq.py</code> <pre><code>async def stop(self):\n    \"\"\"The broker stops.\"\"\"\n    await self._plugin_trigger(\"broker_stop\", broker=self)\n    self.running = False\n    if self.connection:\n        await self.connection.close()\n        self.connection = None\n        self.channel = None\n</code></pre>"},{"location":"api/brokers/async_rabbitmqbroker/#qtasks.brokers.async_rabbitmq.AsyncRabbitMQBroker.update","title":"<code>update(**kwargs)</code>  <code>async</code>","text":"<p>Updates task information.</p> <p>Parameters:</p> Name Type Description Default <code>kwargs</code> <code>dict</code> <p>task data of type kwargs.</p> <code>{}</code> Source code in <code>src/qtasks/brokers/async_rabbitmq.py</code> <pre><code>async def update(\n    self,\n    **kwargs: Annotated[\n        Any,\n        Doc(\"\"\"\n                Update arguments for storage type kwargs.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Updates task information.\n\n    Args:\n        kwargs (dict, optional): task data of type kwargs.\n    \"\"\"\n    new_kw = await self._plugin_trigger(\n        \"broker_update\", broker=self, kw=kwargs, return_last=True\n    )\n    if new_kw:\n        kwargs = new_kw.get(\"kw\", kwargs)\n    return await self.storage.update(**kwargs)\n</code></pre>"},{"location":"api/brokers/async_redisbroker/","title":"AsyncRedisBroker","text":"<p>Async Redis Broker.</p>"},{"location":"api/brokers/async_redisbroker/#qtasks.brokers.async_redis.AsyncRedisBroker","title":"<code>AsyncRedisBroker</code>","text":"<p>               Bases: <code>BaseBroker[Literal[True]]</code>, <code>AsyncPluginMixin</code></p> <p>A broker that listens to Redis and adds tasks to the queue.</p>"},{"location":"api/brokers/async_redisbroker/#qtasks.brokers.async_redis.AsyncRedisBroker--example","title":"Example","text":"<p>```python from qtasks import QueueTasks from qtasks.brokers import AsyncRedisBroker</p> <p>broker = AsyncRedisBroker(name=\"QueueTasks\", url=\"redis://localhost:6379/2\")</p> <p>app = QueueTasks(broker=broker)     ```</p> Source code in <code>src/qtasks/brokers/async_redis.py</code> <pre><code>class AsyncRedisBroker(BaseBroker[Literal[True]], AsyncPluginMixin):\n    \"\"\"\n    A broker that listens to Redis and adds tasks to the queue.\n\n    ## Example\n\n    ```python\n    from qtasks import QueueTasks\n    from qtasks.brokers import AsyncRedisBroker\n\n    broker = AsyncRedisBroker(name=\"QueueTasks\", url=\"redis://localhost:6379/2\")\n\n    app = QueueTasks(broker=broker)\n        ```\n    \"\"\"\n\n    def __init__(\n        self,\n        name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Project name. This name is also used by the broker.\n\n                    Default: `QueueTasks`.\n                    \"\"\"),\n        ] = \"QueueTasks\",\n        url: Annotated[\n            str | None,\n            Doc(\"\"\"\n                    URL to connect to Redis.\n\n                    Default: `redis://localhost:6379/0`.\n                    \"\"\"),\n        ] = None,\n        storage: Annotated[\n            Optional[BaseStorage],\n            Doc(\"\"\"\n                    Storage.\n\n                    Default: `AsyncRedisStorage`.\n                    \"\"\"),\n        ] = None,\n        queue_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    The name of the task queue array for Redis. The name is updated to: `name:queue_name`.\n\n                    Default: `task_queue`.\n                    \"\"\"),\n        ] = \"task_queue\",\n        log: Annotated[\n            Logger | None,\n            Doc(\"\"\"\n                    Logger.\n\n                    Default: `qtasks.logs.Logger`.\n                    \"\"\"),\n        ] = None,\n        config: Annotated[\n            QueueConfig | None,\n            Doc(\"\"\"\n                    Config.\n\n                    Default: `qtasks.configs.config.QueueConfig`.\n                    \"\"\"),\n        ] = None,\n        events: Annotated[\n            Optional[BaseEvents],\n            Doc(\"\"\"\n                    Events.\n\n                    Default: `qtasks.events.AsyncEvents`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Initializing AsyncRedisBroker.\n\n        Args:\n            name (str, optional): Project name. Default: `QueueTasks`.\n            url (str, optional): URL to connect to Redis. Default: `None`.\n            storage (BaseStorage, optional): Storage. Default: `None`.\n            queue_name (str, optional): Name of the task queue array for Redis. Default: `task_queue`.\n            log (Logger, optional): Logger. Default: `None`.\n            config (QueueConfig, optional): Config. Default: `None`.\n            events (BaseEvents, optional): Events. Default: `qtasks.events.AsyncEvents`.\n        \"\"\"\n        self.url = url or \"redis://localhost:6379/0\"\n        self.client = aioredis.Redis.from_url(\n            self.url, decode_responses=True, encoding=\"utf-8\"\n        )\n        storage = storage or AsyncRedisStorage(\n            name=name,\n            url=self.url,\n            redis_connect=self.client,\n            log=log,\n            config=config,\n            events=events,\n        )\n\n        events = events or AsyncEvents()\n\n        super().__init__(\n            name=name, log=log, config=config, events=events, storage=storage\n        )\n\n        self.storage: BaseStorage[Literal[True]]\n\n        self.queue_name = f\"{self.name}:{queue_name}\"\n\n        self.running = False\n        self.default_sleep = 0.01\n\n    async def listen(\n        self,\n        worker: Annotated[\n            BaseWorker[Literal[True]],\n            Doc(\"\"\"\n                    Worker class.\n                    \"\"\"),\n        ],\n    ):\n        \"\"\"\n        Listens to the Redis queue and passes tasks to the worker.\n\n        Args:\n            worker (BaseWorker): Worker class.\n\n        Raises:\n            ValueError: Unknown task data format.\n            KeyError: Task not found.\n        \"\"\"\n        await self._plugin_trigger(\"broker_listen_start\", broker=self, worker=worker)\n        self.running = True\n\n        while self.running:\n            raw = self.client.lpop(self.queue_name)\n            task_data = await cast(Awaitable[str | list[Any] | None], raw)\n\n            if not task_data:\n                await asyncio.sleep(self.default_sleep)\n                continue\n\n            if isinstance(task_data, list):\n                raise ValueError(\"Unknown task data format.\")\n\n            task_name, uuid, priority = task_data.split(\":\")\n            uuid = UUID(uuid, version=4)\n            priority = int(priority)\n\n            await self.storage.add_process(task_data, priority)\n\n            model_get = await self.get(uuid=uuid)\n            if not model_get:\n                raise KeyError(f\"Task not found: {uuid}\")\n\n            args, kwargs, created_at = (\n                model_get.args or (),\n                model_get.kwargs or {},\n                model_get.created_at.timestamp(),\n            )\n            if self.log:\n                self.log.info(f\"Received new task: {uuid}\")\n            new_args = await self._plugin_trigger(\n                \"broker_add_worker\",\n                broker=self,\n                worker=worker,\n                task_name=task_name,\n                uuid=uuid,\n                priority=priority,\n                args=args,\n                kw=kwargs,\n                created_at=created_at,\n                return_last=True,\n            )\n            if new_args:\n                task_name = new_args.get(\"task_name\", task_name)\n                uuid = new_args.get(\"uuid\", uuid)\n                priority = new_args.get(\"priority\", priority)\n                args = new_args.get(\"args\", args)\n                kwargs = new_args.get(\"kw\", kwargs)\n                created_at = new_args.get(\"created_at\", created_at)\n            await worker.add(\n                name=task_name,\n                uuid=uuid,\n                priority=priority,\n                args=args,\n                kwargs=kwargs,\n                created_at=created_at,\n            )\n        return\n\n    async def add(\n        self,\n        task_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int,\n            Doc(\"\"\"\n                    Task priority.\n\n                    Default: `0`.\n                    \"\"\"),\n        ] = 0,\n        extra: Annotated[\n            dict | None,\n            Doc(\"\"\"\n                    Additional task parameters.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        args: Annotated[\n            tuple | None,\n            Doc(\"\"\"\n                    Task arguments of type args.\n\n                    Default: `()`.\n                    \"\"\"),\n        ] = None,\n        kwargs: Annotated[\n            dict | None,\n            Doc(\"\"\"\n                    Task arguments of type kwargs.\n\n                    Default: `{}`.\n                    \"\"\"),\n        ] = None,\n    ) -&gt; Task:\n        \"\"\"\n        Adds a task to the broker.\n\n        Args:\n            task_name (str): The name of the task.\n            priority (int, optional): Task priority. By default: 0.\n            extra (dict, optional): Additional task parameters. Default: `None`.\n            args (tuple, optional): Task arguments of type args. Default: `()`.\n            kwargs (dict, optional): Task arguments of type kwargs. Default: `{}`.\n\n        Returns:\n            Task: `schemas.task.Task`\n\n        Raises:\n            ValueError: Invalid task status.\n        \"\"\"\n        loop = asyncio.get_running_loop()\n        asyncio_atexit.register(self.stop, loop=loop)\n        asyncio_atexit.register(self.storage.stop, loop=loop)\n\n        args, kwargs = args or (), kwargs or {}\n        uuid = uuid4()\n        uuid_str = str(uuid)\n        created_at = time()\n        model = TaskStatusNewSchema(\n            task_name=task_name,\n            priority=priority,\n            created_at=created_at,\n            updated_at=created_at,\n            args=json.dumps(args),\n            kwargs=json.dumps(kwargs),\n        )\n\n        if extra:\n            model = self._dynamic_model(model=model, extra=extra)\n\n        new_model = await self._plugin_trigger(\n            \"broker_add_before\", broker=self, storage=self.storage, model=model\n        )\n        if new_model:\n            model = new_model.get(\"model\", model)\n\n        if not isinstance(model, TaskStatusNewSchema):\n            raise ValueError(\"Invalid task status.\")\n\n        await self.storage.add(uuid=uuid, task_status=model)\n\n        raw = self.client.rpush(self.queue_name, f\"{task_name}:{uuid_str}:{priority}\")\n        await cast(Awaitable[int], raw)\n\n        await self._plugin_trigger(\n            \"broker_add_after\", broker=self, storage=self.storage, model=model\n        )\n        return Task(\n            status=TaskStatusEnum.NEW.value,\n            task_name=task_name,\n            uuid=uuid,\n            priority=priority,\n            args=args,\n            kwargs=kwargs,\n            created_at=datetime.fromtimestamp(created_at),\n            updated_at=datetime.fromtimestamp(created_at),\n        )\n\n    async def get(\n        self,\n        uuid: Annotated[\n            UUID | str,\n            Doc(\"\"\"\n                    UUID of the task.\n                    \"\"\"),\n        ],\n    ) -&gt; Task | None:\n        \"\"\"\n        Obtaining information about a task.\n\n        Args:\n            uuid (UUID|str): UUID of the task.\n\n        Returns:\n            Task|None: If there is task information, returns `schemas.task.Task`, otherwise `None`.\n        \"\"\"\n        if isinstance(uuid, str):\n            uuid = UUID(uuid)\n        task = await self.storage.get(uuid=uuid)\n        new_task = await self._plugin_trigger(\n            \"broker_get\", broker=self, task=task, return_last=True\n        )\n        if new_task:\n            task = new_task.get(\"task\", task)\n        return task\n\n    async def update(\n        self,\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    Update arguments for storage type kwargs.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Updates task information.\n\n        Args:\n            kwargs (dict, optional): task data of type kwargs.\n        \"\"\"\n        new_kw = await self._plugin_trigger(\n            \"broker_update\", broker=self, kw=kwargs, return_last=True\n        )\n        if new_kw:\n            kwargs = new_kw.get(\"kw\", kwargs)\n        return await self.storage.update(**kwargs)\n\n    async def start(\n        self,\n        worker: Annotated[\n            BaseWorker,\n            Doc(\"\"\"\n                    Worker class.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Launches the broker.\n\n        Args:\n            worker (BaseWorker): Worker class.\n        \"\"\"\n        await self._plugin_trigger(\"broker_start\", broker=self, worker=worker)\n        await self.storage.start()\n\n        if self.config.delete_finished_tasks:\n            await self.storage._delete_finished_tasks()\n\n        if self.config.running_older_tasks:\n            await self.storage._running_older_tasks(worker)\n\n        await self.listen(worker)\n\n    async def stop(self):\n        \"\"\"The broker stops.\"\"\"\n        await self._plugin_trigger(\"broker_stop\", broker=self)\n        self.running = False\n        await self.client.aclose()\n\n    async def remove_finished_task(\n        self,\n        task_broker: Annotated[\n            TaskPrioritySchema,\n            Doc(\"\"\"\n                    Priority task diagram.\n                    \"\"\"),\n        ],\n        model: Annotated[\n            TaskStatusSuccessSchema | TaskStatusErrorSchema,\n            Doc(\"\"\"\n                    Model of the task result.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Updates storage data via the `self.storage.remove_finished_task` function.\n\n        Args:\n            task_broker (TaskPrioritySchema): The priority task schema.\n            model (TaskStatusSuccessSchema | TaskStatusErrorSchema): Model of the task result.\n        \"\"\"\n        new_model = await self._plugin_trigger(\n            \"broker_remove_finished_task\",\n            broker=self,\n            storage=self.storage,\n            model=model,\n            return_last=True,\n        )\n        if new_model:\n            model = new_model.get(\"model\", model)\n\n        await self.storage.remove_finished_task(task_broker, model)\n        return\n\n    async def _running_older_tasks(self, worker):\n        await self._plugin_trigger(\n            \"broker_running_older_tasks\", broker=self, worker=worker\n        )\n        return await self.storage._running_older_tasks(worker)\n\n    async def flush_all(self) -&gt; None:\n        \"\"\"Delete all data.\"\"\"\n        await self._plugin_trigger(\"broker_flush_all\", broker=self)\n        await self.storage.flush_all()\n</code></pre>"},{"location":"api/brokers/async_redisbroker/#qtasks.brokers.async_redis.AsyncRedisBroker.__init__","title":"<code>__init__(name='QueueTasks', url=None, storage=None, queue_name='task_queue', log=None, config=None, events=None)</code>","text":"<p>Initializing AsyncRedisBroker.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Project name. Default: <code>QueueTasks</code>.</p> <code>'QueueTasks'</code> <code>url</code> <code>str</code> <p>URL to connect to Redis. Default: <code>None</code>.</p> <code>None</code> <code>storage</code> <code>BaseStorage</code> <p>Storage. Default: <code>None</code>.</p> <code>None</code> <code>queue_name</code> <code>str</code> <p>Name of the task queue array for Redis. Default: <code>task_queue</code>.</p> <code>'task_queue'</code> <code>log</code> <code>Logger</code> <p>Logger. Default: <code>None</code>.</p> <code>None</code> <code>config</code> <code>QueueConfig</code> <p>Config. Default: <code>None</code>.</p> <code>None</code> <code>events</code> <code>BaseEvents</code> <p>Events. Default: <code>qtasks.events.AsyncEvents</code>.</p> <code>None</code> Source code in <code>src/qtasks/brokers/async_redis.py</code> <pre><code>def __init__(\n    self,\n    name: Annotated[\n        str,\n        Doc(\"\"\"\n                Project name. This name is also used by the broker.\n\n                Default: `QueueTasks`.\n                \"\"\"),\n    ] = \"QueueTasks\",\n    url: Annotated[\n        str | None,\n        Doc(\"\"\"\n                URL to connect to Redis.\n\n                Default: `redis://localhost:6379/0`.\n                \"\"\"),\n    ] = None,\n    storage: Annotated[\n        Optional[BaseStorage],\n        Doc(\"\"\"\n                Storage.\n\n                Default: `AsyncRedisStorage`.\n                \"\"\"),\n    ] = None,\n    queue_name: Annotated[\n        str,\n        Doc(\"\"\"\n                The name of the task queue array for Redis. The name is updated to: `name:queue_name`.\n\n                Default: `task_queue`.\n                \"\"\"),\n    ] = \"task_queue\",\n    log: Annotated[\n        Logger | None,\n        Doc(\"\"\"\n                Logger.\n\n                Default: `qtasks.logs.Logger`.\n                \"\"\"),\n    ] = None,\n    config: Annotated[\n        QueueConfig | None,\n        Doc(\"\"\"\n                Config.\n\n                Default: `qtasks.configs.config.QueueConfig`.\n                \"\"\"),\n    ] = None,\n    events: Annotated[\n        Optional[BaseEvents],\n        Doc(\"\"\"\n                Events.\n\n                Default: `qtasks.events.AsyncEvents`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    Initializing AsyncRedisBroker.\n\n    Args:\n        name (str, optional): Project name. Default: `QueueTasks`.\n        url (str, optional): URL to connect to Redis. Default: `None`.\n        storage (BaseStorage, optional): Storage. Default: `None`.\n        queue_name (str, optional): Name of the task queue array for Redis. Default: `task_queue`.\n        log (Logger, optional): Logger. Default: `None`.\n        config (QueueConfig, optional): Config. Default: `None`.\n        events (BaseEvents, optional): Events. Default: `qtasks.events.AsyncEvents`.\n    \"\"\"\n    self.url = url or \"redis://localhost:6379/0\"\n    self.client = aioredis.Redis.from_url(\n        self.url, decode_responses=True, encoding=\"utf-8\"\n    )\n    storage = storage or AsyncRedisStorage(\n        name=name,\n        url=self.url,\n        redis_connect=self.client,\n        log=log,\n        config=config,\n        events=events,\n    )\n\n    events = events or AsyncEvents()\n\n    super().__init__(\n        name=name, log=log, config=config, events=events, storage=storage\n    )\n\n    self.storage: BaseStorage[Literal[True]]\n\n    self.queue_name = f\"{self.name}:{queue_name}\"\n\n    self.running = False\n    self.default_sleep = 0.01\n</code></pre>"},{"location":"api/brokers/async_redisbroker/#qtasks.brokers.async_redis.AsyncRedisBroker.add","title":"<code>add(task_name, priority=0, extra=None, args=None, kwargs=None)</code>  <code>async</code>","text":"<p>Adds a task to the broker.</p> <p>Parameters:</p> Name Type Description Default <code>task_name</code> <code>str</code> <p>The name of the task.</p> required <code>priority</code> <code>int</code> <p>Task priority. By default: 0.</p> <code>0</code> <code>extra</code> <code>dict</code> <p>Additional task parameters. Default: <code>None</code>.</p> <code>None</code> <code>args</code> <code>tuple</code> <p>Task arguments of type args. Default: <code>()</code>.</p> <code>None</code> <code>kwargs</code> <code>dict</code> <p>Task arguments of type kwargs. Default: <code>{}</code>.</p> <code>None</code> <p>Returns:</p> Name Type Description <code>Task</code> <code>Task</code> <p><code>schemas.task.Task</code></p> <p>Raises:</p> Type Description <code>ValueError</code> <p>Invalid task status.</p> Source code in <code>src/qtasks/brokers/async_redis.py</code> <pre><code>async def add(\n    self,\n    task_name: Annotated[\n        str,\n        Doc(\"\"\"\n                Task name.\n                \"\"\"),\n    ],\n    priority: Annotated[\n        int,\n        Doc(\"\"\"\n                Task priority.\n\n                Default: `0`.\n                \"\"\"),\n    ] = 0,\n    extra: Annotated[\n        dict | None,\n        Doc(\"\"\"\n                Additional task parameters.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    args: Annotated[\n        tuple | None,\n        Doc(\"\"\"\n                Task arguments of type args.\n\n                Default: `()`.\n                \"\"\"),\n    ] = None,\n    kwargs: Annotated[\n        dict | None,\n        Doc(\"\"\"\n                Task arguments of type kwargs.\n\n                Default: `{}`.\n                \"\"\"),\n    ] = None,\n) -&gt; Task:\n    \"\"\"\n    Adds a task to the broker.\n\n    Args:\n        task_name (str): The name of the task.\n        priority (int, optional): Task priority. By default: 0.\n        extra (dict, optional): Additional task parameters. Default: `None`.\n        args (tuple, optional): Task arguments of type args. Default: `()`.\n        kwargs (dict, optional): Task arguments of type kwargs. Default: `{}`.\n\n    Returns:\n        Task: `schemas.task.Task`\n\n    Raises:\n        ValueError: Invalid task status.\n    \"\"\"\n    loop = asyncio.get_running_loop()\n    asyncio_atexit.register(self.stop, loop=loop)\n    asyncio_atexit.register(self.storage.stop, loop=loop)\n\n    args, kwargs = args or (), kwargs or {}\n    uuid = uuid4()\n    uuid_str = str(uuid)\n    created_at = time()\n    model = TaskStatusNewSchema(\n        task_name=task_name,\n        priority=priority,\n        created_at=created_at,\n        updated_at=created_at,\n        args=json.dumps(args),\n        kwargs=json.dumps(kwargs),\n    )\n\n    if extra:\n        model = self._dynamic_model(model=model, extra=extra)\n\n    new_model = await self._plugin_trigger(\n        \"broker_add_before\", broker=self, storage=self.storage, model=model\n    )\n    if new_model:\n        model = new_model.get(\"model\", model)\n\n    if not isinstance(model, TaskStatusNewSchema):\n        raise ValueError(\"Invalid task status.\")\n\n    await self.storage.add(uuid=uuid, task_status=model)\n\n    raw = self.client.rpush(self.queue_name, f\"{task_name}:{uuid_str}:{priority}\")\n    await cast(Awaitable[int], raw)\n\n    await self._plugin_trigger(\n        \"broker_add_after\", broker=self, storage=self.storage, model=model\n    )\n    return Task(\n        status=TaskStatusEnum.NEW.value,\n        task_name=task_name,\n        uuid=uuid,\n        priority=priority,\n        args=args,\n        kwargs=kwargs,\n        created_at=datetime.fromtimestamp(created_at),\n        updated_at=datetime.fromtimestamp(created_at),\n    )\n</code></pre>"},{"location":"api/brokers/async_redisbroker/#qtasks.brokers.async_redis.AsyncRedisBroker.flush_all","title":"<code>flush_all()</code>  <code>async</code>","text":"<p>Delete all data.</p> Source code in <code>src/qtasks/brokers/async_redis.py</code> <pre><code>async def flush_all(self) -&gt; None:\n    \"\"\"Delete all data.\"\"\"\n    await self._plugin_trigger(\"broker_flush_all\", broker=self)\n    await self.storage.flush_all()\n</code></pre>"},{"location":"api/brokers/async_redisbroker/#qtasks.brokers.async_redis.AsyncRedisBroker.get","title":"<code>get(uuid)</code>  <code>async</code>","text":"<p>Obtaining information about a task.</p> <p>Parameters:</p> Name Type Description Default <code>uuid</code> <code>UUID | str</code> <p>UUID of the task.</p> required <p>Returns:</p> Type Description <code>Task | None</code> <p>Task|None: If there is task information, returns <code>schemas.task.Task</code>, otherwise <code>None</code>.</p> Source code in <code>src/qtasks/brokers/async_redis.py</code> <pre><code>async def get(\n    self,\n    uuid: Annotated[\n        UUID | str,\n        Doc(\"\"\"\n                UUID of the task.\n                \"\"\"),\n    ],\n) -&gt; Task | None:\n    \"\"\"\n    Obtaining information about a task.\n\n    Args:\n        uuid (UUID|str): UUID of the task.\n\n    Returns:\n        Task|None: If there is task information, returns `schemas.task.Task`, otherwise `None`.\n    \"\"\"\n    if isinstance(uuid, str):\n        uuid = UUID(uuid)\n    task = await self.storage.get(uuid=uuid)\n    new_task = await self._plugin_trigger(\n        \"broker_get\", broker=self, task=task, return_last=True\n    )\n    if new_task:\n        task = new_task.get(\"task\", task)\n    return task\n</code></pre>"},{"location":"api/brokers/async_redisbroker/#qtasks.brokers.async_redis.AsyncRedisBroker.listen","title":"<code>listen(worker)</code>  <code>async</code>","text":"<p>Listens to the Redis queue and passes tasks to the worker.</p> <p>Parameters:</p> Name Type Description Default <code>worker</code> <code>BaseWorker</code> <p>Worker class.</p> required <p>Raises:</p> Type Description <code>ValueError</code> <p>Unknown task data format.</p> <code>KeyError</code> <p>Task not found.</p> Source code in <code>src/qtasks/brokers/async_redis.py</code> <pre><code>async def listen(\n    self,\n    worker: Annotated[\n        BaseWorker[Literal[True]],\n        Doc(\"\"\"\n                Worker class.\n                \"\"\"),\n    ],\n):\n    \"\"\"\n    Listens to the Redis queue and passes tasks to the worker.\n\n    Args:\n        worker (BaseWorker): Worker class.\n\n    Raises:\n        ValueError: Unknown task data format.\n        KeyError: Task not found.\n    \"\"\"\n    await self._plugin_trigger(\"broker_listen_start\", broker=self, worker=worker)\n    self.running = True\n\n    while self.running:\n        raw = self.client.lpop(self.queue_name)\n        task_data = await cast(Awaitable[str | list[Any] | None], raw)\n\n        if not task_data:\n            await asyncio.sleep(self.default_sleep)\n            continue\n\n        if isinstance(task_data, list):\n            raise ValueError(\"Unknown task data format.\")\n\n        task_name, uuid, priority = task_data.split(\":\")\n        uuid = UUID(uuid, version=4)\n        priority = int(priority)\n\n        await self.storage.add_process(task_data, priority)\n\n        model_get = await self.get(uuid=uuid)\n        if not model_get:\n            raise KeyError(f\"Task not found: {uuid}\")\n\n        args, kwargs, created_at = (\n            model_get.args or (),\n            model_get.kwargs or {},\n            model_get.created_at.timestamp(),\n        )\n        if self.log:\n            self.log.info(f\"Received new task: {uuid}\")\n        new_args = await self._plugin_trigger(\n            \"broker_add_worker\",\n            broker=self,\n            worker=worker,\n            task_name=task_name,\n            uuid=uuid,\n            priority=priority,\n            args=args,\n            kw=kwargs,\n            created_at=created_at,\n            return_last=True,\n        )\n        if new_args:\n            task_name = new_args.get(\"task_name\", task_name)\n            uuid = new_args.get(\"uuid\", uuid)\n            priority = new_args.get(\"priority\", priority)\n            args = new_args.get(\"args\", args)\n            kwargs = new_args.get(\"kw\", kwargs)\n            created_at = new_args.get(\"created_at\", created_at)\n        await worker.add(\n            name=task_name,\n            uuid=uuid,\n            priority=priority,\n            args=args,\n            kwargs=kwargs,\n            created_at=created_at,\n        )\n    return\n</code></pre>"},{"location":"api/brokers/async_redisbroker/#qtasks.brokers.async_redis.AsyncRedisBroker.remove_finished_task","title":"<code>remove_finished_task(task_broker, model)</code>  <code>async</code>","text":"<p>Updates storage data via the <code>self.storage.remove_finished_task</code> function.</p> <p>Parameters:</p> Name Type Description Default <code>task_broker</code> <code>TaskPrioritySchema</code> <p>The priority task schema.</p> required <code>model</code> <code>TaskStatusSuccessSchema | TaskStatusErrorSchema</code> <p>Model of the task result.</p> required Source code in <code>src/qtasks/brokers/async_redis.py</code> <pre><code>async def remove_finished_task(\n    self,\n    task_broker: Annotated[\n        TaskPrioritySchema,\n        Doc(\"\"\"\n                Priority task diagram.\n                \"\"\"),\n    ],\n    model: Annotated[\n        TaskStatusSuccessSchema | TaskStatusErrorSchema,\n        Doc(\"\"\"\n                Model of the task result.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Updates storage data via the `self.storage.remove_finished_task` function.\n\n    Args:\n        task_broker (TaskPrioritySchema): The priority task schema.\n        model (TaskStatusSuccessSchema | TaskStatusErrorSchema): Model of the task result.\n    \"\"\"\n    new_model = await self._plugin_trigger(\n        \"broker_remove_finished_task\",\n        broker=self,\n        storage=self.storage,\n        model=model,\n        return_last=True,\n    )\n    if new_model:\n        model = new_model.get(\"model\", model)\n\n    await self.storage.remove_finished_task(task_broker, model)\n    return\n</code></pre>"},{"location":"api/brokers/async_redisbroker/#qtasks.brokers.async_redis.AsyncRedisBroker.start","title":"<code>start(worker)</code>  <code>async</code>","text":"<p>Launches the broker.</p> <p>Parameters:</p> Name Type Description Default <code>worker</code> <code>BaseWorker</code> <p>Worker class.</p> required Source code in <code>src/qtasks/brokers/async_redis.py</code> <pre><code>async def start(\n    self,\n    worker: Annotated[\n        BaseWorker,\n        Doc(\"\"\"\n                Worker class.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Launches the broker.\n\n    Args:\n        worker (BaseWorker): Worker class.\n    \"\"\"\n    await self._plugin_trigger(\"broker_start\", broker=self, worker=worker)\n    await self.storage.start()\n\n    if self.config.delete_finished_tasks:\n        await self.storage._delete_finished_tasks()\n\n    if self.config.running_older_tasks:\n        await self.storage._running_older_tasks(worker)\n\n    await self.listen(worker)\n</code></pre>"},{"location":"api/brokers/async_redisbroker/#qtasks.brokers.async_redis.AsyncRedisBroker.stop","title":"<code>stop()</code>  <code>async</code>","text":"<p>The broker stops.</p> Source code in <code>src/qtasks/brokers/async_redis.py</code> <pre><code>async def stop(self):\n    \"\"\"The broker stops.\"\"\"\n    await self._plugin_trigger(\"broker_stop\", broker=self)\n    self.running = False\n    await self.client.aclose()\n</code></pre>"},{"location":"api/brokers/async_redisbroker/#qtasks.brokers.async_redis.AsyncRedisBroker.update","title":"<code>update(**kwargs)</code>  <code>async</code>","text":"<p>Updates task information.</p> <p>Parameters:</p> Name Type Description Default <code>kwargs</code> <code>dict</code> <p>task data of type kwargs.</p> <code>{}</code> Source code in <code>src/qtasks/brokers/async_redis.py</code> <pre><code>async def update(\n    self,\n    **kwargs: Annotated[\n        Any,\n        Doc(\"\"\"\n                Update arguments for storage type kwargs.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Updates task information.\n\n    Args:\n        kwargs (dict, optional): task data of type kwargs.\n    \"\"\"\n    new_kw = await self._plugin_trigger(\n        \"broker_update\", broker=self, kw=kwargs, return_last=True\n    )\n    if new_kw:\n        kwargs = new_kw.get(\"kw\", kwargs)\n    return await self.storage.update(**kwargs)\n</code></pre>"},{"location":"api/brokers/async_socket/","title":"AsyncSocketBroker","text":"<p>Async Socket Broker.</p>"},{"location":"api/brokers/async_socket/#qtasks.brokers.async_socket.AsyncSocketBroker","title":"<code>AsyncSocketBroker</code>","text":"<p>               Bases: <code>BaseBroker</code>, <code>AsyncPluginMixin</code></p> <p>A broker that listens to sockets and adds tasks to the queue.</p>"},{"location":"api/brokers/async_socket/#qtasks.brokers.async_socket.AsyncSocketBroker--example","title":"Example","text":"<pre><code>from qtasks import QueueTasks\nfrom qtasks.brokers import AsyncSocketBroker\n\nbroker = AsyncSocketBroker(name=\"QueueTasks\", url=\"127.0.0.1\")\n\napp = QueueTasks(broker=broker)\n</code></pre> Source code in <code>src/qtasks/brokers/async_socket.py</code> <pre><code>class AsyncSocketBroker(BaseBroker, AsyncPluginMixin):\n    \"\"\"\n    A broker that listens to sockets and adds tasks to the queue.\n\n    ## Example\n\n    ```python\n    from qtasks import QueueTasks\n    from qtasks.brokers import AsyncSocketBroker\n\n    broker = AsyncSocketBroker(name=\"QueueTasks\", url=\"127.0.0.1\")\n\n    app = QueueTasks(broker=broker)\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Project name. This name is also used by the broker.\n\n                    Default: `QueueTasks`.\n                    \"\"\"),\n        ] = \"QueueTasks\",\n        url: Annotated[\n            str,\n            Doc(\"\"\"\n                    URL to connect to the socket.\n\n                    Default: `127.0.0.1`.\n                    \"\"\"),\n        ] = \"127.0.0.1\",\n        port: Annotated[\n            int,\n            Doc(\"\"\"\n                    Port for connecting to a socket.\n\n                    Default: `6379`.\n                    \"\"\"),\n        ] = 6379,\n        storage: Annotated[\n            Optional[BaseStorage],\n            Doc(\"\"\"\n                    Storage.\n\n                    Default: `AsyncRedisStorage`.\n                    \"\"\"),\n        ] = None,\n        log: Annotated[\n            Logger | None,\n            Doc(\"\"\"\n                    Logger.\n\n                    Default: `qtasks.logs.Logger`.\n                    \"\"\"),\n        ] = None,\n        config: Annotated[\n            QueueConfig | None,\n            Doc(\"\"\"\n                    Config.\n\n                    Default: `qtasks.configs.config.QueueConfig`.\n                    \"\"\"),\n        ] = None,\n        events: Annotated[\n            Optional[BaseEvents],\n            Doc(\"\"\"\n                    Events.\n\n                    Default: `qtasks.events.AsyncEvents`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Initializing AsyncSocketBroker.\n\n        Args:\n            name (str, optional): Project name. Default: `QueueTasks`.\n            url (str, optional): URL to connect to the socket. Default: `127.0.0.1`.\n            port (int, optional): Port to connect to the socket. Default: `6379`.\n            storage (BaseStorage, optional): Storage. Default: `None`.\n            log (Logger, optional): Logger. Default: `None`.\n            config (QueueConfig, optional): Config. Default: `None`.\n            events (BaseEvents, optional): Events. Default: `qtasks.events.AsyncEvents`.\n        \"\"\"\n        self.url = url\n        self.port = port\n        storage = storage or AsyncRedisStorage(\n            name=name, log=log, config=config, events=events\n        )\n\n        super().__init__(\n            name=name, log=log, config=config, events=events, storage=storage\n        )\n\n        self.storage: BaseStorage[Literal[True]]\n\n        self.events = self.events or AsyncEvents()\n\n        self.client = None\n        self.default_sleep = 0.01\n        self.running = False\n\n        self.queue = asyncio.Queue()\n        self._serve_task: asyncio.Task | None = None\n        self._listen_task: asyncio.Task | None = None\n\n    async def handle_connection(\n        self, reader: asyncio.StreamReader, writer: asyncio.StreamWriter\n    ):\n        \"\"\"\n        Handles an incoming connection.\n\n        Args:\n            reader(asyncio.StreamReader): Reader for incoming data.\n            writer(asyncio.StreamWriter): Writer for outgoing data.\n        \"\"\"\n        try:\n            data = await reader.read(4096)\n            message = json.loads(data.decode())\n            task_name = message[\"task_name\"]\n            uuid = message[\"uuid\"]\n            priority = message[\"priority\"]\n            args = message.get(\"args\", ())\n            kwargs = message.get(\"kwargs\", {})\n            created_at = message[\"created_at\"]\n\n            await self.storage.add(\n                uuid=uuid,\n                task_status=TaskStatusNewSchema(\n                    task_name=task_name,\n                    priority=priority,\n                    args=args,\n                    kwargs=kwargs,\n                    created_at=created_at,\n                    updated_at=created_at,\n                ),\n            )\n\n            await self.queue.put((task_name, uuid, priority))\n            writer.write(b\"OK\")\n            await writer.drain()\n        finally:\n            writer.close()\n            with contextlib.suppress(Exception):\n                await writer.wait_closed()\n\n    async def listen(\n        self,\n        worker: Annotated[\n            BaseWorker[Literal[True]],\n            Doc(\"\"\"\n                    Worker class.\n                    \"\"\"),\n        ],\n    ):\n        \"\"\"\n        Listens to the socket queue and transfers tasks to the worker.\n\n        Args:\n            worker (BaseWorker): Worker class.\n\n        Raises:\n            KeyError: Task not found.\n        \"\"\"\n        await self._plugin_trigger(\"broker_listen_start\", broker=self, worker=worker)\n        self.running = True\n\n        while self.running:\n            try:\n                item = await self.queue.get()\n            except asyncio.CancelledError:\n                break\n            if item is None:\n                break\n\n            task_name, uuid, priority = item\n            model_get = await self.get(uuid=uuid)\n            if not model_get:\n                raise KeyError(f\"Task not found: {uuid}\")\n\n            args, kwargs, created_at = (\n                model_get.args or (),\n                model_get.kwargs or {},\n                model_get.created_at.timestamp(),\n            )\n\n            await self.storage.add_process(f\"{task_name}:{uuid}:{priority}\", priority)\n\n            if self.log:\n                self.log.info(f\"Received new task: {uuid}\")\n            new_args = await self._plugin_trigger(\n                \"broker_add_worker\",\n                broker=self,\n                worker=worker,\n                task_name=task_name,\n                uuid=uuid,\n                priority=int(priority),\n                args=args,\n                kw=kwargs,\n                created_at=created_at,\n                return_last=True,\n            )\n            if new_args:\n                task_name = new_args.get(\"task_name\", task_name)\n                uuid = new_args.get(\"uuid\", uuid)\n                priority = new_args.get(\"priority\", priority)\n                args = new_args.get(\"args\", args)\n                kwargs = new_args.get(\"kw\", kwargs)\n                created_at = new_args.get(\"created_at\", created_at)\n\n            await worker.add(\n                name=task_name,\n                uuid=uuid,\n                priority=int(priority),\n                args=args,\n                kwargs=kwargs,\n                created_at=created_at,\n            )\n            return\n\n    async def add(\n        self,\n        task_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int,\n            Doc(\"\"\"\n                    Task priority.\n\n                    Default: `0`.\n                    \"\"\"),\n        ] = 0,\n        extra: Annotated[\n            dict | None,\n            Doc(\"\"\"\n                    Additional task parameters.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        args: Annotated[\n            tuple | None,\n            Doc(\"\"\"\n                    Task arguments of type args.\n\n                    Default: `()`.\n                    \"\"\"),\n        ] = None,\n        kwargs: Annotated[\n            dict | None,\n            Doc(\"\"\"\n                    Task arguments of type kwargs.\n\n                    Default: `{}`.\n                    \"\"\"),\n        ] = None,\n    ) -&gt; Task:\n        \"\"\"\n        Adds a task to the broker.\n\n        Args:\n            task_name (str): The name of the task.\n            priority (int, optional): Task priority. By default: 0.\n            extra (dict, optional): Additional task parameters. Default: `None`.\n            args (tuple, optional): Task arguments of type args. Default: `()`.\n            kwargs (dict, optional): Task arguments of type kwargs. Default: `{}`.\n\n        Returns:\n            Task: `schemas.task.Task`\n\n        Raises:\n            ValueError: Invalid task status.\n        \"\"\"\n        loop = asyncio.get_running_loop()\n        asyncio_atexit.register(self.stop, loop=loop)\n        asyncio_atexit.register(self.storage.stop, loop=loop)\n\n        args, kwargs = args or (), kwargs or {}\n        uuid = uuid4()\n        uuid_str = str(uuid)\n        created_at = time()\n        model = TaskStatusNewSchema(\n            task_name=task_name,\n            priority=priority,\n            created_at=created_at,\n            updated_at=created_at,\n            args=str(args),\n            kwargs=str(kwargs),\n        )\n\n        if extra:\n            model = self._dynamic_model(model=model, extra=extra)\n\n        new_model = await self._plugin_trigger(\n            \"broker_add_before\", broker=self, storage=self.storage, model=model\n        )\n        if new_model:\n            model = new_model.get(\"model\", model)\n\n        if not isinstance(model, TaskStatusNewSchema):\n            raise ValueError(\"Invalid task status.\")\n\n        await self.storage.add(uuid=uuid, task_status=model)\n        reader, writer = await asyncio.open_connection(self.url, self.port)\n        payload = asdict(model)\n        payload.update({\"uuid\": uuid_str})\n        writer.write(json.dumps(payload).encode())\n        await writer.drain()\n        with contextlib.suppress(Exception):\n            writer.close()\n\n        await self._plugin_trigger(\n            \"broker_add_after\", broker=self, storage=self.storage, model=model\n        )\n        return Task(\n            status=TaskStatusEnum.NEW.value,\n            task_name=task_name,\n            uuid=uuid,\n            priority=priority,\n            args=args,\n            kwargs=kwargs,\n            created_at=datetime.fromtimestamp(created_at),\n            updated_at=datetime.fromtimestamp(created_at),\n        )\n\n    async def get(\n        self,\n        uuid: Annotated[\n            UUID | str,\n            Doc(\"\"\"\n                    UUID of the task.\n                    \"\"\"),\n        ],\n    ) -&gt; Task | None:\n        \"\"\"\n        Obtaining information about a task.\n\n        Args:\n            uuid (UUID|str): UUID of the task.\n\n        Returns:\n            Task|None: If there is task information, returns `schemas.task.Task`, otherwise `None`.\n        \"\"\"\n        if isinstance(uuid, str):\n            uuid = UUID(uuid)\n        task = await self.storage.get(uuid=uuid)\n        new_task = await self._plugin_trigger(\n            \"broker_get\", broker=self, task=task, return_last=True\n        )\n        if new_task:\n            task = new_task.get(\"task\", task)\n        return task\n\n    async def update(\n        self,\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    Update arguments for storage type kwargs.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Updates task information.\n\n        Args:\n            kwargs (dict, optional): task data of type kwargs.\n        \"\"\"\n        new_kw = await self._plugin_trigger(\n            \"broker_update\", broker=self, kw=kwargs, return_last=True\n        )\n        if new_kw:\n            kwargs = new_kw.get(\"kw\", kwargs)\n        return await self.storage.update(**kwargs)\n\n    async def start(\n        self,\n        worker: Annotated[\n            BaseWorker,\n            Doc(\"\"\"\n                    Worker class.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Launches the broker.\n\n        Args:\n            worker (BaseWorker): Worker class.\n        \"\"\"\n        await self._plugin_trigger(\"broker_start\", broker=self, worker=worker)\n        await self.storage.start()\n\n        if self.config.delete_finished_tasks:\n            await self.storage._delete_finished_tasks()\n\n        if self.config.running_older_tasks:\n            await self.storage._running_older_tasks(worker)\n\n        self.client = await asyncio.start_server(\n            self.handle_connection, self.url, self.port\n        )\n\n        self._listen_task = asyncio.create_task(\n            self.listen(worker), name=\"broker-listen\"\n        )\n        self._serve_task = asyncio.create_task(\n            self.client.serve_forever(), name=\"broker-serve\"\n        )\n        with contextlib.suppress(asyncio.CancelledError):\n            await self._serve_task\n\n    async def stop(self):\n        \"\"\"The broker stops.\"\"\"\n        await self._plugin_trigger(\"broker_stop\", broker=self)\n        self.running = False\n\n        if self._listen_task and not self._listen_task.done():\n            self.queue.put_nowait(None)\n\n        if self.client:\n            self.client.close()\n            with contextlib.suppress(Exception):\n                await self.client.wait_closed()\n\n        if self._serve_task and not self._serve_task.done():\n            self._serve_task.cancel()\n            with contextlib.suppress(asyncio.CancelledError):\n                await self._serve_task\n\n        if self._listen_task and not self._listen_task.done():\n            with contextlib.suppress(asyncio.CancelledError):\n                await self._listen_task\n\n    async def remove_finished_task(\n        self,\n        task_broker: Annotated[\n            TaskPrioritySchema,\n            Doc(\"\"\"\n                    Priority task diagram.\n                    \"\"\"),\n        ],\n        model: Annotated[\n            TaskStatusSuccessSchema | TaskStatusErrorSchema,\n            Doc(\"\"\"\n                    Model of the task result.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Updates storage data via the `self.storage.remove_finished_task` function.\n\n        Args:\n            task_broker (TaskPrioritySchema): The priority task schema.\n            model (TaskStatusSuccessSchema | TaskStatusErrorSchema): Model of the task result.\n        \"\"\"\n        new_model = await self._plugin_trigger(\n            \"broker_remove_finished_task\",\n            broker=self,\n            storage=self.storage,\n            model=model,\n            return_last=True,\n        )\n        if new_model:\n            model = new_model.get(\"model\", model)\n\n        await self.storage.remove_finished_task(task_broker, model)\n        return\n\n    async def _running_older_tasks(self, worker):\n        await self._plugin_trigger(\n            \"broker_running_older_tasks\", broker=self, worker=worker\n        )\n        return await self.storage._running_older_tasks(worker)\n\n    async def flush_all(self) -&gt; None:\n        \"\"\"Delete all data.\"\"\"\n        await self._plugin_trigger(\"broker_flush_all\", broker=self)\n        await self.storage.flush_all()\n</code></pre>"},{"location":"api/brokers/async_socket/#qtasks.brokers.async_socket.AsyncSocketBroker.__init__","title":"<code>__init__(name='QueueTasks', url='127.0.0.1', port=6379, storage=None, log=None, config=None, events=None)</code>","text":"<p>Initializing AsyncSocketBroker.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Project name. Default: <code>QueueTasks</code>.</p> <code>'QueueTasks'</code> <code>url</code> <code>str</code> <p>URL to connect to the socket. Default: <code>127.0.0.1</code>.</p> <code>'127.0.0.1'</code> <code>port</code> <code>int</code> <p>Port to connect to the socket. Default: <code>6379</code>.</p> <code>6379</code> <code>storage</code> <code>BaseStorage</code> <p>Storage. Default: <code>None</code>.</p> <code>None</code> <code>log</code> <code>Logger</code> <p>Logger. Default: <code>None</code>.</p> <code>None</code> <code>config</code> <code>QueueConfig</code> <p>Config. Default: <code>None</code>.</p> <code>None</code> <code>events</code> <code>BaseEvents</code> <p>Events. Default: <code>qtasks.events.AsyncEvents</code>.</p> <code>None</code> Source code in <code>src/qtasks/brokers/async_socket.py</code> <pre><code>def __init__(\n    self,\n    name: Annotated[\n        str,\n        Doc(\"\"\"\n                Project name. This name is also used by the broker.\n\n                Default: `QueueTasks`.\n                \"\"\"),\n    ] = \"QueueTasks\",\n    url: Annotated[\n        str,\n        Doc(\"\"\"\n                URL to connect to the socket.\n\n                Default: `127.0.0.1`.\n                \"\"\"),\n    ] = \"127.0.0.1\",\n    port: Annotated[\n        int,\n        Doc(\"\"\"\n                Port for connecting to a socket.\n\n                Default: `6379`.\n                \"\"\"),\n    ] = 6379,\n    storage: Annotated[\n        Optional[BaseStorage],\n        Doc(\"\"\"\n                Storage.\n\n                Default: `AsyncRedisStorage`.\n                \"\"\"),\n    ] = None,\n    log: Annotated[\n        Logger | None,\n        Doc(\"\"\"\n                Logger.\n\n                Default: `qtasks.logs.Logger`.\n                \"\"\"),\n    ] = None,\n    config: Annotated[\n        QueueConfig | None,\n        Doc(\"\"\"\n                Config.\n\n                Default: `qtasks.configs.config.QueueConfig`.\n                \"\"\"),\n    ] = None,\n    events: Annotated[\n        Optional[BaseEvents],\n        Doc(\"\"\"\n                Events.\n\n                Default: `qtasks.events.AsyncEvents`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    Initializing AsyncSocketBroker.\n\n    Args:\n        name (str, optional): Project name. Default: `QueueTasks`.\n        url (str, optional): URL to connect to the socket. Default: `127.0.0.1`.\n        port (int, optional): Port to connect to the socket. Default: `6379`.\n        storage (BaseStorage, optional): Storage. Default: `None`.\n        log (Logger, optional): Logger. Default: `None`.\n        config (QueueConfig, optional): Config. Default: `None`.\n        events (BaseEvents, optional): Events. Default: `qtasks.events.AsyncEvents`.\n    \"\"\"\n    self.url = url\n    self.port = port\n    storage = storage or AsyncRedisStorage(\n        name=name, log=log, config=config, events=events\n    )\n\n    super().__init__(\n        name=name, log=log, config=config, events=events, storage=storage\n    )\n\n    self.storage: BaseStorage[Literal[True]]\n\n    self.events = self.events or AsyncEvents()\n\n    self.client = None\n    self.default_sleep = 0.01\n    self.running = False\n\n    self.queue = asyncio.Queue()\n    self._serve_task: asyncio.Task | None = None\n    self._listen_task: asyncio.Task | None = None\n</code></pre>"},{"location":"api/brokers/async_socket/#qtasks.brokers.async_socket.AsyncSocketBroker.add","title":"<code>add(task_name, priority=0, extra=None, args=None, kwargs=None)</code>  <code>async</code>","text":"<p>Adds a task to the broker.</p> <p>Parameters:</p> Name Type Description Default <code>task_name</code> <code>str</code> <p>The name of the task.</p> required <code>priority</code> <code>int</code> <p>Task priority. By default: 0.</p> <code>0</code> <code>extra</code> <code>dict</code> <p>Additional task parameters. Default: <code>None</code>.</p> <code>None</code> <code>args</code> <code>tuple</code> <p>Task arguments of type args. Default: <code>()</code>.</p> <code>None</code> <code>kwargs</code> <code>dict</code> <p>Task arguments of type kwargs. Default: <code>{}</code>.</p> <code>None</code> <p>Returns:</p> Name Type Description <code>Task</code> <code>Task</code> <p><code>schemas.task.Task</code></p> <p>Raises:</p> Type Description <code>ValueError</code> <p>Invalid task status.</p> Source code in <code>src/qtasks/brokers/async_socket.py</code> <pre><code>async def add(\n    self,\n    task_name: Annotated[\n        str,\n        Doc(\"\"\"\n                Task name.\n                \"\"\"),\n    ],\n    priority: Annotated[\n        int,\n        Doc(\"\"\"\n                Task priority.\n\n                Default: `0`.\n                \"\"\"),\n    ] = 0,\n    extra: Annotated[\n        dict | None,\n        Doc(\"\"\"\n                Additional task parameters.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    args: Annotated[\n        tuple | None,\n        Doc(\"\"\"\n                Task arguments of type args.\n\n                Default: `()`.\n                \"\"\"),\n    ] = None,\n    kwargs: Annotated[\n        dict | None,\n        Doc(\"\"\"\n                Task arguments of type kwargs.\n\n                Default: `{}`.\n                \"\"\"),\n    ] = None,\n) -&gt; Task:\n    \"\"\"\n    Adds a task to the broker.\n\n    Args:\n        task_name (str): The name of the task.\n        priority (int, optional): Task priority. By default: 0.\n        extra (dict, optional): Additional task parameters. Default: `None`.\n        args (tuple, optional): Task arguments of type args. Default: `()`.\n        kwargs (dict, optional): Task arguments of type kwargs. Default: `{}`.\n\n    Returns:\n        Task: `schemas.task.Task`\n\n    Raises:\n        ValueError: Invalid task status.\n    \"\"\"\n    loop = asyncio.get_running_loop()\n    asyncio_atexit.register(self.stop, loop=loop)\n    asyncio_atexit.register(self.storage.stop, loop=loop)\n\n    args, kwargs = args or (), kwargs or {}\n    uuid = uuid4()\n    uuid_str = str(uuid)\n    created_at = time()\n    model = TaskStatusNewSchema(\n        task_name=task_name,\n        priority=priority,\n        created_at=created_at,\n        updated_at=created_at,\n        args=str(args),\n        kwargs=str(kwargs),\n    )\n\n    if extra:\n        model = self._dynamic_model(model=model, extra=extra)\n\n    new_model = await self._plugin_trigger(\n        \"broker_add_before\", broker=self, storage=self.storage, model=model\n    )\n    if new_model:\n        model = new_model.get(\"model\", model)\n\n    if not isinstance(model, TaskStatusNewSchema):\n        raise ValueError(\"Invalid task status.\")\n\n    await self.storage.add(uuid=uuid, task_status=model)\n    reader, writer = await asyncio.open_connection(self.url, self.port)\n    payload = asdict(model)\n    payload.update({\"uuid\": uuid_str})\n    writer.write(json.dumps(payload).encode())\n    await writer.drain()\n    with contextlib.suppress(Exception):\n        writer.close()\n\n    await self._plugin_trigger(\n        \"broker_add_after\", broker=self, storage=self.storage, model=model\n    )\n    return Task(\n        status=TaskStatusEnum.NEW.value,\n        task_name=task_name,\n        uuid=uuid,\n        priority=priority,\n        args=args,\n        kwargs=kwargs,\n        created_at=datetime.fromtimestamp(created_at),\n        updated_at=datetime.fromtimestamp(created_at),\n    )\n</code></pre>"},{"location":"api/brokers/async_socket/#qtasks.brokers.async_socket.AsyncSocketBroker.flush_all","title":"<code>flush_all()</code>  <code>async</code>","text":"<p>Delete all data.</p> Source code in <code>src/qtasks/brokers/async_socket.py</code> <pre><code>async def flush_all(self) -&gt; None:\n    \"\"\"Delete all data.\"\"\"\n    await self._plugin_trigger(\"broker_flush_all\", broker=self)\n    await self.storage.flush_all()\n</code></pre>"},{"location":"api/brokers/async_socket/#qtasks.brokers.async_socket.AsyncSocketBroker.get","title":"<code>get(uuid)</code>  <code>async</code>","text":"<p>Obtaining information about a task.</p> <p>Parameters:</p> Name Type Description Default <code>uuid</code> <code>UUID | str</code> <p>UUID of the task.</p> required <p>Returns:</p> Type Description <code>Task | None</code> <p>Task|None: If there is task information, returns <code>schemas.task.Task</code>, otherwise <code>None</code>.</p> Source code in <code>src/qtasks/brokers/async_socket.py</code> <pre><code>async def get(\n    self,\n    uuid: Annotated[\n        UUID | str,\n        Doc(\"\"\"\n                UUID of the task.\n                \"\"\"),\n    ],\n) -&gt; Task | None:\n    \"\"\"\n    Obtaining information about a task.\n\n    Args:\n        uuid (UUID|str): UUID of the task.\n\n    Returns:\n        Task|None: If there is task information, returns `schemas.task.Task`, otherwise `None`.\n    \"\"\"\n    if isinstance(uuid, str):\n        uuid = UUID(uuid)\n    task = await self.storage.get(uuid=uuid)\n    new_task = await self._plugin_trigger(\n        \"broker_get\", broker=self, task=task, return_last=True\n    )\n    if new_task:\n        task = new_task.get(\"task\", task)\n    return task\n</code></pre>"},{"location":"api/brokers/async_socket/#qtasks.brokers.async_socket.AsyncSocketBroker.handle_connection","title":"<code>handle_connection(reader, writer)</code>  <code>async</code>","text":"<p>Handles an incoming connection.</p> <p>Parameters:</p> Name Type Description Default <code>reader</code> <code>StreamReader</code> <p>Reader for incoming data.</p> required <code>writer</code> <code>StreamWriter</code> <p>Writer for outgoing data.</p> required Source code in <code>src/qtasks/brokers/async_socket.py</code> <pre><code>async def handle_connection(\n    self, reader: asyncio.StreamReader, writer: asyncio.StreamWriter\n):\n    \"\"\"\n    Handles an incoming connection.\n\n    Args:\n        reader(asyncio.StreamReader): Reader for incoming data.\n        writer(asyncio.StreamWriter): Writer for outgoing data.\n    \"\"\"\n    try:\n        data = await reader.read(4096)\n        message = json.loads(data.decode())\n        task_name = message[\"task_name\"]\n        uuid = message[\"uuid\"]\n        priority = message[\"priority\"]\n        args = message.get(\"args\", ())\n        kwargs = message.get(\"kwargs\", {})\n        created_at = message[\"created_at\"]\n\n        await self.storage.add(\n            uuid=uuid,\n            task_status=TaskStatusNewSchema(\n                task_name=task_name,\n                priority=priority,\n                args=args,\n                kwargs=kwargs,\n                created_at=created_at,\n                updated_at=created_at,\n            ),\n        )\n\n        await self.queue.put((task_name, uuid, priority))\n        writer.write(b\"OK\")\n        await writer.drain()\n    finally:\n        writer.close()\n        with contextlib.suppress(Exception):\n            await writer.wait_closed()\n</code></pre>"},{"location":"api/brokers/async_socket/#qtasks.brokers.async_socket.AsyncSocketBroker.listen","title":"<code>listen(worker)</code>  <code>async</code>","text":"<p>Listens to the socket queue and transfers tasks to the worker.</p> <p>Parameters:</p> Name Type Description Default <code>worker</code> <code>BaseWorker</code> <p>Worker class.</p> required <p>Raises:</p> Type Description <code>KeyError</code> <p>Task not found.</p> Source code in <code>src/qtasks/brokers/async_socket.py</code> <pre><code>async def listen(\n    self,\n    worker: Annotated[\n        BaseWorker[Literal[True]],\n        Doc(\"\"\"\n                Worker class.\n                \"\"\"),\n    ],\n):\n    \"\"\"\n    Listens to the socket queue and transfers tasks to the worker.\n\n    Args:\n        worker (BaseWorker): Worker class.\n\n    Raises:\n        KeyError: Task not found.\n    \"\"\"\n    await self._plugin_trigger(\"broker_listen_start\", broker=self, worker=worker)\n    self.running = True\n\n    while self.running:\n        try:\n            item = await self.queue.get()\n        except asyncio.CancelledError:\n            break\n        if item is None:\n            break\n\n        task_name, uuid, priority = item\n        model_get = await self.get(uuid=uuid)\n        if not model_get:\n            raise KeyError(f\"Task not found: {uuid}\")\n\n        args, kwargs, created_at = (\n            model_get.args or (),\n            model_get.kwargs or {},\n            model_get.created_at.timestamp(),\n        )\n\n        await self.storage.add_process(f\"{task_name}:{uuid}:{priority}\", priority)\n\n        if self.log:\n            self.log.info(f\"Received new task: {uuid}\")\n        new_args = await self._plugin_trigger(\n            \"broker_add_worker\",\n            broker=self,\n            worker=worker,\n            task_name=task_name,\n            uuid=uuid,\n            priority=int(priority),\n            args=args,\n            kw=kwargs,\n            created_at=created_at,\n            return_last=True,\n        )\n        if new_args:\n            task_name = new_args.get(\"task_name\", task_name)\n            uuid = new_args.get(\"uuid\", uuid)\n            priority = new_args.get(\"priority\", priority)\n            args = new_args.get(\"args\", args)\n            kwargs = new_args.get(\"kw\", kwargs)\n            created_at = new_args.get(\"created_at\", created_at)\n\n        await worker.add(\n            name=task_name,\n            uuid=uuid,\n            priority=int(priority),\n            args=args,\n            kwargs=kwargs,\n            created_at=created_at,\n        )\n        return\n</code></pre>"},{"location":"api/brokers/async_socket/#qtasks.brokers.async_socket.AsyncSocketBroker.remove_finished_task","title":"<code>remove_finished_task(task_broker, model)</code>  <code>async</code>","text":"<p>Updates storage data via the <code>self.storage.remove_finished_task</code> function.</p> <p>Parameters:</p> Name Type Description Default <code>task_broker</code> <code>TaskPrioritySchema</code> <p>The priority task schema.</p> required <code>model</code> <code>TaskStatusSuccessSchema | TaskStatusErrorSchema</code> <p>Model of the task result.</p> required Source code in <code>src/qtasks/brokers/async_socket.py</code> <pre><code>async def remove_finished_task(\n    self,\n    task_broker: Annotated[\n        TaskPrioritySchema,\n        Doc(\"\"\"\n                Priority task diagram.\n                \"\"\"),\n    ],\n    model: Annotated[\n        TaskStatusSuccessSchema | TaskStatusErrorSchema,\n        Doc(\"\"\"\n                Model of the task result.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Updates storage data via the `self.storage.remove_finished_task` function.\n\n    Args:\n        task_broker (TaskPrioritySchema): The priority task schema.\n        model (TaskStatusSuccessSchema | TaskStatusErrorSchema): Model of the task result.\n    \"\"\"\n    new_model = await self._plugin_trigger(\n        \"broker_remove_finished_task\",\n        broker=self,\n        storage=self.storage,\n        model=model,\n        return_last=True,\n    )\n    if new_model:\n        model = new_model.get(\"model\", model)\n\n    await self.storage.remove_finished_task(task_broker, model)\n    return\n</code></pre>"},{"location":"api/brokers/async_socket/#qtasks.brokers.async_socket.AsyncSocketBroker.start","title":"<code>start(worker)</code>  <code>async</code>","text":"<p>Launches the broker.</p> <p>Parameters:</p> Name Type Description Default <code>worker</code> <code>BaseWorker</code> <p>Worker class.</p> required Source code in <code>src/qtasks/brokers/async_socket.py</code> <pre><code>async def start(\n    self,\n    worker: Annotated[\n        BaseWorker,\n        Doc(\"\"\"\n                Worker class.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Launches the broker.\n\n    Args:\n        worker (BaseWorker): Worker class.\n    \"\"\"\n    await self._plugin_trigger(\"broker_start\", broker=self, worker=worker)\n    await self.storage.start()\n\n    if self.config.delete_finished_tasks:\n        await self.storage._delete_finished_tasks()\n\n    if self.config.running_older_tasks:\n        await self.storage._running_older_tasks(worker)\n\n    self.client = await asyncio.start_server(\n        self.handle_connection, self.url, self.port\n    )\n\n    self._listen_task = asyncio.create_task(\n        self.listen(worker), name=\"broker-listen\"\n    )\n    self._serve_task = asyncio.create_task(\n        self.client.serve_forever(), name=\"broker-serve\"\n    )\n    with contextlib.suppress(asyncio.CancelledError):\n        await self._serve_task\n</code></pre>"},{"location":"api/brokers/async_socket/#qtasks.brokers.async_socket.AsyncSocketBroker.stop","title":"<code>stop()</code>  <code>async</code>","text":"<p>The broker stops.</p> Source code in <code>src/qtasks/brokers/async_socket.py</code> <pre><code>async def stop(self):\n    \"\"\"The broker stops.\"\"\"\n    await self._plugin_trigger(\"broker_stop\", broker=self)\n    self.running = False\n\n    if self._listen_task and not self._listen_task.done():\n        self.queue.put_nowait(None)\n\n    if self.client:\n        self.client.close()\n        with contextlib.suppress(Exception):\n            await self.client.wait_closed()\n\n    if self._serve_task and not self._serve_task.done():\n        self._serve_task.cancel()\n        with contextlib.suppress(asyncio.CancelledError):\n            await self._serve_task\n\n    if self._listen_task and not self._listen_task.done():\n        with contextlib.suppress(asyncio.CancelledError):\n            await self._listen_task\n</code></pre>"},{"location":"api/brokers/async_socket/#qtasks.brokers.async_socket.AsyncSocketBroker.update","title":"<code>update(**kwargs)</code>  <code>async</code>","text":"<p>Updates task information.</p> <p>Parameters:</p> Name Type Description Default <code>kwargs</code> <code>dict</code> <p>task data of type kwargs.</p> <code>{}</code> Source code in <code>src/qtasks/brokers/async_socket.py</code> <pre><code>async def update(\n    self,\n    **kwargs: Annotated[\n        Any,\n        Doc(\"\"\"\n                Update arguments for storage type kwargs.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Updates task information.\n\n    Args:\n        kwargs (dict, optional): task data of type kwargs.\n    \"\"\"\n    new_kw = await self._plugin_trigger(\n        \"broker_update\", broker=self, kw=kwargs, return_last=True\n    )\n    if new_kw:\n        kwargs = new_kw.get(\"kw\", kwargs)\n    return await self.storage.update(**kwargs)\n</code></pre>"},{"location":"api/brokers/basebroker/","title":"BaseBroker - \u043f\u0438\u0448\u0435\u043c \u0441\u0432\u043e\u0439 \u0411\u0440\u043e\u043a\u0435\u0440","text":"<p>Base Broker.</p>"},{"location":"api/brokers/basebroker/#qtasks.brokers.base.BaseBroker","title":"<code>BaseBroker</code>","text":"<p>               Bases: <code>Generic[TAsyncFlag]</code>, <code>ABC</code></p> <p><code>BaseBroker</code> - An abstract class that is the foundation for Brokers.</p>"},{"location":"api/brokers/basebroker/#qtasks.brokers.base.BaseBroker--example","title":"Example","text":"<pre><code>from qtasks import QueueTasks\nfrom qtasks.brokers.base import BaseBroker\n\nclass MyBroker(BaseBroker):\n    def __init__(self, name: str = None, storage: BaseStorage = None):\n        super().__init__(name=name, storage=storage)\n        pass\n</code></pre> Source code in <code>src/qtasks/brokers/base.py</code> <pre><code>class BaseBroker(Generic[TAsyncFlag], ABC):\n    \"\"\"\n    `BaseBroker` - An abstract class that is the foundation for Brokers.\n\n    ## Example\n\n    ```python\n    from qtasks import QueueTasks\n    from qtasks.brokers.base import BaseBroker\n\n    class MyBroker(BaseBroker):\n        def __init__(self, name: str = None, storage: BaseStorage = None):\n            super().__init__(name=name, storage=storage)\n            pass\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        storage: Annotated[\n            BaseStorage[TAsyncFlag],\n            Doc(\"\"\"\n                    Storage `qtasks.storages.base.BaseStorage`.\n\n                    Default: `None`.\n                    \"\"\"),\n        ],\n        name: Annotated[\n            str | None,\n            Doc(\"\"\"\n                    Project name. This name can be used for tags for Brokers.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        log: Annotated[\n            Logger | None,\n            Doc(\"\"\"\n                    Logger.\n\n                    Default: `qtasks.logs.Logger`.\n                    \"\"\"),\n        ] = None,\n        config: Annotated[\n            QueueConfig | None,\n            Doc(\"\"\"\n                    Config.\n\n                    Default: `qtasks.configs.config.QueueConfig`.\n                    \"\"\"),\n        ] = None,\n        events: Annotated[\n            Optional[BaseEvents],\n            Doc(\"\"\"\n                    Events.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        BaseBroker initialization.\n\n        Args:\n            name (str, optional): Project name. Default: `None`.\n            storage (BaseStorage, optional): Storage. Default: `None`.\n            log (Logger, optional): Logger. Default: `None`.\n            config (QueueConfig, optional): Config. Default: `None`.\n            events (BaseEvents, optional): Events. Default: `None`.\n        \"\"\"\n        self.name = name\n        self.config = config or QueueConfig()\n        self.log = (\n            log.with_subname(\"Broker\")\n            if log\n            else Logger(\n                name=self.name or \"QueueTasks\",\n                subname=\"Broker\",\n                default_level=self.config.logs_default_level_server,\n                format=self.config.logs_format,\n            )\n        )\n        self.events = events\n\n        self.storage = storage\n\n        self.plugins: dict[str, list[BasePlugin]] = {}\n\n        self.init_plugins()\n\n    @overload\n    def add(\n        self: BaseBroker[Literal[False]],\n        task_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int,\n            Doc(\"\"\"\n                    Task priority.\n\n                    Default: `0`.\n                    \"\"\"),\n        ] = 0,\n        extra: Annotated[\n            dict | None,\n            Doc(\"\"\"\n                    Additional task parameters.\n                    \"\"\"),\n        ] = None,\n        args: Annotated[\n            tuple | None,\n            Doc(\"\"\"\n                    Task arguments of type args.\n                    \"\"\"),\n        ] = None,\n        kwargs: Annotated[\n            dict | None,\n            Doc(\"\"\"\n                    Task arguments of type kwargs.\n                    \"\"\"),\n        ] = None,\n    ) -&gt; Task: ...\n\n    @overload\n    async def add(\n        self: BaseBroker[Literal[True]],\n        task_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int,\n            Doc(\"\"\"\n                    Task priority.\n\n                    Default: `0`.\n                    \"\"\"),\n        ] = 0,\n        extra: Annotated[\n            dict | None,\n            Doc(\"\"\"\n                    Additional task parameters.\n                    \"\"\"),\n        ] = None,\n        args: Annotated[\n            tuple | None,\n            Doc(\"\"\"\n                    Task arguments of type args.\n                    \"\"\"),\n        ] = None,\n        kwargs: Annotated[\n            dict | None,\n            Doc(\"\"\"\n                    Task arguments of type kwargs.\n                    \"\"\"),\n        ] = None,\n    ) -&gt; Task: ...\n\n    @abstractmethod\n    def add(\n        self,\n        task_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int,\n            Doc(\"\"\"\n                    Task priority.\n\n                    Default: `0`.\n                    \"\"\"),\n        ] = 0,\n        extra: Annotated[\n            dict | None,\n            Doc(\"\"\"\n                    Additional task parameters.\n                    \"\"\"),\n        ] = None,\n        args: Annotated[\n            tuple | None,\n            Doc(\"\"\"\n                    Task arguments of type args.\n                    \"\"\"),\n        ] = None,\n        kwargs: Annotated[\n            dict | None,\n            Doc(\"\"\"\n                    Task arguments of type kwargs.\n                    \"\"\"),\n        ] = None,\n    ) -&gt; Task | Awaitable[Task]:\n        \"\"\"\n        Adding a task to the broker.\n\n        Args:\n            task_name (str): The name of the task.\n            priority (int, optional): Task priority. Default: `0`.\n            extra (dict, optional): Additional task parameters. Default: `None`.\n            args (tuple, optional): Task arguments of type args. Default: `None`.\n            kwargs (dict, optional): Task arguments of type kwargs. Default: `None`.\n\n        Returns:\n            Task: `schemas.task.Task`\n        \"\"\"\n        pass\n\n    @overload\n    def get(\n        self: BaseBroker[Literal[False]],\n        uuid: Annotated[\n            UUID | str,\n            Doc(\"\"\"\n                    UUID of the task.\n                    \"\"\"),\n        ],\n    ) -&gt; Task | None: ...\n\n    @overload\n    async def get(\n        self: BaseBroker[Literal[True]],\n        uuid: Annotated[\n            UUID | str,\n            Doc(\"\"\"\n                    UUID of the task.\n                    \"\"\"),\n        ],\n    ) -&gt; Task | None: ...\n\n    @abstractmethod\n    def get(\n        self,\n        uuid: Annotated[\n            UUID | str,\n            Doc(\"\"\"\n                    UUID of the task.\n                    \"\"\"),\n        ],\n    ) -&gt; Task | None | Awaitable[Task | None]:\n        \"\"\"\n        Obtaining information about a task.\n\n        Args:\n            uuid (UUID|str): UUID of the task.\n\n        Returns:\n            Task|None: If there is task information, returns `schemas.task.Task`, otherwise `None`.\n        \"\"\"\n        pass\n\n    @overload\n    def update(\n        self: BaseBroker[Literal[False]],\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    Update arguments for storage type kwargs.\n                    \"\"\"),\n        ],\n    ) -&gt; None: ...\n\n    @overload\n    async def update(\n        self: BaseBroker[Literal[True]],\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    Update arguments for storage type kwargs.\n                    \"\"\"),\n        ],\n    ) -&gt; None: ...\n\n    @abstractmethod\n    def update(\n        self,\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    Update arguments for storage type kwargs.\n                    \"\"\"),\n        ],\n    ) -&gt; None | Awaitable[None]:\n        \"\"\"\n        Updates task information.\n\n        Args:\n            kwargs (dict, optional): task data of type kwargs.\n        \"\"\"\n        pass\n\n    @overload\n    def start(\n        self: BaseBroker[Literal[False]],\n        worker: Annotated[\n            Optional[BaseWorker],\n            Doc(\"\"\"\n                    Worker class.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n    ) -&gt; None: ...\n\n    @overload\n    async def start(\n        self: BaseBroker[Literal[True]],\n        worker: Annotated[\n            Optional[BaseWorker],\n            Doc(\"\"\"\n                    Worker class.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n    ) -&gt; None: ...\n\n    @abstractmethod\n    def start(\n        self,\n        worker: Annotated[\n            Optional[BaseWorker],\n            Doc(\"\"\"\n                    Worker class.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n    ) -&gt; None | Awaitable[None]:\n        \"\"\"\n        Launching the Broker. This function is enabled by the main `QueueTasks` instance via `run_forever`.\n\n        Args:\n            worker (BaseWorker, optional): Worker class. Default: `None`.\n        \"\"\"\n        pass\n\n    @overload\n    def stop(\n        self: BaseBroker[Literal[False]],\n    ) -&gt; None: ...\n\n    @overload\n    async def stop(\n        self: BaseBroker[Literal[True]],\n    ) -&gt; None: ...\n\n    @abstractmethod\n    def stop(self) -&gt; None | Awaitable[None]:\n        \"\"\"The broker stops. This function is invoked by the main `QueueTasks` instance after the `run_forever` function completes.\"\"\"\n        pass\n\n    def update_config(\n        self,\n        config: Annotated[\n            QueueConfig,\n            Doc(\"\"\"\n                    Config.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Updates the broker config.\n\n        Args:\n            config (QueueConfig): Config.\n        \"\"\"\n        self.config = config\n        return\n\n    def add_plugin(\n        self,\n        plugin: Annotated[\n            BasePlugin,\n            Doc(\"\"\"\n                    Plugin.\n                    \"\"\"),\n        ],\n        trigger_names: Annotated[\n            list[str] | None,\n            Doc(\"\"\"\n                    The name of the triggers for the plugin.\n\n                    Default: Default: will be added to `Globals`.\n                    \"\"\"),\n        ] = None,\n    ) -&gt; None:\n        \"\"\"\n        Add a plugin to the class.\n\n        Args:\n            plugin (BasePlugin): Plugin\n            trigger_names (List[str], optional): The name of the triggers for the plugin. Default: will be added to `Globals`.\n        \"\"\"\n        trigger_names = trigger_names or [\"Globals\"]\n\n        for name in trigger_names:\n            if name not in self.plugins:\n                self.plugins.update({name: [plugin]})\n            else:\n                self.plugins[name].append(plugin)\n        return\n\n    @overload\n    def flush_all(self: BaseBroker[Literal[False]]) -&gt; None: ...\n\n    @overload\n    async def flush_all(self: BaseBroker[Literal[True]]) -&gt; None: ...\n\n    def flush_all(self) -&gt; None | Awaitable[None]:\n        \"\"\"Delete all data.\"\"\"\n        pass\n\n    def init_plugins(self):\n        \"\"\"Initializing plugins.\"\"\"\n        pass\n\n    @overload\n    def remove_finished_task(\n        self: BaseBroker[Literal[False]],\n        task_broker: Annotated[\n            TaskPrioritySchema,\n            Doc(\"\"\"\n                    Priority task diagram.\n                    \"\"\"),\n        ],\n        model: Annotated[\n            TaskStatusSuccessSchema | TaskStatusProcessSchema | TaskStatusErrorSchema | TaskStatusCancelSchema,\n            Doc(\"\"\"\n                    Model of the task result.\n                    \"\"\"),\n        ],\n    ) -&gt; None: ...\n\n    @overload\n    async def remove_finished_task(\n        self: BaseBroker[Literal[True]],\n        task_broker: Annotated[\n            TaskPrioritySchema,\n            Doc(\"\"\"\n                    Priority task diagram.\n                    \"\"\"),\n        ],\n        model: Annotated[\n            TaskStatusSuccessSchema | TaskStatusProcessSchema | TaskStatusErrorSchema | TaskStatusCancelSchema,\n            Doc(\"\"\"\n                    Model of the task result.\n                    \"\"\"),\n        ],\n    ) -&gt; None: ...\n\n    def remove_finished_task(\n        self,\n        task_broker: Annotated[\n            TaskPrioritySchema,\n            Doc(\"\"\"\n                    Priority task diagram.\n                    \"\"\"),\n        ],\n        model: Annotated[\n            TaskStatusSuccessSchema | TaskStatusProcessSchema | TaskStatusErrorSchema | TaskStatusCancelSchema,\n            Doc(\"\"\"\n                    Model of the task result.\n                    \"\"\"),\n        ],\n    ) -&gt; None | Awaitable[None]:\n        \"\"\"\n        Updates storage data via the `self.storage.remove_finished_task` function.\n\n        Args:\n            task_broker (TaskPrioritySchema): The priority task schema.\n            model (TaskStatusSuccessSchema | TaskStatusProcessSchema | TaskStatusErrorSchema | TaskStatusCancelSchema): Model of the task result.\n        \"\"\"\n        pass\n\n    def _dynamic_model(\n        self,\n        model: Annotated[\n            TaskStatusNewSchema,\n            Doc(\"\"\"\n                    Task model.\n                    \"\"\"),\n        ],\n        extra: Annotated[\n            dict,\n            Doc(\"\"\"\n                    Additional fields.\n                    \"\"\"),\n        ],\n    ):\n        # Get the names of standard fields\n        task_field_names = {f.name for f in fields(TaskStatusNewSchema)}\n\n        # We are looking for additional keys\n        extra_fields = []\n        extra_values = {}\n\n        for key, value in extra.items():\n            if key not in task_field_names:\n                # Typing is primitive - can be improved\n                field_type = type(value)\n                extra_fields.append((key, field_type, field(default=None)))\n                extra_values[key] = value\n\n        # Create a new dataclass with additional fields\n        if extra_fields:\n            NewTask = make_dataclass(\n                \"TaskStatusNewSchema\", extra_fields, bases=(TaskStatusNewSchema,)\n            )\n        else:\n            NewTask = TaskStatusNewSchema\n\n        # Let's combine all the arguments\n        return NewTask(**asdict(model), **extra_values)\n</code></pre>"},{"location":"api/brokers/basebroker/#qtasks.brokers.base.BaseBroker.__init__","title":"<code>__init__(storage, name=None, log=None, config=None, events=None)</code>","text":"<p>BaseBroker initialization.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Project name. Default: <code>None</code>.</p> <code>None</code> <code>storage</code> <code>BaseStorage</code> <p>Storage. Default: <code>None</code>.</p> required <code>log</code> <code>Logger</code> <p>Logger. Default: <code>None</code>.</p> <code>None</code> <code>config</code> <code>QueueConfig</code> <p>Config. Default: <code>None</code>.</p> <code>None</code> <code>events</code> <code>BaseEvents</code> <p>Events. Default: <code>None</code>.</p> <code>None</code> Source code in <code>src/qtasks/brokers/base.py</code> <pre><code>def __init__(\n    self,\n    storage: Annotated[\n        BaseStorage[TAsyncFlag],\n        Doc(\"\"\"\n                Storage `qtasks.storages.base.BaseStorage`.\n\n                Default: `None`.\n                \"\"\"),\n    ],\n    name: Annotated[\n        str | None,\n        Doc(\"\"\"\n                Project name. This name can be used for tags for Brokers.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    log: Annotated[\n        Logger | None,\n        Doc(\"\"\"\n                Logger.\n\n                Default: `qtasks.logs.Logger`.\n                \"\"\"),\n    ] = None,\n    config: Annotated[\n        QueueConfig | None,\n        Doc(\"\"\"\n                Config.\n\n                Default: `qtasks.configs.config.QueueConfig`.\n                \"\"\"),\n    ] = None,\n    events: Annotated[\n        Optional[BaseEvents],\n        Doc(\"\"\"\n                Events.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    BaseBroker initialization.\n\n    Args:\n        name (str, optional): Project name. Default: `None`.\n        storage (BaseStorage, optional): Storage. Default: `None`.\n        log (Logger, optional): Logger. Default: `None`.\n        config (QueueConfig, optional): Config. Default: `None`.\n        events (BaseEvents, optional): Events. Default: `None`.\n    \"\"\"\n    self.name = name\n    self.config = config or QueueConfig()\n    self.log = (\n        log.with_subname(\"Broker\")\n        if log\n        else Logger(\n            name=self.name or \"QueueTasks\",\n            subname=\"Broker\",\n            default_level=self.config.logs_default_level_server,\n            format=self.config.logs_format,\n        )\n    )\n    self.events = events\n\n    self.storage = storage\n\n    self.plugins: dict[str, list[BasePlugin]] = {}\n\n    self.init_plugins()\n</code></pre>"},{"location":"api/brokers/basebroker/#qtasks.brokers.base.BaseBroker.add","title":"<code>add(task_name, priority=0, extra=None, args=None, kwargs=None)</code>  <code>abstractmethod</code>","text":"<pre><code>add(task_name: Annotated[str, Doc('\\n                    Task name.\\n                    ')], priority: Annotated[int, Doc('\\n                    Task priority.\\n\\n                    Default: `0`.\\n                    ')] = 0, extra: Annotated[dict | None, Doc('\\n                    Additional task parameters.\\n                    ')] = None, args: Annotated[tuple | None, Doc('\\n                    Task arguments of type args.\\n                    ')] = None, kwargs: Annotated[dict | None, Doc('\\n                    Task arguments of type kwargs.\\n                    ')] = None) -&gt; Task\n</code></pre><pre><code>add(task_name: Annotated[str, Doc('\\n                    Task name.\\n                    ')], priority: Annotated[int, Doc('\\n                    Task priority.\\n\\n                    Default: `0`.\\n                    ')] = 0, extra: Annotated[dict | None, Doc('\\n                    Additional task parameters.\\n                    ')] = None, args: Annotated[tuple | None, Doc('\\n                    Task arguments of type args.\\n                    ')] = None, kwargs: Annotated[dict | None, Doc('\\n                    Task arguments of type kwargs.\\n                    ')] = None) -&gt; Task\n</code></pre> <p>Adding a task to the broker.</p> <p>Parameters:</p> Name Type Description Default <code>task_name</code> <code>str</code> <p>The name of the task.</p> required <code>priority</code> <code>int</code> <p>Task priority. Default: <code>0</code>.</p> <code>0</code> <code>extra</code> <code>dict</code> <p>Additional task parameters. Default: <code>None</code>.</p> <code>None</code> <code>args</code> <code>tuple</code> <p>Task arguments of type args. Default: <code>None</code>.</p> <code>None</code> <code>kwargs</code> <code>dict</code> <p>Task arguments of type kwargs. Default: <code>None</code>.</p> <code>None</code> <p>Returns:</p> Name Type Description <code>Task</code> <code>Task | Awaitable[Task]</code> <p><code>schemas.task.Task</code></p> Source code in <code>src/qtasks/brokers/base.py</code> <pre><code>@abstractmethod\ndef add(\n    self,\n    task_name: Annotated[\n        str,\n        Doc(\"\"\"\n                Task name.\n                \"\"\"),\n    ],\n    priority: Annotated[\n        int,\n        Doc(\"\"\"\n                Task priority.\n\n                Default: `0`.\n                \"\"\"),\n    ] = 0,\n    extra: Annotated[\n        dict | None,\n        Doc(\"\"\"\n                Additional task parameters.\n                \"\"\"),\n    ] = None,\n    args: Annotated[\n        tuple | None,\n        Doc(\"\"\"\n                Task arguments of type args.\n                \"\"\"),\n    ] = None,\n    kwargs: Annotated[\n        dict | None,\n        Doc(\"\"\"\n                Task arguments of type kwargs.\n                \"\"\"),\n    ] = None,\n) -&gt; Task | Awaitable[Task]:\n    \"\"\"\n    Adding a task to the broker.\n\n    Args:\n        task_name (str): The name of the task.\n        priority (int, optional): Task priority. Default: `0`.\n        extra (dict, optional): Additional task parameters. Default: `None`.\n        args (tuple, optional): Task arguments of type args. Default: `None`.\n        kwargs (dict, optional): Task arguments of type kwargs. Default: `None`.\n\n    Returns:\n        Task: `schemas.task.Task`\n    \"\"\"\n    pass\n</code></pre>"},{"location":"api/brokers/basebroker/#qtasks.brokers.base.BaseBroker.add_plugin","title":"<code>add_plugin(plugin, trigger_names=None)</code>","text":"<p>Add a plugin to the class.</p> <p>Parameters:</p> Name Type Description Default <code>plugin</code> <code>BasePlugin</code> <p>Plugin</p> required <code>trigger_names</code> <code>List[str]</code> <p>The name of the triggers for the plugin. Default: will be added to <code>Globals</code>.</p> <code>None</code> Source code in <code>src/qtasks/brokers/base.py</code> <pre><code>def add_plugin(\n    self,\n    plugin: Annotated[\n        BasePlugin,\n        Doc(\"\"\"\n                Plugin.\n                \"\"\"),\n    ],\n    trigger_names: Annotated[\n        list[str] | None,\n        Doc(\"\"\"\n                The name of the triggers for the plugin.\n\n                Default: Default: will be added to `Globals`.\n                \"\"\"),\n    ] = None,\n) -&gt; None:\n    \"\"\"\n    Add a plugin to the class.\n\n    Args:\n        plugin (BasePlugin): Plugin\n        trigger_names (List[str], optional): The name of the triggers for the plugin. Default: will be added to `Globals`.\n    \"\"\"\n    trigger_names = trigger_names or [\"Globals\"]\n\n    for name in trigger_names:\n        if name not in self.plugins:\n            self.plugins.update({name: [plugin]})\n        else:\n            self.plugins[name].append(plugin)\n    return\n</code></pre>"},{"location":"api/brokers/basebroker/#qtasks.brokers.base.BaseBroker.flush_all","title":"<code>flush_all()</code>","text":"<pre><code>flush_all() -&gt; None\n</code></pre><pre><code>flush_all() -&gt; None\n</code></pre> <p>Delete all data.</p> Source code in <code>src/qtasks/brokers/base.py</code> <pre><code>def flush_all(self) -&gt; None | Awaitable[None]:\n    \"\"\"Delete all data.\"\"\"\n    pass\n</code></pre>"},{"location":"api/brokers/basebroker/#qtasks.brokers.base.BaseBroker.get","title":"<code>get(uuid)</code>  <code>abstractmethod</code>","text":"<pre><code>get(uuid: Annotated[UUID | str, Doc('\\n                    UUID of the task.\\n                    ')]) -&gt; Task | None\n</code></pre><pre><code>get(uuid: Annotated[UUID | str, Doc('\\n                    UUID of the task.\\n                    ')]) -&gt; Task | None\n</code></pre> <p>Obtaining information about a task.</p> <p>Parameters:</p> Name Type Description Default <code>uuid</code> <code>UUID | str</code> <p>UUID of the task.</p> required <p>Returns:</p> Type Description <code>Task | None | Awaitable[Task | None]</code> <p>Task|None: If there is task information, returns <code>schemas.task.Task</code>, otherwise <code>None</code>.</p> Source code in <code>src/qtasks/brokers/base.py</code> <pre><code>@abstractmethod\ndef get(\n    self,\n    uuid: Annotated[\n        UUID | str,\n        Doc(\"\"\"\n                UUID of the task.\n                \"\"\"),\n    ],\n) -&gt; Task | None | Awaitable[Task | None]:\n    \"\"\"\n    Obtaining information about a task.\n\n    Args:\n        uuid (UUID|str): UUID of the task.\n\n    Returns:\n        Task|None: If there is task information, returns `schemas.task.Task`, otherwise `None`.\n    \"\"\"\n    pass\n</code></pre>"},{"location":"api/brokers/basebroker/#qtasks.brokers.base.BaseBroker.init_plugins","title":"<code>init_plugins()</code>","text":"<p>Initializing plugins.</p> Source code in <code>src/qtasks/brokers/base.py</code> <pre><code>def init_plugins(self):\n    \"\"\"Initializing plugins.\"\"\"\n    pass\n</code></pre>"},{"location":"api/brokers/basebroker/#qtasks.brokers.base.BaseBroker.remove_finished_task","title":"<code>remove_finished_task(task_broker, model)</code>","text":"<pre><code>remove_finished_task(task_broker: Annotated[TaskPrioritySchema, Doc('\\n                    Priority task diagram.\\n                    ')], model: Annotated[TaskStatusSuccessSchema | TaskStatusProcessSchema | TaskStatusErrorSchema | TaskStatusCancelSchema, Doc('\\n                    Model of the task result.\\n                    ')]) -&gt; None\n</code></pre><pre><code>remove_finished_task(task_broker: Annotated[TaskPrioritySchema, Doc('\\n                    Priority task diagram.\\n                    ')], model: Annotated[TaskStatusSuccessSchema | TaskStatusProcessSchema | TaskStatusErrorSchema | TaskStatusCancelSchema, Doc('\\n                    Model of the task result.\\n                    ')]) -&gt; None\n</code></pre> <p>Updates storage data via the <code>self.storage.remove_finished_task</code> function.</p> <p>Parameters:</p> Name Type Description Default <code>task_broker</code> <code>TaskPrioritySchema</code> <p>The priority task schema.</p> required <code>model</code> <code>TaskStatusSuccessSchema | TaskStatusProcessSchema | TaskStatusErrorSchema | TaskStatusCancelSchema</code> <p>Model of the task result.</p> required Source code in <code>src/qtasks/brokers/base.py</code> <pre><code>def remove_finished_task(\n    self,\n    task_broker: Annotated[\n        TaskPrioritySchema,\n        Doc(\"\"\"\n                Priority task diagram.\n                \"\"\"),\n    ],\n    model: Annotated[\n        TaskStatusSuccessSchema | TaskStatusProcessSchema | TaskStatusErrorSchema | TaskStatusCancelSchema,\n        Doc(\"\"\"\n                Model of the task result.\n                \"\"\"),\n    ],\n) -&gt; None | Awaitable[None]:\n    \"\"\"\n    Updates storage data via the `self.storage.remove_finished_task` function.\n\n    Args:\n        task_broker (TaskPrioritySchema): The priority task schema.\n        model (TaskStatusSuccessSchema | TaskStatusProcessSchema | TaskStatusErrorSchema | TaskStatusCancelSchema): Model of the task result.\n    \"\"\"\n    pass\n</code></pre>"},{"location":"api/brokers/basebroker/#qtasks.brokers.base.BaseBroker.start","title":"<code>start(worker=None)</code>  <code>abstractmethod</code>","text":"<pre><code>start(worker: Annotated[Optional[BaseWorker], Doc('\\n                    Worker class.\\n\\n                    Default: `None`.\\n                    ')] = None) -&gt; None\n</code></pre><pre><code>start(worker: Annotated[Optional[BaseWorker], Doc('\\n                    Worker class.\\n\\n                    Default: `None`.\\n                    ')] = None) -&gt; None\n</code></pre> <p>Launching the Broker. This function is enabled by the main <code>QueueTasks</code> instance via <code>run_forever</code>.</p> <p>Parameters:</p> Name Type Description Default <code>worker</code> <code>BaseWorker</code> <p>Worker class. Default: <code>None</code>.</p> <code>None</code> Source code in <code>src/qtasks/brokers/base.py</code> <pre><code>@abstractmethod\ndef start(\n    self,\n    worker: Annotated[\n        Optional[BaseWorker],\n        Doc(\"\"\"\n                Worker class.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n) -&gt; None | Awaitable[None]:\n    \"\"\"\n    Launching the Broker. This function is enabled by the main `QueueTasks` instance via `run_forever`.\n\n    Args:\n        worker (BaseWorker, optional): Worker class. Default: `None`.\n    \"\"\"\n    pass\n</code></pre>"},{"location":"api/brokers/basebroker/#qtasks.brokers.base.BaseBroker.stop","title":"<code>stop()</code>  <code>abstractmethod</code>","text":"<pre><code>stop() -&gt; None\n</code></pre><pre><code>stop() -&gt; None\n</code></pre> <p>The broker stops. This function is invoked by the main <code>QueueTasks</code> instance after the <code>run_forever</code> function completes.</p> Source code in <code>src/qtasks/brokers/base.py</code> <pre><code>@abstractmethod\ndef stop(self) -&gt; None | Awaitable[None]:\n    \"\"\"The broker stops. This function is invoked by the main `QueueTasks` instance after the `run_forever` function completes.\"\"\"\n    pass\n</code></pre>"},{"location":"api/brokers/basebroker/#qtasks.brokers.base.BaseBroker.update","title":"<code>update(**kwargs)</code>  <code>abstractmethod</code>","text":"<pre><code>update(**kwargs: Annotated[Any, Doc('\\n                    Update arguments for storage type kwargs.\\n                    ')]) -&gt; None\n</code></pre><pre><code>update(**kwargs: Annotated[Any, Doc('\\n                    Update arguments for storage type kwargs.\\n                    ')]) -&gt; None\n</code></pre> <p>Updates task information.</p> <p>Parameters:</p> Name Type Description Default <code>kwargs</code> <code>dict</code> <p>task data of type kwargs.</p> <code>{}</code> Source code in <code>src/qtasks/brokers/base.py</code> <pre><code>@abstractmethod\ndef update(\n    self,\n    **kwargs: Annotated[\n        Any,\n        Doc(\"\"\"\n                Update arguments for storage type kwargs.\n                \"\"\"),\n    ],\n) -&gt; None | Awaitable[None]:\n    \"\"\"\n    Updates task information.\n\n    Args:\n        kwargs (dict, optional): task data of type kwargs.\n    \"\"\"\n    pass\n</code></pre>"},{"location":"api/brokers/basebroker/#qtasks.brokers.base.BaseBroker.update_config","title":"<code>update_config(config)</code>","text":"<p>Updates the broker config.</p> <p>Parameters:</p> Name Type Description Default <code>config</code> <code>QueueConfig</code> <p>Config.</p> required Source code in <code>src/qtasks/brokers/base.py</code> <pre><code>def update_config(\n    self,\n    config: Annotated[\n        QueueConfig,\n        Doc(\"\"\"\n                Config.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Updates the broker config.\n\n    Args:\n        config (QueueConfig): Config.\n    \"\"\"\n    self.config = config\n    return\n</code></pre>"},{"location":"api/brokers/sync_kafkabroker/","title":"SyncKafkaBroker","text":"<p>Sync Kafka Broker.</p>"},{"location":"api/brokers/sync_kafkabroker/#qtasks.brokers.sync_kafka.SyncKafkaBroker","title":"<code>SyncKafkaBroker</code>","text":"<p>               Bases: <code>BaseBroker</code>, <code>SyncPluginMixin</code></p> <p>A broker that listens to Kafka and adds tasks to the queue.</p>"},{"location":"api/brokers/sync_kafkabroker/#qtasks.brokers.sync_kafka.SyncKafkaBroker--example","title":"Example","text":"<pre><code>from qtasks import QueueTasks\nfrom qtasks.brokers import SyncKafkaBroker\n\nbroker = SyncKafkaBroker(name=\"QueueTasks\", url=\"localhost:9092\")\n\napp = QueueTasks(broker=broker)\n</code></pre> Source code in <code>src/qtasks/brokers/sync_kafka.py</code> <pre><code>class SyncKafkaBroker(BaseBroker, SyncPluginMixin):\n    \"\"\"\n    A broker that listens to Kafka and adds tasks to the queue.\n\n    ## Example\n\n    ```python\n    from qtasks import QueueTasks\n    from qtasks.brokers import SyncKafkaBroker\n\n    broker = SyncKafkaBroker(name=\"QueueTasks\", url=\"localhost:9092\")\n\n    app = QueueTasks(broker=broker)\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Project name. This name is also used by the broker.\n\n                    Default: `QueueTasks`.\n                    \"\"\"),\n        ] = \"QueueTasks\",\n        url: Annotated[\n            str,\n            Doc(\"\"\"\n                    URL to connect to Kafka.\n\n                    Default: `localhost:9092`.\n                    \"\"\"),\n        ] = \"localhost:9092\",\n        storage: Annotated[\n            Optional[BaseStorage],\n            Doc(\"\"\"\n                    Storage.\n\n                    Default: `SyncRedisStorage`.\n                    \"\"\"),\n        ] = None,\n        topic: Annotated[\n            str,\n            Doc(\"\"\"\n                    Kafka topic.\n\n                    Default: `task_queue`.\n                    \"\"\"),\n        ] = \"task_queue\",\n        log: Annotated[\n            Logger | None,\n            Doc(\"\"\"\n                    Logger.\n\n                    Default: `qtasks.logs.Logger`.\n                    \"\"\"),\n        ] = None,\n        config: Annotated[\n            QueueConfig | None,\n            Doc(\"\"\"\n                    Config.\n\n                    Default: `qtasks.configs.config.QueueConfig`.\n                    \"\"\"),\n        ] = None,\n        events: Annotated[\n            Optional[BaseEvents],\n            Doc(\"\"\"\n                    Events.\n\n                    Default: `qtasks.events.SyncEvents`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Initializing SyncKafkaBroker.\n\n        Args:\n            name (str, optional): Project name. Default: `QueueTasks`.\n            url (str, optional): URL to connect to Kafka. Default: `None`.\n            storage (BaseStorage, optional): Storage. Default: `None`.\n            topic (str, optional): Kafka topic. Default: `task_queue`.\n            log (Logger, optional): Logger. Default: `None`.\n            config (QueueConfig, optional): Config. Default: `None`.\n            events (BaseEvents, optional): Events. Default: `qtasks.events.SyncEvents`.\n        \"\"\"\n        self.url = url\n        storage = storage or SyncRedisStorage(\n            name=name, log=log, config=config, events=events\n        )\n        super().__init__(\n            name=name, log=log, config=config, events=events, storage=storage\n        )\n\n        self.storage: BaseStorage[Literal[False]]\n\n        self.events = self.events or SyncEvents()\n        self.topic = f\"{self.name}_{topic}\"\n\n        self.consumer = KafkaConsumer(\n            self.topic,\n            bootstrap_servers=self.url,\n            group_id=f\"{self.name}_group\",\n            auto_offset_reset=\"earliest\",\n            enable_auto_commit=True,\n            value_deserializer=lambda m: m.decode(\"utf-8\"),\n        )\n        self.producer = KafkaProducer(\n            bootstrap_servers=self.url,\n            auto_offset_reset=\"earliest\",\n            enable_auto_commit=True,\n            value_deserializer=lambda m: m.decode(\"utf-8\"),\n        )\n\n        self.running = False\n\n    def listen(\n        self,\n        worker: Annotated[\n            BaseWorker[Literal[False]],\n            Doc(\"\"\"\n                    Worker class.\n                    \"\"\"),\n        ],\n    ):\n        \"\"\"\n        Listens to Kafka and transfers tasks to the worker.\n\n        Args:\n            worker (BaseWorker): Worker class.\n        \"\"\"\n        self._plugin_trigger(\"broker_listen_start\", broker=self, worker=worker)\n        self.running = True\n        for msg in self.consumer:\n            if not self.running:\n                break\n            task_data = msg.value\n            task_name, uuid_str, priority = task_data.split(\":\")\n            uuid = UUID(uuid_str)\n            model_get = self.get(uuid=uuid)\n            if model_get is None:\n                if self.log:\n                    self.log.warning(f\"Task {uuid} not found in repository.\")\n                continue\n            args, kwargs, created_at = (\n                model_get.args or (),\n                model_get.kwargs or {},\n                model_get.created_at.timestamp(),\n            )\n            if self.log:\n                self.log.info(f\"Received new task: {uuid}\")\n            new_args = self._plugin_trigger(\n                \"broker_add_worker\",\n                broker=self,\n                worker=worker,\n                task_name=task_name,\n                uuid=uuid,\n                priority=int(priority),\n                args=args,\n                kw=kwargs,\n                created_at=created_at,\n                return_last=True,\n            )\n            if new_args:\n                task_name = new_args.get(\"task_name\", task_name)\n                uuid = new_args.get(\"uuid\", uuid)\n                priority = new_args.get(\"priority\", priority)\n                args = new_args.get(\"args\", args)\n                kwargs = new_args.get(\"kw\", kwargs)\n                created_at = new_args.get(\"created_at\", created_at)\n\n            worker.add(\n                name=task_name,\n                uuid=uuid,\n                priority=int(priority),\n                args=args,\n                kwargs=kwargs,\n                created_at=created_at,\n            )\n\n    def add(\n        self,\n        task_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int,\n            Doc(\"\"\"\n                    Task priority.\n\n                    Default: `0`.\n                    \"\"\"),\n        ] = 0,\n        extra: Annotated[\n            dict | None,\n            Doc(\"\"\"\n                    Additional task parameters.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        args: Annotated[\n            tuple | None,\n            Doc(\"\"\"\n                    Task arguments of type args.\n\n                    Default: `()`.\n                    \"\"\"),\n        ] = None,\n        kwargs: Annotated[\n            dict | None,\n            Doc(\"\"\"\n                    Task arguments of type kwargs.\n\n                    Default: `{}`.\n                    \"\"\"),\n        ] = None,\n    ) -&gt; Task:\n        \"\"\"\n        Adds a task to the broker.\n\n        Args:\n            task_name (str): The name of the task.\n            priority (int, optional): Task priority. Default: `0`.\n            extra (dict, optional): Additional task parameters. Default: `None`.\n            args (tuple, optional): Task arguments of type args. Default: `()`.\n            kwargs (dict, optional): Task arguments of type kwargs. Default: `{}`.\n\n        Returns:\n            Task: `schemas.task.Task`\n\n        Raises:\n            ValueError: Invalid task status.\n        \"\"\"\n        args, kwargs = args or (), kwargs or {}\n        uuid = uuid4()\n        uuid_str = str(uuid)\n        created_at = time()\n\n        model = TaskStatusNewSchema(\n            task_name=task_name,\n            priority=priority,\n            created_at=created_at,\n            updated_at=created_at,\n            args=str(args),\n            kwargs=str(kwargs),\n        )\n\n        if extra:\n            model = self._dynamic_model(model=model, extra=extra)\n\n        new_model = self._plugin_trigger(\n            \"broker_add_before\",\n            broker=self,\n            storage=self.storage,\n            model=model,\n            return_last=True,\n        )\n        if new_model:\n            model = new_model.get(\"model\", model)\n\n        self.storage.add(uuid=uuid, task_status=model)\n\n        task_data = f\"{task_name}:{uuid_str}:{priority}\"\n        self.producer.send(self.topic, task_data)\n        self.producer.flush()\n\n        self._plugin_trigger(\n            \"broker_add_after\", broker=self, storage=self.storage, model=model\n        )\n\n        return Task(\n            status=TaskStatusEnum.NEW.value,\n            task_name=task_name,\n            uuid=uuid,\n            priority=priority,\n            args=args,\n            kwargs=kwargs,\n            created_at=datetime.fromtimestamp(created_at),\n            updated_at=datetime.fromtimestamp(created_at),\n        )\n\n    def get(\n        self,\n        uuid: Annotated[\n            UUID | str,\n            Doc(\"\"\"\n                    UUID of the task.\n                    \"\"\"),\n        ],\n    ) -&gt; Task | None:\n        \"\"\"\n        Obtaining information about a task.\n\n        Args:\n            uuid (UUID|str): UUID of the task.\n\n        Returns:\n            Task|None: If there is task information, returns `schemas.task.Task`, otherwise `None`.\n        \"\"\"\n        if isinstance(uuid, str):\n            uuid = UUID(uuid)\n        task = self.storage.get(uuid=uuid)\n        new_task = self._plugin_trigger(\n            \"broker_get\", broker=self, task=task, return_last=True\n        )\n        if new_task:\n            task = new_task.get(\"task\", task)\n        return task\n\n    def update(\n        self,\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    Update arguments for storage type kwargs.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Updates task information.\n\n        Args:\n            kwargs (dict, optional): task data of type kwargs.\n        \"\"\"\n        new_kw = self._plugin_trigger(\n            \"broker_update\", broker=self, kw=kwargs, return_last=True\n        )\n        if new_kw:\n            kwargs = new_kw.get(\"kw\", kwargs)\n        return self.storage.update(**kwargs)\n\n    def start(\n        self,\n        worker: Annotated[\n            BaseWorker,\n            Doc(\"\"\"\n                    Worker class.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Launches the broker.\n\n        Args:\n            worker (BaseWorker): Worker class.\n        \"\"\"\n        self._plugin_trigger(\"broker_start\", broker=self, worker=worker)\n        self.storage.start()\n\n        if self.config.delete_finished_tasks:\n            self.storage._delete_finished_tasks()\n\n        if self.config.running_older_tasks:\n            self.storage._running_older_tasks(worker)\n\n        self.listen(worker)\n\n    def stop(self):\n        \"\"\"The broker stops.\"\"\"\n        self._plugin_trigger(\"broker_stop\", broker=self)\n        self.running = False\n        self.consumer.stop()\n        self.producer.stop()\n\n    def remove_finished_task(\n        self,\n        task_broker: Annotated[\n            TaskPrioritySchema,\n            Doc(\"\"\"\n                    Priority task diagram.\n                    \"\"\"),\n        ],\n        model: Annotated[\n            TaskStatusSuccessSchema | TaskStatusErrorSchema,\n            Doc(\"\"\"\n                    Model of the task result.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Updates storage data via the `self.storage.remove_finished_task` function.\n\n        Args:\n            task_broker (TaskPrioritySchema): The priority task schema.\n            model (TaskStatusSuccessSchema | TaskStatusErrorSchema): Model of the task result.\n        \"\"\"\n        new_model = self._plugin_trigger(\n            \"broker_remove_finished_task\",\n            broker=self,\n            storage=self.storage,\n            model=model,\n            return_last=True,\n        )\n        if new_model:\n            model = new_model.get(\"model\", model)\n\n        self.storage.remove_finished_task(task_broker, model)\n\n    def _running_older_tasks(self, worker):\n        self._plugin_trigger(\"broker_running_older_tasks\", broker=self, worker=worker)\n        return self.storage._running_older_tasks(worker)\n\n    def flush_all(self) -&gt; None:\n        \"\"\"Delete all data.\"\"\"\n        self._plugin_trigger(\"broker_flush_all\", broker=self)\n        self.storage.flush_all()\n</code></pre>"},{"location":"api/brokers/sync_kafkabroker/#qtasks.brokers.sync_kafka.SyncKafkaBroker.__init__","title":"<code>__init__(name='QueueTasks', url='localhost:9092', storage=None, topic='task_queue', log=None, config=None, events=None)</code>","text":"<p>Initializing SyncKafkaBroker.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Project name. Default: <code>QueueTasks</code>.</p> <code>'QueueTasks'</code> <code>url</code> <code>str</code> <p>URL to connect to Kafka. Default: <code>None</code>.</p> <code>'localhost:9092'</code> <code>storage</code> <code>BaseStorage</code> <p>Storage. Default: <code>None</code>.</p> <code>None</code> <code>topic</code> <code>str</code> <p>Kafka topic. Default: <code>task_queue</code>.</p> <code>'task_queue'</code> <code>log</code> <code>Logger</code> <p>Logger. Default: <code>None</code>.</p> <code>None</code> <code>config</code> <code>QueueConfig</code> <p>Config. Default: <code>None</code>.</p> <code>None</code> <code>events</code> <code>BaseEvents</code> <p>Events. Default: <code>qtasks.events.SyncEvents</code>.</p> <code>None</code> Source code in <code>src/qtasks/brokers/sync_kafka.py</code> <pre><code>def __init__(\n    self,\n    name: Annotated[\n        str,\n        Doc(\"\"\"\n                Project name. This name is also used by the broker.\n\n                Default: `QueueTasks`.\n                \"\"\"),\n    ] = \"QueueTasks\",\n    url: Annotated[\n        str,\n        Doc(\"\"\"\n                URL to connect to Kafka.\n\n                Default: `localhost:9092`.\n                \"\"\"),\n    ] = \"localhost:9092\",\n    storage: Annotated[\n        Optional[BaseStorage],\n        Doc(\"\"\"\n                Storage.\n\n                Default: `SyncRedisStorage`.\n                \"\"\"),\n    ] = None,\n    topic: Annotated[\n        str,\n        Doc(\"\"\"\n                Kafka topic.\n\n                Default: `task_queue`.\n                \"\"\"),\n    ] = \"task_queue\",\n    log: Annotated[\n        Logger | None,\n        Doc(\"\"\"\n                Logger.\n\n                Default: `qtasks.logs.Logger`.\n                \"\"\"),\n    ] = None,\n    config: Annotated[\n        QueueConfig | None,\n        Doc(\"\"\"\n                Config.\n\n                Default: `qtasks.configs.config.QueueConfig`.\n                \"\"\"),\n    ] = None,\n    events: Annotated[\n        Optional[BaseEvents],\n        Doc(\"\"\"\n                Events.\n\n                Default: `qtasks.events.SyncEvents`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    Initializing SyncKafkaBroker.\n\n    Args:\n        name (str, optional): Project name. Default: `QueueTasks`.\n        url (str, optional): URL to connect to Kafka. Default: `None`.\n        storage (BaseStorage, optional): Storage. Default: `None`.\n        topic (str, optional): Kafka topic. Default: `task_queue`.\n        log (Logger, optional): Logger. Default: `None`.\n        config (QueueConfig, optional): Config. Default: `None`.\n        events (BaseEvents, optional): Events. Default: `qtasks.events.SyncEvents`.\n    \"\"\"\n    self.url = url\n    storage = storage or SyncRedisStorage(\n        name=name, log=log, config=config, events=events\n    )\n    super().__init__(\n        name=name, log=log, config=config, events=events, storage=storage\n    )\n\n    self.storage: BaseStorage[Literal[False]]\n\n    self.events = self.events or SyncEvents()\n    self.topic = f\"{self.name}_{topic}\"\n\n    self.consumer = KafkaConsumer(\n        self.topic,\n        bootstrap_servers=self.url,\n        group_id=f\"{self.name}_group\",\n        auto_offset_reset=\"earliest\",\n        enable_auto_commit=True,\n        value_deserializer=lambda m: m.decode(\"utf-8\"),\n    )\n    self.producer = KafkaProducer(\n        bootstrap_servers=self.url,\n        auto_offset_reset=\"earliest\",\n        enable_auto_commit=True,\n        value_deserializer=lambda m: m.decode(\"utf-8\"),\n    )\n\n    self.running = False\n</code></pre>"},{"location":"api/brokers/sync_kafkabroker/#qtasks.brokers.sync_kafka.SyncKafkaBroker.add","title":"<code>add(task_name, priority=0, extra=None, args=None, kwargs=None)</code>","text":"<p>Adds a task to the broker.</p> <p>Parameters:</p> Name Type Description Default <code>task_name</code> <code>str</code> <p>The name of the task.</p> required <code>priority</code> <code>int</code> <p>Task priority. Default: <code>0</code>.</p> <code>0</code> <code>extra</code> <code>dict</code> <p>Additional task parameters. Default: <code>None</code>.</p> <code>None</code> <code>args</code> <code>tuple</code> <p>Task arguments of type args. Default: <code>()</code>.</p> <code>None</code> <code>kwargs</code> <code>dict</code> <p>Task arguments of type kwargs. Default: <code>{}</code>.</p> <code>None</code> <p>Returns:</p> Name Type Description <code>Task</code> <code>Task</code> <p><code>schemas.task.Task</code></p> <p>Raises:</p> Type Description <code>ValueError</code> <p>Invalid task status.</p> Source code in <code>src/qtasks/brokers/sync_kafka.py</code> <pre><code>def add(\n    self,\n    task_name: Annotated[\n        str,\n        Doc(\"\"\"\n                Task name.\n                \"\"\"),\n    ],\n    priority: Annotated[\n        int,\n        Doc(\"\"\"\n                Task priority.\n\n                Default: `0`.\n                \"\"\"),\n    ] = 0,\n    extra: Annotated[\n        dict | None,\n        Doc(\"\"\"\n                Additional task parameters.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    args: Annotated[\n        tuple | None,\n        Doc(\"\"\"\n                Task arguments of type args.\n\n                Default: `()`.\n                \"\"\"),\n    ] = None,\n    kwargs: Annotated[\n        dict | None,\n        Doc(\"\"\"\n                Task arguments of type kwargs.\n\n                Default: `{}`.\n                \"\"\"),\n    ] = None,\n) -&gt; Task:\n    \"\"\"\n    Adds a task to the broker.\n\n    Args:\n        task_name (str): The name of the task.\n        priority (int, optional): Task priority. Default: `0`.\n        extra (dict, optional): Additional task parameters. Default: `None`.\n        args (tuple, optional): Task arguments of type args. Default: `()`.\n        kwargs (dict, optional): Task arguments of type kwargs. Default: `{}`.\n\n    Returns:\n        Task: `schemas.task.Task`\n\n    Raises:\n        ValueError: Invalid task status.\n    \"\"\"\n    args, kwargs = args or (), kwargs or {}\n    uuid = uuid4()\n    uuid_str = str(uuid)\n    created_at = time()\n\n    model = TaskStatusNewSchema(\n        task_name=task_name,\n        priority=priority,\n        created_at=created_at,\n        updated_at=created_at,\n        args=str(args),\n        kwargs=str(kwargs),\n    )\n\n    if extra:\n        model = self._dynamic_model(model=model, extra=extra)\n\n    new_model = self._plugin_trigger(\n        \"broker_add_before\",\n        broker=self,\n        storage=self.storage,\n        model=model,\n        return_last=True,\n    )\n    if new_model:\n        model = new_model.get(\"model\", model)\n\n    self.storage.add(uuid=uuid, task_status=model)\n\n    task_data = f\"{task_name}:{uuid_str}:{priority}\"\n    self.producer.send(self.topic, task_data)\n    self.producer.flush()\n\n    self._plugin_trigger(\n        \"broker_add_after\", broker=self, storage=self.storage, model=model\n    )\n\n    return Task(\n        status=TaskStatusEnum.NEW.value,\n        task_name=task_name,\n        uuid=uuid,\n        priority=priority,\n        args=args,\n        kwargs=kwargs,\n        created_at=datetime.fromtimestamp(created_at),\n        updated_at=datetime.fromtimestamp(created_at),\n    )\n</code></pre>"},{"location":"api/brokers/sync_kafkabroker/#qtasks.brokers.sync_kafka.SyncKafkaBroker.flush_all","title":"<code>flush_all()</code>","text":"<p>Delete all data.</p> Source code in <code>src/qtasks/brokers/sync_kafka.py</code> <pre><code>def flush_all(self) -&gt; None:\n    \"\"\"Delete all data.\"\"\"\n    self._plugin_trigger(\"broker_flush_all\", broker=self)\n    self.storage.flush_all()\n</code></pre>"},{"location":"api/brokers/sync_kafkabroker/#qtasks.brokers.sync_kafka.SyncKafkaBroker.get","title":"<code>get(uuid)</code>","text":"<p>Obtaining information about a task.</p> <p>Parameters:</p> Name Type Description Default <code>uuid</code> <code>UUID | str</code> <p>UUID of the task.</p> required <p>Returns:</p> Type Description <code>Task | None</code> <p>Task|None: If there is task information, returns <code>schemas.task.Task</code>, otherwise <code>None</code>.</p> Source code in <code>src/qtasks/brokers/sync_kafka.py</code> <pre><code>def get(\n    self,\n    uuid: Annotated[\n        UUID | str,\n        Doc(\"\"\"\n                UUID of the task.\n                \"\"\"),\n    ],\n) -&gt; Task | None:\n    \"\"\"\n    Obtaining information about a task.\n\n    Args:\n        uuid (UUID|str): UUID of the task.\n\n    Returns:\n        Task|None: If there is task information, returns `schemas.task.Task`, otherwise `None`.\n    \"\"\"\n    if isinstance(uuid, str):\n        uuid = UUID(uuid)\n    task = self.storage.get(uuid=uuid)\n    new_task = self._plugin_trigger(\n        \"broker_get\", broker=self, task=task, return_last=True\n    )\n    if new_task:\n        task = new_task.get(\"task\", task)\n    return task\n</code></pre>"},{"location":"api/brokers/sync_kafkabroker/#qtasks.brokers.sync_kafka.SyncKafkaBroker.listen","title":"<code>listen(worker)</code>","text":"<p>Listens to Kafka and transfers tasks to the worker.</p> <p>Parameters:</p> Name Type Description Default <code>worker</code> <code>BaseWorker</code> <p>Worker class.</p> required Source code in <code>src/qtasks/brokers/sync_kafka.py</code> <pre><code>def listen(\n    self,\n    worker: Annotated[\n        BaseWorker[Literal[False]],\n        Doc(\"\"\"\n                Worker class.\n                \"\"\"),\n    ],\n):\n    \"\"\"\n    Listens to Kafka and transfers tasks to the worker.\n\n    Args:\n        worker (BaseWorker): Worker class.\n    \"\"\"\n    self._plugin_trigger(\"broker_listen_start\", broker=self, worker=worker)\n    self.running = True\n    for msg in self.consumer:\n        if not self.running:\n            break\n        task_data = msg.value\n        task_name, uuid_str, priority = task_data.split(\":\")\n        uuid = UUID(uuid_str)\n        model_get = self.get(uuid=uuid)\n        if model_get is None:\n            if self.log:\n                self.log.warning(f\"Task {uuid} not found in repository.\")\n            continue\n        args, kwargs, created_at = (\n            model_get.args or (),\n            model_get.kwargs or {},\n            model_get.created_at.timestamp(),\n        )\n        if self.log:\n            self.log.info(f\"Received new task: {uuid}\")\n        new_args = self._plugin_trigger(\n            \"broker_add_worker\",\n            broker=self,\n            worker=worker,\n            task_name=task_name,\n            uuid=uuid,\n            priority=int(priority),\n            args=args,\n            kw=kwargs,\n            created_at=created_at,\n            return_last=True,\n        )\n        if new_args:\n            task_name = new_args.get(\"task_name\", task_name)\n            uuid = new_args.get(\"uuid\", uuid)\n            priority = new_args.get(\"priority\", priority)\n            args = new_args.get(\"args\", args)\n            kwargs = new_args.get(\"kw\", kwargs)\n            created_at = new_args.get(\"created_at\", created_at)\n\n        worker.add(\n            name=task_name,\n            uuid=uuid,\n            priority=int(priority),\n            args=args,\n            kwargs=kwargs,\n            created_at=created_at,\n        )\n</code></pre>"},{"location":"api/brokers/sync_kafkabroker/#qtasks.brokers.sync_kafka.SyncKafkaBroker.remove_finished_task","title":"<code>remove_finished_task(task_broker, model)</code>","text":"<p>Updates storage data via the <code>self.storage.remove_finished_task</code> function.</p> <p>Parameters:</p> Name Type Description Default <code>task_broker</code> <code>TaskPrioritySchema</code> <p>The priority task schema.</p> required <code>model</code> <code>TaskStatusSuccessSchema | TaskStatusErrorSchema</code> <p>Model of the task result.</p> required Source code in <code>src/qtasks/brokers/sync_kafka.py</code> <pre><code>def remove_finished_task(\n    self,\n    task_broker: Annotated[\n        TaskPrioritySchema,\n        Doc(\"\"\"\n                Priority task diagram.\n                \"\"\"),\n    ],\n    model: Annotated[\n        TaskStatusSuccessSchema | TaskStatusErrorSchema,\n        Doc(\"\"\"\n                Model of the task result.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Updates storage data via the `self.storage.remove_finished_task` function.\n\n    Args:\n        task_broker (TaskPrioritySchema): The priority task schema.\n        model (TaskStatusSuccessSchema | TaskStatusErrorSchema): Model of the task result.\n    \"\"\"\n    new_model = self._plugin_trigger(\n        \"broker_remove_finished_task\",\n        broker=self,\n        storage=self.storage,\n        model=model,\n        return_last=True,\n    )\n    if new_model:\n        model = new_model.get(\"model\", model)\n\n    self.storage.remove_finished_task(task_broker, model)\n</code></pre>"},{"location":"api/brokers/sync_kafkabroker/#qtasks.brokers.sync_kafka.SyncKafkaBroker.start","title":"<code>start(worker)</code>","text":"<p>Launches the broker.</p> <p>Parameters:</p> Name Type Description Default <code>worker</code> <code>BaseWorker</code> <p>Worker class.</p> required Source code in <code>src/qtasks/brokers/sync_kafka.py</code> <pre><code>def start(\n    self,\n    worker: Annotated[\n        BaseWorker,\n        Doc(\"\"\"\n                Worker class.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Launches the broker.\n\n    Args:\n        worker (BaseWorker): Worker class.\n    \"\"\"\n    self._plugin_trigger(\"broker_start\", broker=self, worker=worker)\n    self.storage.start()\n\n    if self.config.delete_finished_tasks:\n        self.storage._delete_finished_tasks()\n\n    if self.config.running_older_tasks:\n        self.storage._running_older_tasks(worker)\n\n    self.listen(worker)\n</code></pre>"},{"location":"api/brokers/sync_kafkabroker/#qtasks.brokers.sync_kafka.SyncKafkaBroker.stop","title":"<code>stop()</code>","text":"<p>The broker stops.</p> Source code in <code>src/qtasks/brokers/sync_kafka.py</code> <pre><code>def stop(self):\n    \"\"\"The broker stops.\"\"\"\n    self._plugin_trigger(\"broker_stop\", broker=self)\n    self.running = False\n    self.consumer.stop()\n    self.producer.stop()\n</code></pre>"},{"location":"api/brokers/sync_kafkabroker/#qtasks.brokers.sync_kafka.SyncKafkaBroker.update","title":"<code>update(**kwargs)</code>","text":"<p>Updates task information.</p> <p>Parameters:</p> Name Type Description Default <code>kwargs</code> <code>dict</code> <p>task data of type kwargs.</p> <code>{}</code> Source code in <code>src/qtasks/brokers/sync_kafka.py</code> <pre><code>def update(\n    self,\n    **kwargs: Annotated[\n        Any,\n        Doc(\"\"\"\n                Update arguments for storage type kwargs.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Updates task information.\n\n    Args:\n        kwargs (dict, optional): task data of type kwargs.\n    \"\"\"\n    new_kw = self._plugin_trigger(\n        \"broker_update\", broker=self, kw=kwargs, return_last=True\n    )\n    if new_kw:\n        kwargs = new_kw.get(\"kw\", kwargs)\n    return self.storage.update(**kwargs)\n</code></pre>"},{"location":"api/brokers/sync_rabbitmqbroker/","title":"SyncRabbitMQBroker","text":"<p>Sync RabbitMQ Broker.</p>"},{"location":"api/brokers/sync_rabbitmqbroker/#qtasks.brokers.sync_rabbitmq.SyncRabbitMQBroker","title":"<code>SyncRabbitMQBroker</code>","text":"<p>               Bases: <code>BaseBroker</code>, <code>SyncPluginMixin</code></p> <p>A broker that listens to RabbitMQ and adds tasks to the queue.</p>"},{"location":"api/brokers/sync_rabbitmqbroker/#qtasks.brokers.sync_rabbitmq.SyncRabbitMQBroker--example","title":"Example","text":"<pre><code>from qtasks import QueueTasks\nfrom qtasks.brokers import SyncRabbitMQBroker\n\nbroker = SyncRabbitMQBroker(name=\"QueueTasks\", url=\"amqp://guest:guest@localhost/\")\n\napp = QueueTasks(broker=broker)\n</code></pre> Source code in <code>src/qtasks/brokers/sync_rabbitmq.py</code> <pre><code>class SyncRabbitMQBroker(BaseBroker, SyncPluginMixin):\n    \"\"\"\n    A broker that listens to RabbitMQ and adds tasks to the queue.\n\n    ## Example\n\n    ```python\n    from qtasks import QueueTasks\n    from qtasks.brokers import SyncRabbitMQBroker\n\n    broker = SyncRabbitMQBroker(name=\"QueueTasks\", url=\"amqp://guest:guest@localhost/\")\n\n    app = QueueTasks(broker=broker)\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Project name. This name is also used by the broker.\n\n                    Default: `QueueTasks`.\n                    \"\"\"),\n        ] = \"QueueTasks\",\n        url: Annotated[\n            str,\n            Doc(\"\"\"\n                    URL to connect to RabbitMQ.\n\n                    Default: `amqp://guest:guest@localhost/`.\n                    \"\"\"),\n        ] = \"amqp://guest:guest@localhost/\",\n        storage: Annotated[\n            Optional[BaseStorage],\n            Doc(\"\"\"\n                    Storage.\n\n                    Default: `SyncRedisStorage`.\n                    \"\"\"),\n        ] = None,\n        queue_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    The name of the task queue for RabbitMQ. The title is updated to: `name:queue_name`\n\n                    Default: `task_queue`.\n                    \"\"\"),\n        ] = \"task_queue\",\n        log: Annotated[\n            Logger | None,\n            Doc(\"\"\"\n                    Logger.\n\n                    Default: `qtasks.logs.Logger`.\n                    \"\"\"),\n        ] = None,\n        config: Annotated[\n            QueueConfig | None,\n            Doc(\"\"\"\n                    Config.\n\n                    Default: `qtasks.configs.config.QueueConfig`.\n                    \"\"\"),\n        ] = None,\n        events: Annotated[\n            Optional[BaseEvents],\n            Doc(\"\"\"\n                    Events.\n\n                    Default: `qtasks.events.SyncEvents`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Initializing SyncRabbitMQBroker.\n\n        Args:\n            name (str, optional): Project name. Default: `QueueTasks`.\n            url (str, optional): URL to connect to RabbitMQ. Default: `None`.\n            storage (BaseStorage, optional): Storage. Default: `None`.\n            queue_name (str, optional): RabbitMQ queue name. Default: `task_queue`.\n            log (Logger, optional): Logger. Default: `None`.\n            config (QueueConfig, optional): Config. Default: `None`.\n            events (BaseEvents, optional): Events. Default: `qtasks.events.SyncEvents`.\n        \"\"\"\n        self.url = url\n        storage = storage or SyncRedisStorage(\n            name=name, log=log, config=config, events=events\n        )\n        super().__init__(\n            name=name, log=log, config=config, events=events, storage=storage\n        )\n\n        self.storage: BaseStorage[Literal[False]]\n\n        self.queue_name = f\"{self.name}:{queue_name}\"\n        self.events = self.events or SyncEvents()\n\n        self.connection = None\n        self.channel = None  # type: ignore\n        self.running = False\n\n    def connect(self):\n        \"\"\"Connection to RabbitMQ is synchronous.\"\"\"\n        self.connection = pika.BlockingConnection(pika.URLParameters(self.url))\n        self.channel = self.connection.channel()\n        self.channel.basic_qos(prefetch_count=1)\n\n        self.queue = self.channel.queue_declare(self.queue_name, durable=True)\n\n    def listen(\n        self,\n        worker: Annotated[\n            BaseWorker[Literal[False]],\n            Doc(\"\"\"\n                    Worker class.\n                    \"\"\"),\n        ],\n    ):\n        \"\"\"\n        Listens to the RabbitMQ queue and transfers tasks to the worker.\n\n        Args:\n            worker (BaseWorker): Worker class.\n        \"\"\"\n        self._plugin_trigger(\"broker_listen_start\", broker=self, worker=worker)\n        if not self.channel:\n            self.connect()\n\n        def callback(ch, method, properties, body):\n            task_data = json.loads(body)\n            task_name, uuid, priority = (\n                task_data[\"task_name\"],\n                task_data[\"uuid\"],\n                task_data[\"priority\"],\n            )\n            args, kwargs = task_data.get(\"args\", ()), task_data.get(\"kwargs\", {})\n            created_at = task_data.get(\"created_at\", 0)\n\n            self.storage.add_process(\n                f'{task_data[\"task_name\"]}:{task_data[\"uuid\"]}:{task_data[\"priority\"]}',\n                task_data[\"priority\"],\n            )\n            if self.log:\n                self.log.info(f\"Received new task: {task_data['uuid']}\")\n            new_args = self._plugin_trigger(\n                \"broker_add_worker\",\n                broker=self,\n                worker=worker,\n                task_name=task_name,\n                uuid=uuid,\n                priority=int(priority),\n                args=args,\n                kw=kwargs,\n                created_at=created_at,\n                return_last=True,\n            )\n            if new_args:\n                task_name = new_args.get(\"task_name\", task_name)\n                uuid = new_args.get(\"uuid\", uuid)\n                priority = new_args.get(\"priority\", priority)\n                args = new_args.get(\"args\", args)\n                kwargs = new_args.get(\"kw\", kwargs)\n                created_at = new_args.get(\"created_at\", created_at)\n\n            worker.add(\n                name=task_name,\n                uuid=uuid,\n                priority=priority,\n                args=args,\n                kwargs=kwargs,\n                created_at=created_at,\n            )\n\n        if not isinstance(self.channel, BlockingChannel):\n            raise RuntimeError(\"self.channel is not defined. The server is not running!\")\n        self.channel: BlockingChannel\n\n        self.channel.basic_consume(\n            queue=self.queue_name, on_message_callback=callback, auto_ack=True\n        )\n        self.running = True\n        self.channel.start_consuming()\n\n    def add(\n        self,\n        task_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int,\n            Doc(\"\"\"\n                    Task priority.\n\n                    Default: `0`.\n                    \"\"\"),\n        ] = 0,\n        extra: Annotated[\n            dict | None,\n            Doc(\"\"\"\n                    Additional task parameters.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        args: Annotated[\n            tuple | None,\n            Doc(\"\"\"\n                    Task arguments of type args.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        kwargs: Annotated[\n            dict | None,\n            Doc(\"\"\"\n                    Task arguments of type kwargs.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n    ) -&gt; Task:\n        \"\"\"\n        Adds a task to the broker.\n\n        Args:\n            task_name (str): The name of the task.\n            priority (int, optional): Task priority. Default: `0`.\n            extra (dict, optional): Additional task parameters. Default: `None`.\n            args (tuple, optional): Task arguments of type args. Default: `None`.\n            kwargs (dict, optional): Task arguments of type kwargs. Default: `None`.\n\n        Returns:\n            Task: `schemas.task.Task`\n\n        Raises:\n            RuntimeError: self.channel is not defined. The server is not running!\n        \"\"\"\n        args, kwargs = args or (), kwargs or {}\n        if not self.channel:\n            self.connect()\n        if not isinstance(self.channel, BlockingChannel):\n            raise RuntimeError(\"self.channel is not defined. The server is not running!\")\n        self.channel: BlockingChannel\n\n        uuid = uuid4()\n        uuid_str = uuid\n        created_at = time()\n\n        model = TaskStatusNewSchema(\n            task_name=task_name,\n            priority=priority,\n            created_at=created_at,\n            updated_at=created_at,\n            args=str(args),\n            kwargs=str(kwargs),\n        )\n\n        if extra:\n            model = self._dynamic_model(model=model, extra=extra)\n\n        new_model = self._plugin_trigger(\n            \"broker_add_before\",\n            broker=self,\n            storage=self.storage,\n            model=model,\n            return_last=True,\n        )\n        if new_model:\n            model = new_model.get(\"model\", model)\n\n        self.storage.add(uuid=uuid, task_status=model)\n\n        task_data = {\n            \"uuid\": uuid_str,\n            \"task_name\": task_name,\n            \"priority\": priority,\n            \"args\": args,\n            \"kwargs\": kwargs,\n            \"created_at\": created_at,\n        }\n\n        self.channel.basic_publish(\n            exchange=\"\",\n            routing_key=self.queue_name,\n            body=json.dumps(task_data).encode(),\n            properties=pika.BasicProperties(\n                delivery_mode=2,\n            ),\n        )\n\n        self._plugin_trigger(\n            \"broker_add_after\", broker=self, storage=self.storage, model=model\n        )\n\n        return Task(\n            status=TaskStatusEnum.NEW.value,\n            task_name=task_name,\n            uuid=uuid,\n            priority=priority,\n            args=args,\n            kwargs=kwargs,\n            created_at=datetime.fromtimestamp(created_at),\n            updated_at=datetime.fromtimestamp(created_at),\n        )\n\n    def get(\n        self,\n        uuid: Annotated[\n            UUID | str,\n            Doc(\"\"\"\n                    UUID of the task.\n                    \"\"\"),\n        ],\n    ) -&gt; Task | None:\n        \"\"\"\n        Obtaining information about a task.\n\n        Args:\n            uuid (UUID|str): UUID of the task.\n\n        Returns:\n            Task|None: If there is task information, returns `schemas.task.Task`, otherwise `None`.\n        \"\"\"\n        if isinstance(uuid, str):\n            uuid = UUID(uuid)\n        task = self.storage.get(uuid=uuid)\n        new_task = self._plugin_trigger(\n            \"broker_get\", broker=self, task=task, return_last=True\n        )\n        if new_task:\n            task = new_task.get(\"task\", task)\n        return task\n\n    def update(\n        self,\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    Update arguments for storage type kwargs.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Updates task information.\n\n        Args:\n            kwargs (dict, optional): task data of type kwargs.\n        \"\"\"\n        new_kw = self._plugin_trigger(\n            \"broker_update\", broker=self, kw=kwargs, return_last=True\n        )\n        if new_kw:\n            kwargs = new_kw.get(\"kw\", kwargs)\n        return self.storage.update(**kwargs)\n\n    def start(\n        self,\n        worker: Annotated[\n            BaseWorker,\n            Doc(\"\"\"\n                    Worker class.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Launches the broker.\n\n        Args:\n            worker (BaseWorker): Worker class.\n        \"\"\"\n        self._plugin_trigger(\"broker_start\", broker=self, worker=worker)\n        self.storage.start()\n\n        if self.config.delete_finished_tasks:\n            self.storage._delete_finished_tasks()\n\n        if self.config.running_older_tasks:\n            self.storage._running_older_tasks(worker)\n\n        self.listen(worker)\n\n    def stop(self):\n        \"\"\"The broker stops.\"\"\"\n        self._plugin_trigger(\"broker_stop\", broker=self)\n        self.running = False\n        if self.connection:\n            self.connection.close()\n            self.connection = None\n            self.channel = None  # type: ignore\n        self.storage.stop()\n\n    def remove_finished_task(\n        self,\n        task_broker: Annotated[\n            TaskPrioritySchema,\n            Doc(\"\"\"\n                    Priority task diagram.\n                    \"\"\"),\n        ],\n        model: Annotated[\n            TaskStatusSuccessSchema | TaskStatusErrorSchema,\n            Doc(\"\"\"\n                    Model of the task result.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Updates storage data via the `self.storage.remove_finished_task` function.\n\n        Args:\n            task_broker (TaskPrioritySchema): The priority task schema.\n            model (TaskStatusSuccessSchema | TaskStatusErrorSchema): Model of the task result.\n        \"\"\"\n        new_model = self._plugin_trigger(\n            \"broker_remove_finished_task\",\n            broker=self,\n            storage=self.storage,\n            model=model,\n            return_last=True,\n        )\n        if new_model:\n            model = new_model.get(\"model\", model)\n\n        self.storage.remove_finished_task(task_broker, model)\n\n    def _running_older_tasks(self, worker):\n        self._plugin_trigger(\"broker_running_older_tasks\", broker=self, worker=worker)\n        return self.storage._running_older_tasks(worker)\n\n    def flush_all(self) -&gt; None:\n        \"\"\"Delete all data.\"\"\"\n        self._plugin_trigger(\"broker_flush_all\", broker=self)\n        self.storage.flush_all()\n</code></pre>"},{"location":"api/brokers/sync_rabbitmqbroker/#qtasks.brokers.sync_rabbitmq.SyncRabbitMQBroker.__init__","title":"<code>__init__(name='QueueTasks', url='amqp://guest:guest@localhost/', storage=None, queue_name='task_queue', log=None, config=None, events=None)</code>","text":"<p>Initializing SyncRabbitMQBroker.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Project name. Default: <code>QueueTasks</code>.</p> <code>'QueueTasks'</code> <code>url</code> <code>str</code> <p>URL to connect to RabbitMQ. Default: <code>None</code>.</p> <code>'amqp://guest:guest@localhost/'</code> <code>storage</code> <code>BaseStorage</code> <p>Storage. Default: <code>None</code>.</p> <code>None</code> <code>queue_name</code> <code>str</code> <p>RabbitMQ queue name. Default: <code>task_queue</code>.</p> <code>'task_queue'</code> <code>log</code> <code>Logger</code> <p>Logger. Default: <code>None</code>.</p> <code>None</code> <code>config</code> <code>QueueConfig</code> <p>Config. Default: <code>None</code>.</p> <code>None</code> <code>events</code> <code>BaseEvents</code> <p>Events. Default: <code>qtasks.events.SyncEvents</code>.</p> <code>None</code> Source code in <code>src/qtasks/brokers/sync_rabbitmq.py</code> <pre><code>def __init__(\n    self,\n    name: Annotated[\n        str,\n        Doc(\"\"\"\n                Project name. This name is also used by the broker.\n\n                Default: `QueueTasks`.\n                \"\"\"),\n    ] = \"QueueTasks\",\n    url: Annotated[\n        str,\n        Doc(\"\"\"\n                URL to connect to RabbitMQ.\n\n                Default: `amqp://guest:guest@localhost/`.\n                \"\"\"),\n    ] = \"amqp://guest:guest@localhost/\",\n    storage: Annotated[\n        Optional[BaseStorage],\n        Doc(\"\"\"\n                Storage.\n\n                Default: `SyncRedisStorage`.\n                \"\"\"),\n    ] = None,\n    queue_name: Annotated[\n        str,\n        Doc(\"\"\"\n                The name of the task queue for RabbitMQ. The title is updated to: `name:queue_name`\n\n                Default: `task_queue`.\n                \"\"\"),\n    ] = \"task_queue\",\n    log: Annotated[\n        Logger | None,\n        Doc(\"\"\"\n                Logger.\n\n                Default: `qtasks.logs.Logger`.\n                \"\"\"),\n    ] = None,\n    config: Annotated[\n        QueueConfig | None,\n        Doc(\"\"\"\n                Config.\n\n                Default: `qtasks.configs.config.QueueConfig`.\n                \"\"\"),\n    ] = None,\n    events: Annotated[\n        Optional[BaseEvents],\n        Doc(\"\"\"\n                Events.\n\n                Default: `qtasks.events.SyncEvents`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    Initializing SyncRabbitMQBroker.\n\n    Args:\n        name (str, optional): Project name. Default: `QueueTasks`.\n        url (str, optional): URL to connect to RabbitMQ. Default: `None`.\n        storage (BaseStorage, optional): Storage. Default: `None`.\n        queue_name (str, optional): RabbitMQ queue name. Default: `task_queue`.\n        log (Logger, optional): Logger. Default: `None`.\n        config (QueueConfig, optional): Config. Default: `None`.\n        events (BaseEvents, optional): Events. Default: `qtasks.events.SyncEvents`.\n    \"\"\"\n    self.url = url\n    storage = storage or SyncRedisStorage(\n        name=name, log=log, config=config, events=events\n    )\n    super().__init__(\n        name=name, log=log, config=config, events=events, storage=storage\n    )\n\n    self.storage: BaseStorage[Literal[False]]\n\n    self.queue_name = f\"{self.name}:{queue_name}\"\n    self.events = self.events or SyncEvents()\n\n    self.connection = None\n    self.channel = None  # type: ignore\n    self.running = False\n</code></pre>"},{"location":"api/brokers/sync_rabbitmqbroker/#qtasks.brokers.sync_rabbitmq.SyncRabbitMQBroker.add","title":"<code>add(task_name, priority=0, extra=None, args=None, kwargs=None)</code>","text":"<p>Adds a task to the broker.</p> <p>Parameters:</p> Name Type Description Default <code>task_name</code> <code>str</code> <p>The name of the task.</p> required <code>priority</code> <code>int</code> <p>Task priority. Default: <code>0</code>.</p> <code>0</code> <code>extra</code> <code>dict</code> <p>Additional task parameters. Default: <code>None</code>.</p> <code>None</code> <code>args</code> <code>tuple</code> <p>Task arguments of type args. Default: <code>None</code>.</p> <code>None</code> <code>kwargs</code> <code>dict</code> <p>Task arguments of type kwargs. Default: <code>None</code>.</p> <code>None</code> <p>Returns:</p> Name Type Description <code>Task</code> <code>Task</code> <p><code>schemas.task.Task</code></p> <p>Raises:</p> Type Description <code>RuntimeError</code> <p>self.channel is not defined. The server is not running!</p> Source code in <code>src/qtasks/brokers/sync_rabbitmq.py</code> <pre><code>def add(\n    self,\n    task_name: Annotated[\n        str,\n        Doc(\"\"\"\n                Task name.\n                \"\"\"),\n    ],\n    priority: Annotated[\n        int,\n        Doc(\"\"\"\n                Task priority.\n\n                Default: `0`.\n                \"\"\"),\n    ] = 0,\n    extra: Annotated[\n        dict | None,\n        Doc(\"\"\"\n                Additional task parameters.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    args: Annotated[\n        tuple | None,\n        Doc(\"\"\"\n                Task arguments of type args.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    kwargs: Annotated[\n        dict | None,\n        Doc(\"\"\"\n                Task arguments of type kwargs.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n) -&gt; Task:\n    \"\"\"\n    Adds a task to the broker.\n\n    Args:\n        task_name (str): The name of the task.\n        priority (int, optional): Task priority. Default: `0`.\n        extra (dict, optional): Additional task parameters. Default: `None`.\n        args (tuple, optional): Task arguments of type args. Default: `None`.\n        kwargs (dict, optional): Task arguments of type kwargs. Default: `None`.\n\n    Returns:\n        Task: `schemas.task.Task`\n\n    Raises:\n        RuntimeError: self.channel is not defined. The server is not running!\n    \"\"\"\n    args, kwargs = args or (), kwargs or {}\n    if not self.channel:\n        self.connect()\n    if not isinstance(self.channel, BlockingChannel):\n        raise RuntimeError(\"self.channel is not defined. The server is not running!\")\n    self.channel: BlockingChannel\n\n    uuid = uuid4()\n    uuid_str = uuid\n    created_at = time()\n\n    model = TaskStatusNewSchema(\n        task_name=task_name,\n        priority=priority,\n        created_at=created_at,\n        updated_at=created_at,\n        args=str(args),\n        kwargs=str(kwargs),\n    )\n\n    if extra:\n        model = self._dynamic_model(model=model, extra=extra)\n\n    new_model = self._plugin_trigger(\n        \"broker_add_before\",\n        broker=self,\n        storage=self.storage,\n        model=model,\n        return_last=True,\n    )\n    if new_model:\n        model = new_model.get(\"model\", model)\n\n    self.storage.add(uuid=uuid, task_status=model)\n\n    task_data = {\n        \"uuid\": uuid_str,\n        \"task_name\": task_name,\n        \"priority\": priority,\n        \"args\": args,\n        \"kwargs\": kwargs,\n        \"created_at\": created_at,\n    }\n\n    self.channel.basic_publish(\n        exchange=\"\",\n        routing_key=self.queue_name,\n        body=json.dumps(task_data).encode(),\n        properties=pika.BasicProperties(\n            delivery_mode=2,\n        ),\n    )\n\n    self._plugin_trigger(\n        \"broker_add_after\", broker=self, storage=self.storage, model=model\n    )\n\n    return Task(\n        status=TaskStatusEnum.NEW.value,\n        task_name=task_name,\n        uuid=uuid,\n        priority=priority,\n        args=args,\n        kwargs=kwargs,\n        created_at=datetime.fromtimestamp(created_at),\n        updated_at=datetime.fromtimestamp(created_at),\n    )\n</code></pre>"},{"location":"api/brokers/sync_rabbitmqbroker/#qtasks.brokers.sync_rabbitmq.SyncRabbitMQBroker.connect","title":"<code>connect()</code>","text":"<p>Connection to RabbitMQ is synchronous.</p> Source code in <code>src/qtasks/brokers/sync_rabbitmq.py</code> <pre><code>def connect(self):\n    \"\"\"Connection to RabbitMQ is synchronous.\"\"\"\n    self.connection = pika.BlockingConnection(pika.URLParameters(self.url))\n    self.channel = self.connection.channel()\n    self.channel.basic_qos(prefetch_count=1)\n\n    self.queue = self.channel.queue_declare(self.queue_name, durable=True)\n</code></pre>"},{"location":"api/brokers/sync_rabbitmqbroker/#qtasks.brokers.sync_rabbitmq.SyncRabbitMQBroker.flush_all","title":"<code>flush_all()</code>","text":"<p>Delete all data.</p> Source code in <code>src/qtasks/brokers/sync_rabbitmq.py</code> <pre><code>def flush_all(self) -&gt; None:\n    \"\"\"Delete all data.\"\"\"\n    self._plugin_trigger(\"broker_flush_all\", broker=self)\n    self.storage.flush_all()\n</code></pre>"},{"location":"api/brokers/sync_rabbitmqbroker/#qtasks.brokers.sync_rabbitmq.SyncRabbitMQBroker.get","title":"<code>get(uuid)</code>","text":"<p>Obtaining information about a task.</p> <p>Parameters:</p> Name Type Description Default <code>uuid</code> <code>UUID | str</code> <p>UUID of the task.</p> required <p>Returns:</p> Type Description <code>Task | None</code> <p>Task|None: If there is task information, returns <code>schemas.task.Task</code>, otherwise <code>None</code>.</p> Source code in <code>src/qtasks/brokers/sync_rabbitmq.py</code> <pre><code>def get(\n    self,\n    uuid: Annotated[\n        UUID | str,\n        Doc(\"\"\"\n                UUID of the task.\n                \"\"\"),\n    ],\n) -&gt; Task | None:\n    \"\"\"\n    Obtaining information about a task.\n\n    Args:\n        uuid (UUID|str): UUID of the task.\n\n    Returns:\n        Task|None: If there is task information, returns `schemas.task.Task`, otherwise `None`.\n    \"\"\"\n    if isinstance(uuid, str):\n        uuid = UUID(uuid)\n    task = self.storage.get(uuid=uuid)\n    new_task = self._plugin_trigger(\n        \"broker_get\", broker=self, task=task, return_last=True\n    )\n    if new_task:\n        task = new_task.get(\"task\", task)\n    return task\n</code></pre>"},{"location":"api/brokers/sync_rabbitmqbroker/#qtasks.brokers.sync_rabbitmq.SyncRabbitMQBroker.listen","title":"<code>listen(worker)</code>","text":"<p>Listens to the RabbitMQ queue and transfers tasks to the worker.</p> <p>Parameters:</p> Name Type Description Default <code>worker</code> <code>BaseWorker</code> <p>Worker class.</p> required Source code in <code>src/qtasks/brokers/sync_rabbitmq.py</code> <pre><code>def listen(\n    self,\n    worker: Annotated[\n        BaseWorker[Literal[False]],\n        Doc(\"\"\"\n                Worker class.\n                \"\"\"),\n    ],\n):\n    \"\"\"\n    Listens to the RabbitMQ queue and transfers tasks to the worker.\n\n    Args:\n        worker (BaseWorker): Worker class.\n    \"\"\"\n    self._plugin_trigger(\"broker_listen_start\", broker=self, worker=worker)\n    if not self.channel:\n        self.connect()\n\n    def callback(ch, method, properties, body):\n        task_data = json.loads(body)\n        task_name, uuid, priority = (\n            task_data[\"task_name\"],\n            task_data[\"uuid\"],\n            task_data[\"priority\"],\n        )\n        args, kwargs = task_data.get(\"args\", ()), task_data.get(\"kwargs\", {})\n        created_at = task_data.get(\"created_at\", 0)\n\n        self.storage.add_process(\n            f'{task_data[\"task_name\"]}:{task_data[\"uuid\"]}:{task_data[\"priority\"]}',\n            task_data[\"priority\"],\n        )\n        if self.log:\n            self.log.info(f\"Received new task: {task_data['uuid']}\")\n        new_args = self._plugin_trigger(\n            \"broker_add_worker\",\n            broker=self,\n            worker=worker,\n            task_name=task_name,\n            uuid=uuid,\n            priority=int(priority),\n            args=args,\n            kw=kwargs,\n            created_at=created_at,\n            return_last=True,\n        )\n        if new_args:\n            task_name = new_args.get(\"task_name\", task_name)\n            uuid = new_args.get(\"uuid\", uuid)\n            priority = new_args.get(\"priority\", priority)\n            args = new_args.get(\"args\", args)\n            kwargs = new_args.get(\"kw\", kwargs)\n            created_at = new_args.get(\"created_at\", created_at)\n\n        worker.add(\n            name=task_name,\n            uuid=uuid,\n            priority=priority,\n            args=args,\n            kwargs=kwargs,\n            created_at=created_at,\n        )\n\n    if not isinstance(self.channel, BlockingChannel):\n        raise RuntimeError(\"self.channel is not defined. The server is not running!\")\n    self.channel: BlockingChannel\n\n    self.channel.basic_consume(\n        queue=self.queue_name, on_message_callback=callback, auto_ack=True\n    )\n    self.running = True\n    self.channel.start_consuming()\n</code></pre>"},{"location":"api/brokers/sync_rabbitmqbroker/#qtasks.brokers.sync_rabbitmq.SyncRabbitMQBroker.remove_finished_task","title":"<code>remove_finished_task(task_broker, model)</code>","text":"<p>Updates storage data via the <code>self.storage.remove_finished_task</code> function.</p> <p>Parameters:</p> Name Type Description Default <code>task_broker</code> <code>TaskPrioritySchema</code> <p>The priority task schema.</p> required <code>model</code> <code>TaskStatusSuccessSchema | TaskStatusErrorSchema</code> <p>Model of the task result.</p> required Source code in <code>src/qtasks/brokers/sync_rabbitmq.py</code> <pre><code>def remove_finished_task(\n    self,\n    task_broker: Annotated[\n        TaskPrioritySchema,\n        Doc(\"\"\"\n                Priority task diagram.\n                \"\"\"),\n    ],\n    model: Annotated[\n        TaskStatusSuccessSchema | TaskStatusErrorSchema,\n        Doc(\"\"\"\n                Model of the task result.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Updates storage data via the `self.storage.remove_finished_task` function.\n\n    Args:\n        task_broker (TaskPrioritySchema): The priority task schema.\n        model (TaskStatusSuccessSchema | TaskStatusErrorSchema): Model of the task result.\n    \"\"\"\n    new_model = self._plugin_trigger(\n        \"broker_remove_finished_task\",\n        broker=self,\n        storage=self.storage,\n        model=model,\n        return_last=True,\n    )\n    if new_model:\n        model = new_model.get(\"model\", model)\n\n    self.storage.remove_finished_task(task_broker, model)\n</code></pre>"},{"location":"api/brokers/sync_rabbitmqbroker/#qtasks.brokers.sync_rabbitmq.SyncRabbitMQBroker.start","title":"<code>start(worker)</code>","text":"<p>Launches the broker.</p> <p>Parameters:</p> Name Type Description Default <code>worker</code> <code>BaseWorker</code> <p>Worker class.</p> required Source code in <code>src/qtasks/brokers/sync_rabbitmq.py</code> <pre><code>def start(\n    self,\n    worker: Annotated[\n        BaseWorker,\n        Doc(\"\"\"\n                Worker class.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Launches the broker.\n\n    Args:\n        worker (BaseWorker): Worker class.\n    \"\"\"\n    self._plugin_trigger(\"broker_start\", broker=self, worker=worker)\n    self.storage.start()\n\n    if self.config.delete_finished_tasks:\n        self.storage._delete_finished_tasks()\n\n    if self.config.running_older_tasks:\n        self.storage._running_older_tasks(worker)\n\n    self.listen(worker)\n</code></pre>"},{"location":"api/brokers/sync_rabbitmqbroker/#qtasks.brokers.sync_rabbitmq.SyncRabbitMQBroker.stop","title":"<code>stop()</code>","text":"<p>The broker stops.</p> Source code in <code>src/qtasks/brokers/sync_rabbitmq.py</code> <pre><code>def stop(self):\n    \"\"\"The broker stops.\"\"\"\n    self._plugin_trigger(\"broker_stop\", broker=self)\n    self.running = False\n    if self.connection:\n        self.connection.close()\n        self.connection = None\n        self.channel = None  # type: ignore\n    self.storage.stop()\n</code></pre>"},{"location":"api/brokers/sync_rabbitmqbroker/#qtasks.brokers.sync_rabbitmq.SyncRabbitMQBroker.update","title":"<code>update(**kwargs)</code>","text":"<p>Updates task information.</p> <p>Parameters:</p> Name Type Description Default <code>kwargs</code> <code>dict</code> <p>task data of type kwargs.</p> <code>{}</code> Source code in <code>src/qtasks/brokers/sync_rabbitmq.py</code> <pre><code>def update(\n    self,\n    **kwargs: Annotated[\n        Any,\n        Doc(\"\"\"\n                Update arguments for storage type kwargs.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Updates task information.\n\n    Args:\n        kwargs (dict, optional): task data of type kwargs.\n    \"\"\"\n    new_kw = self._plugin_trigger(\n        \"broker_update\", broker=self, kw=kwargs, return_last=True\n    )\n    if new_kw:\n        kwargs = new_kw.get(\"kw\", kwargs)\n    return self.storage.update(**kwargs)\n</code></pre>"},{"location":"api/brokers/sync_redisbroker/","title":"SyncRedisBroker","text":"<p>Sync Redis Broker.</p>"},{"location":"api/brokers/sync_redisbroker/#qtasks.brokers.sync_redis.SyncRedisBroker","title":"<code>SyncRedisBroker</code>","text":"<p>               Bases: <code>BaseBroker</code>, <code>SyncPluginMixin</code></p> <p>A broker that listens to Redis and adds tasks to the queue.</p>"},{"location":"api/brokers/sync_redisbroker/#qtasks.brokers.sync_redis.SyncRedisBroker--example","title":"Example","text":"<pre><code>from qtasks import QueueTasks\nfrom qtasks.brokers import SyncRedisBroker\n\nbroker = SyncRedisBroker(name=\"QueueTasks\", url=\"redis://localhost:6379/2\")\n\napp = QueueTasks(broker=broker)\n</code></pre> Source code in <code>src/qtasks/brokers/sync_redis.py</code> <pre><code>class SyncRedisBroker(BaseBroker, SyncPluginMixin):\n    \"\"\"\n    A broker that listens to Redis and adds tasks to the queue.\n\n    ## Example\n\n    ```python\n    from qtasks import QueueTasks\n    from qtasks.brokers import SyncRedisBroker\n\n    broker = SyncRedisBroker(name=\"QueueTasks\", url=\"redis://localhost:6379/2\")\n\n    app = QueueTasks(broker=broker)\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Project name. This name is also used by the broker.\n\n                    Default: `QueueTasks`.\n                    \"\"\"),\n        ] = \"QueueTasks\",\n        url: Annotated[\n            str | None,\n            Doc(\"\"\"\n                    URL to connect to Redis.\n\n                    Default: `redis://localhost:6379/0`.\n                    \"\"\"),\n        ] = None,\n        storage: Annotated[\n            Optional[BaseStorage],\n            Doc(\"\"\"\n                    Storage.\n\n                    Default: `AsyncRedisStorage`.\n                    \"\"\"),\n        ] = None,\n        queue_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    The name of the task queue array for Redis. The title is updated to: `name:queue_name`\n\n                    Default: `task_queue`.\n                    \"\"\"),\n        ] = \"task_queue\",\n        log: Annotated[\n            Logger | None,\n            Doc(\"\"\"\n                    Logger.\n\n                    Default: `qtasks.logs.Logger`.\n                    \"\"\"),\n        ] = None,\n        config: Annotated[\n            QueueConfig | None,\n            Doc(\"\"\"\n                    Config.\n\n                    Default: `qtasks.configs.config.QueueConfig`.\n                    \"\"\"),\n        ] = None,\n        events: Annotated[\n            Optional[BaseEvents],\n            Doc(\"\"\"\n                    Events.\n\n                    Default: `qtasks.events.SyncEvents`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Initializing SyncRedisBroker.\n\n        Args:\n            name (str, optional): Project name. Default: `QueueTasks`.\n            url (str, optional): URL to connect to Redis. Default: `None`.\n            storage (BaseStorage, optional): Storage. Default: `None`.\n            queue_name (str, optional): Name of the task queue array for Redis. Default: `task_queue`.\n            log (Logger, optional): Logger. Default: `None`.\n            config (QueueConfig, optional): Config. Default: `None`.\n            events (BaseEvents, optional): Events. Default: `qtasks.events.SyncEvents`.\n        \"\"\"\n        self.url = url or \"redis://localhost:6379/0\"\n        self.client = redis.Redis.from_url(\n            self.url, decode_responses=True, encoding=\"utf-8\"\n        )\n        storage = storage or SyncRedisStorage(\n            name=name,\n            url=self.url,\n            redis_connect=self.client,\n            log=log,\n            config=config,\n        )\n        events = events or SyncEvents()\n\n        super().__init__(\n            name=name, log=log, config=config, events=events, storage=storage\n        )\n\n        self.storage: BaseStorage[Literal[False]]\n\n        self.queue_name = f\"{self.name}:{queue_name}\"\n\n        self.running = False\n        self.default_sleep = 0.01\n\n    def listen(\n        self,\n        worker: Annotated[\n            BaseWorker[Literal[False]],\n            Doc(\"\"\"\n                    Worker class.\n                    \"\"\"),\n        ],\n    ):\n        \"\"\"\n        Listens to the Redis queue and passes tasks to the worker.\n\n        Args:\n            worker (BaseWorker): Worker class.\n\n        Raises:\n            ValueError: Unknown task data format.\n            KeyError: Task not found.\n        \"\"\"\n        self._plugin_trigger(\"broker_listen_start\", broker=self, worker=worker)\n        self.running = True\n\n        while self.running:\n            raw = self.client.lpop(self.queue_name)\n            task_data = cast(str | list[Any] | None, raw)\n            if not task_data:\n                sleep(self.default_sleep)\n                continue\n\n            if isinstance(task_data, list):\n                raise ValueError(\"Unknown task data format.\")\n\n            task_name, uuid, priority = task_data.split(\":\")\n            uuid = UUID(uuid, version=4)\n            priority = int(priority)\n\n            self.storage.add_process(task_data, priority)\n\n            model_get = self.get(uuid=uuid)\n            if not model_get:\n                raise KeyError(f\"Task not found: {uuid}\")\n\n            args, kwargs, created_at = (\n                model_get.args or (),\n                model_get.kwargs or {},\n                model_get.created_at.timestamp(),\n            )\n            if self.log:\n                self.log.info(f\"Received new task: {uuid}\")\n\n            new_args = self._plugin_trigger(\n                \"broker_add_worker\",\n                broker=self,\n                worker=worker,\n                task_name=task_name,\n                uuid=uuid,\n                priority=int(priority),\n                args=args,\n                kw=kwargs,\n                created_at=created_at,\n                return_last=True,\n            )\n            if new_args:\n                task_name = new_args.get(\"task_name\", task_name)\n                uuid = new_args.get(\"uuid\", uuid)\n                priority = new_args.get(\"priority\", priority)\n                args = new_args.get(\"args\", args)\n                kwargs = new_args.get(\"kw\", kwargs)\n                created_at = new_args.get(\"created_at\", created_at)\n\n            worker.add(\n                name=task_name,\n                uuid=uuid,\n                priority=int(priority),\n                args=args,\n                kwargs=kwargs,\n                created_at=created_at,\n            )\n        return\n\n    def add(\n        self,\n        task_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int,\n            Doc(\"\"\"\n                    Task priority.\n\n                    Default: `0`.\n                    \"\"\"),\n        ] = 0,\n        extra: Annotated[\n            dict | None,\n            Doc(\"\"\"\n                    Additional task parameters.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        args: Annotated[\n            tuple | None,\n            Doc(\"\"\"\n                    Task arguments of type args.\n                    \"\"\"),\n        ] = None,\n        kwargs: Annotated[\n            dict | None,\n            Doc(\"\"\"\n                    Task arguments of type kwargs.\n                    \"\"\"),\n        ] = None,\n    ) -&gt; Task:\n        \"\"\"\n        Adds a task to the broker.\n\n        Args:\n            task_name (str): The name of the task.\n            priority (int, optional): Task priority. Default: 0.\n            extra (dict, optional): Additional task parameters. Default: `None`.\n            args (tuple, optional): Task arguments of type args.\n            kwargs (dict, optional): Task arguments of type kwargs.\n\n        Returns:\n            Task: `schemas.task.Task`\n\n        Raises:\n            ValueError: Invalid task status.\n        \"\"\"\n        args, kwargs = args or (), kwargs or {}\n        uuid = uuid4()\n        uuid_str = str(uuid)\n        created_at = time()\n        model = TaskStatusNewSchema(\n            task_name=task_name,\n            priority=priority,\n            created_at=created_at,\n            updated_at=created_at,\n            args=json.dumps(args),\n            kwargs=json.dumps(kwargs),\n        )\n\n        if extra:\n            model = self._dynamic_model(model=model, extra=extra)\n\n        new_model = self._plugin_trigger(\n            \"broker_add_before\",\n            broker=self,\n            storage=self.storage,\n            model=model,\n            return_last=True,\n        )\n        if new_model:\n            model = new_model.get(\"model\", model)\n\n        self.storage.add(uuid=uuid, task_status=model)\n        self.client.rpush(self.queue_name, f\"{task_name}:{uuid_str}:{priority}\")\n\n        self._plugin_trigger(\n            \"broker_add_after\", broker=self, storage=self.storage, model=model\n        )\n\n        return Task(\n            status=TaskStatusEnum.NEW.value,\n            task_name=task_name,\n            uuid=uuid,\n            priority=priority,\n            args=args,\n            kwargs=kwargs,\n            created_at=datetime.fromtimestamp(created_at),\n            updated_at=datetime.fromtimestamp(created_at),\n        )\n\n    def get(\n        self,\n        uuid: Annotated[\n            UUID | str,\n            Doc(\"\"\"\n                    UUID of the task.\n                    \"\"\"),\n        ],\n    ) -&gt; Task | None:\n        \"\"\"\n        Obtaining information about a task.\n\n        Args:\n            uuid (UUID|str): UUID of the task.\n\n        Returns:\n            Task|None: If there is task information, returns `schemas.task.Task`, otherwise `None`.\n        \"\"\"\n        if isinstance(uuid, str):\n            uuid = UUID(uuid)\n        task = self.storage.get(uuid=uuid)\n        new_task = self._plugin_trigger(\n            \"broker_get\", broker=self, task=task, return_last=True\n        )\n        if new_task:\n            task = new_task.get(\"task\", task)\n        return task\n\n    def update(\n        self,\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    Update arguments for storage type kwargs.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Updates task information.\n\n        Args:\n            kwargs (dict, optional): task data of type kwargs.\n        \"\"\"\n        new_kw = self._plugin_trigger(\n            \"broker_update\", broker=self, kw=kwargs, return_last=True\n        )\n        if new_kw:\n            kwargs = new_kw.get(\"kw\", kwargs)\n        return self.storage.update(**kwargs)\n\n    def start(\n        self,\n        worker: Annotated[\n            BaseWorker,\n            Doc(\"\"\"\n                    Worker class.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Launches the broker.\n\n        Args:\n            worker (BaseWorker): Worker class.\n        \"\"\"\n        self._plugin_trigger(\"broker_start\", broker=self, worker=worker)\n        self.storage.start()\n\n        if self.config.delete_finished_tasks:\n            self.storage._delete_finished_tasks()\n\n        if self.config.running_older_tasks:\n            self.storage._running_older_tasks(worker)\n\n        self.listen(worker)\n\n    def stop(self):\n        \"\"\"The broker stops.\"\"\"\n        self._plugin_trigger(\"broker_stop\", broker=self)\n        self.running = False\n        self.client.close()\n\n    def remove_finished_task(\n        self,\n        task_broker: Annotated[\n            TaskPrioritySchema,\n            Doc(\"\"\"\n                    Priority task diagram.\n                    \"\"\"),\n        ],\n        model: Annotated[\n            TaskStatusSuccessSchema | TaskStatusErrorSchema,\n            Doc(\"\"\"\n                    Model of the task result.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Updates storage data via the `self.storage.remove_finished_task` function.\n\n        Args:\n            task_broker (TaskPrioritySchema): The priority task schema.\n            model (TaskStatusSuccessSchema | TaskStatusErrorSchema): Model of the task result.\n        \"\"\"\n        new_model = self._plugin_trigger(\n            \"broker_remove_finished_task\",\n            broker=self,\n            storage=self.storage,\n            model=model,\n            return_last=True,\n        )\n        if new_model:\n            model = new_model.get(\"model\", model)\n\n        self.storage.remove_finished_task(task_broker, model)\n\n    def _running_older_tasks(self, worker):\n        self._plugin_trigger(\"broker_running_older_tasks\", broker=self, worker=worker)\n        return self.storage._running_older_tasks(worker)\n\n    def flush_all(self) -&gt; None:\n        \"\"\"Delete all data.\"\"\"\n        self._plugin_trigger(\"broker_flush_all\", broker=self)\n        self.storage.flush_all()\n</code></pre>"},{"location":"api/brokers/sync_redisbroker/#qtasks.brokers.sync_redis.SyncRedisBroker.__init__","title":"<code>__init__(name='QueueTasks', url=None, storage=None, queue_name='task_queue', log=None, config=None, events=None)</code>","text":"<p>Initializing SyncRedisBroker.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Project name. Default: <code>QueueTasks</code>.</p> <code>'QueueTasks'</code> <code>url</code> <code>str</code> <p>URL to connect to Redis. Default: <code>None</code>.</p> <code>None</code> <code>storage</code> <code>BaseStorage</code> <p>Storage. Default: <code>None</code>.</p> <code>None</code> <code>queue_name</code> <code>str</code> <p>Name of the task queue array for Redis. Default: <code>task_queue</code>.</p> <code>'task_queue'</code> <code>log</code> <code>Logger</code> <p>Logger. Default: <code>None</code>.</p> <code>None</code> <code>config</code> <code>QueueConfig</code> <p>Config. Default: <code>None</code>.</p> <code>None</code> <code>events</code> <code>BaseEvents</code> <p>Events. Default: <code>qtasks.events.SyncEvents</code>.</p> <code>None</code> Source code in <code>src/qtasks/brokers/sync_redis.py</code> <pre><code>def __init__(\n    self,\n    name: Annotated[\n        str,\n        Doc(\"\"\"\n                Project name. This name is also used by the broker.\n\n                Default: `QueueTasks`.\n                \"\"\"),\n    ] = \"QueueTasks\",\n    url: Annotated[\n        str | None,\n        Doc(\"\"\"\n                URL to connect to Redis.\n\n                Default: `redis://localhost:6379/0`.\n                \"\"\"),\n    ] = None,\n    storage: Annotated[\n        Optional[BaseStorage],\n        Doc(\"\"\"\n                Storage.\n\n                Default: `AsyncRedisStorage`.\n                \"\"\"),\n    ] = None,\n    queue_name: Annotated[\n        str,\n        Doc(\"\"\"\n                The name of the task queue array for Redis. The title is updated to: `name:queue_name`\n\n                Default: `task_queue`.\n                \"\"\"),\n    ] = \"task_queue\",\n    log: Annotated[\n        Logger | None,\n        Doc(\"\"\"\n                Logger.\n\n                Default: `qtasks.logs.Logger`.\n                \"\"\"),\n    ] = None,\n    config: Annotated[\n        QueueConfig | None,\n        Doc(\"\"\"\n                Config.\n\n                Default: `qtasks.configs.config.QueueConfig`.\n                \"\"\"),\n    ] = None,\n    events: Annotated[\n        Optional[BaseEvents],\n        Doc(\"\"\"\n                Events.\n\n                Default: `qtasks.events.SyncEvents`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    Initializing SyncRedisBroker.\n\n    Args:\n        name (str, optional): Project name. Default: `QueueTasks`.\n        url (str, optional): URL to connect to Redis. Default: `None`.\n        storage (BaseStorage, optional): Storage. Default: `None`.\n        queue_name (str, optional): Name of the task queue array for Redis. Default: `task_queue`.\n        log (Logger, optional): Logger. Default: `None`.\n        config (QueueConfig, optional): Config. Default: `None`.\n        events (BaseEvents, optional): Events. Default: `qtasks.events.SyncEvents`.\n    \"\"\"\n    self.url = url or \"redis://localhost:6379/0\"\n    self.client = redis.Redis.from_url(\n        self.url, decode_responses=True, encoding=\"utf-8\"\n    )\n    storage = storage or SyncRedisStorage(\n        name=name,\n        url=self.url,\n        redis_connect=self.client,\n        log=log,\n        config=config,\n    )\n    events = events or SyncEvents()\n\n    super().__init__(\n        name=name, log=log, config=config, events=events, storage=storage\n    )\n\n    self.storage: BaseStorage[Literal[False]]\n\n    self.queue_name = f\"{self.name}:{queue_name}\"\n\n    self.running = False\n    self.default_sleep = 0.01\n</code></pre>"},{"location":"api/brokers/sync_redisbroker/#qtasks.brokers.sync_redis.SyncRedisBroker.add","title":"<code>add(task_name, priority=0, extra=None, args=None, kwargs=None)</code>","text":"<p>Adds a task to the broker.</p> <p>Parameters:</p> Name Type Description Default <code>task_name</code> <code>str</code> <p>The name of the task.</p> required <code>priority</code> <code>int</code> <p>Task priority. Default: 0.</p> <code>0</code> <code>extra</code> <code>dict</code> <p>Additional task parameters. Default: <code>None</code>.</p> <code>None</code> <code>args</code> <code>tuple</code> <p>Task arguments of type args.</p> <code>None</code> <code>kwargs</code> <code>dict</code> <p>Task arguments of type kwargs.</p> <code>None</code> <p>Returns:</p> Name Type Description <code>Task</code> <code>Task</code> <p><code>schemas.task.Task</code></p> <p>Raises:</p> Type Description <code>ValueError</code> <p>Invalid task status.</p> Source code in <code>src/qtasks/brokers/sync_redis.py</code> <pre><code>def add(\n    self,\n    task_name: Annotated[\n        str,\n        Doc(\"\"\"\n                Task name.\n                \"\"\"),\n    ],\n    priority: Annotated[\n        int,\n        Doc(\"\"\"\n                Task priority.\n\n                Default: `0`.\n                \"\"\"),\n    ] = 0,\n    extra: Annotated[\n        dict | None,\n        Doc(\"\"\"\n                Additional task parameters.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    args: Annotated[\n        tuple | None,\n        Doc(\"\"\"\n                Task arguments of type args.\n                \"\"\"),\n    ] = None,\n    kwargs: Annotated[\n        dict | None,\n        Doc(\"\"\"\n                Task arguments of type kwargs.\n                \"\"\"),\n    ] = None,\n) -&gt; Task:\n    \"\"\"\n    Adds a task to the broker.\n\n    Args:\n        task_name (str): The name of the task.\n        priority (int, optional): Task priority. Default: 0.\n        extra (dict, optional): Additional task parameters. Default: `None`.\n        args (tuple, optional): Task arguments of type args.\n        kwargs (dict, optional): Task arguments of type kwargs.\n\n    Returns:\n        Task: `schemas.task.Task`\n\n    Raises:\n        ValueError: Invalid task status.\n    \"\"\"\n    args, kwargs = args or (), kwargs or {}\n    uuid = uuid4()\n    uuid_str = str(uuid)\n    created_at = time()\n    model = TaskStatusNewSchema(\n        task_name=task_name,\n        priority=priority,\n        created_at=created_at,\n        updated_at=created_at,\n        args=json.dumps(args),\n        kwargs=json.dumps(kwargs),\n    )\n\n    if extra:\n        model = self._dynamic_model(model=model, extra=extra)\n\n    new_model = self._plugin_trigger(\n        \"broker_add_before\",\n        broker=self,\n        storage=self.storage,\n        model=model,\n        return_last=True,\n    )\n    if new_model:\n        model = new_model.get(\"model\", model)\n\n    self.storage.add(uuid=uuid, task_status=model)\n    self.client.rpush(self.queue_name, f\"{task_name}:{uuid_str}:{priority}\")\n\n    self._plugin_trigger(\n        \"broker_add_after\", broker=self, storage=self.storage, model=model\n    )\n\n    return Task(\n        status=TaskStatusEnum.NEW.value,\n        task_name=task_name,\n        uuid=uuid,\n        priority=priority,\n        args=args,\n        kwargs=kwargs,\n        created_at=datetime.fromtimestamp(created_at),\n        updated_at=datetime.fromtimestamp(created_at),\n    )\n</code></pre>"},{"location":"api/brokers/sync_redisbroker/#qtasks.brokers.sync_redis.SyncRedisBroker.flush_all","title":"<code>flush_all()</code>","text":"<p>Delete all data.</p> Source code in <code>src/qtasks/brokers/sync_redis.py</code> <pre><code>def flush_all(self) -&gt; None:\n    \"\"\"Delete all data.\"\"\"\n    self._plugin_trigger(\"broker_flush_all\", broker=self)\n    self.storage.flush_all()\n</code></pre>"},{"location":"api/brokers/sync_redisbroker/#qtasks.brokers.sync_redis.SyncRedisBroker.get","title":"<code>get(uuid)</code>","text":"<p>Obtaining information about a task.</p> <p>Parameters:</p> Name Type Description Default <code>uuid</code> <code>UUID | str</code> <p>UUID of the task.</p> required <p>Returns:</p> Type Description <code>Task | None</code> <p>Task|None: If there is task information, returns <code>schemas.task.Task</code>, otherwise <code>None</code>.</p> Source code in <code>src/qtasks/brokers/sync_redis.py</code> <pre><code>def get(\n    self,\n    uuid: Annotated[\n        UUID | str,\n        Doc(\"\"\"\n                UUID of the task.\n                \"\"\"),\n    ],\n) -&gt; Task | None:\n    \"\"\"\n    Obtaining information about a task.\n\n    Args:\n        uuid (UUID|str): UUID of the task.\n\n    Returns:\n        Task|None: If there is task information, returns `schemas.task.Task`, otherwise `None`.\n    \"\"\"\n    if isinstance(uuid, str):\n        uuid = UUID(uuid)\n    task = self.storage.get(uuid=uuid)\n    new_task = self._plugin_trigger(\n        \"broker_get\", broker=self, task=task, return_last=True\n    )\n    if new_task:\n        task = new_task.get(\"task\", task)\n    return task\n</code></pre>"},{"location":"api/brokers/sync_redisbroker/#qtasks.brokers.sync_redis.SyncRedisBroker.listen","title":"<code>listen(worker)</code>","text":"<p>Listens to the Redis queue and passes tasks to the worker.</p> <p>Parameters:</p> Name Type Description Default <code>worker</code> <code>BaseWorker</code> <p>Worker class.</p> required <p>Raises:</p> Type Description <code>ValueError</code> <p>Unknown task data format.</p> <code>KeyError</code> <p>Task not found.</p> Source code in <code>src/qtasks/brokers/sync_redis.py</code> <pre><code>def listen(\n    self,\n    worker: Annotated[\n        BaseWorker[Literal[False]],\n        Doc(\"\"\"\n                Worker class.\n                \"\"\"),\n    ],\n):\n    \"\"\"\n    Listens to the Redis queue and passes tasks to the worker.\n\n    Args:\n        worker (BaseWorker): Worker class.\n\n    Raises:\n        ValueError: Unknown task data format.\n        KeyError: Task not found.\n    \"\"\"\n    self._plugin_trigger(\"broker_listen_start\", broker=self, worker=worker)\n    self.running = True\n\n    while self.running:\n        raw = self.client.lpop(self.queue_name)\n        task_data = cast(str | list[Any] | None, raw)\n        if not task_data:\n            sleep(self.default_sleep)\n            continue\n\n        if isinstance(task_data, list):\n            raise ValueError(\"Unknown task data format.\")\n\n        task_name, uuid, priority = task_data.split(\":\")\n        uuid = UUID(uuid, version=4)\n        priority = int(priority)\n\n        self.storage.add_process(task_data, priority)\n\n        model_get = self.get(uuid=uuid)\n        if not model_get:\n            raise KeyError(f\"Task not found: {uuid}\")\n\n        args, kwargs, created_at = (\n            model_get.args or (),\n            model_get.kwargs or {},\n            model_get.created_at.timestamp(),\n        )\n        if self.log:\n            self.log.info(f\"Received new task: {uuid}\")\n\n        new_args = self._plugin_trigger(\n            \"broker_add_worker\",\n            broker=self,\n            worker=worker,\n            task_name=task_name,\n            uuid=uuid,\n            priority=int(priority),\n            args=args,\n            kw=kwargs,\n            created_at=created_at,\n            return_last=True,\n        )\n        if new_args:\n            task_name = new_args.get(\"task_name\", task_name)\n            uuid = new_args.get(\"uuid\", uuid)\n            priority = new_args.get(\"priority\", priority)\n            args = new_args.get(\"args\", args)\n            kwargs = new_args.get(\"kw\", kwargs)\n            created_at = new_args.get(\"created_at\", created_at)\n\n        worker.add(\n            name=task_name,\n            uuid=uuid,\n            priority=int(priority),\n            args=args,\n            kwargs=kwargs,\n            created_at=created_at,\n        )\n    return\n</code></pre>"},{"location":"api/brokers/sync_redisbroker/#qtasks.brokers.sync_redis.SyncRedisBroker.remove_finished_task","title":"<code>remove_finished_task(task_broker, model)</code>","text":"<p>Updates storage data via the <code>self.storage.remove_finished_task</code> function.</p> <p>Parameters:</p> Name Type Description Default <code>task_broker</code> <code>TaskPrioritySchema</code> <p>The priority task schema.</p> required <code>model</code> <code>TaskStatusSuccessSchema | TaskStatusErrorSchema</code> <p>Model of the task result.</p> required Source code in <code>src/qtasks/brokers/sync_redis.py</code> <pre><code>def remove_finished_task(\n    self,\n    task_broker: Annotated[\n        TaskPrioritySchema,\n        Doc(\"\"\"\n                Priority task diagram.\n                \"\"\"),\n    ],\n    model: Annotated[\n        TaskStatusSuccessSchema | TaskStatusErrorSchema,\n        Doc(\"\"\"\n                Model of the task result.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Updates storage data via the `self.storage.remove_finished_task` function.\n\n    Args:\n        task_broker (TaskPrioritySchema): The priority task schema.\n        model (TaskStatusSuccessSchema | TaskStatusErrorSchema): Model of the task result.\n    \"\"\"\n    new_model = self._plugin_trigger(\n        \"broker_remove_finished_task\",\n        broker=self,\n        storage=self.storage,\n        model=model,\n        return_last=True,\n    )\n    if new_model:\n        model = new_model.get(\"model\", model)\n\n    self.storage.remove_finished_task(task_broker, model)\n</code></pre>"},{"location":"api/brokers/sync_redisbroker/#qtasks.brokers.sync_redis.SyncRedisBroker.start","title":"<code>start(worker)</code>","text":"<p>Launches the broker.</p> <p>Parameters:</p> Name Type Description Default <code>worker</code> <code>BaseWorker</code> <p>Worker class.</p> required Source code in <code>src/qtasks/brokers/sync_redis.py</code> <pre><code>def start(\n    self,\n    worker: Annotated[\n        BaseWorker,\n        Doc(\"\"\"\n                Worker class.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Launches the broker.\n\n    Args:\n        worker (BaseWorker): Worker class.\n    \"\"\"\n    self._plugin_trigger(\"broker_start\", broker=self, worker=worker)\n    self.storage.start()\n\n    if self.config.delete_finished_tasks:\n        self.storage._delete_finished_tasks()\n\n    if self.config.running_older_tasks:\n        self.storage._running_older_tasks(worker)\n\n    self.listen(worker)\n</code></pre>"},{"location":"api/brokers/sync_redisbroker/#qtasks.brokers.sync_redis.SyncRedisBroker.stop","title":"<code>stop()</code>","text":"<p>The broker stops.</p> Source code in <code>src/qtasks/brokers/sync_redis.py</code> <pre><code>def stop(self):\n    \"\"\"The broker stops.\"\"\"\n    self._plugin_trigger(\"broker_stop\", broker=self)\n    self.running = False\n    self.client.close()\n</code></pre>"},{"location":"api/brokers/sync_redisbroker/#qtasks.brokers.sync_redis.SyncRedisBroker.update","title":"<code>update(**kwargs)</code>","text":"<p>Updates task information.</p> <p>Parameters:</p> Name Type Description Default <code>kwargs</code> <code>dict</code> <p>task data of type kwargs.</p> <code>{}</code> Source code in <code>src/qtasks/brokers/sync_redis.py</code> <pre><code>def update(\n    self,\n    **kwargs: Annotated[\n        Any,\n        Doc(\"\"\"\n                Update arguments for storage type kwargs.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Updates task information.\n\n    Args:\n        kwargs (dict, optional): task data of type kwargs.\n    \"\"\"\n    new_kw = self._plugin_trigger(\n        \"broker_update\", broker=self, kw=kwargs, return_last=True\n    )\n    if new_kw:\n        kwargs = new_kw.get(\"kw\", kwargs)\n    return self.storage.update(**kwargs)\n</code></pre>"},{"location":"api/brokers/sync_socket/","title":"SyncSocketBroker","text":"<p>Sync Socket Broker.</p>"},{"location":"api/brokers/sync_socket/#qtasks.brokers.sync_socket.SyncSocketBroker","title":"<code>SyncSocketBroker</code>","text":"<p>               Bases: <code>BaseBroker</code>, <code>SyncPluginMixin</code></p> <p>A broker that listens to sockets and adds tasks to the queue.</p>"},{"location":"api/brokers/sync_socket/#qtasks.brokers.sync_socket.SyncSocketBroker--example","title":"Example","text":"<pre><code>from qtasks import QueueTasks\nfrom qtasks.brokers import SyncSocketBroker\n\nbroker = SyncSocketBroker(name=\"QueueTasks\", url=\"127.0.0.1\")\n\napp = QueueTasks(broker=broker)\n</code></pre> Source code in <code>src/qtasks/brokers/sync_socket.py</code> <pre><code>class SyncSocketBroker(BaseBroker, SyncPluginMixin):\n    \"\"\"\n    A broker that listens to sockets and adds tasks to the queue.\n\n    ## Example\n\n    ```python\n    from qtasks import QueueTasks\n    from qtasks.brokers import SyncSocketBroker\n\n    broker = SyncSocketBroker(name=\"QueueTasks\", url=\"127.0.0.1\")\n\n    app = QueueTasks(broker=broker)\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Project name. This name is also used by the broker.\n\n                    Default: `QueueTasks`.\n                    \"\"\"),\n        ] = \"QueueTasks\",\n        url: Annotated[\n            str,\n            Doc(\"\"\"\n                    URL to connect to the socket.\n\n                    Default: `127.0.0.1`.\n                    \"\"\"),\n        ] = \"127.0.0.1\",\n        port: Annotated[\n            int,\n            Doc(\"\"\"\n                    Port for connecting to a socket.\n\n                    Default: `6379`.\n                    \"\"\"),\n        ] = 6379,\n        storage: Annotated[\n            Optional[BaseStorage],\n            Doc(\"\"\"\n                    Storage.\n\n                    Default: `AsyncRedisStorage`.\n                    \"\"\"),\n        ] = None,\n        log: Annotated[\n            Logger | None,\n            Doc(\"\"\"\n                    Logger.\n\n                    Default: `qtasks.logs.Logger`.\n                    \"\"\"),\n        ] = None,\n        config: Annotated[\n            QueueConfig | None,\n            Doc(\"\"\"\n                    Config.\n\n                    Default: `qtasks.configs.config.QueueConfig`.\n                    \"\"\"),\n        ] = None,\n        events: Annotated[\n            Optional[BaseEvents],\n            Doc(\"\"\"\n                    Events.\n\n                    Default: `qtasks.events.AsyncEvents`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Initializing SyncSocketBroker.\n\n        Args:\n            name (str, optional): Project name. Default: `QueueTasks`.\n            url (str, optional): URL to connect to the socket. Default: `127.0.0.1`.\n            port (int, optional): Port to connect to the socket. Default: `6379`.\n            storage (BaseStorage, optional): Storage. Default: `None`.\n            log (Logger, optional): Logger. Default: `None`.\n            config (QueueConfig, optional): Config. Default: `None`.\n            events (BaseEvents, optional): Events. Default: `qtasks.events.SyncEvents`.\n        \"\"\"\n        self.url = url\n        self.port = port\n        storage = storage or SyncRedisStorage(\n            name=name, log=log, config=config, events=events\n        )\n        super().__init__(\n            name=name, log=log, config=config, events=events, storage=storage\n        )\n\n        self.storage: BaseStorage[Literal[False]]\n\n        self.events = self.events or SyncEvents()\n\n        self.client = None\n        self.default_sleep = 0.01\n        self.running = False\n\n        self.queue = Queue()\n        self._serve_task = None\n        self._listen_task = None\n\n    def handle_connection(self, reader, writer):\n        \"\"\"\n        Handles an incoming connection.\n\n        Args:\n            reader: Reader for incoming data.\n            writer: Writer for outgoing data.\n        \"\"\"\n        conn = reader\n        try:\n            data = conn.recv(4096)\n            if not data:\n                return\n            message = json.loads(data.decode())\n            task_name = message[\"task_name\"]\n            uuid = message[\"uuid\"]\n            priority = message[\"priority\"]\n            args = message.get(\"args\", ())\n            kwargs = message.get(\"kwargs\", {})\n            created_at = message[\"created_at\"]\n\n            self.storage.add(\n                uuid=uuid,\n                task_status=TaskStatusNewSchema(\n                    task_name=task_name,\n                    priority=priority,\n                    args=args,\n                    kwargs=kwargs,\n                    created_at=created_at,\n                    updated_at=created_at,\n                ),\n            )\n\n            self.queue.put((task_name, uuid, priority))\n            conn.sendall(b\"OK\")\n        finally:\n            with contextlib.suppress(Exception):\n                conn.shutdown(socket.SHUT_RDWR)\n                conn.close()\n\n    def listen(\n        self,\n        worker: Annotated[\n            BaseWorker[Literal[False]],\n            Doc(\"\"\"\n                    Worker class.\n                    \"\"\"),\n        ],\n    ):\n        \"\"\"\n        Listens to the socket queue and transfers tasks to the worker.\n\n        Args:\n            worker (BaseWorker): Worker class.\n\n        Raises:\n            KeyError: Task not found.\n        \"\"\"\n        self._plugin_trigger(\"broker_listen_start\", broker=self, worker=worker)\n        self.running = True\n\n        while self.running:\n            try:\n                item = self.queue.get(timeout=0.1)\n            except Empty:\n                continue\n            if item is None:\n                break\n\n            task_name, uuid, priority = item\n            model_get = self.get(uuid=uuid)\n            if not model_get:\n                raise KeyError(f\"Task not found: {uuid}\")\n\n            args, kwargs, created_at = (\n                model_get.args or (),\n                model_get.kwargs or {},\n                model_get.created_at.timestamp(),\n            )\n\n            self.storage.add_process(f\"{task_name}:{uuid}:{priority}\", priority)\n\n            if self.log:\n                self.log.info(f\"Received new task: {uuid}\")\n            new_args = self._plugin_trigger(\n                \"broker_add_worker\",\n                broker=self,\n                worker=worker,\n                task_name=task_name,\n                uuid=uuid,\n                priority=int(priority),\n                args=args,\n                kw=kwargs,\n                created_at=created_at,\n                return_last=True,\n            )\n            if new_args:\n                task_name = new_args.get(\"task_name\", task_name)\n                uuid = new_args.get(\"uuid\", uuid)\n                priority = new_args.get(\"priority\", priority)\n                args = new_args.get(\"args\", args)\n                kwargs = new_args.get(\"kw\", kwargs)\n                created_at = new_args.get(\"created_at\", created_at)\n            worker.add(\n                name=task_name,\n                uuid=uuid,\n                priority=int(priority),\n                args=args,\n                kwargs=kwargs,\n                created_at=created_at,\n            )\n\n    def add(\n        self,\n        task_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int,\n            Doc(\"\"\"\n                    Task priority.\n\n                    Default: `0`.\n                    \"\"\"),\n        ] = 0,\n        extra: Annotated[\n            dict | None,\n            Doc(\"\"\"\n                    Additional task parameters.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        args: Annotated[\n            tuple | None,\n            Doc(\"\"\"\n                    Task arguments of type args.\n\n                    Default: `()`.\n                    \"\"\"),\n        ] = None,\n        kwargs: Annotated[\n            dict | None,\n            Doc(\"\"\"\n                    Task arguments of type kwargs.\n\n                    Default: `{}`.\n                    \"\"\"),\n        ] = None,\n    ) -&gt; Task:\n        \"\"\"\n        Adds a task to the broker.\n\n        Args:\n            task_name (str): The name of the task.\n            priority (int, optional): Task priority. By default: 0.\n            extra (dict, optional): Additional task parameters. Default: `None`.\n            args (tuple, optional): Task arguments of type args. Default: `()`.\n            kwargs (dict, optional): Task arguments of type kwargs. Default: `{}`.\n\n        Returns:\n            Task: `schemas.task.Task`\n\n        Raises:\n            ValueError: Invalid task status.\n        \"\"\"\n        atexit.register(self.stop)\n        atexit.register(self.storage.stop)\n\n        args, kwargs = args or (), kwargs or {}\n        uuid = uuid4()\n        uuid_str = str(uuid)\n        created_at = time()\n        model = TaskStatusNewSchema(\n            task_name=task_name,\n            priority=priority,\n            created_at=created_at,\n            updated_at=created_at,\n            args=json.dumps(args),\n            kwargs=json.dumps(kwargs),\n        )\n\n        if extra:\n            model = self._dynamic_model(model=model, extra=extra)\n\n        new_model = self._plugin_trigger(\n            \"broker_add_before\", broker=self, storage=self.storage, model=model\n        )\n        if new_model:\n            model = new_model.get(\"model\", model)\n\n        with socket.create_connection((self.url, self.port)) as s:\n            payload = asdict(model)\n            payload.update({\"uuid\": uuid_str})\n            s.sendall(json.dumps(payload).encode())\n            try:\n                s.settimeout(2.0)\n                _ = s.recv(1024)\n            except Exception:\n                pass\n\n        self._plugin_trigger(\n            \"broker_add_after\", broker=self, storage=self.storage, model=model\n        )\n        return Task(\n            status=TaskStatusEnum.NEW.value,\n            task_name=task_name,\n            uuid=uuid,\n            priority=priority,\n            args=args,\n            kwargs=kwargs,\n            created_at=datetime.fromtimestamp(created_at),\n            updated_at=datetime.fromtimestamp(created_at),\n        )\n\n    def get(\n        self,\n        uuid: Annotated[\n            UUID | str,\n            Doc(\"\"\"\n                    UUID of the task.\n                    \"\"\"),\n        ],\n    ) -&gt; Task | None:\n        \"\"\"\n        Obtaining information about a task.\n\n        Args:\n            uuid (UUID|str): UUID of the task.\n\n        Returns:\n            Task|None: If there is task information, returns `schemas.task.Task`, otherwise `None`.\n        \"\"\"\n        if isinstance(uuid, str):\n            uuid = UUID(uuid)\n        task = self.storage.get(uuid=uuid)\n        new_task = self._plugin_trigger(\n            \"broker_get\", broker=self, task=task, return_last=True\n        )\n        if new_task:\n            task = new_task.get(\"task\", task)\n        return task\n\n    def update(\n        self,\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    Update arguments for storage type kwargs.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Updates task information.\n\n        Args:\n            kwargs (dict, optional): task data of type kwargs.\n        \"\"\"\n        new_kw = self._plugin_trigger(\n            \"broker_update\", broker=self, kw=kwargs, return_last=True\n        )\n        if new_kw:\n            kwargs = new_kw.get(\"kw\", kwargs)\n        return self.storage.update(**kwargs)\n\n    def start(\n        self,\n        worker: Annotated[\n            BaseWorker,\n            Doc(\"\"\"\n                    Worker class.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Launches the broker.\n\n        Args:\n            worker (BaseWorker): Worker class.\n\n        Raises:\n            RuntimeError: self.client is not initialized.\n        \"\"\"\n        self._plugin_trigger(\"broker_start\", broker=self, worker=worker)\n        self.storage.start()\n\n        if self.config.delete_finished_tasks:\n            self.storage._delete_finished_tasks()\n\n        if self.config.running_older_tasks:\n            self.storage._running_older_tasks(worker)\n\n        self.client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n        self.client.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)\n        self.client.bind((self.url, self.port))\n        self.client.listen(128)\n        self.running = True\n\n        self._listen_task = threading.Thread(\n            target=self.listen, args=(worker,), name=\"broker-listen\", daemon=True\n        )\n        self._listen_task.start()\n\n        def _serve():\n            if not self.client:\n                raise RuntimeError(\"self.client is not initialized.\")\n\n            while self.running:\n                try:\n                    conn, _addr = self.client.accept()\n                except OSError:\n                    break\n                try:\n                    self.handle_connection(conn, conn)\n                except Exception:\n                    with contextlib.suppress(Exception):\n                        conn.close()\n\n        self._serve_task = threading.Thread(\n            target=_serve, name=\"broker-serve\", daemon=True\n        )\n        self._serve_task.start()\n\n        try:\n            while self._serve_task.is_alive():\n                self._serve_task.join(timeout=0.5)\n        except KeyboardInterrupt:\n            pass\n\n    def stop(self):\n        \"\"\"The broker stops.\"\"\"\n        self._plugin_trigger(\"broker_stop\", broker=self)\n        self.running = False\n\n        with contextlib.suppress(Exception):\n            self.queue.put_nowait(None)\n\n        if self.client:\n            with contextlib.suppress(Exception):\n                self.client.shutdown(socket.SHUT_RDWR)\n                self.client.close()\n\n            self.client = None\n\n        if self._serve_task and self._serve_task.is_alive():\n            with contextlib.suppress(Exception):\n                self._serve_task.join(timeout=2.0)\n\n        if self._listen_task and self._listen_task.is_alive():\n            with contextlib.suppress(Exception):\n                self._listen_task.join(timeout=2.0)\n\n    def remove_finished_task(\n        self,\n        task_broker: Annotated[\n            TaskPrioritySchema,\n            Doc(\"\"\"\n                    Priority task diagram.\n                    \"\"\"),\n        ],\n        model: Annotated[\n            TaskStatusSuccessSchema | TaskStatusErrorSchema,\n            Doc(\"\"\"\n                    Model of the task result.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Updates storage data via the `self.storage.remove_finished_task` function.\n\n        Args:\n            task_broker (TaskPrioritySchema): The priority task schema.\n            model (TaskStatusSuccessSchema | TaskStatusErrorSchema): Model of the task result.\n        \"\"\"\n        new_model = self._plugin_trigger(\n            \"broker_remove_finished_task\",\n            broker=self,\n            storage=self.storage,\n            model=model,\n            return_last=True,\n        )\n        if new_model:\n            model = new_model.get(\"model\", model)\n\n        self.storage.remove_finished_task(task_broker, model)\n        return\n\n    def _running_older_tasks(self, worker):\n        self._plugin_trigger(\"broker_running_older_tasks\", broker=self, worker=worker)\n        return self.storage._running_older_tasks(worker)\n\n    def flush_all(self) -&gt; None:\n        \"\"\"Delete all data.\"\"\"\n        self._plugin_trigger(\"broker_flush_all\", broker=self)\n        self.storage.flush_all()\n</code></pre>"},{"location":"api/brokers/sync_socket/#qtasks.brokers.sync_socket.SyncSocketBroker.__init__","title":"<code>__init__(name='QueueTasks', url='127.0.0.1', port=6379, storage=None, log=None, config=None, events=None)</code>","text":"<p>Initializing SyncSocketBroker.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Project name. Default: <code>QueueTasks</code>.</p> <code>'QueueTasks'</code> <code>url</code> <code>str</code> <p>URL to connect to the socket. Default: <code>127.0.0.1</code>.</p> <code>'127.0.0.1'</code> <code>port</code> <code>int</code> <p>Port to connect to the socket. Default: <code>6379</code>.</p> <code>6379</code> <code>storage</code> <code>BaseStorage</code> <p>Storage. Default: <code>None</code>.</p> <code>None</code> <code>log</code> <code>Logger</code> <p>Logger. Default: <code>None</code>.</p> <code>None</code> <code>config</code> <code>QueueConfig</code> <p>Config. Default: <code>None</code>.</p> <code>None</code> <code>events</code> <code>BaseEvents</code> <p>Events. Default: <code>qtasks.events.SyncEvents</code>.</p> <code>None</code> Source code in <code>src/qtasks/brokers/sync_socket.py</code> <pre><code>def __init__(\n    self,\n    name: Annotated[\n        str,\n        Doc(\"\"\"\n                Project name. This name is also used by the broker.\n\n                Default: `QueueTasks`.\n                \"\"\"),\n    ] = \"QueueTasks\",\n    url: Annotated[\n        str,\n        Doc(\"\"\"\n                URL to connect to the socket.\n\n                Default: `127.0.0.1`.\n                \"\"\"),\n    ] = \"127.0.0.1\",\n    port: Annotated[\n        int,\n        Doc(\"\"\"\n                Port for connecting to a socket.\n\n                Default: `6379`.\n                \"\"\"),\n    ] = 6379,\n    storage: Annotated[\n        Optional[BaseStorage],\n        Doc(\"\"\"\n                Storage.\n\n                Default: `AsyncRedisStorage`.\n                \"\"\"),\n    ] = None,\n    log: Annotated[\n        Logger | None,\n        Doc(\"\"\"\n                Logger.\n\n                Default: `qtasks.logs.Logger`.\n                \"\"\"),\n    ] = None,\n    config: Annotated[\n        QueueConfig | None,\n        Doc(\"\"\"\n                Config.\n\n                Default: `qtasks.configs.config.QueueConfig`.\n                \"\"\"),\n    ] = None,\n    events: Annotated[\n        Optional[BaseEvents],\n        Doc(\"\"\"\n                Events.\n\n                Default: `qtasks.events.AsyncEvents`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    Initializing SyncSocketBroker.\n\n    Args:\n        name (str, optional): Project name. Default: `QueueTasks`.\n        url (str, optional): URL to connect to the socket. Default: `127.0.0.1`.\n        port (int, optional): Port to connect to the socket. Default: `6379`.\n        storage (BaseStorage, optional): Storage. Default: `None`.\n        log (Logger, optional): Logger. Default: `None`.\n        config (QueueConfig, optional): Config. Default: `None`.\n        events (BaseEvents, optional): Events. Default: `qtasks.events.SyncEvents`.\n    \"\"\"\n    self.url = url\n    self.port = port\n    storage = storage or SyncRedisStorage(\n        name=name, log=log, config=config, events=events\n    )\n    super().__init__(\n        name=name, log=log, config=config, events=events, storage=storage\n    )\n\n    self.storage: BaseStorage[Literal[False]]\n\n    self.events = self.events or SyncEvents()\n\n    self.client = None\n    self.default_sleep = 0.01\n    self.running = False\n\n    self.queue = Queue()\n    self._serve_task = None\n    self._listen_task = None\n</code></pre>"},{"location":"api/brokers/sync_socket/#qtasks.brokers.sync_socket.SyncSocketBroker.add","title":"<code>add(task_name, priority=0, extra=None, args=None, kwargs=None)</code>","text":"<p>Adds a task to the broker.</p> <p>Parameters:</p> Name Type Description Default <code>task_name</code> <code>str</code> <p>The name of the task.</p> required <code>priority</code> <code>int</code> <p>Task priority. By default: 0.</p> <code>0</code> <code>extra</code> <code>dict</code> <p>Additional task parameters. Default: <code>None</code>.</p> <code>None</code> <code>args</code> <code>tuple</code> <p>Task arguments of type args. Default: <code>()</code>.</p> <code>None</code> <code>kwargs</code> <code>dict</code> <p>Task arguments of type kwargs. Default: <code>{}</code>.</p> <code>None</code> <p>Returns:</p> Name Type Description <code>Task</code> <code>Task</code> <p><code>schemas.task.Task</code></p> <p>Raises:</p> Type Description <code>ValueError</code> <p>Invalid task status.</p> Source code in <code>src/qtasks/brokers/sync_socket.py</code> <pre><code>def add(\n    self,\n    task_name: Annotated[\n        str,\n        Doc(\"\"\"\n                Task name.\n                \"\"\"),\n    ],\n    priority: Annotated[\n        int,\n        Doc(\"\"\"\n                Task priority.\n\n                Default: `0`.\n                \"\"\"),\n    ] = 0,\n    extra: Annotated[\n        dict | None,\n        Doc(\"\"\"\n                Additional task parameters.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    args: Annotated[\n        tuple | None,\n        Doc(\"\"\"\n                Task arguments of type args.\n\n                Default: `()`.\n                \"\"\"),\n    ] = None,\n    kwargs: Annotated[\n        dict | None,\n        Doc(\"\"\"\n                Task arguments of type kwargs.\n\n                Default: `{}`.\n                \"\"\"),\n    ] = None,\n) -&gt; Task:\n    \"\"\"\n    Adds a task to the broker.\n\n    Args:\n        task_name (str): The name of the task.\n        priority (int, optional): Task priority. By default: 0.\n        extra (dict, optional): Additional task parameters. Default: `None`.\n        args (tuple, optional): Task arguments of type args. Default: `()`.\n        kwargs (dict, optional): Task arguments of type kwargs. Default: `{}`.\n\n    Returns:\n        Task: `schemas.task.Task`\n\n    Raises:\n        ValueError: Invalid task status.\n    \"\"\"\n    atexit.register(self.stop)\n    atexit.register(self.storage.stop)\n\n    args, kwargs = args or (), kwargs or {}\n    uuid = uuid4()\n    uuid_str = str(uuid)\n    created_at = time()\n    model = TaskStatusNewSchema(\n        task_name=task_name,\n        priority=priority,\n        created_at=created_at,\n        updated_at=created_at,\n        args=json.dumps(args),\n        kwargs=json.dumps(kwargs),\n    )\n\n    if extra:\n        model = self._dynamic_model(model=model, extra=extra)\n\n    new_model = self._plugin_trigger(\n        \"broker_add_before\", broker=self, storage=self.storage, model=model\n    )\n    if new_model:\n        model = new_model.get(\"model\", model)\n\n    with socket.create_connection((self.url, self.port)) as s:\n        payload = asdict(model)\n        payload.update({\"uuid\": uuid_str})\n        s.sendall(json.dumps(payload).encode())\n        try:\n            s.settimeout(2.0)\n            _ = s.recv(1024)\n        except Exception:\n            pass\n\n    self._plugin_trigger(\n        \"broker_add_after\", broker=self, storage=self.storage, model=model\n    )\n    return Task(\n        status=TaskStatusEnum.NEW.value,\n        task_name=task_name,\n        uuid=uuid,\n        priority=priority,\n        args=args,\n        kwargs=kwargs,\n        created_at=datetime.fromtimestamp(created_at),\n        updated_at=datetime.fromtimestamp(created_at),\n    )\n</code></pre>"},{"location":"api/brokers/sync_socket/#qtasks.brokers.sync_socket.SyncSocketBroker.flush_all","title":"<code>flush_all()</code>","text":"<p>Delete all data.</p> Source code in <code>src/qtasks/brokers/sync_socket.py</code> <pre><code>def flush_all(self) -&gt; None:\n    \"\"\"Delete all data.\"\"\"\n    self._plugin_trigger(\"broker_flush_all\", broker=self)\n    self.storage.flush_all()\n</code></pre>"},{"location":"api/brokers/sync_socket/#qtasks.brokers.sync_socket.SyncSocketBroker.get","title":"<code>get(uuid)</code>","text":"<p>Obtaining information about a task.</p> <p>Parameters:</p> Name Type Description Default <code>uuid</code> <code>UUID | str</code> <p>UUID of the task.</p> required <p>Returns:</p> Type Description <code>Task | None</code> <p>Task|None: If there is task information, returns <code>schemas.task.Task</code>, otherwise <code>None</code>.</p> Source code in <code>src/qtasks/brokers/sync_socket.py</code> <pre><code>def get(\n    self,\n    uuid: Annotated[\n        UUID | str,\n        Doc(\"\"\"\n                UUID of the task.\n                \"\"\"),\n    ],\n) -&gt; Task | None:\n    \"\"\"\n    Obtaining information about a task.\n\n    Args:\n        uuid (UUID|str): UUID of the task.\n\n    Returns:\n        Task|None: If there is task information, returns `schemas.task.Task`, otherwise `None`.\n    \"\"\"\n    if isinstance(uuid, str):\n        uuid = UUID(uuid)\n    task = self.storage.get(uuid=uuid)\n    new_task = self._plugin_trigger(\n        \"broker_get\", broker=self, task=task, return_last=True\n    )\n    if new_task:\n        task = new_task.get(\"task\", task)\n    return task\n</code></pre>"},{"location":"api/brokers/sync_socket/#qtasks.brokers.sync_socket.SyncSocketBroker.handle_connection","title":"<code>handle_connection(reader, writer)</code>","text":"<p>Handles an incoming connection.</p> <p>Parameters:</p> Name Type Description Default <code>reader</code> <p>Reader for incoming data.</p> required <code>writer</code> <p>Writer for outgoing data.</p> required Source code in <code>src/qtasks/brokers/sync_socket.py</code> <pre><code>def handle_connection(self, reader, writer):\n    \"\"\"\n    Handles an incoming connection.\n\n    Args:\n        reader: Reader for incoming data.\n        writer: Writer for outgoing data.\n    \"\"\"\n    conn = reader\n    try:\n        data = conn.recv(4096)\n        if not data:\n            return\n        message = json.loads(data.decode())\n        task_name = message[\"task_name\"]\n        uuid = message[\"uuid\"]\n        priority = message[\"priority\"]\n        args = message.get(\"args\", ())\n        kwargs = message.get(\"kwargs\", {})\n        created_at = message[\"created_at\"]\n\n        self.storage.add(\n            uuid=uuid,\n            task_status=TaskStatusNewSchema(\n                task_name=task_name,\n                priority=priority,\n                args=args,\n                kwargs=kwargs,\n                created_at=created_at,\n                updated_at=created_at,\n            ),\n        )\n\n        self.queue.put((task_name, uuid, priority))\n        conn.sendall(b\"OK\")\n    finally:\n        with contextlib.suppress(Exception):\n            conn.shutdown(socket.SHUT_RDWR)\n            conn.close()\n</code></pre>"},{"location":"api/brokers/sync_socket/#qtasks.brokers.sync_socket.SyncSocketBroker.listen","title":"<code>listen(worker)</code>","text":"<p>Listens to the socket queue and transfers tasks to the worker.</p> <p>Parameters:</p> Name Type Description Default <code>worker</code> <code>BaseWorker</code> <p>Worker class.</p> required <p>Raises:</p> Type Description <code>KeyError</code> <p>Task not found.</p> Source code in <code>src/qtasks/brokers/sync_socket.py</code> <pre><code>def listen(\n    self,\n    worker: Annotated[\n        BaseWorker[Literal[False]],\n        Doc(\"\"\"\n                Worker class.\n                \"\"\"),\n    ],\n):\n    \"\"\"\n    Listens to the socket queue and transfers tasks to the worker.\n\n    Args:\n        worker (BaseWorker): Worker class.\n\n    Raises:\n        KeyError: Task not found.\n    \"\"\"\n    self._plugin_trigger(\"broker_listen_start\", broker=self, worker=worker)\n    self.running = True\n\n    while self.running:\n        try:\n            item = self.queue.get(timeout=0.1)\n        except Empty:\n            continue\n        if item is None:\n            break\n\n        task_name, uuid, priority = item\n        model_get = self.get(uuid=uuid)\n        if not model_get:\n            raise KeyError(f\"Task not found: {uuid}\")\n\n        args, kwargs, created_at = (\n            model_get.args or (),\n            model_get.kwargs or {},\n            model_get.created_at.timestamp(),\n        )\n\n        self.storage.add_process(f\"{task_name}:{uuid}:{priority}\", priority)\n\n        if self.log:\n            self.log.info(f\"Received new task: {uuid}\")\n        new_args = self._plugin_trigger(\n            \"broker_add_worker\",\n            broker=self,\n            worker=worker,\n            task_name=task_name,\n            uuid=uuid,\n            priority=int(priority),\n            args=args,\n            kw=kwargs,\n            created_at=created_at,\n            return_last=True,\n        )\n        if new_args:\n            task_name = new_args.get(\"task_name\", task_name)\n            uuid = new_args.get(\"uuid\", uuid)\n            priority = new_args.get(\"priority\", priority)\n            args = new_args.get(\"args\", args)\n            kwargs = new_args.get(\"kw\", kwargs)\n            created_at = new_args.get(\"created_at\", created_at)\n        worker.add(\n            name=task_name,\n            uuid=uuid,\n            priority=int(priority),\n            args=args,\n            kwargs=kwargs,\n            created_at=created_at,\n        )\n</code></pre>"},{"location":"api/brokers/sync_socket/#qtasks.brokers.sync_socket.SyncSocketBroker.remove_finished_task","title":"<code>remove_finished_task(task_broker, model)</code>","text":"<p>Updates storage data via the <code>self.storage.remove_finished_task</code> function.</p> <p>Parameters:</p> Name Type Description Default <code>task_broker</code> <code>TaskPrioritySchema</code> <p>The priority task schema.</p> required <code>model</code> <code>TaskStatusSuccessSchema | TaskStatusErrorSchema</code> <p>Model of the task result.</p> required Source code in <code>src/qtasks/brokers/sync_socket.py</code> <pre><code>def remove_finished_task(\n    self,\n    task_broker: Annotated[\n        TaskPrioritySchema,\n        Doc(\"\"\"\n                Priority task diagram.\n                \"\"\"),\n    ],\n    model: Annotated[\n        TaskStatusSuccessSchema | TaskStatusErrorSchema,\n        Doc(\"\"\"\n                Model of the task result.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Updates storage data via the `self.storage.remove_finished_task` function.\n\n    Args:\n        task_broker (TaskPrioritySchema): The priority task schema.\n        model (TaskStatusSuccessSchema | TaskStatusErrorSchema): Model of the task result.\n    \"\"\"\n    new_model = self._plugin_trigger(\n        \"broker_remove_finished_task\",\n        broker=self,\n        storage=self.storage,\n        model=model,\n        return_last=True,\n    )\n    if new_model:\n        model = new_model.get(\"model\", model)\n\n    self.storage.remove_finished_task(task_broker, model)\n    return\n</code></pre>"},{"location":"api/brokers/sync_socket/#qtasks.brokers.sync_socket.SyncSocketBroker.start","title":"<code>start(worker)</code>","text":"<p>Launches the broker.</p> <p>Parameters:</p> Name Type Description Default <code>worker</code> <code>BaseWorker</code> <p>Worker class.</p> required <p>Raises:</p> Type Description <code>RuntimeError</code> <p>self.client is not initialized.</p> Source code in <code>src/qtasks/brokers/sync_socket.py</code> <pre><code>def start(\n    self,\n    worker: Annotated[\n        BaseWorker,\n        Doc(\"\"\"\n                Worker class.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Launches the broker.\n\n    Args:\n        worker (BaseWorker): Worker class.\n\n    Raises:\n        RuntimeError: self.client is not initialized.\n    \"\"\"\n    self._plugin_trigger(\"broker_start\", broker=self, worker=worker)\n    self.storage.start()\n\n    if self.config.delete_finished_tasks:\n        self.storage._delete_finished_tasks()\n\n    if self.config.running_older_tasks:\n        self.storage._running_older_tasks(worker)\n\n    self.client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n    self.client.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)\n    self.client.bind((self.url, self.port))\n    self.client.listen(128)\n    self.running = True\n\n    self._listen_task = threading.Thread(\n        target=self.listen, args=(worker,), name=\"broker-listen\", daemon=True\n    )\n    self._listen_task.start()\n\n    def _serve():\n        if not self.client:\n            raise RuntimeError(\"self.client is not initialized.\")\n\n        while self.running:\n            try:\n                conn, _addr = self.client.accept()\n            except OSError:\n                break\n            try:\n                self.handle_connection(conn, conn)\n            except Exception:\n                with contextlib.suppress(Exception):\n                    conn.close()\n\n    self._serve_task = threading.Thread(\n        target=_serve, name=\"broker-serve\", daemon=True\n    )\n    self._serve_task.start()\n\n    try:\n        while self._serve_task.is_alive():\n            self._serve_task.join(timeout=0.5)\n    except KeyboardInterrupt:\n        pass\n</code></pre>"},{"location":"api/brokers/sync_socket/#qtasks.brokers.sync_socket.SyncSocketBroker.stop","title":"<code>stop()</code>","text":"<p>The broker stops.</p> Source code in <code>src/qtasks/brokers/sync_socket.py</code> <pre><code>def stop(self):\n    \"\"\"The broker stops.\"\"\"\n    self._plugin_trigger(\"broker_stop\", broker=self)\n    self.running = False\n\n    with contextlib.suppress(Exception):\n        self.queue.put_nowait(None)\n\n    if self.client:\n        with contextlib.suppress(Exception):\n            self.client.shutdown(socket.SHUT_RDWR)\n            self.client.close()\n\n        self.client = None\n\n    if self._serve_task and self._serve_task.is_alive():\n        with contextlib.suppress(Exception):\n            self._serve_task.join(timeout=2.0)\n\n    if self._listen_task and self._listen_task.is_alive():\n        with contextlib.suppress(Exception):\n            self._listen_task.join(timeout=2.0)\n</code></pre>"},{"location":"api/brokers/sync_socket/#qtasks.brokers.sync_socket.SyncSocketBroker.update","title":"<code>update(**kwargs)</code>","text":"<p>Updates task information.</p> <p>Parameters:</p> Name Type Description Default <code>kwargs</code> <code>dict</code> <p>task data of type kwargs.</p> <code>{}</code> Source code in <code>src/qtasks/brokers/sync_socket.py</code> <pre><code>def update(\n    self,\n    **kwargs: Annotated[\n        Any,\n        Doc(\"\"\"\n                Update arguments for storage type kwargs.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Updates task information.\n\n    Args:\n        kwargs (dict, optional): task data of type kwargs.\n    \"\"\"\n    new_kw = self._plugin_trigger(\n        \"broker_update\", broker=self, kw=kwargs, return_last=True\n    )\n    if new_kw:\n        kwargs = new_kw.get(\"kw\", kwargs)\n    return self.storage.update(**kwargs)\n</code></pre>"},{"location":"api/classes/async_redis_commands/","title":"AsyncRedisCommandQueue","text":"<p>Async Redis command queue.</p>"},{"location":"api/classes/async_redis_commands/#qtasks.contrib.redis.async_queue_client.AsyncRedisCommandQueue","title":"<code>AsyncRedisCommandQueue</code>","text":"<p><code>AsyncRedisCommandQueue</code> - Asynchronous class for working with <code>Redis</code>.</p>"},{"location":"api/classes/async_redis_commands/#qtasks.contrib.redis.async_queue_client.AsyncRedisCommandQueue--example","title":"Example","text":"<pre><code>import asyncio\nfrom qtasks import QueueTasks\nfrom qtasks.contrib.redis import AsyncRedisCommandQueue\n\nredis_contrib = AsyncRedisCommandQueue(redis)\nasyncio.run(redis_contrib.execute(\"hset\", kwargs[\"name\"], mapping=kwargs[\"mapping\"]))\n</code></pre> Source code in <code>src/qtasks/contrib/redis/async_queue_client.py</code> <pre><code>class AsyncRedisCommandQueue:\n    \"\"\"\n    `AsyncRedisCommandQueue` - Asynchronous class for working with `Redis`.\n\n    ## Example\n\n    ```python\n    import asyncio\n    from qtasks import QueueTasks\n    from qtasks.contrib.redis import AsyncRedisCommandQueue\n\n    redis_contrib = AsyncRedisCommandQueue(redis)\n    asyncio.run(redis_contrib.execute(\"hset\", kwargs[\"name\"], mapping=kwargs[\"mapping\"]))\n    ```\n    \"\"\"\n\n    def __init__(self, redis: aioredis.Redis, log: Logger | None = None):\n        \"\"\"\n        An instance of a class.\n\n        Args:\n            redis (redis.asyncio.Redis): class `Redis`.\n            log (Logger, optional): class `qtasks.logs.Logger`. Default: `qtasks._state.log_main`.\n        \"\"\"\n        self.log = self._get_log(log)\n        self.redis = redis\n        self.queue = asyncio.Queue()\n        self.worker_task = None\n        self.lock = asyncio.Lock()\n\n    async def _worker(self):\n        while not self.queue.empty():\n            cmd, args, kwargs = await self.queue.get()\n            self.log.debug(f\"Task {cmd} with parameters {args} and {kwargs} executed\")\n            try:\n                await getattr(self.redis, cmd)(*args, **kwargs)\n            except Exception as e:\n                self.log.error(\n                    f\"Error executing Redis command {cmd}: {e}. Args: {args}, Kwargs: {kwargs}\"\n                )\n            self.queue.task_done()\n\n        async with self.lock:\n            self.worker_task = None\n\n    async def execute(self, cmd: str, *args, **kwargs):\n        \"\"\"\n        Query in `Redis`.\n\n        Args:\n            cmd (str): Command.\n            args(tuple, optional): Parameters to the command via *args.\n            kwargs(dict, optional): Parameters to the command via *args.\n        \"\"\"\n        await self.queue.put((cmd, args, kwargs))\n        async with self.lock:\n            if self.worker_task is None or self.worker_task.done():\n                self.worker_task = asyncio.create_task(self._worker())\n\n    def _get_log(self, log: Logger | None):\n        if log is None:\n            import qtasks._state\n\n            log = qtasks._state.log_main\n        return log.with_subname(\"AsyncRedisCommandQueue\")\n</code></pre>"},{"location":"api/classes/async_redis_commands/#qtasks.contrib.redis.async_queue_client.AsyncRedisCommandQueue.__init__","title":"<code>__init__(redis, log=None)</code>","text":"<p>An instance of a class.</p> <p>Parameters:</p> Name Type Description Default <code>redis</code> <code>Redis</code> <p>class <code>Redis</code>.</p> required <code>log</code> <code>Logger</code> <p>class <code>qtasks.logs.Logger</code>. Default: <code>qtasks._state.log_main</code>.</p> <code>None</code> Source code in <code>src/qtasks/contrib/redis/async_queue_client.py</code> <pre><code>def __init__(self, redis: aioredis.Redis, log: Logger | None = None):\n    \"\"\"\n    An instance of a class.\n\n    Args:\n        redis (redis.asyncio.Redis): class `Redis`.\n        log (Logger, optional): class `qtasks.logs.Logger`. Default: `qtasks._state.log_main`.\n    \"\"\"\n    self.log = self._get_log(log)\n    self.redis = redis\n    self.queue = asyncio.Queue()\n    self.worker_task = None\n    self.lock = asyncio.Lock()\n</code></pre>"},{"location":"api/classes/async_redis_commands/#qtasks.contrib.redis.async_queue_client.AsyncRedisCommandQueue.execute","title":"<code>execute(cmd, *args, **kwargs)</code>  <code>async</code>","text":"<p>Query in <code>Redis</code>.</p> <p>Parameters:</p> Name Type Description Default <code>cmd</code> <code>str</code> <p>Command.</p> required <code>args</code> <code>tuple</code> <p>Parameters to the command via *args.</p> <code>()</code> <code>kwargs</code> <code>dict</code> <p>Parameters to the command via *args.</p> <code>{}</code> Source code in <code>src/qtasks/contrib/redis/async_queue_client.py</code> <pre><code>async def execute(self, cmd: str, *args, **kwargs):\n    \"\"\"\n    Query in `Redis`.\n\n    Args:\n        cmd (str): Command.\n        args(tuple, optional): Parameters to the command via *args.\n        kwargs(dict, optional): Parameters to the command via *args.\n    \"\"\"\n    await self.queue.put((cmd, args, kwargs))\n    async with self.lock:\n        if self.worker_task is None or self.worker_task.done():\n            self.worker_task = asyncio.create_task(self._worker())\n</code></pre>"},{"location":"api/classes/baseqtasks/","title":"BaseQueueTasks","text":"<p>Base QueueTasks.</p>"},{"location":"api/classes/baseqtasks/#qtasks.base.qtasks.BaseQueueTasks","title":"<code>BaseQueueTasks</code>","text":"<p>               Bases: <code>Generic[TAsyncFlag]</code></p> <p>Base class for QueueTasks. Stores the general logic for working with tasks in the queue.</p> Source code in <code>src/qtasks/base/qtasks.py</code> <pre><code>class BaseQueueTasks(Generic[TAsyncFlag]):\n    \"\"\"Base class for QueueTasks. Stores the general logic for working with tasks in the queue.\"\"\"\n\n    def __init__(\n        self,\n        broker: Annotated[\n            BaseBroker,\n            Doc(\"\"\"\n                    Broker. Stores processing from task queues and data storage.\n                    \"\"\"),\n        ],\n        worker: Annotated[\n            BaseWorker,\n            Doc(\"\"\"\n                    Worker. Stores task processing.\n                    \"\"\"),\n        ],\n        name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Project name. This name is also used by components (Worker, Broker, etc.)\n\n                    Default: `QueueTasks`.\n                    \"\"\"),\n        ] = \"QueueTasks\",\n        broker_url: Annotated[\n            str | None,\n            Doc(\"\"\"\n                    Broker URL. Used by the Broker by default via the url parameter.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        log: Annotated[\n            Logger | None,\n            Doc(\"\"\"\n                    Logger.\n\n                    Default: `qtasks.logs.Logger`.\n                    \"\"\"),\n        ] = None,\n        config: Annotated[\n            QueueConfig | None,\n            Doc(\"\"\"\n                    Config.\n\n                    Default: `qtasks.configs.QueueConfig`.\n                    \"\"\"),\n        ] = None,\n        events: Annotated[\n            Optional[BaseEvents],\n            Doc(\"\"\"\n                    Events.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Initializing the base class for QueueTasks.\n\n        Args:\n            name (str, optional): Project name. Default: `QueueTasks`.\n            broker_url (str, optional): URL for the Broker. Default: `None`.\n            broker (BaseBroker, optional): Broker.\n            worker (BaseWorker, optional): Worker.\n            log (Logger, optional): Logger. Default: `qtasks.logs.Logger`.\n            config (QueueConfig, optional): Config. Default: `qtasks.configs.QueueConfig`.\n            events (BaseEvents, optional): Events. Default: `None`.\n        \"\"\"\n        self.name = name\n\n        self.version: Annotated[str, Doc(\"Project version.\")] = \"1.7.3\"\n\n        self.config: Annotated[\n            QueueConfig,\n            Doc(\"\"\"\n                Config, type `qtasks.configs.QueueConfig`.\n\n                Default: `QueueConfig()`.\n                \"\"\"),\n        ] = (\n            config or QueueConfig()\n        )\n        self.config.subscribe(self._update_configs)\n\n        self.log = (\n            log.with_subname(\"QueueTasks\")\n            if log\n            else Logger(\n                name=self.name,\n                subname=\"QueueTasks\",\n                default_level=self.config.logs_default_level_server,\n                format=self.config.logs_format,\n            )\n        )\n\n        self.broker = broker\n        self.worker = worker\n        self.starter: BaseStarter | None = None\n\n        self.routers: Annotated[\n            list[SyncRouter | AsyncRouter],\n            Doc(\"\"\"\n                Routers, type `qtasks.routers.SyncRouter | qtasks.routers.AsyncRouter`.\n\n                Default: `Empty array`.\n                \"\"\"),\n        ] = []\n\n        self.tasks: Annotated[\n            dict[str, TaskExecSchema],\n            Doc(\"\"\"\n                Tasks, type `{task_name:qtasks.schemas.TaskExecSchema}`.\n\n                Default: `Empty dictionary`.\n                \"\"\"),\n        ] = {}\n\n        self.plugins: Annotated[\n            dict[str, list[BasePlugin]],\n            Doc(\"\"\"\n                Tasks, type `{trigger_name:[qtasks.plugins.base.BasePlugin]}`.\n\n                Default: `Empty dictionary`.\n                \"\"\"),\n        ] = {}\n\n        self.events = events\n\n        self._method: Annotated[\n            str | None,\n            Doc(\"\"\"Method for using QueueTasks.\n\n                Default: `None`.\n                \"\"\"),\n        ] = None\n\n    @overload\n    def task(\n        self: BaseQueueTasks[Literal[False]],\n        name: str | None = None,\n        *,\n        priority: int | None = None,\n        echo: bool = False,\n        max_time: float | None = None,\n        retry: int | None = None,\n        retry_on_exc: list[type[Exception]] | None = None,\n        decode: Callable | None = None,\n        tags: list[str] | None = None,\n        description: str | None = None,\n        generate_handler: Callable | None = None,\n        executor: type[BaseTaskExecutor] | None = None,\n        middlewares_before: list[type[TaskMiddleware]] | None = None,\n        middlewares_after: list[type[TaskMiddleware]] | None = None,\n        **kwargs,\n    ) -&gt; Callable[[Callable[P, R]], SyncTask[P, R]]:\n        \"\"\"\n        Decorator for registering tasks.\n\n        Args:\n            name (str, optional): Name of the task. Default: `func.__name__`.\n            priority (int, optional): The task's default priority. Default: `config.task_default_priority`.\n            echo (bool, optional): Add SyncTask as the first parameter. Default: `False`.\n            max_time (float, optional): The maximum time the task will take to complete in seconds. Default: `None`.\n            retry (int, optional): Number of attempts to retry the task. Default: `None`.\n            retry_on_exc (List[Type[Exception]], optional): Exceptions under which the task will be re-executed. Default: `None`.\n            decode (Callable, optional): Decoder of the task result. Default: `None`.\n            tags (List[str], optional): Task tags. Default: `None`.\n            description (str, optional): Description of the task. Default: `None`.\n            generate_handler (Callable, optional): Handler generator. Default: `None`.\n            executor (Type[\"BaseTaskExecutor\"], optional): Class `BaseTaskExecutor`. Default: `SyncTaskExecutor`.\n            middlewares_before (List[Type[\"TaskMiddleware\"]], optional): Middleware that will be executed before the task. Default: `Empty array`.\n            middlewares_after (List[Type[\"TaskMiddleware\"]], optional): Middleware that will be executed after the task. Default: `Empty array`.\n\n        Raises:\n            ValueError: If a task with the same name is already registered.\n            ValueError: Unknown method {self._method}.\n\n        Returns:\n            SyncTask: Decorator for registering a task.\n        \"\"\"\n        ...\n\n    @overload\n    def task(\n        self: BaseQueueTasks[Literal[True]],\n        name: str | None = None,\n        *,\n        priority: int | None = None,\n        echo: bool = False,\n        max_time: float | None = None,\n        retry: int | None = None,\n        retry_on_exc: list[type[Exception]] | None = None,\n        decode: Callable | None = None,\n        tags: list[str] | None = None,\n        description: str | None = None,\n        generate_handler: Callable | None = None,\n        executor: type[BaseTaskExecutor] | None = None,\n        middlewares_before: list[type[TaskMiddleware]] | None = None,\n        middlewares_after: list[type[TaskMiddleware]] | None = None,\n        **kwargs,\n    ) -&gt; Callable[[Callable[P, R]], AsyncTask[P, R]]:\n        \"\"\"\n        Decorator for registering tasks.\n\n        Args:\n            name (str, optional): Name of the task. Default: `func.__name__`.\n            priority (int, optional): The task's default priority. Default: `config.task_default_priority`.\n            echo (bool, optional): Add AsyncTask as the first parameter. Default: `False`.\n            max_time (float, optional): The maximum time the task will take to complete in seconds. Default: `None`.\n            retry (int, optional): Number of attempts to retry the task. Default: `None`.\n            retry_on_exc (List[Type[Exception]], optional): Exceptions under which the task will be re-executed. Default: `None`.\n            decode (Callable, optional): Decoder of the task result. Default: `None`.\n            tags (List[str], optional): Task tags. Default: `None`.\n            description (str, optional): Description of the task. Default: `None`.\n            generate_handler (Callable, optional): Handler generator. Default: `None`.\n            executor (Type[\"BaseTaskExecutor\"], optional): Class `BaseTaskExecutor`. Default: `AsyncTaskExecutor`.\n            middlewares_before (List[Type[\"TaskMiddleware\"]],, optional): Middleware that will be executed before the task. Default: `Empty array`.\n            middlewares_after (List[Type[\"TaskMiddleware\"]],, optional): Middleware that will be executed after the task. Default: `Empty array`.\n\n        Raises:\n            ValueError: If a task with the same name is already registered.\n            ValueError: Unknown method {self._method}.\n\n        Returns:\n            AsyncTask: Decorator for registering a task.\n        \"\"\"\n        ...\n\n    @overload\n    def task(\n        self: BaseQueueTasks[Literal[False]], name: Callable[P, R]\n    ) -&gt; SyncTask[P, R]:\n        \"\"\"\n        Decorator for registering tasks.\n\n        Args:\n            name (str, optional): Name of the task. Default: `func.__name__`.\n            priority (int, optional): The task's default priority. Default: `config.task_default_priority`.\n            echo (bool, optional): Add SyncTask as the first parameter. Default: `False`.\n            max_time (float, optional): The maximum time the task will take to complete in seconds. Default: `None`.\n            retry (int, optional): Number of attempts to retry the task. Default: `None`.\n            retry_on_exc (List[Type[Exception]], optional): Exceptions under which the task will be re-executed. Default: `None`.\n            decode (Callable, optional): Decoder of the task result. Default: `None`.\n            tags (List[str], optional): Task tags. Default: `None`.\n            description (str, optional): Description of the task. Default: `None`.\n            generate_handler (Callable, optional): Handler generator. Default: `None`.\n            executor (Type[\"BaseTaskExecutor\"], optional): Class `BaseTaskExecutor`. Default: `SyncTaskExecutor`.\n            middlewares_before (List[Type[\"TaskMiddleware\"]], optional): Middleware that will be executed before the task. Default: `Empty array`.\n            middlewares_after (List[Type[\"TaskMiddleware\"]], optional): Middleware that will be executed after the task. Default: `Empty array`.\n\n        Raises:\n            ValueError: If a task with the same name is already registered.\n            ValueError: Unknown method {self._method}.\n\n        Returns:\n            SyncTask: Decorator for registering a task.\n        \"\"\"\n        ...\n\n    @overload\n    def task(\n        self: BaseQueueTasks[Literal[True]], name: Callable[P, R]\n    ) -&gt; AsyncTask[P, R]:\n        \"\"\"\n        Decorator for registering tasks.\n\n        Args:\n            name (str, optional): Name of the task. Default: `func.__name__`.\n            priority (int, optional): The task's default priority. Default: `config.task_default_priority`.\n            echo (bool, optional): Add AsyncTask as the first parameter. Default: `False`.\n            max_time (float, optional): The maximum time the task will take to complete in seconds. Default: `None`.\n            retry (int, optional): Number of attempts to retry the task. Default: `None`.\n            retry_on_exc (List[Type[Exception]], optional): Exceptions under which the task will be re-executed. Default: `None`.\n            decode (Callable, optional): Decoder of the task result. Default: `None`.\n            tags (List[str], optional): Task tags. Default: `None`.\n            description (str, optional): Description of the task. Default: `None`.\n            generate_handler (Callable, optional): Handler generator. Default: `None`.\n            executor (Type[\"BaseTaskExecutor\"], optional): Class `BaseTaskExecutor`. Default: `AsyncTaskExecutor`.\n            middlewares_before (List[Type[\"TaskMiddleware\"]],, optional): Middleware that will be executed before the task. Default: `Empty array`.\n            middlewares_after (List[Type[\"TaskMiddleware\"]],, optional): Middleware that will be executed after the task. Default: `Empty array`.\n\n        Raises:\n            ValueError: If a task with the same name is already registered.\n            ValueError: Unknown method {self._method}.\n\n        Returns:\n            AsyncTask: Decorator for registering a task.\n        \"\"\"\n        ...\n\n    def task(\n        self,\n        name: Annotated[\n            Callable[P, R] | str | None,\n            Doc(\"\"\"\n                    The name of the task or function.\n\n                    Default: `func.__name__`.\n                    \"\"\"),\n        ] = None,\n        *,\n        priority: Annotated[\n            int | None,\n            Doc(\"\"\"\n                    The task has priority by default.\n\n                    Default: `config.task_default_priority`.\n                    \"\"\"),\n        ] = None,\n        echo: Annotated[\n            bool,\n            Doc(\"\"\"\n                    Add (A)syncTask as the first parameter.\n\n                    Default: `False`.\n                    \"\"\"),\n        ] = False,\n        max_time: Annotated[\n            float | None,\n            Doc(\"\"\"\n                    The maximum time it takes to complete a task in seconds.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        retry: Annotated[\n            int | None,\n            Doc(\"\"\"\n                    The number of attempts to retry the task.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        retry_on_exc: Annotated[\n            list[type[Exception]] | None,\n            Doc(\"\"\"\n                    Exceptions under which the task will be re-executed.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        decode: Annotated[\n            Callable | None,\n            Doc(\"\"\"\n                    Task result decoder.\n\n                    Default: `None`.\n                \"\"\"),\n        ] = None,\n        tags: Annotated[\n            list[str] | None,\n            Doc(\"\"\"\n                    Task tags.\n\n                    Default: `None`.\n                \"\"\"),\n        ] = None,\n        description: Annotated[\n            str | None,\n            Doc(\"\"\"\n                    Description of the task.\n\n                    Default: `None`.\n                \"\"\"),\n        ] = None,\n        generate_handler: Annotated[\n            Callable | None,\n            Doc(\"\"\"\n                    Handler generator.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        executor: Annotated[\n            type[BaseTaskExecutor] | None,\n            Doc(\"\"\"\n                    Class `BaseTaskExecutor`.\n\n                    Default: `SyncTaskExecutor`.\n                    \"\"\"),\n        ] = None,\n        middlewares_before: Annotated[\n            list[type[TaskMiddleware]] | None,\n            Doc(\"\"\"\n                    Middleware that will be completed before the task.\n\n                    Default: `Empty array`.\n                    \"\"\"),\n        ] = None,\n        middlewares_after: Annotated[\n            list[type[TaskMiddleware]] | None,\n            Doc(\"\"\"\n                    Middleware that will be executed after the task.\n\n                    Default: `Empty array`.\n                    \"\"\"),\n        ] = None,\n        **kwargs,\n    ) -&gt; SyncTask[P, R] | AsyncTask[P, R] | Callable[[Callable[P, R]], SyncTask[P, R] | AsyncTask[P, R]]:\n        \"\"\"\n        Decorator for registering tasks.\n\n        Args:\n            name (str, optional): Name of the task. Default: `func.__name__`.\n            priority (int, optional): The task's default priority. Default: `config.task_default_priority`.\n            echo (bool, optional): Add (A)syncTask as the first parameter. Default: `False`.\n            retry (int, optional): Number of attempts to retry the task. Default: `None`.\n            retry_on_exc (List[Type[Exception]], optional): Exceptions under which the task will be re-executed. Default: `None`.\n            decode (Callable, optional): Decoder of the task result. Default: `None`.\n            tags (List[str], optional): Task tags. Default: `None`.\n            description (str, optional): Description of the task. Default: `None`.\n            generate_handler (Callable, optional): Handler generator. Default: `None`.\n            executor (Type[\"BaseTaskExecutor\"], optional): `BaseTaskExecutor` class. Default: `SyncTaskExecutor`.\n            middlewares_before (List[Type[\"TaskMiddleware\"]], optional): Middleware that will be executed before the task. Default: `Empty array`.\n            middlewares_after (List[Type[\"TaskMiddleware\"]], optional): Middleware that will be executed after the task. Default: `Empty array`.\n\n        Raises:\n            ValueError: If a task with the same name is already registered.\n            ValueError: Unknown method {self._method}.\n            ValueError: Unsupported method {self._method}.\n\n        Returns:\n            SyncTask | AsyncTask: Decorator for registering a task.\n        \"\"\"\n\n        def wrapper(func: Callable[P, R]):\n            if not self._method:\n                raise ValueError(f\"Unknown method {self._method}.\")\n            nonlocal priority, middlewares_after, middlewares_before\n            task_name = name or func.__name__ if not callable(name) else name.__name__\n\n            if task_name in self.tasks:\n                raise ValueError(f\"Task with name {task_name} is already registered!\")\n\n            priority = (\n                priority if priority is not None else self.config.task_default_priority\n            )\n\n            generating = (\n                \"async\"\n                if inspect.isasyncgenfunction(func)\n                else \"sync\" if inspect.isgeneratorfunction(func) else False\n            )\n\n            middlewares_before = middlewares_before or []\n            middlewares_after = middlewares_after or []\n\n            model = TaskExecSchema(\n                name=task_name,\n                priority=priority,\n                func=func,\n                awaiting=inspect.iscoroutinefunction(func),\n                generating=generating,\n                echo=echo,\n                max_time=max_time,\n                retry=retry,\n                retry_on_exc=retry_on_exc,\n                decode=decode,\n                tags=tags,\n                description=description,\n                generate_handler=generate_handler,\n                executor=executor,\n                middlewares_before=middlewares_before,\n                middlewares_after=middlewares_after,\n                extra=kwargs,\n            )\n\n            for registry in (self.tasks, self.worker._tasks):\n                registry[task_name] = model\n\n            method_map = {\"async\": AsyncTask, \"sync\": SyncTask}\n            try:\n                method = method_map[self._method]\n            except KeyError as exc:\n                raise ValueError(f\"Unsupported method: {self._method}\") from exc\n\n            return method(\n                app=self,\n                task_name=model.name,\n                priority=model.priority,\n                echo=model.echo,\n                max_time=model.max_time,\n                retry=model.retry,\n                retry_on_exc=model.retry_on_exc,\n                decode=model.decode,\n                tags=model.tags,\n                description=model.description,\n                generate_handler=model.generate_handler,\n                executor=model.executor,\n                middlewares_before=model.middlewares_before,\n                middlewares_after=model.middlewares_after,\n                extra=model.extra,\n            )\n\n        if callable(name):\n            func = name\n            name = func.__name__\n            return wrapper(func)\n        return wrapper\n\n    def include_router(\n        self,\n        router: Annotated[\n            SyncRouter | AsyncRouter,\n            Doc(\"\"\"\n                    Router `qtasks.routers.SyncRouter` | `qtasks.routers.AsyncRouter`.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Add Router.\n\n        Args:\n            router (Router): Router `qtasks.routers.SyncRouter` | `qtasks.routers.AsyncRouter`.\n        \"\"\"\n        self.routers.append(router)\n        self.tasks.update(router.tasks)\n        self.worker._tasks.update(router.tasks)\n\n    def add_plugin(\n        self,\n        plugin: Annotated[\n            BasePlugin,\n            Doc(\n                \"\"\"\n                    Plugin class.\n                    \"\"\"\n            ),\n        ],\n        trigger_names: Annotated[\n            list[str] | None,\n            Doc(\n                \"\"\"\n                    The name of the triggers for the plugin.\n\n                    Default: will be added to `Globals`.\n                    \"\"\"\n            ),\n        ] = None,\n        component: Annotated[\n            str | None,\n            Doc(\n                \"\"\"\n                    Component name.\n\n                    Default: `None`.\n                    \"\"\"\n            ),\n        ] = None,\n    ) -&gt; None:\n        \"\"\"\n        Add a plugin.\n\n        Args:\n            plugin (Type[BasePlugin]): Plugin class.\n            trigger_names (List[str], optional): The name of the triggers for the plugin. Default: will be added to `Globals`.\n            component (str, optional): Component name. Default: `None`.\n\n        Raises:\n            KeyError: Unable to get component {component}!\n        \"\"\"\n        data = {\n            \"worker\": self.worker,\n            \"broker\": self.broker,\n            \"storage\": self.broker.storage,\n            \"global_config\": self.broker.storage.global_config,\n        }\n\n        trigger_names = trigger_names or [\"Globals\"]\n\n        if not component:\n            for name in trigger_names:\n                if name not in self.plugins:\n                    self.plugins.update({name: [plugin]})\n                else:\n                    self.plugins[name].append(plugin)\n            return\n\n        component_data = data.get(component)\n        if not component_data:\n            raise KeyError(f\"Unable to get component {component}!\")\n        component_data.add_plugin(plugin, trigger_names)\n        return\n\n    def add_middleware(\n        self,\n        middleware: Annotated[\n            type[BaseMiddleware],\n            Doc(\n                \"\"\"\n                    Middleware class.\n                    \"\"\"\n            ),\n        ],\n        **kwargs: Annotated[\n            Any,\n            Doc(\n                \"\"\"\n                    Kwargs.\n\n                    Default: `{}`.\n                    \"\"\"\n            ),\n        ]\n        ) -&gt; None:\n        \"\"\"\n        Add middleware.\n\n        Args:\n            middleware (Type[BaseMiddleware]): Middleware.\n            **kwargs (Any): Kwargs.\n\n        Raises:\n            ImportError: Unable to connect Middleware: It does not belong to the BaseMiddleware class!\n        \"\"\"\n        if (\n            not middleware.__base__\n            or (middleware.__base__.__base__ and middleware.__base__.__base__.__name__)\n            != \"BaseMiddleware\"\n        ):\n            raise ImportError(\n                f\"Unable to attach middleware {middleware.__name__}: \"\n                \"it does not inherit from BaseMiddleware!\"\n            )\n        if issubclass(middleware, \"TaskMiddleware\"):\n\n            position = kwargs.get(\"position\", \"before\")\n            if position == \"before\":\n                self.worker.task_middlewares_before.append(middleware)\n            elif position == \"after\":\n                self.worker.task_middlewares_after.append(middleware)\n        self.log.debug(f\"Middleware {middleware.__name__} added.\")\n        return\n\n    def _registry_tasks(self):\n        \"\"\"\n        Register tasks from the task registry.\n\n        Updates `self.tasks` and `self.worker._tasks` with all tasks,\n        registered in the `TaskRegistry`, setting the default priority.\n        \"\"\"\n        all_tasks = TaskRegistry.all_tasks()\n\n        for task in all_tasks.values():\n            if task.priority is None:\n                task.priority = self.config.task_default_priority\n\n        self.tasks.update(all_tasks)\n        self.worker._tasks.update(all_tasks)\n\n    def _set_state(self):\n        \"\"\"Set parameters in `qtasks._state`.\"\"\"\n        qtasks._state.app_main = self\n        qtasks._state.log_main = self.log\n\n    def _update_configs(self, config: QueueConfig, key, value):\n        \"\"\"\n        Update configuration.\n\n        Args:\n            config (QueueConfig): Configuration.\n            key (str): Configuration key.\n            value (Any): Configuration value.\n        \"\"\"\n        if key == \"logs_default_level_server\":\n            self.log.default_level = value\n            self.log = self.log.update_logger()\n            self._update_logs(default_level=value)\n\n    def _update_logs(self, **kwargs):\n        \"\"\"Update logs.\"\"\"\n        if self.worker:\n            self.worker.log = self.worker.log.update_logger(**kwargs)\n        if self.broker:\n            self.broker.log = self.broker.log.update_logger(**kwargs)\n            if self.broker.storage:\n                self.broker.storage.log = self.broker.storage.log.update_logger(\n                    **kwargs\n                )\n                if self.broker.storage.global_config:\n                    self.broker.storage.global_config.log = (\n                        self.broker.storage.global_config.log.update_logger(**kwargs)\n                    )\n\n    @overload\n    def add_task(\n        self,\n        *args: Annotated[\n            Any,\n            Doc(\"\"\"\n                    args of the task.\n\n                    Default: `()`.\n                    \"\"\"),\n        ],\n        task_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int | None,\n            Doc(\"\"\"\n                    The task has priority.\n\n                    Default: Task priority value.\n                    \"\"\"),\n        ] = None,\n        timeout: Annotated[\n            float | None,\n            Doc(\"\"\"\n                    Task timeout.\n\n                    If specified, the task is returned via `qtasks.results.AsyncTask`.\n                    \"\"\"),\n        ] = None,\n        **kwargs: Annotated[\n            dict | None,\n            Doc(\"\"\"\n                    kwargs tasks.\n\n                    Default: `{}`.\n                    \"\"\"),\n        ],\n    ) -&gt; Optional[Task]: ...\n\n    @overload\n    async def add_task(\n        self,\n        *args: Annotated[\n            Any,\n            Doc(\"\"\"\n                    args of the task.\n\n                    Default: `()`.\n                    \"\"\"),\n        ],\n        task_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int | None,\n            Doc(\"\"\"\n                    The task has priority.\n\n                    Default: Task priority value.\n                    \"\"\"),\n        ] = None,\n        timeout: Annotated[\n            float | None,\n            Doc(\"\"\"\n                    Task timeout.\n\n                    If specified, the task is returned via `qtasks.results.AsyncTask`.\n                    \"\"\"),\n        ] = None,\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    kwargs tasks.\n\n                    Default: `{}`.\n                    \"\"\"),\n        ],\n    ) -&gt; Optional[Task]: ...\n\n    @overload\n    def add_task(\n        self,\n        *args: Annotated[\n            Any,\n            Doc(\"\"\"\n                    args of the task.\n\n                    Default: `()`.\n                    \"\"\"),\n        ],\n        task_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int | None,\n            Doc(\"\"\"\n                    The task has priority.\n\n                    Default: Task priority value.\n                    \"\"\"),\n        ] = None,\n        timeout: Annotated[\n            None,\n            Doc(\"\"\"\n                    Task timeout.\n\n                    If specified, the task is returned via `qtasks.results.AsyncTask`.\n                    \"\"\"),\n        ] = None,\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    kwargs tasks.\n\n                    Default: `{}`.\n                    \"\"\"),\n        ],\n    ) -&gt; Task: ...\n\n    @overload\n    async def add_task(\n        self,\n        *args: Annotated[\n            Any,\n            Doc(\"\"\"\n                    args of the task.\n\n                    Default: `()`.\n                    \"\"\"),\n        ],\n        task_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int | None,\n            Doc(\"\"\"\n                    The task has priority.\n\n                    Default: Task priority value.\n                    \"\"\"),\n        ] = None,\n        timeout: Annotated[\n            None,\n            Doc(\"\"\"\n                    Task timeout.\n\n                    If specified, the task is returned via `qtasks.results.AsyncTask`.\n                    \"\"\"),\n        ] = None,\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    kwargs tasks.\n\n                    Default: `{}`.\n                    \"\"\"),\n        ],\n    ) -&gt; Task: ...\n\n    def add_task(\n        self,\n        *args: Annotated[\n            Any,\n            Doc(\"\"\"\n                    args of the task.\n\n                    Default: `()`.\n                    \"\"\"),\n        ],\n        task_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int | None,\n            Doc(\"\"\"\n                    The task has priority.\n\n                    Default: Task priority value.\n                    \"\"\"),\n        ] = None,\n        timeout: Annotated[\n            float | None,\n            Doc(\"\"\"\n                    Task timeout.\n\n                    If specified, the task is returned via `qtasks.results.AsyncTask`.\n                    \"\"\"),\n        ] = None,\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    kwargs tasks.\n\n                    Default: `{}`.\n                    \"\"\"),\n        ],\n    ) -&gt; Union[\n        Optional[Task], Awaitable[Optional[Task]], Task, Awaitable[Task]\n    ]:\n        \"\"\"\n        Add a task.\n\n        Args:\n            task_name (str): The name of the task.\n            priority (int, optional): Task priority. Default: Task priority value.\n            args (tuple, optional): Task args. Default: `()`.\n            kwargs (dict, optional): Task kwargs. Default: `{}`.\n\n            timeout (float, optional): Task timeout. If specified, the task is returned via `qtasks.results.SyncResult` or `qtasks.results.AsyncResult`.\n\n        Returns:\n            Task|None: `schemas.task.Task` or `None`.\n        \"\"\"\n        pass\n</code></pre>"},{"location":"api/classes/baseqtasks/#qtasks.base.qtasks.BaseQueueTasks.__init__","title":"<code>__init__(broker, worker, name='QueueTasks', broker_url=None, log=None, config=None, events=None)</code>","text":"<p>Initializing the base class for QueueTasks.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Project name. Default: <code>QueueTasks</code>.</p> <code>'QueueTasks'</code> <code>broker_url</code> <code>str</code> <p>URL for the Broker. Default: <code>None</code>.</p> <code>None</code> <code>broker</code> <code>BaseBroker</code> <p>Broker.</p> required <code>worker</code> <code>BaseWorker</code> <p>Worker.</p> required <code>log</code> <code>Logger</code> <p>Logger. Default: <code>qtasks.logs.Logger</code>.</p> <code>None</code> <code>config</code> <code>QueueConfig</code> <p>Config. Default: <code>qtasks.configs.QueueConfig</code>.</p> <code>None</code> <code>events</code> <code>BaseEvents</code> <p>Events. Default: <code>None</code>.</p> <code>None</code> Source code in <code>src/qtasks/base/qtasks.py</code> <pre><code>def __init__(\n    self,\n    broker: Annotated[\n        BaseBroker,\n        Doc(\"\"\"\n                Broker. Stores processing from task queues and data storage.\n                \"\"\"),\n    ],\n    worker: Annotated[\n        BaseWorker,\n        Doc(\"\"\"\n                Worker. Stores task processing.\n                \"\"\"),\n    ],\n    name: Annotated[\n        str,\n        Doc(\"\"\"\n                Project name. This name is also used by components (Worker, Broker, etc.)\n\n                Default: `QueueTasks`.\n                \"\"\"),\n    ] = \"QueueTasks\",\n    broker_url: Annotated[\n        str | None,\n        Doc(\"\"\"\n                Broker URL. Used by the Broker by default via the url parameter.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    log: Annotated[\n        Logger | None,\n        Doc(\"\"\"\n                Logger.\n\n                Default: `qtasks.logs.Logger`.\n                \"\"\"),\n    ] = None,\n    config: Annotated[\n        QueueConfig | None,\n        Doc(\"\"\"\n                Config.\n\n                Default: `qtasks.configs.QueueConfig`.\n                \"\"\"),\n    ] = None,\n    events: Annotated[\n        Optional[BaseEvents],\n        Doc(\"\"\"\n                Events.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    Initializing the base class for QueueTasks.\n\n    Args:\n        name (str, optional): Project name. Default: `QueueTasks`.\n        broker_url (str, optional): URL for the Broker. Default: `None`.\n        broker (BaseBroker, optional): Broker.\n        worker (BaseWorker, optional): Worker.\n        log (Logger, optional): Logger. Default: `qtasks.logs.Logger`.\n        config (QueueConfig, optional): Config. Default: `qtasks.configs.QueueConfig`.\n        events (BaseEvents, optional): Events. Default: `None`.\n    \"\"\"\n    self.name = name\n\n    self.version: Annotated[str, Doc(\"Project version.\")] = \"1.7.3\"\n\n    self.config: Annotated[\n        QueueConfig,\n        Doc(\"\"\"\n            Config, type `qtasks.configs.QueueConfig`.\n\n            Default: `QueueConfig()`.\n            \"\"\"),\n    ] = (\n        config or QueueConfig()\n    )\n    self.config.subscribe(self._update_configs)\n\n    self.log = (\n        log.with_subname(\"QueueTasks\")\n        if log\n        else Logger(\n            name=self.name,\n            subname=\"QueueTasks\",\n            default_level=self.config.logs_default_level_server,\n            format=self.config.logs_format,\n        )\n    )\n\n    self.broker = broker\n    self.worker = worker\n    self.starter: BaseStarter | None = None\n\n    self.routers: Annotated[\n        list[SyncRouter | AsyncRouter],\n        Doc(\"\"\"\n            Routers, type `qtasks.routers.SyncRouter | qtasks.routers.AsyncRouter`.\n\n            Default: `Empty array`.\n            \"\"\"),\n    ] = []\n\n    self.tasks: Annotated[\n        dict[str, TaskExecSchema],\n        Doc(\"\"\"\n            Tasks, type `{task_name:qtasks.schemas.TaskExecSchema}`.\n\n            Default: `Empty dictionary`.\n            \"\"\"),\n    ] = {}\n\n    self.plugins: Annotated[\n        dict[str, list[BasePlugin]],\n        Doc(\"\"\"\n            Tasks, type `{trigger_name:[qtasks.plugins.base.BasePlugin]}`.\n\n            Default: `Empty dictionary`.\n            \"\"\"),\n    ] = {}\n\n    self.events = events\n\n    self._method: Annotated[\n        str | None,\n        Doc(\"\"\"Method for using QueueTasks.\n\n            Default: `None`.\n            \"\"\"),\n    ] = None\n</code></pre>"},{"location":"api/classes/baseqtasks/#qtasks.base.qtasks.BaseQueueTasks.add_middleware","title":"<code>add_middleware(middleware, **kwargs)</code>","text":"<p>Add middleware.</p> <p>Parameters:</p> Name Type Description Default <code>middleware</code> <code>Type[BaseMiddleware]</code> <p>Middleware.</p> required <code>**kwargs</code> <code>Any</code> <p>Kwargs.</p> <code>{}</code> <p>Raises:</p> Type Description <code>ImportError</code> <p>Unable to connect Middleware: It does not belong to the BaseMiddleware class!</p> Source code in <code>src/qtasks/base/qtasks.py</code> <pre><code>def add_middleware(\n    self,\n    middleware: Annotated[\n        type[BaseMiddleware],\n        Doc(\n            \"\"\"\n                Middleware class.\n                \"\"\"\n        ),\n    ],\n    **kwargs: Annotated[\n        Any,\n        Doc(\n            \"\"\"\n                Kwargs.\n\n                Default: `{}`.\n                \"\"\"\n        ),\n    ]\n    ) -&gt; None:\n    \"\"\"\n    Add middleware.\n\n    Args:\n        middleware (Type[BaseMiddleware]): Middleware.\n        **kwargs (Any): Kwargs.\n\n    Raises:\n        ImportError: Unable to connect Middleware: It does not belong to the BaseMiddleware class!\n    \"\"\"\n    if (\n        not middleware.__base__\n        or (middleware.__base__.__base__ and middleware.__base__.__base__.__name__)\n        != \"BaseMiddleware\"\n    ):\n        raise ImportError(\n            f\"Unable to attach middleware {middleware.__name__}: \"\n            \"it does not inherit from BaseMiddleware!\"\n        )\n    if issubclass(middleware, \"TaskMiddleware\"):\n\n        position = kwargs.get(\"position\", \"before\")\n        if position == \"before\":\n            self.worker.task_middlewares_before.append(middleware)\n        elif position == \"after\":\n            self.worker.task_middlewares_after.append(middleware)\n    self.log.debug(f\"Middleware {middleware.__name__} added.\")\n    return\n</code></pre>"},{"location":"api/classes/baseqtasks/#qtasks.base.qtasks.BaseQueueTasks.add_plugin","title":"<code>add_plugin(plugin, trigger_names=None, component=None)</code>","text":"<p>Add a plugin.</p> <p>Parameters:</p> Name Type Description Default <code>plugin</code> <code>Type[BasePlugin]</code> <p>Plugin class.</p> required <code>trigger_names</code> <code>List[str]</code> <p>The name of the triggers for the plugin. Default: will be added to <code>Globals</code>.</p> <code>None</code> <code>component</code> <code>str</code> <p>Component name. Default: <code>None</code>.</p> <code>None</code> <p>Raises:</p> Type Description <code>KeyError</code> <p>Unable to get component {component}!</p> Source code in <code>src/qtasks/base/qtasks.py</code> <pre><code>def add_plugin(\n    self,\n    plugin: Annotated[\n        BasePlugin,\n        Doc(\n            \"\"\"\n                Plugin class.\n                \"\"\"\n        ),\n    ],\n    trigger_names: Annotated[\n        list[str] | None,\n        Doc(\n            \"\"\"\n                The name of the triggers for the plugin.\n\n                Default: will be added to `Globals`.\n                \"\"\"\n        ),\n    ] = None,\n    component: Annotated[\n        str | None,\n        Doc(\n            \"\"\"\n                Component name.\n\n                Default: `None`.\n                \"\"\"\n        ),\n    ] = None,\n) -&gt; None:\n    \"\"\"\n    Add a plugin.\n\n    Args:\n        plugin (Type[BasePlugin]): Plugin class.\n        trigger_names (List[str], optional): The name of the triggers for the plugin. Default: will be added to `Globals`.\n        component (str, optional): Component name. Default: `None`.\n\n    Raises:\n        KeyError: Unable to get component {component}!\n    \"\"\"\n    data = {\n        \"worker\": self.worker,\n        \"broker\": self.broker,\n        \"storage\": self.broker.storage,\n        \"global_config\": self.broker.storage.global_config,\n    }\n\n    trigger_names = trigger_names or [\"Globals\"]\n\n    if not component:\n        for name in trigger_names:\n            if name not in self.plugins:\n                self.plugins.update({name: [plugin]})\n            else:\n                self.plugins[name].append(plugin)\n        return\n\n    component_data = data.get(component)\n    if not component_data:\n        raise KeyError(f\"Unable to get component {component}!\")\n    component_data.add_plugin(plugin, trigger_names)\n    return\n</code></pre>"},{"location":"api/classes/baseqtasks/#qtasks.base.qtasks.BaseQueueTasks.add_task","title":"<code>add_task(*args, task_name, priority=None, timeout=None, **kwargs)</code>","text":"<pre><code>add_task(*args: Annotated[Any, Doc('\\n                    args of the task.\\n\\n                    Default: `()`.\\n                    ')], task_name: Annotated[str, Doc('\\n                    Task name.\\n                    ')], priority: Annotated[int | None, Doc('\\n                    The task has priority.\\n\\n                    Default: Task priority value.\\n                    ')] = None, timeout: Annotated[float | None, Doc('\\n                    Task timeout.\\n\\n                    If specified, the task is returned via `qtasks.results.AsyncTask`.\\n                    ')] = None, **kwargs: Annotated[dict | None, Doc('\\n                    kwargs tasks.\\n\\n                    Default: `{}`.\\n                    ')]) -&gt; Optional[Task]\n</code></pre><pre><code>add_task(*args: Annotated[Any, Doc('\\n                    args of the task.\\n\\n                    Default: `()`.\\n                    ')], task_name: Annotated[str, Doc('\\n                    Task name.\\n                    ')], priority: Annotated[int | None, Doc('\\n                    The task has priority.\\n\\n                    Default: Task priority value.\\n                    ')] = None, timeout: Annotated[float | None, Doc('\\n                    Task timeout.\\n\\n                    If specified, the task is returned via `qtasks.results.AsyncTask`.\\n                    ')] = None, **kwargs: Annotated[Any, Doc('\\n                    kwargs tasks.\\n\\n                    Default: `{}`.\\n                    ')]) -&gt; Optional[Task]\n</code></pre><pre><code>add_task(*args: Annotated[Any, Doc('\\n                    args of the task.\\n\\n                    Default: `()`.\\n                    ')], task_name: Annotated[str, Doc('\\n                    Task name.\\n                    ')], priority: Annotated[int | None, Doc('\\n                    The task has priority.\\n\\n                    Default: Task priority value.\\n                    ')] = None, timeout: Annotated[None, Doc('\\n                    Task timeout.\\n\\n                    If specified, the task is returned via `qtasks.results.AsyncTask`.\\n                    ')] = None, **kwargs: Annotated[Any, Doc('\\n                    kwargs tasks.\\n\\n                    Default: `{}`.\\n                    ')]) -&gt; Task\n</code></pre><pre><code>add_task(*args: Annotated[Any, Doc('\\n                    args of the task.\\n\\n                    Default: `()`.\\n                    ')], task_name: Annotated[str, Doc('\\n                    Task name.\\n                    ')], priority: Annotated[int | None, Doc('\\n                    The task has priority.\\n\\n                    Default: Task priority value.\\n                    ')] = None, timeout: Annotated[None, Doc('\\n                    Task timeout.\\n\\n                    If specified, the task is returned via `qtasks.results.AsyncTask`.\\n                    ')] = None, **kwargs: Annotated[Any, Doc('\\n                    kwargs tasks.\\n\\n                    Default: `{}`.\\n                    ')]) -&gt; Task\n</code></pre> <p>Add a task.</p> <p>Parameters:</p> Name Type Description Default <code>task_name</code> <code>str</code> <p>The name of the task.</p> required <code>priority</code> <code>int</code> <p>Task priority. Default: Task priority value.</p> <code>None</code> <code>args</code> <code>tuple</code> <p>Task args. Default: <code>()</code>.</p> <code>()</code> <code>kwargs</code> <code>dict</code> <p>Task kwargs. Default: <code>{}</code>.</p> <code>{}</code> <code>timeout</code> <code>float</code> <p>Task timeout. If specified, the task is returned via <code>qtasks.results.SyncResult</code> or <code>qtasks.results.AsyncResult</code>.</p> <code>None</code> <p>Returns:</p> Type Description <code>Union[Optional[Task], Awaitable[Optional[Task]], Task, Awaitable[Task]]</code> <p>Task|None: <code>schemas.task.Task</code> or <code>None</code>.</p> Source code in <code>src/qtasks/base/qtasks.py</code> <pre><code>def add_task(\n    self,\n    *args: Annotated[\n        Any,\n        Doc(\"\"\"\n                args of the task.\n\n                Default: `()`.\n                \"\"\"),\n    ],\n    task_name: Annotated[\n        str,\n        Doc(\"\"\"\n                Task name.\n                \"\"\"),\n    ],\n    priority: Annotated[\n        int | None,\n        Doc(\"\"\"\n                The task has priority.\n\n                Default: Task priority value.\n                \"\"\"),\n    ] = None,\n    timeout: Annotated[\n        float | None,\n        Doc(\"\"\"\n                Task timeout.\n\n                If specified, the task is returned via `qtasks.results.AsyncTask`.\n                \"\"\"),\n    ] = None,\n    **kwargs: Annotated[\n        Any,\n        Doc(\"\"\"\n                kwargs tasks.\n\n                Default: `{}`.\n                \"\"\"),\n    ],\n) -&gt; Union[\n    Optional[Task], Awaitable[Optional[Task]], Task, Awaitable[Task]\n]:\n    \"\"\"\n    Add a task.\n\n    Args:\n        task_name (str): The name of the task.\n        priority (int, optional): Task priority. Default: Task priority value.\n        args (tuple, optional): Task args. Default: `()`.\n        kwargs (dict, optional): Task kwargs. Default: `{}`.\n\n        timeout (float, optional): Task timeout. If specified, the task is returned via `qtasks.results.SyncResult` or `qtasks.results.AsyncResult`.\n\n    Returns:\n        Task|None: `schemas.task.Task` or `None`.\n    \"\"\"\n    pass\n</code></pre>"},{"location":"api/classes/baseqtasks/#qtasks.base.qtasks.BaseQueueTasks.include_router","title":"<code>include_router(router)</code>","text":"<p>Add Router.</p> <p>Parameters:</p> Name Type Description Default <code>router</code> <code>Router</code> <p>Router <code>qtasks.routers.SyncRouter</code> | <code>qtasks.routers.AsyncRouter</code>.</p> required Source code in <code>src/qtasks/base/qtasks.py</code> <pre><code>def include_router(\n    self,\n    router: Annotated[\n        SyncRouter | AsyncRouter,\n        Doc(\"\"\"\n                Router `qtasks.routers.SyncRouter` | `qtasks.routers.AsyncRouter`.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Add Router.\n\n    Args:\n        router (Router): Router `qtasks.routers.SyncRouter` | `qtasks.routers.AsyncRouter`.\n    \"\"\"\n    self.routers.append(router)\n    self.tasks.update(router.tasks)\n    self.worker._tasks.update(router.tasks)\n</code></pre>"},{"location":"api/classes/baseqtasks/#qtasks.base.qtasks.BaseQueueTasks.task","title":"<code>task(name=None, *, priority=None, echo=False, max_time=None, retry=None, retry_on_exc=None, decode=None, tags=None, description=None, generate_handler=None, executor=None, middlewares_before=None, middlewares_after=None, **kwargs)</code>","text":"<pre><code>task(name: str | None = None, *, priority: int | None = None, echo: bool = False, max_time: float | None = None, retry: int | None = None, retry_on_exc: list[type[Exception]] | None = None, decode: Callable | None = None, tags: list[str] | None = None, description: str | None = None, generate_handler: Callable | None = None, executor: type[BaseTaskExecutor] | None = None, middlewares_before: list[type[TaskMiddleware]] | None = None, middlewares_after: list[type[TaskMiddleware]] | None = None, **kwargs) -&gt; Callable[[Callable[P, R]], SyncTask[P, R]]\n</code></pre><pre><code>task(name: str | None = None, *, priority: int | None = None, echo: bool = False, max_time: float | None = None, retry: int | None = None, retry_on_exc: list[type[Exception]] | None = None, decode: Callable | None = None, tags: list[str] | None = None, description: str | None = None, generate_handler: Callable | None = None, executor: type[BaseTaskExecutor] | None = None, middlewares_before: list[type[TaskMiddleware]] | None = None, middlewares_after: list[type[TaskMiddleware]] | None = None, **kwargs) -&gt; Callable[[Callable[P, R]], AsyncTask[P, R]]\n</code></pre><pre><code>task(name: Callable[P, R]) -&gt; SyncTask[P, R]\n</code></pre><pre><code>task(name: Callable[P, R]) -&gt; AsyncTask[P, R]\n</code></pre> <p>Decorator for registering tasks.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Name of the task. Default: <code>func.__name__</code>.</p> <code>None</code> <code>priority</code> <code>int</code> <p>The task's default priority. Default: <code>config.task_default_priority</code>.</p> <code>None</code> <code>echo</code> <code>bool</code> <p>Add (A)syncTask as the first parameter. Default: <code>False</code>.</p> <code>False</code> <code>retry</code> <code>int</code> <p>Number of attempts to retry the task. Default: <code>None</code>.</p> <code>None</code> <code>retry_on_exc</code> <code>List[Type[Exception]]</code> <p>Exceptions under which the task will be re-executed. Default: <code>None</code>.</p> <code>None</code> <code>decode</code> <code>Callable</code> <p>Decoder of the task result. Default: <code>None</code>.</p> <code>None</code> <code>tags</code> <code>List[str]</code> <p>Task tags. Default: <code>None</code>.</p> <code>None</code> <code>description</code> <code>str</code> <p>Description of the task. Default: <code>None</code>.</p> <code>None</code> <code>generate_handler</code> <code>Callable</code> <p>Handler generator. Default: <code>None</code>.</p> <code>None</code> <code>executor</code> <code>Type['BaseTaskExecutor']</code> <p><code>BaseTaskExecutor</code> class. Default: <code>SyncTaskExecutor</code>.</p> <code>None</code> <code>middlewares_before</code> <code>List[Type['TaskMiddleware']]</code> <p>Middleware that will be executed before the task. Default: <code>Empty array</code>.</p> <code>None</code> <code>middlewares_after</code> <code>List[Type['TaskMiddleware']]</code> <p>Middleware that will be executed after the task. Default: <code>Empty array</code>.</p> <code>None</code> <p>Raises:</p> Type Description <code>ValueError</code> <p>If a task with the same name is already registered.</p> <code>ValueError</code> <p>Unknown method {self._method}.</p> <code>ValueError</code> <p>Unsupported method {self._method}.</p> <p>Returns:</p> Type Description <code>SyncTask[P, R] | AsyncTask[P, R] | Callable[[Callable[P, R]], SyncTask[P, R] | AsyncTask[P, R]]</code> <p>SyncTask | AsyncTask: Decorator for registering a task.</p> Source code in <code>src/qtasks/base/qtasks.py</code> <pre><code>def task(\n    self,\n    name: Annotated[\n        Callable[P, R] | str | None,\n        Doc(\"\"\"\n                The name of the task or function.\n\n                Default: `func.__name__`.\n                \"\"\"),\n    ] = None,\n    *,\n    priority: Annotated[\n        int | None,\n        Doc(\"\"\"\n                The task has priority by default.\n\n                Default: `config.task_default_priority`.\n                \"\"\"),\n    ] = None,\n    echo: Annotated[\n        bool,\n        Doc(\"\"\"\n                Add (A)syncTask as the first parameter.\n\n                Default: `False`.\n                \"\"\"),\n    ] = False,\n    max_time: Annotated[\n        float | None,\n        Doc(\"\"\"\n                The maximum time it takes to complete a task in seconds.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    retry: Annotated[\n        int | None,\n        Doc(\"\"\"\n                The number of attempts to retry the task.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    retry_on_exc: Annotated[\n        list[type[Exception]] | None,\n        Doc(\"\"\"\n                Exceptions under which the task will be re-executed.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    decode: Annotated[\n        Callable | None,\n        Doc(\"\"\"\n                Task result decoder.\n\n                Default: `None`.\n            \"\"\"),\n    ] = None,\n    tags: Annotated[\n        list[str] | None,\n        Doc(\"\"\"\n                Task tags.\n\n                Default: `None`.\n            \"\"\"),\n    ] = None,\n    description: Annotated[\n        str | None,\n        Doc(\"\"\"\n                Description of the task.\n\n                Default: `None`.\n            \"\"\"),\n    ] = None,\n    generate_handler: Annotated[\n        Callable | None,\n        Doc(\"\"\"\n                Handler generator.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    executor: Annotated[\n        type[BaseTaskExecutor] | None,\n        Doc(\"\"\"\n                Class `BaseTaskExecutor`.\n\n                Default: `SyncTaskExecutor`.\n                \"\"\"),\n    ] = None,\n    middlewares_before: Annotated[\n        list[type[TaskMiddleware]] | None,\n        Doc(\"\"\"\n                Middleware that will be completed before the task.\n\n                Default: `Empty array`.\n                \"\"\"),\n    ] = None,\n    middlewares_after: Annotated[\n        list[type[TaskMiddleware]] | None,\n        Doc(\"\"\"\n                Middleware that will be executed after the task.\n\n                Default: `Empty array`.\n                \"\"\"),\n    ] = None,\n    **kwargs,\n) -&gt; SyncTask[P, R] | AsyncTask[P, R] | Callable[[Callable[P, R]], SyncTask[P, R] | AsyncTask[P, R]]:\n    \"\"\"\n    Decorator for registering tasks.\n\n    Args:\n        name (str, optional): Name of the task. Default: `func.__name__`.\n        priority (int, optional): The task's default priority. Default: `config.task_default_priority`.\n        echo (bool, optional): Add (A)syncTask as the first parameter. Default: `False`.\n        retry (int, optional): Number of attempts to retry the task. Default: `None`.\n        retry_on_exc (List[Type[Exception]], optional): Exceptions under which the task will be re-executed. Default: `None`.\n        decode (Callable, optional): Decoder of the task result. Default: `None`.\n        tags (List[str], optional): Task tags. Default: `None`.\n        description (str, optional): Description of the task. Default: `None`.\n        generate_handler (Callable, optional): Handler generator. Default: `None`.\n        executor (Type[\"BaseTaskExecutor\"], optional): `BaseTaskExecutor` class. Default: `SyncTaskExecutor`.\n        middlewares_before (List[Type[\"TaskMiddleware\"]], optional): Middleware that will be executed before the task. Default: `Empty array`.\n        middlewares_after (List[Type[\"TaskMiddleware\"]], optional): Middleware that will be executed after the task. Default: `Empty array`.\n\n    Raises:\n        ValueError: If a task with the same name is already registered.\n        ValueError: Unknown method {self._method}.\n        ValueError: Unsupported method {self._method}.\n\n    Returns:\n        SyncTask | AsyncTask: Decorator for registering a task.\n    \"\"\"\n\n    def wrapper(func: Callable[P, R]):\n        if not self._method:\n            raise ValueError(f\"Unknown method {self._method}.\")\n        nonlocal priority, middlewares_after, middlewares_before\n        task_name = name or func.__name__ if not callable(name) else name.__name__\n\n        if task_name in self.tasks:\n            raise ValueError(f\"Task with name {task_name} is already registered!\")\n\n        priority = (\n            priority if priority is not None else self.config.task_default_priority\n        )\n\n        generating = (\n            \"async\"\n            if inspect.isasyncgenfunction(func)\n            else \"sync\" if inspect.isgeneratorfunction(func) else False\n        )\n\n        middlewares_before = middlewares_before or []\n        middlewares_after = middlewares_after or []\n\n        model = TaskExecSchema(\n            name=task_name,\n            priority=priority,\n            func=func,\n            awaiting=inspect.iscoroutinefunction(func),\n            generating=generating,\n            echo=echo,\n            max_time=max_time,\n            retry=retry,\n            retry_on_exc=retry_on_exc,\n            decode=decode,\n            tags=tags,\n            description=description,\n            generate_handler=generate_handler,\n            executor=executor,\n            middlewares_before=middlewares_before,\n            middlewares_after=middlewares_after,\n            extra=kwargs,\n        )\n\n        for registry in (self.tasks, self.worker._tasks):\n            registry[task_name] = model\n\n        method_map = {\"async\": AsyncTask, \"sync\": SyncTask}\n        try:\n            method = method_map[self._method]\n        except KeyError as exc:\n            raise ValueError(f\"Unsupported method: {self._method}\") from exc\n\n        return method(\n            app=self,\n            task_name=model.name,\n            priority=model.priority,\n            echo=model.echo,\n            max_time=model.max_time,\n            retry=model.retry,\n            retry_on_exc=model.retry_on_exc,\n            decode=model.decode,\n            tags=model.tags,\n            description=model.description,\n            generate_handler=model.generate_handler,\n            executor=model.executor,\n            middlewares_before=model.middlewares_before,\n            middlewares_after=model.middlewares_after,\n            extra=model.extra,\n        )\n\n    if callable(name):\n        func = name\n        name = func.__name__\n        return wrapper(func)\n    return wrapper\n</code></pre>"},{"location":"api/classes/sync_redis_commands/","title":"SyncRedisCommandQueue","text":"<p>Sync Redis command queue.</p>"},{"location":"api/classes/sync_redis_commands/#qtasks.contrib.redis.sync_queue_client.SyncRedisCommandQueue","title":"<code>SyncRedisCommandQueue</code>","text":"<p><code>SyncRedisCommandQueue</code> - Synchronous class for working with <code>Redis</code>.</p>"},{"location":"api/classes/sync_redis_commands/#qtasks.contrib.redis.sync_queue_client.SyncRedisCommandQueue--example","title":"Example","text":"<pre><code>from qtasks import QueueTasks\nfrom qtasks.contrib.redis import SyncRedisCommandQueue\n\nredis_contrib = SyncRedisCommandQueue(redis)\nredis_contrib.execute(\"hset\", kwargs[\"name\"], mapping=kwargs[\"mapping\"])\n</code></pre> Source code in <code>src/qtasks/contrib/redis/sync_queue_client.py</code> <pre><code>class SyncRedisCommandQueue:\n    \"\"\"\n    `SyncRedisCommandQueue` - Synchronous class for working with `Redis`.\n\n    ## Example\n\n    ```python\n    from qtasks import QueueTasks\n    from qtasks.contrib.redis import SyncRedisCommandQueue\n\n    redis_contrib = SyncRedisCommandQueue(redis)\n    redis_contrib.execute(\"hset\", kwargs[\"name\"], mapping=kwargs[\"mapping\"])\n    ```\n    \"\"\"\n\n    def __init__(self, redis: redis.Redis, log: Logger | None = None):\n        \"\"\"\n        An instance of a class.\n\n        Args:\n            redis (redis.Redis): class `Redis`.\n            log (Logger, optional): class `qtasks.logs.Logger`. Default: `qtasks._state.log_main`.\n        \"\"\"\n        self.log = self._get_log(log)\n        self.redis = redis\n        self.queue = Queue()\n        self.worker_thread = None\n        self.lock = threading.Lock()\n\n    def _worker(self):\n        while not self.queue.empty():\n            try:\n                cmd, args, kwargs = self.queue.get(timeout=2)\n                self.log.debug(f\"Task {cmd} with parameters {args} and {kwargs} executed\")\n                try:\n                    getattr(self.redis, cmd)(*args, **kwargs)\n                except Exception as e:\n                    self.log.error(\n                        f\"Error executing Redis command {cmd}: {e}. Args: {args}, Kwargs: {kwargs}\"\n                    )\n                self.queue.task_done()\n            except Empty:\n                break\n\n        with self.lock:\n            self.worker_thread = None\n\n    def execute(self, cmd: str, *args, **kwargs):\n        \"\"\"\n        Query in `Redis`.\n\n        Args:\n            cmd (str): Command.\n            args(tuple, optional): Parameters to the command via *args.\n            kwargs(dict, optional): Parameters to the command via *args.\n        \"\"\"\n        self.queue.put((cmd, args, kwargs))\n        with self.lock:\n            if self.worker_thread is None or not self.worker_thread.is_alive():\n                self.worker_thread = threading.Thread(target=self._worker, daemon=True)\n                self.worker_thread.start()\n\n    def _get_log(self, log: Logger | None):\n        if log is None:\n            import qtasks._state\n\n            log = qtasks._state.log_main\n        return log.with_subname(\"SyncRedisCommandQueue\")\n</code></pre>"},{"location":"api/classes/sync_redis_commands/#qtasks.contrib.redis.sync_queue_client.SyncRedisCommandQueue.__init__","title":"<code>__init__(redis, log=None)</code>","text":"<p>An instance of a class.</p> <p>Parameters:</p> Name Type Description Default <code>redis</code> <code>Redis</code> <p>class <code>Redis</code>.</p> required <code>log</code> <code>Logger</code> <p>class <code>qtasks.logs.Logger</code>. Default: <code>qtasks._state.log_main</code>.</p> <code>None</code> Source code in <code>src/qtasks/contrib/redis/sync_queue_client.py</code> <pre><code>def __init__(self, redis: redis.Redis, log: Logger | None = None):\n    \"\"\"\n    An instance of a class.\n\n    Args:\n        redis (redis.Redis): class `Redis`.\n        log (Logger, optional): class `qtasks.logs.Logger`. Default: `qtasks._state.log_main`.\n    \"\"\"\n    self.log = self._get_log(log)\n    self.redis = redis\n    self.queue = Queue()\n    self.worker_thread = None\n    self.lock = threading.Lock()\n</code></pre>"},{"location":"api/classes/sync_redis_commands/#qtasks.contrib.redis.sync_queue_client.SyncRedisCommandQueue.execute","title":"<code>execute(cmd, *args, **kwargs)</code>","text":"<p>Query in <code>Redis</code>.</p> <p>Parameters:</p> Name Type Description Default <code>cmd</code> <code>str</code> <p>Command.</p> required <code>args</code> <code>tuple</code> <p>Parameters to the command via *args.</p> <code>()</code> <code>kwargs</code> <code>dict</code> <p>Parameters to the command via *args.</p> <code>{}</code> Source code in <code>src/qtasks/contrib/redis/sync_queue_client.py</code> <pre><code>def execute(self, cmd: str, *args, **kwargs):\n    \"\"\"\n    Query in `Redis`.\n\n    Args:\n        cmd (str): Command.\n        args(tuple, optional): Parameters to the command via *args.\n        kwargs(dict, optional): Parameters to the command via *args.\n    \"\"\"\n    self.queue.put((cmd, args, kwargs))\n    with self.lock:\n        if self.worker_thread is None or not self.worker_thread.is_alive():\n            self.worker_thread = threading.Thread(target=self._worker, daemon=True)\n            self.worker_thread.start()\n</code></pre>"},{"location":"api/contexts/async_context/","title":"AsyncContext","text":"<p>Async context for tasks.</p>"},{"location":"api/contexts/async_context/#qtasks.contexts.async_context.AsyncContext","title":"<code>AsyncContext</code>","text":"<p>Context associated with asynchronous tasks.</p>"},{"location":"api/contexts/async_context/#qtasks.contexts.async_context.AsyncContext--example","title":"Example","text":"<pre><code>from qtasks import QueueTasks\nfrom qtasks.registries import AsyncTask\n\napp = QueueTasks()\n\n@app.task(echo=True)\nasync def my_task(self: AsyncTask):\n    self.ctx #AsyncContext\n</code></pre> Source code in <code>src/qtasks/contexts/async_context.py</code> <pre><code>class AsyncContext:\n    \"\"\"\n    Context associated with asynchronous tasks.\n\n    ## Example\n\n    ```python\n    from qtasks import QueueTasks\n    from qtasks.registries import AsyncTask\n\n    app = QueueTasks()\n\n    @app.task(echo=True)\n    async def my_task(self: AsyncTask):\n        self.ctx #AsyncContext\n    ```\n    \"\"\"\n\n    def __init__(self, **kwargs):\n        \"\"\"Initializing the context.\"\"\"\n        self.task_name = kwargs.get(\"task_name\")\n        \"\"\"Task name.\"\"\"\n\n        self.task_uuid: UUID | str | None = kwargs.get(\"task_uuid\")\n        \"\"\"Task UUID.\"\"\"\n\n        self.generate_handler = kwargs.get(\"generate_handler\")\n        \"\"\"Generator function for creating tasks.\"\"\"\n\n        self._app: QueueTasks = kwargs.get(\"app\", self._update_app())\n        \"\"\"The application the task belongs to.\"\"\"\n\n        self._log: Logger = kwargs.get(\"log\", self._update_logger())\n        \"\"\"Logger.\"\"\"\n\n        self._metadata: Task | None = None\n        \"\"\"Task metadata.\"\"\"\n\n    def get_logger(self, name: str | None = None) -&gt; Logger:\n        \"\"\"\n        Returns a logger for the current context.\n\n        Args:\n            name (str|None): Logger name. If not specified, the task name or `AsyncContext` is used.\n\n        Returns:\n            Logger: Logger for the current context.\n        \"\"\"\n        self._log = self._log.with_subname(name or self.task_name or \"AsyncContext\")\n        return self._log\n\n    def get_config(self) -&gt; QueueConfig:\n        \"\"\"\n        Returns the application configuration.\n\n                Returns:\n                    QueueConfig: Application configuration.\n        \"\"\"\n        return self._app.config\n\n    async def get_metadata(self, cache=True) -&gt; Union[Task, None]:\n        \"\"\"\n        Returns task metadata.\n\n        Args:\n            cache (bool): Use cached metadata.\n\n        Returns:\n            Task|None: Task metadata or None if not found.\n\n        Raises:\n            ValueError: Task UUID is not set.\n        \"\"\"\n        if not self.task_uuid:\n            raise ValueError(\"Task UUID is not set.\")\n\n        if cache:\n            if not self._metadata:\n                self._metadata = await self._app.get(self.task_uuid)\n            return self._metadata\n        return await self._app.get(self.task_uuid)\n\n    async def get_task(self, uuid: UUID | str) -&gt; Union[Task, None]:\n        \"\"\"\n        Returns the task by UUID.\n\n        Args:\n            uuid (UUID|str): UUID of the task.\n\n        Returns:\n            Task|None: Task or None if not found.\n        \"\"\"\n        return await self._app.get(uuid)\n\n    async def sleep(self, seconds: float) -&gt; None:\n        \"\"\"\n        Pauses execution for the specified number of seconds.\n\n        Args:\n            seconds (float): Number of seconds to pause.\n        \"\"\"\n        await asyncio.sleep(seconds)\n\n    def cancel(self, reason: str = \"\") -&gt; NoReturn:\n        \"\"\"\n        Cancels the task.\n\n        Args:\n            reason (str): Reason for canceling the task.\n\n        Raises:\n            TaskCancelError: The exception thrown when a task is canceled.\n        \"\"\"\n        raise TaskCancelError(reason or f\"{self.task_name}.cancel\")\n\n    def plugin_error(self, **kwargs):\n        \"\"\"\n        Causes a plugin error.\n\n        Args:\n            **kwargs: Arguments to pass to the plugin error handler.\n        \"\"\"\n        raise TaskPluginTriggerError(**kwargs)\n\n    def get_component(self, name: str):\n        \"\"\"\n        Returns the application component by name.\n\n        Args:\n            name (str): Component name.\n\n        Returns:\n            Any: Application component or None if not found.\n        \"\"\"\n        return getattr(self._app, name, None)\n\n    def _update_app(self):\n        \"\"\"Updates the application for the current context.\"\"\"\n        import qtasks._state\n\n        app = qtasks._state.app_main  # type: ignore\n        return app\n\n    def _update_logger(self) -&gt; Logger:\n        if self._app and self._app.log:\n            log = self._app.log.with_subname(self.task_name or \"AsyncContext\")\n        else:\n            import qtasks._state\n\n            log = qtasks._state.log_main.with_subname(self.task_name or \"AsyncContext\")\n        return log\n\n    def _update(self, **kwargs):\n        \"\"\"\n        Updates context attributes.\n\n        Args:\n            kwargs (dict, optional): New context attribute values.\n        \"\"\"\n        for name, value in kwargs.items():\n            setattr(self, name, value)\n        return\n</code></pre>"},{"location":"api/contexts/async_context/#qtasks.contexts.async_context.AsyncContext.generate_handler","title":"<code>generate_handler = kwargs.get('generate_handler')</code>  <code>instance-attribute</code>","text":"<p>Generator function for creating tasks.</p>"},{"location":"api/contexts/async_context/#qtasks.contexts.async_context.AsyncContext.task_name","title":"<code>task_name = kwargs.get('task_name')</code>  <code>instance-attribute</code>","text":"<p>Task name.</p>"},{"location":"api/contexts/async_context/#qtasks.contexts.async_context.AsyncContext.task_uuid","title":"<code>task_uuid = kwargs.get('task_uuid')</code>  <code>instance-attribute</code>","text":"<p>Task UUID.</p>"},{"location":"api/contexts/async_context/#qtasks.contexts.async_context.AsyncContext.__init__","title":"<code>__init__(**kwargs)</code>","text":"<p>Initializing the context.</p> Source code in <code>src/qtasks/contexts/async_context.py</code> <pre><code>def __init__(self, **kwargs):\n    \"\"\"Initializing the context.\"\"\"\n    self.task_name = kwargs.get(\"task_name\")\n    \"\"\"Task name.\"\"\"\n\n    self.task_uuid: UUID | str | None = kwargs.get(\"task_uuid\")\n    \"\"\"Task UUID.\"\"\"\n\n    self.generate_handler = kwargs.get(\"generate_handler\")\n    \"\"\"Generator function for creating tasks.\"\"\"\n\n    self._app: QueueTasks = kwargs.get(\"app\", self._update_app())\n    \"\"\"The application the task belongs to.\"\"\"\n\n    self._log: Logger = kwargs.get(\"log\", self._update_logger())\n    \"\"\"Logger.\"\"\"\n\n    self._metadata: Task | None = None\n    \"\"\"Task metadata.\"\"\"\n</code></pre>"},{"location":"api/contexts/async_context/#qtasks.contexts.async_context.AsyncContext.cancel","title":"<code>cancel(reason='')</code>","text":"<p>Cancels the task.</p> <p>Parameters:</p> Name Type Description Default <code>reason</code> <code>str</code> <p>Reason for canceling the task.</p> <code>''</code> <p>Raises:</p> Type Description <code>TaskCancelError</code> <p>The exception thrown when a task is canceled.</p> Source code in <code>src/qtasks/contexts/async_context.py</code> <pre><code>def cancel(self, reason: str = \"\") -&gt; NoReturn:\n    \"\"\"\n    Cancels the task.\n\n    Args:\n        reason (str): Reason for canceling the task.\n\n    Raises:\n        TaskCancelError: The exception thrown when a task is canceled.\n    \"\"\"\n    raise TaskCancelError(reason or f\"{self.task_name}.cancel\")\n</code></pre>"},{"location":"api/contexts/async_context/#qtasks.contexts.async_context.AsyncContext.get_component","title":"<code>get_component(name)</code>","text":"<p>Returns the application component by name.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Component name.</p> required <p>Returns:</p> Name Type Description <code>Any</code> <p>Application component or None if not found.</p> Source code in <code>src/qtasks/contexts/async_context.py</code> <pre><code>def get_component(self, name: str):\n    \"\"\"\n    Returns the application component by name.\n\n    Args:\n        name (str): Component name.\n\n    Returns:\n        Any: Application component or None if not found.\n    \"\"\"\n    return getattr(self._app, name, None)\n</code></pre>"},{"location":"api/contexts/async_context/#qtasks.contexts.async_context.AsyncContext.get_config","title":"<code>get_config()</code>","text":"<p>Returns the application configuration.</p> <pre><code>    Returns:\n        QueueConfig: Application configuration.\n</code></pre> Source code in <code>src/qtasks/contexts/async_context.py</code> <pre><code>def get_config(self) -&gt; QueueConfig:\n    \"\"\"\n    Returns the application configuration.\n\n            Returns:\n                QueueConfig: Application configuration.\n    \"\"\"\n    return self._app.config\n</code></pre>"},{"location":"api/contexts/async_context/#qtasks.contexts.async_context.AsyncContext.get_logger","title":"<code>get_logger(name=None)</code>","text":"<p>Returns a logger for the current context.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str | None</code> <p>Logger name. If not specified, the task name or <code>AsyncContext</code> is used.</p> <code>None</code> <p>Returns:</p> Name Type Description <code>Logger</code> <code>Logger</code> <p>Logger for the current context.</p> Source code in <code>src/qtasks/contexts/async_context.py</code> <pre><code>def get_logger(self, name: str | None = None) -&gt; Logger:\n    \"\"\"\n    Returns a logger for the current context.\n\n    Args:\n        name (str|None): Logger name. If not specified, the task name or `AsyncContext` is used.\n\n    Returns:\n        Logger: Logger for the current context.\n    \"\"\"\n    self._log = self._log.with_subname(name or self.task_name or \"AsyncContext\")\n    return self._log\n</code></pre>"},{"location":"api/contexts/async_context/#qtasks.contexts.async_context.AsyncContext.get_metadata","title":"<code>get_metadata(cache=True)</code>  <code>async</code>","text":"<p>Returns task metadata.</p> <p>Parameters:</p> Name Type Description Default <code>cache</code> <code>bool</code> <p>Use cached metadata.</p> <code>True</code> <p>Returns:</p> Type Description <code>Union[Task, None]</code> <p>Task|None: Task metadata or None if not found.</p> <p>Raises:</p> Type Description <code>ValueError</code> <p>Task UUID is not set.</p> Source code in <code>src/qtasks/contexts/async_context.py</code> <pre><code>async def get_metadata(self, cache=True) -&gt; Union[Task, None]:\n    \"\"\"\n    Returns task metadata.\n\n    Args:\n        cache (bool): Use cached metadata.\n\n    Returns:\n        Task|None: Task metadata or None if not found.\n\n    Raises:\n        ValueError: Task UUID is not set.\n    \"\"\"\n    if not self.task_uuid:\n        raise ValueError(\"Task UUID is not set.\")\n\n    if cache:\n        if not self._metadata:\n            self._metadata = await self._app.get(self.task_uuid)\n        return self._metadata\n    return await self._app.get(self.task_uuid)\n</code></pre>"},{"location":"api/contexts/async_context/#qtasks.contexts.async_context.AsyncContext.get_task","title":"<code>get_task(uuid)</code>  <code>async</code>","text":"<p>Returns the task by UUID.</p> <p>Parameters:</p> Name Type Description Default <code>uuid</code> <code>UUID | str</code> <p>UUID of the task.</p> required <p>Returns:</p> Type Description <code>Union[Task, None]</code> <p>Task|None: Task or None if not found.</p> Source code in <code>src/qtasks/contexts/async_context.py</code> <pre><code>async def get_task(self, uuid: UUID | str) -&gt; Union[Task, None]:\n    \"\"\"\n    Returns the task by UUID.\n\n    Args:\n        uuid (UUID|str): UUID of the task.\n\n    Returns:\n        Task|None: Task or None if not found.\n    \"\"\"\n    return await self._app.get(uuid)\n</code></pre>"},{"location":"api/contexts/async_context/#qtasks.contexts.async_context.AsyncContext.plugin_error","title":"<code>plugin_error(**kwargs)</code>","text":"<p>Causes a plugin error.</p> <p>Parameters:</p> Name Type Description Default <code>**kwargs</code> <p>Arguments to pass to the plugin error handler.</p> <code>{}</code> Source code in <code>src/qtasks/contexts/async_context.py</code> <pre><code>def plugin_error(self, **kwargs):\n    \"\"\"\n    Causes a plugin error.\n\n    Args:\n        **kwargs: Arguments to pass to the plugin error handler.\n    \"\"\"\n    raise TaskPluginTriggerError(**kwargs)\n</code></pre>"},{"location":"api/contexts/async_context/#qtasks.contexts.async_context.AsyncContext.sleep","title":"<code>sleep(seconds)</code>  <code>async</code>","text":"<p>Pauses execution for the specified number of seconds.</p> <p>Parameters:</p> Name Type Description Default <code>seconds</code> <code>float</code> <p>Number of seconds to pause.</p> required Source code in <code>src/qtasks/contexts/async_context.py</code> <pre><code>async def sleep(self, seconds: float) -&gt; None:\n    \"\"\"\n    Pauses execution for the specified number of seconds.\n\n    Args:\n        seconds (float): Number of seconds to pause.\n    \"\"\"\n    await asyncio.sleep(seconds)\n</code></pre>"},{"location":"api/contexts/sync_context/","title":"SyncContext","text":"<p>Sync context for tasks.</p>"},{"location":"api/contexts/sync_context/#qtasks.contexts.sync_context.SyncContext","title":"<code>SyncContext</code>","text":"<p>Context associated with synchronous tasks.</p>"},{"location":"api/contexts/sync_context/#qtasks.contexts.sync_context.SyncContext--example","title":"Example","text":"<pre><code>from qtasks import QueueTasks\nfrom qtasks.registries import SyncTask\n\napp = QueueTasks()\n\n@app.task(echo=True)\ndef my_task(self: SyncTask):\n    self.ctx # SyncContext\n</code></pre> Source code in <code>src/qtasks/contexts/sync_context.py</code> <pre><code>class SyncContext:\n    \"\"\"\n    Context associated with synchronous tasks.\n\n    ## Example\n\n    ```python\n    from qtasks import QueueTasks\n    from qtasks.registries import SyncTask\n\n    app = QueueTasks()\n\n    @app.task(echo=True)\n    def my_task(self: SyncTask):\n        self.ctx # SyncContext\n    ```\n    \"\"\"\n\n    def __init__(self, **kwargs):\n        \"\"\"Initializing the context.\"\"\"\n        self.task_name = kwargs.get(\"task_name\")\n        \"\"\"Task name.\"\"\"\n\n        self.task_uuid: UUID | str | None = kwargs.get(\"task_uuid\")\n        \"\"\"Task UUID.\"\"\"\n\n        self.generate_handler = kwargs.get(\"generate_handler\")\n        \"\"\"Generator function for creating tasks.\"\"\"\n\n        self._app: QueueTasks = kwargs.get(\"app\", self._update_app())\n        \"\"\"The application the task belongs to.\"\"\"\n\n        self._log: Logger = kwargs.get(\"log\", self._update_logger())\n        \"\"\"Logger.\"\"\"\n\n        self._metadata: Task | None = None\n        \"\"\"Task metadata.\"\"\"\n\n    def get_logger(self, name: str | None = None) -&gt; Logger:\n        \"\"\"\n        Returns a logger for the current context.\n\n        Args:\n            name (str|None): Logger name. If not specified, the task name is used.\n\n        Returns:\n            Logger: Logger for the current context.\n        \"\"\"\n        self._log = self._log.with_subname(name or self.task_name or \"SyncContext\")\n        return self._log\n\n    def get_config(self) -&gt; QueueConfig:\n        \"\"\"\n        Returns the application configuration.\n\n        Returns:\n            QueueConfig: Application configuration.\n        \"\"\"\n        return self._app.config\n\n    def get_metadata(self, cache=True) -&gt; Union[Task, None]:\n        \"\"\"\n        Returns task metadata.\n\n        Args:\n            cache (bool): Use cached metadata.\n\n        Returns:\n            Task|None: Task metadata or None if not found.\n\n        Raises:\n            ValueError: Task UUID is not set.\n        \"\"\"\n        if not self.task_uuid:\n            raise ValueError(\"Task UUID is not set.\")\n\n        if cache:\n            if not self._metadata:\n                self._metadata = self._app.get(self.task_uuid)\n            return self._metadata\n        return self._app.get(self.task_uuid)\n\n    def get_task(self, uuid: UUID | str) -&gt; Union[Task, None]:\n        \"\"\"\n        Returns the task by UUID.\n\n        Args:\n            uuid (UUID|str): UUID of the task.\n\n        Returns:\n            Task|None: Task or None if not found.\n        \"\"\"\n        return self._app.get(uuid)\n\n    def sleep(self, seconds: float) -&gt; None:\n        \"\"\"\n        Pauses execution for the specified number of seconds.\n\n        Args:\n            seconds (float): Number of seconds to pause.\n        \"\"\"\n        time.sleep(seconds)\n        return\n\n    def cancel(self, reason: str = \"\") -&gt; NoReturn:\n        \"\"\"\n        Cancels the task.\n\n        Args:\n            reason (str): Reason for canceling the task.\n\n        Raises:\n            TaskCancelError: The exception thrown when a task is canceled.\n        \"\"\"\n        raise TaskCancelError(reason or f\"{self.task_name}.cancel\")\n\n    def plugin_error(self, **kwargs):\n        \"\"\"\n        Causes a plugin error.\n\n        Args:\n            **kwargs: Arguments to pass to the plugin error handler.\n        \"\"\"\n        raise TaskPluginTriggerError(**kwargs)\n\n    def get_component(self, name: str):\n        \"\"\"\n        Returns the application component by name.\n\n        Args:\n            name (str): Component name.\n\n        Returns:\n            Any: Application component or None if not found.\n        \"\"\"\n        return getattr(self._app, name, None)\n\n    def _update_app(self):\n        \"\"\"Updates the application for the current context.\"\"\"\n        import qtasks._state\n\n        app = qtasks._state.app_main  # type: ignore\n        return app\n\n    def _update_logger(self) -&gt; Logger:\n        if self._app and self._app.log:\n            log = self._app.log.with_subname(self.task_name or \"SyncContext\")\n        else:\n            import qtasks._state\n\n            log = qtasks._state.log_main.with_subname(self.task_name or \"SyncContext\")\n        return log\n\n    def _update(self, **kwargs):\n        \"\"\"\n        Updates context attributes.\n\n        Args:\n            kwargs (dict, optional): New context attribute values.\n        \"\"\"\n        for name, value in kwargs.items():\n            setattr(self, name, value)\n        return\n</code></pre>"},{"location":"api/contexts/sync_context/#qtasks.contexts.sync_context.SyncContext.generate_handler","title":"<code>generate_handler = kwargs.get('generate_handler')</code>  <code>instance-attribute</code>","text":"<p>Generator function for creating tasks.</p>"},{"location":"api/contexts/sync_context/#qtasks.contexts.sync_context.SyncContext.task_name","title":"<code>task_name = kwargs.get('task_name')</code>  <code>instance-attribute</code>","text":"<p>Task name.</p>"},{"location":"api/contexts/sync_context/#qtasks.contexts.sync_context.SyncContext.task_uuid","title":"<code>task_uuid = kwargs.get('task_uuid')</code>  <code>instance-attribute</code>","text":"<p>Task UUID.</p>"},{"location":"api/contexts/sync_context/#qtasks.contexts.sync_context.SyncContext.__init__","title":"<code>__init__(**kwargs)</code>","text":"<p>Initializing the context.</p> Source code in <code>src/qtasks/contexts/sync_context.py</code> <pre><code>def __init__(self, **kwargs):\n    \"\"\"Initializing the context.\"\"\"\n    self.task_name = kwargs.get(\"task_name\")\n    \"\"\"Task name.\"\"\"\n\n    self.task_uuid: UUID | str | None = kwargs.get(\"task_uuid\")\n    \"\"\"Task UUID.\"\"\"\n\n    self.generate_handler = kwargs.get(\"generate_handler\")\n    \"\"\"Generator function for creating tasks.\"\"\"\n\n    self._app: QueueTasks = kwargs.get(\"app\", self._update_app())\n    \"\"\"The application the task belongs to.\"\"\"\n\n    self._log: Logger = kwargs.get(\"log\", self._update_logger())\n    \"\"\"Logger.\"\"\"\n\n    self._metadata: Task | None = None\n    \"\"\"Task metadata.\"\"\"\n</code></pre>"},{"location":"api/contexts/sync_context/#qtasks.contexts.sync_context.SyncContext.cancel","title":"<code>cancel(reason='')</code>","text":"<p>Cancels the task.</p> <p>Parameters:</p> Name Type Description Default <code>reason</code> <code>str</code> <p>Reason for canceling the task.</p> <code>''</code> <p>Raises:</p> Type Description <code>TaskCancelError</code> <p>The exception thrown when a task is canceled.</p> Source code in <code>src/qtasks/contexts/sync_context.py</code> <pre><code>def cancel(self, reason: str = \"\") -&gt; NoReturn:\n    \"\"\"\n    Cancels the task.\n\n    Args:\n        reason (str): Reason for canceling the task.\n\n    Raises:\n        TaskCancelError: The exception thrown when a task is canceled.\n    \"\"\"\n    raise TaskCancelError(reason or f\"{self.task_name}.cancel\")\n</code></pre>"},{"location":"api/contexts/sync_context/#qtasks.contexts.sync_context.SyncContext.get_component","title":"<code>get_component(name)</code>","text":"<p>Returns the application component by name.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Component name.</p> required <p>Returns:</p> Name Type Description <code>Any</code> <p>Application component or None if not found.</p> Source code in <code>src/qtasks/contexts/sync_context.py</code> <pre><code>def get_component(self, name: str):\n    \"\"\"\n    Returns the application component by name.\n\n    Args:\n        name (str): Component name.\n\n    Returns:\n        Any: Application component or None if not found.\n    \"\"\"\n    return getattr(self._app, name, None)\n</code></pre>"},{"location":"api/contexts/sync_context/#qtasks.contexts.sync_context.SyncContext.get_config","title":"<code>get_config()</code>","text":"<p>Returns the application configuration.</p> <p>Returns:</p> Name Type Description <code>QueueConfig</code> <code>QueueConfig</code> <p>Application configuration.</p> Source code in <code>src/qtasks/contexts/sync_context.py</code> <pre><code>def get_config(self) -&gt; QueueConfig:\n    \"\"\"\n    Returns the application configuration.\n\n    Returns:\n        QueueConfig: Application configuration.\n    \"\"\"\n    return self._app.config\n</code></pre>"},{"location":"api/contexts/sync_context/#qtasks.contexts.sync_context.SyncContext.get_logger","title":"<code>get_logger(name=None)</code>","text":"<p>Returns a logger for the current context.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str | None</code> <p>Logger name. If not specified, the task name is used.</p> <code>None</code> <p>Returns:</p> Name Type Description <code>Logger</code> <code>Logger</code> <p>Logger for the current context.</p> Source code in <code>src/qtasks/contexts/sync_context.py</code> <pre><code>def get_logger(self, name: str | None = None) -&gt; Logger:\n    \"\"\"\n    Returns a logger for the current context.\n\n    Args:\n        name (str|None): Logger name. If not specified, the task name is used.\n\n    Returns:\n        Logger: Logger for the current context.\n    \"\"\"\n    self._log = self._log.with_subname(name or self.task_name or \"SyncContext\")\n    return self._log\n</code></pre>"},{"location":"api/contexts/sync_context/#qtasks.contexts.sync_context.SyncContext.get_metadata","title":"<code>get_metadata(cache=True)</code>","text":"<p>Returns task metadata.</p> <p>Parameters:</p> Name Type Description Default <code>cache</code> <code>bool</code> <p>Use cached metadata.</p> <code>True</code> <p>Returns:</p> Type Description <code>Union[Task, None]</code> <p>Task|None: Task metadata or None if not found.</p> <p>Raises:</p> Type Description <code>ValueError</code> <p>Task UUID is not set.</p> Source code in <code>src/qtasks/contexts/sync_context.py</code> <pre><code>def get_metadata(self, cache=True) -&gt; Union[Task, None]:\n    \"\"\"\n    Returns task metadata.\n\n    Args:\n        cache (bool): Use cached metadata.\n\n    Returns:\n        Task|None: Task metadata or None if not found.\n\n    Raises:\n        ValueError: Task UUID is not set.\n    \"\"\"\n    if not self.task_uuid:\n        raise ValueError(\"Task UUID is not set.\")\n\n    if cache:\n        if not self._metadata:\n            self._metadata = self._app.get(self.task_uuid)\n        return self._metadata\n    return self._app.get(self.task_uuid)\n</code></pre>"},{"location":"api/contexts/sync_context/#qtasks.contexts.sync_context.SyncContext.get_task","title":"<code>get_task(uuid)</code>","text":"<p>Returns the task by UUID.</p> <p>Parameters:</p> Name Type Description Default <code>uuid</code> <code>UUID | str</code> <p>UUID of the task.</p> required <p>Returns:</p> Type Description <code>Union[Task, None]</code> <p>Task|None: Task or None if not found.</p> Source code in <code>src/qtasks/contexts/sync_context.py</code> <pre><code>def get_task(self, uuid: UUID | str) -&gt; Union[Task, None]:\n    \"\"\"\n    Returns the task by UUID.\n\n    Args:\n        uuid (UUID|str): UUID of the task.\n\n    Returns:\n        Task|None: Task or None if not found.\n    \"\"\"\n    return self._app.get(uuid)\n</code></pre>"},{"location":"api/contexts/sync_context/#qtasks.contexts.sync_context.SyncContext.plugin_error","title":"<code>plugin_error(**kwargs)</code>","text":"<p>Causes a plugin error.</p> <p>Parameters:</p> Name Type Description Default <code>**kwargs</code> <p>Arguments to pass to the plugin error handler.</p> <code>{}</code> Source code in <code>src/qtasks/contexts/sync_context.py</code> <pre><code>def plugin_error(self, **kwargs):\n    \"\"\"\n    Causes a plugin error.\n\n    Args:\n        **kwargs: Arguments to pass to the plugin error handler.\n    \"\"\"\n    raise TaskPluginTriggerError(**kwargs)\n</code></pre>"},{"location":"api/contexts/sync_context/#qtasks.contexts.sync_context.SyncContext.sleep","title":"<code>sleep(seconds)</code>","text":"<p>Pauses execution for the specified number of seconds.</p> <p>Parameters:</p> Name Type Description Default <code>seconds</code> <code>float</code> <p>Number of seconds to pause.</p> required Source code in <code>src/qtasks/contexts/sync_context.py</code> <pre><code>def sleep(self, seconds: float) -&gt; None:\n    \"\"\"\n    Pauses execution for the specified number of seconds.\n\n    Args:\n        seconds (float): Number of seconds to pause.\n    \"\"\"\n    time.sleep(seconds)\n    return\n</code></pre>"},{"location":"api/executors/async_task_executor/","title":"AsyncTaskExecutor","text":"<p>Async Task Executor.</p>"},{"location":"api/executors/async_task_executor/#qtasks.executors.async_task_executor.AsyncTaskExecutor","title":"<code>AsyncTaskExecutor</code>","text":"<p>               Bases: <code>BaseTaskExecutor</code>, <code>AsyncPluginMixin</code></p> <p><code>AsyncTaskExecutor</code> - Synchronous task executor class. Used by default in <code>AsyncWorker</code>.</p>"},{"location":"api/executors/async_task_executor/#qtasks.executors.async_task_executor.AsyncTaskExecutor--example","title":"Example","text":"<pre><code>import asyncio\nfrom qtasks.executors import AsyncTaskExecutor\n\ntask_func = TaskExecSchema(...)\ntask_broker = TaskPrioritySchema(...)\nexecutor = AsyncTaskExecutor(task_func, task_broker)\nresult = asyncio.run(executor.execute())\n</code></pre> Source code in <code>src/qtasks/executors/async_task_executor.py</code> <pre><code>class AsyncTaskExecutor(BaseTaskExecutor, AsyncPluginMixin):\n    \"\"\"\n    `AsyncTaskExecutor` - Synchronous task executor class. Used by default in `AsyncWorker`.\n\n    ## Example\n\n    ```python\n    import asyncio\n    from qtasks.executors import AsyncTaskExecutor\n\n    task_func = TaskExecSchema(...)\n    task_broker = TaskPrioritySchema(...)\n    executor = AsyncTaskExecutor(task_func, task_broker)\n    result = asyncio.run(executor.execute())\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        task_func: Annotated[\n            TaskExecSchema,\n            Doc(\"\"\"\n                    `TaskExecSchema` schema.\n                    \"\"\"),\n        ],\n        task_broker: Annotated[\n            TaskPrioritySchema,\n            Doc(\"\"\"\n                    `TaskPrioritySchema` schema.\n                    \"\"\"),\n        ],\n        log: Annotated[\n            Logger | None,\n            Doc(\"\"\"\n                    Logger.\n\n                    Default: `qtasks.logs.Logger`.\n                    \"\"\"),\n        ] = None,\n        plugins: Annotated[\n            dict[str, list[BasePlugin]] | None,\n            Doc(\"\"\"\n                    Array of Plugins.\n\n                    Default: `Empty array`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Initializing the class. Occurs inside a `Worker` before a task is processed.\n\n        Args:\n            task_func (TaskExecSchema): Schema `TaskExecSchema`.\n            task_broker(TaskPrioritySchema): Schema `TaskPrioritySchema`.\n            log (Logger, optional): class `qtasks.logs.Logger`. Default: `qtasks._state.log_main`.\n            plugins (Dict[str, List[BasePlugin]], optional): An array of plugins. Default: `Empty array`.\n        \"\"\"\n        super().__init__(\n            task_func=task_func,\n            task_broker=task_broker,\n            log=log,\n            plugins=plugins,\n        )\n\n    async def before_execute(self):\n        \"\"\"Called before a task is executed.\"\"\"\n        if self.task_func.echo:\n            task_cls = (\n                SyncTask\n                if not self.task_func.awaiting or self.task_func.generating == \"sync\"\n                else AsyncTask\n            )\n            self.echo = task_cls(\n                task_name=self.task_broker.name,\n                priority=self.task_broker.priority,\n                echo=self.task_func.echo,\n                retry=self.task_func.retry,\n                retry_on_exc=self.task_func.retry_on_exc,\n                decode=self.task_func.decode,\n                tags=self.task_func.tags,\n                description=self.task_func.description,\n                executor=self.task_func.executor,\n                middlewares_before=self.task_func.middlewares_before,\n                middlewares_after=self.task_func.middlewares_after,\n                extra=self.task_func.extra,\n            )\n            self.echo.ctx._update(task_uuid=self.task_broker.uuid)\n            self._args.insert(0, self.echo)\n\n        args_from_func = self._extract_args_kwargs_from_func(self.task_func.func)\n        args_info = self._build_args_info(args_from_func[0], args_from_func[1])\n        new_args = await self._plugin_trigger(\n            \"task_executor_args_replace\",\n            task_executor=self,\n            **{\n                \"args\": self._args,\n                \"kw\": self._kwargs,\n                \"args_info\": args_info,\n            },\n            return_last=True,\n        )\n        if new_args:\n            self._args = new_args.get(\"args\", self._args)\n            self._kwargs = new_args.get(\"kw\", self._kwargs)\n\n        await self._plugin_trigger(\"task_executor_before_execute\", task_executor=self)\n\n    async def after_execute(self):\n        \"\"\"Call after starting tasks.\"\"\"\n        await self._plugin_trigger(\"task_executor_after_execute\", task_executor=self)\n        result: Any = await self._plugin_trigger(\n            \"task_executor_after_execute_result_replace\",\n            task_executor=self,\n            result=self._result,\n            return_last=True,\n        )\n        if result:\n            self._result = result.get(\"result\", self._result)\n        return\n\n    async def execute_middlewares_before(self):\n        \"\"\"Calling middleware before the task is completed.\"\"\"\n        await self._plugin_trigger(\n            \"task_executor_middlewares_execute\",\n            task_executor=self,\n            middlewares_before=self.task_func.middlewares_before,\n        )\n        for m in self.task_func.middlewares_before:\n            m = m(self)\n            new_task_executor: BaseTaskExecutor = await m()\n            if new_task_executor:\n                self = new_task_executor\n            if self.log:\n                self.log.debug(f\"Middleware {m.name} for {self.task_func.name} was called.\")\n\n    async def execute_middlewares_after(self):\n        \"\"\"Calling middleware after completing a task.\"\"\"\n        await self._plugin_trigger(\n            \"task_executor_middlewares_execute\",\n            task_executor=self,\n            middlewares_after=self.task_func.middlewares_after,\n        )\n        for m in self.task_func.middlewares_after:\n            m = m(self)\n            new_task_executor: BaseTaskExecutor = await m()\n            if new_task_executor:\n                self = new_task_executor\n            if self.log:\n                self.log.debug(f\"Middleware {m.name} for {self.task_func.name} was called.\")\n\n    async def run_task(self) -&gt; Any:\n        \"\"\"\n        Calling a task.\n\n        Returns:\n            Any: Result of the task.\n        \"\"\"\n        if self._args and self._kwargs:\n            result = (\n                await self.task_func.func(*self._args, **self._kwargs)\n                if self.task_func.awaiting\n                else self.task_func.func(*self._args, **self._kwargs)\n            )\n        elif self._args:\n            result = (\n                await self.task_func.func(*self._args)\n                if self.task_func.awaiting\n                else self.task_func.func(*self._args)\n            )\n        elif self._kwargs:\n            result = (\n                await self.task_func.func(**self._kwargs)\n                if self.task_func.awaiting\n                else self.task_func.func(**self._kwargs)\n            )\n        else:\n            result = (\n                await self.task_func.func()\n                if self.task_func.awaiting\n                else self.task_func.func()\n            )\n\n        if self.task_func.generating:\n            return await self.run_task_gen(result)\n\n        new_result = await self._plugin_trigger(\n            \"task_executor_run_task\", task_executor=self, result=result\n        )\n        if new_result:\n            result = new_result.get(\"result\", result)\n\n        return result\n\n    async def run_task_gen(self, func: AsyncGenerator | Generator) -&gt; list[Any]:\n        \"\"\"\n        Calling the task generator.\n\n        Args:\n            func(AsyncGenerator, Generator): Function.\n\n        Returns:\n            Any: Result of the task.\n        \"\"\"\n        if self.echo:\n            self.echo.ctx._update(generate_handler=self.task_func.generate_handler)\n\n        results = []\n        if self.task_func.generating == \"async\":\n            if isinstance(func, AsyncGenerator):\n                async for result in func:\n                    if self.task_func.generate_handler:\n                        result = await self._maybe_await(\n                            self.task_func.generate_handler(result)\n                        )\n                    results.append(result)\n\n        elif self.task_func.generating == \"sync\":\n            if isinstance(func, Generator):\n                try:\n                    while True:\n                        result = next(func)\n                        if self.task_func.generate_handler:\n                            result = await self._maybe_await(\n                                self.task_func.generate_handler(result)\n                            )\n                        results.append(result)\n                except StopIteration:\n                    pass\n        new_results = await self._plugin_trigger(\n            \"task_executor_run_task_gen\", task_executor=self, results=results\n        )\n        if new_results:\n            results = new_results.get(\"results\", results)\n        return results\n\n    async def _maybe_await(self, value):\n        if asyncio.iscoroutine(value):\n            return await value\n        return value\n\n    async def execute(self, decode: bool = True) -&gt; Any | str:\n        \"\"\"\n        Calling a task.\n\n        Args:\n            decode (bool, optional): Decoding the result of the task. Default: True.\n\n        Returns:\n            Any|str: Result of the task.\n        \"\"\"\n        if self.log:\n            self.log.debug(f\"Called execute for {self.task_func.name}\")\n\n        await self.execute_middlewares_before()\n        await self.before_execute()\n        try:\n            if self.task_func.max_time:\n                self._result = await asyncio.wait_for(\n                    self.run_task(), timeout=self.task_func.max_time\n                )\n            else:\n                self._result = await self.run_task()\n        except TaskPluginTriggerError as e:\n            new_result = await self._plugin_trigger(\n                \"task_executor_run_task_trigger_error\",\n                task_executor=self,\n                task_func=self.task_func,\n                task_broker=self.task_broker,\n                e=e,\n                return_last=True,\n            )\n            if new_result:\n                self._result = new_result.get(\"result\", self._result)\n            else:\n                raise e\n        except asyncio.TimeoutError as exc:\n            msg = f\"Time limit exceeded for task {self.task_func.name}: {self.task_func.max_time} seconds\"\n            if self.log:\n                self.log.error(msg)\n            raise asyncio.TimeoutError(msg) from exc\n\n        await self.after_execute()\n        await self.execute_middlewares_after()\n        if decode:\n            self._result = await self.decode()\n\n        await self._plugin_trigger(\n                \"task_executor_task_close\",\n                task_executor=self,\n                task_func=self.task_func,\n                task_broker=self.task_broker\n            )\n        return self._result\n\n    async def decode(self) -&gt; Any:\n        \"\"\"\n        Decoding the task.\n\n        Returns:\n            Any: Result of the task.\n        \"\"\"\n        if self.task_func.decode is not None:\n            result = await self._maybe_await(self.task_func.decode(self._result))\n        else:\n            result = self.decode_cls(self._result)\n\n        new_result = await self._plugin_trigger(\n            \"task_executor_decode\", task_executor=self, result=result\n        )\n        if new_result:\n            result = new_result.get(\"result\", result)\n        return result\n</code></pre>"},{"location":"api/executors/async_task_executor/#qtasks.executors.async_task_executor.AsyncTaskExecutor.__init__","title":"<code>__init__(task_func, task_broker, log=None, plugins=None)</code>","text":"<p>Initializing the class. Occurs inside a <code>Worker</code> before a task is processed.</p> <p>Parameters:</p> Name Type Description Default <code>task_func</code> <code>TaskExecSchema</code> <p>Schema <code>TaskExecSchema</code>.</p> required <code>task_broker</code> <code>TaskPrioritySchema</code> <p>Schema <code>TaskPrioritySchema</code>.</p> required <code>log</code> <code>Logger</code> <p>class <code>qtasks.logs.Logger</code>. Default: <code>qtasks._state.log_main</code>.</p> <code>None</code> <code>plugins</code> <code>Dict[str, List[BasePlugin]]</code> <p>An array of plugins. Default: <code>Empty array</code>.</p> <code>None</code> Source code in <code>src/qtasks/executors/async_task_executor.py</code> <pre><code>def __init__(\n    self,\n    task_func: Annotated[\n        TaskExecSchema,\n        Doc(\"\"\"\n                `TaskExecSchema` schema.\n                \"\"\"),\n    ],\n    task_broker: Annotated[\n        TaskPrioritySchema,\n        Doc(\"\"\"\n                `TaskPrioritySchema` schema.\n                \"\"\"),\n    ],\n    log: Annotated[\n        Logger | None,\n        Doc(\"\"\"\n                Logger.\n\n                Default: `qtasks.logs.Logger`.\n                \"\"\"),\n    ] = None,\n    plugins: Annotated[\n        dict[str, list[BasePlugin]] | None,\n        Doc(\"\"\"\n                Array of Plugins.\n\n                Default: `Empty array`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    Initializing the class. Occurs inside a `Worker` before a task is processed.\n\n    Args:\n        task_func (TaskExecSchema): Schema `TaskExecSchema`.\n        task_broker(TaskPrioritySchema): Schema `TaskPrioritySchema`.\n        log (Logger, optional): class `qtasks.logs.Logger`. Default: `qtasks._state.log_main`.\n        plugins (Dict[str, List[BasePlugin]], optional): An array of plugins. Default: `Empty array`.\n    \"\"\"\n    super().__init__(\n        task_func=task_func,\n        task_broker=task_broker,\n        log=log,\n        plugins=plugins,\n    )\n</code></pre>"},{"location":"api/executors/async_task_executor/#qtasks.executors.async_task_executor.AsyncTaskExecutor.after_execute","title":"<code>after_execute()</code>  <code>async</code>","text":"<p>Call after starting tasks.</p> Source code in <code>src/qtasks/executors/async_task_executor.py</code> <pre><code>async def after_execute(self):\n    \"\"\"Call after starting tasks.\"\"\"\n    await self._plugin_trigger(\"task_executor_after_execute\", task_executor=self)\n    result: Any = await self._plugin_trigger(\n        \"task_executor_after_execute_result_replace\",\n        task_executor=self,\n        result=self._result,\n        return_last=True,\n    )\n    if result:\n        self._result = result.get(\"result\", self._result)\n    return\n</code></pre>"},{"location":"api/executors/async_task_executor/#qtasks.executors.async_task_executor.AsyncTaskExecutor.before_execute","title":"<code>before_execute()</code>  <code>async</code>","text":"<p>Called before a task is executed.</p> Source code in <code>src/qtasks/executors/async_task_executor.py</code> <pre><code>async def before_execute(self):\n    \"\"\"Called before a task is executed.\"\"\"\n    if self.task_func.echo:\n        task_cls = (\n            SyncTask\n            if not self.task_func.awaiting or self.task_func.generating == \"sync\"\n            else AsyncTask\n        )\n        self.echo = task_cls(\n            task_name=self.task_broker.name,\n            priority=self.task_broker.priority,\n            echo=self.task_func.echo,\n            retry=self.task_func.retry,\n            retry_on_exc=self.task_func.retry_on_exc,\n            decode=self.task_func.decode,\n            tags=self.task_func.tags,\n            description=self.task_func.description,\n            executor=self.task_func.executor,\n            middlewares_before=self.task_func.middlewares_before,\n            middlewares_after=self.task_func.middlewares_after,\n            extra=self.task_func.extra,\n        )\n        self.echo.ctx._update(task_uuid=self.task_broker.uuid)\n        self._args.insert(0, self.echo)\n\n    args_from_func = self._extract_args_kwargs_from_func(self.task_func.func)\n    args_info = self._build_args_info(args_from_func[0], args_from_func[1])\n    new_args = await self._plugin_trigger(\n        \"task_executor_args_replace\",\n        task_executor=self,\n        **{\n            \"args\": self._args,\n            \"kw\": self._kwargs,\n            \"args_info\": args_info,\n        },\n        return_last=True,\n    )\n    if new_args:\n        self._args = new_args.get(\"args\", self._args)\n        self._kwargs = new_args.get(\"kw\", self._kwargs)\n\n    await self._plugin_trigger(\"task_executor_before_execute\", task_executor=self)\n</code></pre>"},{"location":"api/executors/async_task_executor/#qtasks.executors.async_task_executor.AsyncTaskExecutor.decode","title":"<code>decode()</code>  <code>async</code>","text":"<p>Decoding the task.</p> <p>Returns:</p> Name Type Description <code>Any</code> <code>Any</code> <p>Result of the task.</p> Source code in <code>src/qtasks/executors/async_task_executor.py</code> <pre><code>async def decode(self) -&gt; Any:\n    \"\"\"\n    Decoding the task.\n\n    Returns:\n        Any: Result of the task.\n    \"\"\"\n    if self.task_func.decode is not None:\n        result = await self._maybe_await(self.task_func.decode(self._result))\n    else:\n        result = self.decode_cls(self._result)\n\n    new_result = await self._plugin_trigger(\n        \"task_executor_decode\", task_executor=self, result=result\n    )\n    if new_result:\n        result = new_result.get(\"result\", result)\n    return result\n</code></pre>"},{"location":"api/executors/async_task_executor/#qtasks.executors.async_task_executor.AsyncTaskExecutor.execute","title":"<code>execute(decode=True)</code>  <code>async</code>","text":"<p>Calling a task.</p> <p>Parameters:</p> Name Type Description Default <code>decode</code> <code>bool</code> <p>Decoding the result of the task. Default: True.</p> <code>True</code> <p>Returns:</p> Type Description <code>Any | str</code> <p>Any|str: Result of the task.</p> Source code in <code>src/qtasks/executors/async_task_executor.py</code> <pre><code>async def execute(self, decode: bool = True) -&gt; Any | str:\n    \"\"\"\n    Calling a task.\n\n    Args:\n        decode (bool, optional): Decoding the result of the task. Default: True.\n\n    Returns:\n        Any|str: Result of the task.\n    \"\"\"\n    if self.log:\n        self.log.debug(f\"Called execute for {self.task_func.name}\")\n\n    await self.execute_middlewares_before()\n    await self.before_execute()\n    try:\n        if self.task_func.max_time:\n            self._result = await asyncio.wait_for(\n                self.run_task(), timeout=self.task_func.max_time\n            )\n        else:\n            self._result = await self.run_task()\n    except TaskPluginTriggerError as e:\n        new_result = await self._plugin_trigger(\n            \"task_executor_run_task_trigger_error\",\n            task_executor=self,\n            task_func=self.task_func,\n            task_broker=self.task_broker,\n            e=e,\n            return_last=True,\n        )\n        if new_result:\n            self._result = new_result.get(\"result\", self._result)\n        else:\n            raise e\n    except asyncio.TimeoutError as exc:\n        msg = f\"Time limit exceeded for task {self.task_func.name}: {self.task_func.max_time} seconds\"\n        if self.log:\n            self.log.error(msg)\n        raise asyncio.TimeoutError(msg) from exc\n\n    await self.after_execute()\n    await self.execute_middlewares_after()\n    if decode:\n        self._result = await self.decode()\n\n    await self._plugin_trigger(\n            \"task_executor_task_close\",\n            task_executor=self,\n            task_func=self.task_func,\n            task_broker=self.task_broker\n        )\n    return self._result\n</code></pre>"},{"location":"api/executors/async_task_executor/#qtasks.executors.async_task_executor.AsyncTaskExecutor.execute_middlewares_after","title":"<code>execute_middlewares_after()</code>  <code>async</code>","text":"<p>Calling middleware after completing a task.</p> Source code in <code>src/qtasks/executors/async_task_executor.py</code> <pre><code>async def execute_middlewares_after(self):\n    \"\"\"Calling middleware after completing a task.\"\"\"\n    await self._plugin_trigger(\n        \"task_executor_middlewares_execute\",\n        task_executor=self,\n        middlewares_after=self.task_func.middlewares_after,\n    )\n    for m in self.task_func.middlewares_after:\n        m = m(self)\n        new_task_executor: BaseTaskExecutor = await m()\n        if new_task_executor:\n            self = new_task_executor\n        if self.log:\n            self.log.debug(f\"Middleware {m.name} for {self.task_func.name} was called.\")\n</code></pre>"},{"location":"api/executors/async_task_executor/#qtasks.executors.async_task_executor.AsyncTaskExecutor.execute_middlewares_before","title":"<code>execute_middlewares_before()</code>  <code>async</code>","text":"<p>Calling middleware before the task is completed.</p> Source code in <code>src/qtasks/executors/async_task_executor.py</code> <pre><code>async def execute_middlewares_before(self):\n    \"\"\"Calling middleware before the task is completed.\"\"\"\n    await self._plugin_trigger(\n        \"task_executor_middlewares_execute\",\n        task_executor=self,\n        middlewares_before=self.task_func.middlewares_before,\n    )\n    for m in self.task_func.middlewares_before:\n        m = m(self)\n        new_task_executor: BaseTaskExecutor = await m()\n        if new_task_executor:\n            self = new_task_executor\n        if self.log:\n            self.log.debug(f\"Middleware {m.name} for {self.task_func.name} was called.\")\n</code></pre>"},{"location":"api/executors/async_task_executor/#qtasks.executors.async_task_executor.AsyncTaskExecutor.run_task","title":"<code>run_task()</code>  <code>async</code>","text":"<p>Calling a task.</p> <p>Returns:</p> Name Type Description <code>Any</code> <code>Any</code> <p>Result of the task.</p> Source code in <code>src/qtasks/executors/async_task_executor.py</code> <pre><code>async def run_task(self) -&gt; Any:\n    \"\"\"\n    Calling a task.\n\n    Returns:\n        Any: Result of the task.\n    \"\"\"\n    if self._args and self._kwargs:\n        result = (\n            await self.task_func.func(*self._args, **self._kwargs)\n            if self.task_func.awaiting\n            else self.task_func.func(*self._args, **self._kwargs)\n        )\n    elif self._args:\n        result = (\n            await self.task_func.func(*self._args)\n            if self.task_func.awaiting\n            else self.task_func.func(*self._args)\n        )\n    elif self._kwargs:\n        result = (\n            await self.task_func.func(**self._kwargs)\n            if self.task_func.awaiting\n            else self.task_func.func(**self._kwargs)\n        )\n    else:\n        result = (\n            await self.task_func.func()\n            if self.task_func.awaiting\n            else self.task_func.func()\n        )\n\n    if self.task_func.generating:\n        return await self.run_task_gen(result)\n\n    new_result = await self._plugin_trigger(\n        \"task_executor_run_task\", task_executor=self, result=result\n    )\n    if new_result:\n        result = new_result.get(\"result\", result)\n\n    return result\n</code></pre>"},{"location":"api/executors/async_task_executor/#qtasks.executors.async_task_executor.AsyncTaskExecutor.run_task_gen","title":"<code>run_task_gen(func)</code>  <code>async</code>","text":"<p>Calling the task generator.</p> <p>Parameters:</p> Name Type Description Default <code>func</code> <code>(AsyncGenerator, Generator)</code> <p>Function.</p> required <p>Returns:</p> Name Type Description <code>Any</code> <code>list[Any]</code> <p>Result of the task.</p> Source code in <code>src/qtasks/executors/async_task_executor.py</code> <pre><code>async def run_task_gen(self, func: AsyncGenerator | Generator) -&gt; list[Any]:\n    \"\"\"\n    Calling the task generator.\n\n    Args:\n        func(AsyncGenerator, Generator): Function.\n\n    Returns:\n        Any: Result of the task.\n    \"\"\"\n    if self.echo:\n        self.echo.ctx._update(generate_handler=self.task_func.generate_handler)\n\n    results = []\n    if self.task_func.generating == \"async\":\n        if isinstance(func, AsyncGenerator):\n            async for result in func:\n                if self.task_func.generate_handler:\n                    result = await self._maybe_await(\n                        self.task_func.generate_handler(result)\n                    )\n                results.append(result)\n\n    elif self.task_func.generating == \"sync\":\n        if isinstance(func, Generator):\n            try:\n                while True:\n                    result = next(func)\n                    if self.task_func.generate_handler:\n                        result = await self._maybe_await(\n                            self.task_func.generate_handler(result)\n                        )\n                    results.append(result)\n            except StopIteration:\n                pass\n    new_results = await self._plugin_trigger(\n        \"task_executor_run_task_gen\", task_executor=self, results=results\n    )\n    if new_results:\n        results = new_results.get(\"results\", results)\n    return results\n</code></pre>"},{"location":"api/executors/basetask_executor/","title":"BaseTaskExecutor - \u043f\u0438\u0448\u0435\u043c \u0441\u0432\u043e\u0439 \u0438\u0441\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c \u0437\u0430\u0434\u0430\u0447\u0438","text":"<p>Base Task Executor.</p>"},{"location":"api/executors/basetask_executor/#qtasks.executors.base.BaseTaskExecutor","title":"<code>BaseTaskExecutor</code>","text":"<p>               Bases: <code>Generic[TAsyncFlag]</code>, <code>ABC</code></p> <p><code>BaseTaskExecutor</code> - An abstract class that is the foundation for task executor classes.</p>"},{"location":"api/executors/basetask_executor/#qtasks.executors.base.BaseTaskExecutor--example","title":"Example","text":"<pre><code>from qtasks.executors.base import BaseTaskExecutor\n\nclass MyTaskExecutor(BaseTaskExecutor):\n    def __init__(self, name: str):\n        super().__init__(name=name)\n        pass\n</code></pre> Source code in <code>src/qtasks/executors/base.py</code> <pre><code>class BaseTaskExecutor(Generic[TAsyncFlag], ABC):\n    \"\"\"\n    `BaseTaskExecutor` - An abstract class that is the foundation for task executor classes.\n\n    ## Example\n\n    ```python\n    from qtasks.executors.base import BaseTaskExecutor\n\n    class MyTaskExecutor(BaseTaskExecutor):\n        def __init__(self, name: str):\n            super().__init__(name=name)\n            pass\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        task_func: Annotated[\n            TaskExecSchema,\n            Doc(\"\"\"\n                    `TaskExecSchema` schema.\n                    \"\"\"),\n        ],\n        task_broker: Annotated[\n            TaskPrioritySchema,\n            Doc(\"\"\"\n                    `TaskPrioritySchema` schema.\n                    \"\"\"),\n        ],\n        log: Annotated[\n            Logger | None,\n            Doc(\"\"\"\n                    Logger.\n\n                    Default: `qtasks.logs.Logger`.\n                    \"\"\"),\n        ] = None,\n        plugins: Annotated[\n            dict[str, list[BasePlugin]] | None,\n            Doc(\"\"\"\n                    Array of Plugins.\n\n                    Default: `Empty array`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Initializing the class. Occurs inside a `Worker` before a task is processed.\n\n        Args:\n            task_func (TaskExecSchema): Schema `TaskExecSchema`.\n            task_broker(TaskPrioritySchema): Schema `TaskPrioritySchema`.\n            log (Logger, optional): class `qtasks.logs.Logger`. Default: `qtasks._state.log_main`.\n            plugins (Dict[str, List[BasePlugin]], optional): Plugin dictionary. Default: `Empty dictionary`.\n        \"\"\"\n        self.task_func = task_func\n        self.task_broker = task_broker\n        self._args = self.task_broker.args.copy()\n        self._kwargs = self.task_broker.kwargs.copy()\n        self._result: Any = None\n        self.echo = None\n\n        self.decode_cls = lambda res: json.dumps(res, ensure_ascii=False)\n\n        self.log = log\n        if self.log is None:\n            import qtasks._state\n\n            self.log = qtasks._state.log_main\n        self.log = self.log.with_subname(self.__class__.__name__)\n\n        self.plugins = plugins or {}\n\n    @overload\n    def before_execute(self: BaseTaskExecutor[Literal[False]]) -&gt; None: ...\n\n    @overload\n    async def before_execute(self: BaseTaskExecutor[Literal[True]]) -&gt; None: ...\n\n    def before_execute(self) -&gt; None | Awaitable[None]:\n        \"\"\"Called before a task is executed.\"\"\"\n        pass\n\n    @overload\n    def after_execute(self: BaseTaskExecutor[Literal[False]]) -&gt; None: ...\n\n    @overload\n    async def after_execute(self: BaseTaskExecutor[Literal[True]]) -&gt; None: ...\n\n    def after_execute(self) -&gt; None | Awaitable[None]:\n        \"\"\"Called after a task has completed.\"\"\"\n        pass\n\n    @overload\n    def execute_middlewares_before(\n        self: BaseTaskExecutor[Literal[False]],\n    ) -&gt; None: ...\n\n    @overload\n    async def execute_middlewares_before(\n        self: BaseTaskExecutor[Literal[True]],\n    ) -&gt; None: ...\n\n    def execute_middlewares_before(self) -&gt; None | Awaitable[None]:\n        \"\"\"Calling middleware before the task is completed.\"\"\"\n        pass\n\n    @overload\n    def execute_middlewares_after(self: BaseTaskExecutor[Literal[False]]) -&gt; None: ...\n\n    @overload\n    async def execute_middlewares_after(\n        self: BaseTaskExecutor[Literal[True]],\n    ) -&gt; None: ...\n\n    def execute_middlewares_after(self) -&gt; None | Awaitable[None]:\n        \"\"\"Calling middleware after completing a task.\"\"\"\n        pass\n\n    @overload\n    def run_task(self: BaseTaskExecutor[Literal[False]]) -&gt; Any: ...\n\n    @overload\n    async def run_task(self: BaseTaskExecutor[Literal[True]]) -&gt; Any: ...\n\n    def run_task(self) -&gt; Any | Awaitable[Any]:\n        \"\"\"\n        Calling a task.\n\n        Returns:\n            Any: Result of the task.\n        \"\"\"\n        pass\n\n    @overload\n    def execute(self: BaseTaskExecutor[Literal[False]], decode: bool = True) -&gt; str:\n        \"\"\"\n        Task processing.\n\n        Args:\n            decode (bool, optional): Decoding. Default: `True`.\n\n        Returns:\n            str: Result of the task.\n        \"\"\"\n        ...\n\n    @overload\n    def execute(self: BaseTaskExecutor[Literal[False]], decode: bool = False) -&gt; Any:\n        \"\"\"\n        Task processing.\n\n        Args:\n            decode (bool, optional): Decoding. Default: `True`.\n\n        Returns:\n            Any: Result of the task.\n        \"\"\"\n        ...\n\n    @overload\n    async def execute(\n        self: BaseTaskExecutor[Literal[True]], decode: bool = True\n    ) -&gt; str:\n        \"\"\"\n        Task processing.\n\n        Args:\n            decode (bool, optional): Decoding. Default: `True`.\n\n        Returns:\n            str: Result of the task.\n        \"\"\"\n        ...\n\n    @overload\n    async def execute(\n        self: BaseTaskExecutor[Literal[True]], decode: bool = False\n    ) -&gt; Any:\n        \"\"\"\n        Task processing.\n\n        Args:\n            decode (bool, optional): Decoding. Default: `True`.\n\n        Returns:\n            Any: Result of the task.\n        \"\"\"\n        ...\n\n    @abstractmethod\n    def execute(\n        self, decode=None\n    ) -&gt; Any | str | Awaitable[Any | str]:\n        \"\"\"\n        Task processing.\n\n        Args:\n            decode (bool, optional): Decoding. Default: `True`.\n\n        Returns:\n            Any|str: Result of the task.\n        \"\"\"\n        pass\n\n    @overload\n    def decode(self: BaseTaskExecutor[Literal[False]]) -&gt; str: ...\n\n    @overload\n    async def decode(self: BaseTaskExecutor[Literal[True]]) -&gt; str: ...\n\n    def decode(self) -&gt; str | Awaitable[str]:\n        \"\"\"\n        Decoding the task.\n\n        Returns:\n            str: Result of the task.\n        \"\"\"\n        return \"\"\n\n    def add_plugin(\n        self,\n        plugin: Annotated[\n            BasePlugin,\n            Doc(\"\"\"\n                    Plugin.\n                    \"\"\"),\n        ],\n        trigger_names: Annotated[\n            list[str] | None,\n            Doc(\"\"\"\n                    The name of the triggers for the plugin.\n\n                    Default: Default: will be added to `Globals`.\n                    \"\"\"),\n        ] = None,\n    ) -&gt; None:\n        \"\"\"\n        Add a plugin to the class.\n\n        Args:\n            plugin (BasePlugin): Plugin\n            trigger_names (List[str], optional): The name of the triggers for the plugin. Default: will be added to `Globals`.\n        \"\"\"\n        trigger_names = trigger_names or [\"Globals\"]\n\n        for name in trigger_names:\n            if name not in self.plugins:\n                self.plugins.update({name: [plugin]})\n            else:\n                self.plugins[name].append(plugin)\n        return\n\n    def _extract_args_kwargs_from_func(self, func: Any) -&gt; tuple[list, dict]:\n        \"\"\"\n        Retrieves the values of the arguments from a function if they are given as default values.\n\n        Args:\n            func (Callable): The function from which args and kwargs are retrieved.\n\n        Returns:\n            Tuple[list, dict]: args and kwargs ready to be passed to `_build_args_info`.\n        \"\"\"\n        sig = inspect.signature(func)\n        args = []\n        kwargs = {}\n\n        for name, param in sig.parameters.items():\n            if param.default is not inspect.Parameter.empty:\n                # Named argument (has a default value)\n                kwargs[name] = param.default\n            elif param.kind in (\n                inspect.Parameter.POSITIONAL_ONLY,\n                inspect.Parameter.POSITIONAL_OR_KEYWORD,\n            ):\n                # Positional argument without a default value (just None)\n                args.append(None)\n\n        return args, kwargs\n\n    def _build_args_info(self, args: list, kwargs: dict) -&gt; list[ArgMeta]:\n        \"\"\"\n        Constructs an ArgMeta list of args and kwargs based on function annotations.\n\n        Args:\n            args (list): Positional arguments.\n            kwargs (dict): Named arguments.\n\n        Returns:\n            List[ArgMeta]: List of argument metadata.\n        \"\"\"\n        args_info: list[ArgMeta] = []\n        func = self.task_func.func\n\n        try:\n            sig = inspect.signature(func)\n            parameters = list(sig.parameters.items())\n        except (ValueError, TypeError):\n            parameters = []\n\n        annotations = getattr(func, \"__annotations__\", {})\n\n        # Handling positional arguments\n        for idx, value in enumerate(args):\n            param_name = parameters[idx][0] if idx &lt; len(parameters) else f\"arg{idx}\"\n            annotation = annotations.get(param_name)\n            origin = get_origin(annotation)\n            raw_type = get_args(annotation)[0] if get_args(annotation) else annotation\n            args_info.append(\n                ArgMeta(\n                    name=param_name,\n                    value=value,\n                    origin=origin,\n                    raw_type=raw_type,\n                    annotation=annotation,\n                    is_kwarg=False,\n                    index=idx,\n                )\n            )\n\n        # Handling named arguments\n        for key, value in kwargs.items():\n            annotation = annotations.get(key)\n            origin = get_origin(annotation)\n            raw_type = get_args(annotation)[0] if get_args(annotation) else annotation\n            args_info.append(\n                ArgMeta(\n                    name=key,\n                    value=value,\n                    origin=origin,\n                    raw_type=raw_type,\n                    annotation=annotation,\n                    is_kwarg=True,\n                    key=key,\n                )\n            )\n\n        return args_info\n</code></pre>"},{"location":"api/executors/basetask_executor/#qtasks.executors.base.BaseTaskExecutor.__init__","title":"<code>__init__(task_func, task_broker, log=None, plugins=None)</code>","text":"<p>Initializing the class. Occurs inside a <code>Worker</code> before a task is processed.</p> <p>Parameters:</p> Name Type Description Default <code>task_func</code> <code>TaskExecSchema</code> <p>Schema <code>TaskExecSchema</code>.</p> required <code>task_broker</code> <code>TaskPrioritySchema</code> <p>Schema <code>TaskPrioritySchema</code>.</p> required <code>log</code> <code>Logger</code> <p>class <code>qtasks.logs.Logger</code>. Default: <code>qtasks._state.log_main</code>.</p> <code>None</code> <code>plugins</code> <code>Dict[str, List[BasePlugin]]</code> <p>Plugin dictionary. Default: <code>Empty dictionary</code>.</p> <code>None</code> Source code in <code>src/qtasks/executors/base.py</code> <pre><code>def __init__(\n    self,\n    task_func: Annotated[\n        TaskExecSchema,\n        Doc(\"\"\"\n                `TaskExecSchema` schema.\n                \"\"\"),\n    ],\n    task_broker: Annotated[\n        TaskPrioritySchema,\n        Doc(\"\"\"\n                `TaskPrioritySchema` schema.\n                \"\"\"),\n    ],\n    log: Annotated[\n        Logger | None,\n        Doc(\"\"\"\n                Logger.\n\n                Default: `qtasks.logs.Logger`.\n                \"\"\"),\n    ] = None,\n    plugins: Annotated[\n        dict[str, list[BasePlugin]] | None,\n        Doc(\"\"\"\n                Array of Plugins.\n\n                Default: `Empty array`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    Initializing the class. Occurs inside a `Worker` before a task is processed.\n\n    Args:\n        task_func (TaskExecSchema): Schema `TaskExecSchema`.\n        task_broker(TaskPrioritySchema): Schema `TaskPrioritySchema`.\n        log (Logger, optional): class `qtasks.logs.Logger`. Default: `qtasks._state.log_main`.\n        plugins (Dict[str, List[BasePlugin]], optional): Plugin dictionary. Default: `Empty dictionary`.\n    \"\"\"\n    self.task_func = task_func\n    self.task_broker = task_broker\n    self._args = self.task_broker.args.copy()\n    self._kwargs = self.task_broker.kwargs.copy()\n    self._result: Any = None\n    self.echo = None\n\n    self.decode_cls = lambda res: json.dumps(res, ensure_ascii=False)\n\n    self.log = log\n    if self.log is None:\n        import qtasks._state\n\n        self.log = qtasks._state.log_main\n    self.log = self.log.with_subname(self.__class__.__name__)\n\n    self.plugins = plugins or {}\n</code></pre>"},{"location":"api/executors/basetask_executor/#qtasks.executors.base.BaseTaskExecutor.add_plugin","title":"<code>add_plugin(plugin, trigger_names=None)</code>","text":"<p>Add a plugin to the class.</p> <p>Parameters:</p> Name Type Description Default <code>plugin</code> <code>BasePlugin</code> <p>Plugin</p> required <code>trigger_names</code> <code>List[str]</code> <p>The name of the triggers for the plugin. Default: will be added to <code>Globals</code>.</p> <code>None</code> Source code in <code>src/qtasks/executors/base.py</code> <pre><code>def add_plugin(\n    self,\n    plugin: Annotated[\n        BasePlugin,\n        Doc(\"\"\"\n                Plugin.\n                \"\"\"),\n    ],\n    trigger_names: Annotated[\n        list[str] | None,\n        Doc(\"\"\"\n                The name of the triggers for the plugin.\n\n                Default: Default: will be added to `Globals`.\n                \"\"\"),\n    ] = None,\n) -&gt; None:\n    \"\"\"\n    Add a plugin to the class.\n\n    Args:\n        plugin (BasePlugin): Plugin\n        trigger_names (List[str], optional): The name of the triggers for the plugin. Default: will be added to `Globals`.\n    \"\"\"\n    trigger_names = trigger_names or [\"Globals\"]\n\n    for name in trigger_names:\n        if name not in self.plugins:\n            self.plugins.update({name: [plugin]})\n        else:\n            self.plugins[name].append(plugin)\n    return\n</code></pre>"},{"location":"api/executors/basetask_executor/#qtasks.executors.base.BaseTaskExecutor.after_execute","title":"<code>after_execute()</code>","text":"<pre><code>after_execute() -&gt; None\n</code></pre><pre><code>after_execute() -&gt; None\n</code></pre> <p>Called after a task has completed.</p> Source code in <code>src/qtasks/executors/base.py</code> <pre><code>def after_execute(self) -&gt; None | Awaitable[None]:\n    \"\"\"Called after a task has completed.\"\"\"\n    pass\n</code></pre>"},{"location":"api/executors/basetask_executor/#qtasks.executors.base.BaseTaskExecutor.before_execute","title":"<code>before_execute()</code>","text":"<pre><code>before_execute() -&gt; None\n</code></pre><pre><code>before_execute() -&gt; None\n</code></pre> <p>Called before a task is executed.</p> Source code in <code>src/qtasks/executors/base.py</code> <pre><code>def before_execute(self) -&gt; None | Awaitable[None]:\n    \"\"\"Called before a task is executed.\"\"\"\n    pass\n</code></pre>"},{"location":"api/executors/basetask_executor/#qtasks.executors.base.BaseTaskExecutor.decode","title":"<code>decode()</code>","text":"<pre><code>decode() -&gt; str\n</code></pre><pre><code>decode() -&gt; str\n</code></pre> <p>Decoding the task.</p> <p>Returns:</p> Name Type Description <code>str</code> <code>str | Awaitable[str]</code> <p>Result of the task.</p> Source code in <code>src/qtasks/executors/base.py</code> <pre><code>def decode(self) -&gt; str | Awaitable[str]:\n    \"\"\"\n    Decoding the task.\n\n    Returns:\n        str: Result of the task.\n    \"\"\"\n    return \"\"\n</code></pre>"},{"location":"api/executors/basetask_executor/#qtasks.executors.base.BaseTaskExecutor.execute","title":"<code>execute(decode=None)</code>  <code>abstractmethod</code>","text":"<pre><code>execute(decode: bool = True) -&gt; str\n</code></pre><pre><code>execute(decode: bool = False) -&gt; Any\n</code></pre><pre><code>execute(decode: bool = True) -&gt; str\n</code></pre><pre><code>execute(decode: bool = False) -&gt; Any\n</code></pre> <p>Task processing.</p> <p>Parameters:</p> Name Type Description Default <code>decode</code> <code>bool</code> <p>Decoding. Default: <code>True</code>.</p> <code>None</code> <p>Returns:</p> Type Description <code>Any | str | Awaitable[Any | str]</code> <p>Any|str: Result of the task.</p> Source code in <code>src/qtasks/executors/base.py</code> <pre><code>@abstractmethod\ndef execute(\n    self, decode=None\n) -&gt; Any | str | Awaitable[Any | str]:\n    \"\"\"\n    Task processing.\n\n    Args:\n        decode (bool, optional): Decoding. Default: `True`.\n\n    Returns:\n        Any|str: Result of the task.\n    \"\"\"\n    pass\n</code></pre>"},{"location":"api/executors/basetask_executor/#qtasks.executors.base.BaseTaskExecutor.execute_middlewares_after","title":"<code>execute_middlewares_after()</code>","text":"<pre><code>execute_middlewares_after() -&gt; None\n</code></pre><pre><code>execute_middlewares_after() -&gt; None\n</code></pre> <p>Calling middleware after completing a task.</p> Source code in <code>src/qtasks/executors/base.py</code> <pre><code>def execute_middlewares_after(self) -&gt; None | Awaitable[None]:\n    \"\"\"Calling middleware after completing a task.\"\"\"\n    pass\n</code></pre>"},{"location":"api/executors/basetask_executor/#qtasks.executors.base.BaseTaskExecutor.execute_middlewares_before","title":"<code>execute_middlewares_before()</code>","text":"<pre><code>execute_middlewares_before() -&gt; None\n</code></pre><pre><code>execute_middlewares_before() -&gt; None\n</code></pre> <p>Calling middleware before the task is completed.</p> Source code in <code>src/qtasks/executors/base.py</code> <pre><code>def execute_middlewares_before(self) -&gt; None | Awaitable[None]:\n    \"\"\"Calling middleware before the task is completed.\"\"\"\n    pass\n</code></pre>"},{"location":"api/executors/basetask_executor/#qtasks.executors.base.BaseTaskExecutor.run_task","title":"<code>run_task()</code>","text":"<pre><code>run_task() -&gt; Any\n</code></pre><pre><code>run_task() -&gt; Any\n</code></pre> <p>Calling a task.</p> <p>Returns:</p> Name Type Description <code>Any</code> <code>Any | Awaitable[Any]</code> <p>Result of the task.</p> Source code in <code>src/qtasks/executors/base.py</code> <pre><code>def run_task(self) -&gt; Any | Awaitable[Any]:\n    \"\"\"\n    Calling a task.\n\n    Returns:\n        Any: Result of the task.\n    \"\"\"\n    pass\n</code></pre>"},{"location":"api/executors/sync_task_executor/","title":"SyncTaskExecutor","text":"<p>Sync Task Executor.</p>"},{"location":"api/executors/sync_task_executor/#qtasks.executors.sync_task_executor.SyncTaskExecutor","title":"<code>SyncTaskExecutor</code>","text":"<p>               Bases: <code>BaseTaskExecutor</code>, <code>SyncPluginMixin</code></p> <p><code>SyncTaskExecutor</code> - Synchronous task executor class. Used by default in <code>SyncThreadWorker</code>.</p>"},{"location":"api/executors/sync_task_executor/#qtasks.executors.sync_task_executor.SyncTaskExecutor--example","title":"Example","text":"<pre><code>from qtasks.executors import SyncTaskExecutor\n\ntask_func = TaskExecSchema(...)\ntask_broker = TaskPrioritySchema(...)\nexecutor = SyncTaskExecutor(task_func, task_broker)\nresult = executor.execute()\n</code></pre> Source code in <code>src/qtasks/executors/sync_task_executor.py</code> <pre><code>class SyncTaskExecutor(BaseTaskExecutor, SyncPluginMixin):\n    \"\"\"\n    `SyncTaskExecutor` - Synchronous task executor class. Used by default in `SyncThreadWorker`.\n\n    ## Example\n\n    ```python\n    from qtasks.executors import SyncTaskExecutor\n\n    task_func = TaskExecSchema(...)\n    task_broker = TaskPrioritySchema(...)\n    executor = SyncTaskExecutor(task_func, task_broker)\n    result = executor.execute()\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        task_func: Annotated[\n            TaskExecSchema,\n            Doc(\"\"\"\n                    `TaskExecSchema` schema.\n                    \"\"\"),\n        ],\n        task_broker: Annotated[\n            TaskPrioritySchema,\n            Doc(\"\"\"\n                    `TaskPrioritySchema` schema.\n                    \"\"\"),\n        ],\n        log: Annotated[\n            Logger | None,\n            Doc(\"\"\"\n                    Logger.\n\n                    Default: `qtasks.logs.Logger`.\n                    \"\"\"),\n        ] = None,\n        plugins: Annotated[\n            dict[str, list[BasePlugin]] | None,\n            Doc(\"\"\"\n                    Array of Plugins.\n\n                    Default: `Empty array`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Initializing the class. Occurs inside a `Worker` before a task is processed.\n\n        Args:\n            task_func (TaskExecSchema): Schema `TaskExecSchema`.\n            task_broker(TaskPrioritySchema): Schema `TaskPrioritySchema`.\n            log (Logger, optional): class `qtasks.logs.Logger`. Default: `qtasks._state.log_main`.\n            plugins (Dict[str, List[BasePlugin]], optional): Plugin dictionary. Default: `Empty dictionary`.\n        \"\"\"\n        super().__init__(\n            task_func=task_func,\n            task_broker=task_broker,\n            log=log,\n            plugins=plugins,\n        )\n\n    def before_execute(self):\n        \"\"\"Called before a task is executed.\"\"\"\n        if self.task_func.echo:\n            self.echo = SyncTask(\n                task_name=self.task_broker.name,\n                priority=self.task_broker.priority,\n                echo=self.task_func.echo,\n                retry=self.task_func.retry,\n                retry_on_exc=self.task_func.retry_on_exc,\n                decode=self.task_func.decode,\n                tags=self.task_func.tags,\n                description=self.task_func.description,\n                executor=self.task_func.executor,\n                middlewares_before=self.task_func.middlewares_before,\n                middlewares_after=self.task_func.middlewares_after,\n                extra=self.task_func.extra,\n            )\n            self.echo.ctx._update(task_uuid=self.task_broker.uuid)\n            self._args.insert(0, self.echo)\n\n        args_from_func = self._extract_args_kwargs_from_func(self.task_func.func)\n        args_info = self._build_args_info(args_from_func[0], args_from_func[1])\n        new_args = self._plugin_trigger(\n            \"task_executor_args_replace\",\n            task_executor=self,\n            **{\n                \"args\": self._args,\n                \"kw\": self._kwargs,\n                \"args_info\": args_info,\n            },\n            return_last=True,\n        )\n        if new_args:\n            kw: dict = new_args.get(\"kw\")  # type: ignore\n            if not kw:\n                self._args = kw.get(\"args\", self._args)\n                self._kwargs = kw.get(\"kw\", self._kwargs)\n\n        self._plugin_trigger(\"task_executor_before_execute\", task_executor=self)\n\n    def after_execute(self):\n        \"\"\"Called after a task has completed.\"\"\"\n        self._plugin_trigger(\"task_executor_after_execute\", task_executor=self)\n        result = self._plugin_trigger(\n            \"task_executor_after_execute_result_replace\",\n            task_executor=self,\n            result=self._result,\n            return_last=True,\n        )\n        if result:\n            self._result = result.get(\"result\", self._result)\n        return\n\n    def execute_middlewares_before(self):\n        \"\"\"Calling middleware before the task is completed.\"\"\"\n        self._plugin_trigger(\n            \"task_executor_middlewares_execute\",\n            task_executor=self,\n            middlewares_before=self.task_func.middlewares_before,\n        )\n        for m in self.task_func.middlewares_before:\n            m = m(self)\n            new_task_executor: BaseTaskExecutor = m()\n            if new_task_executor:\n                self = new_task_executor\n            self.log.debug(f\"Middleware {m.name} for {self.task_func.name} was called.\")\n\n    def execute_middlewares_after(self):\n        \"\"\"Calling middleware after completing a task.\"\"\"\n        self._plugin_trigger(\n            \"task_executor_middlewares_execute\",\n            task_executor=self,\n            middlewares_after=self.task_func.middlewares_after,\n        )\n        for m in self.task_func.middlewares_after:\n            m = m(self)\n            new_task_executor: BaseTaskExecutor = m()\n            if new_task_executor:\n                self = new_task_executor\n            self.log.debug(f\"Middleware {m.name} for {self.task_func.name} was called.\")\n\n    def run_task(self) -&gt; Any | list:\n        \"\"\"\n        Calling a task.\n\n        Returns:\n            Any: Result of the task.\n        \"\"\"\n        if self._args and self._kwargs:\n            result = self.task_func.func(*self._args, **self._kwargs)\n        elif self._args:\n            result = self.task_func.func(*self._args)\n        elif self._kwargs:\n            result = self.task_func.func(**self._kwargs)\n        else:\n            result = self.task_func.func()\n\n        if self.task_func.generating:\n            return self.run_task_gen(result)\n\n        new_result = self._plugin_trigger(\n            \"task_executor_run_task\", task_executor=self, result=result\n        )\n        if new_result:\n            result = new_result.get(\"result\", result)\n\n        return result\n\n    def run_task_gen(self, func: Generator) -&gt; list[Any]:\n        \"\"\"\n        Calling the task generator.\n\n        Args:\n            func(FunctionType): Function.\n\n        Raises:\n            RuntimeError: Unable to run synchronous task generator in synchronous form!\n\n        Returns:\n            Any: Result of the task.\n        \"\"\"\n        if self.echo:\n            self.echo.ctx._update(generate_handler=self.task_func.generate_handler)\n\n        results = []\n        if self.task_func.generating == \"async\":\n            raise RuntimeError(\n                \"Cannot run an async task generator in synchronous mode!\"\n            )\n\n        elif self.task_func.generating == \"sync\":\n            try:\n                while True:\n                    result = next(func)\n                    if self.task_func.generate_handler:\n                        result = self.task_func.generate_handler(result)\n                    results.append(result)\n            except StopIteration:\n                pass\n\n        new_results = self._plugin_trigger(\n            \"task_executor_run_task_gen\", task_executor=self, results=results\n        )\n        if new_results:\n            results = new_results.get(\"results\", results)\n        return results\n\n    def execute(self, decode: bool = True) -&gt; Any | str:\n        \"\"\"\n        Calling a task.\n\n        Args:\n            decode (bool, optional): Decoding the result of the task. Default: True.\n\n        Returns:\n            Any|str: Result of the task.\n        \"\"\"\n        if self.log:\n            self.log.debug(f\"Called execute for {self.task_func.name}\")\n\n        self.before_execute()\n        self.execute_middlewares_before()\n        try:\n            if self.task_func.max_time:\n                with ThreadPoolExecutor(max_workers=1) as executor:\n                    future = executor.submit(self.run_task)\n                    self._result = future.result(timeout=self.task_func.max_time)\n            else:\n                self._result = self.run_task()\n        except TaskPluginTriggerError as e:\n            new_result = self._plugin_trigger(\n                \"task_executor_run_task_trigger_error\",\n                task_executor=self,\n                task_func=self.task_func,\n                task_broker=self.task_broker,\n                e=e,\n                return_last=True,\n            )\n            if new_result:\n                self._result = new_result.get(\"result\", self._result)\n            else:\n                raise e\n        except TimeoutError as exc:\n            msg = f\"Time limit exceeded for task {self.task_func.name}: {self.task_func.max_time} seconds\"\n            if self.log:\n                self.log.error(msg)\n            raise TimeoutError(msg) from exc\n\n        self.after_execute()\n        self.execute_middlewares_after()\n        if decode:\n            self._result = self.decode()\n\n        self._plugin_trigger(\n            \"task_executor_task_close\",\n            task_executor=self,\n            task_func=self.task_func,\n            task_broker=self.task_broker\n        )\n        return self._result\n\n    def decode(self) -&gt; Any:\n        \"\"\"\n        Decoding the task.\n\n        Returns:\n            Any: Result of the task.\n        \"\"\"\n        if self.task_func.decode is not None:\n            result = self.task_func.decode(self._result)\n        else:\n            result = json.dumps(self._result, ensure_ascii=False)\n        new_result = self._plugin_trigger(\n            \"task_executor_decode\", task_executor=self, result=result\n        )\n        if new_result:\n            result = new_result.get(\"result\", result)\n        return result\n</code></pre>"},{"location":"api/executors/sync_task_executor/#qtasks.executors.sync_task_executor.SyncTaskExecutor.__init__","title":"<code>__init__(task_func, task_broker, log=None, plugins=None)</code>","text":"<p>Initializing the class. Occurs inside a <code>Worker</code> before a task is processed.</p> <p>Parameters:</p> Name Type Description Default <code>task_func</code> <code>TaskExecSchema</code> <p>Schema <code>TaskExecSchema</code>.</p> required <code>task_broker</code> <code>TaskPrioritySchema</code> <p>Schema <code>TaskPrioritySchema</code>.</p> required <code>log</code> <code>Logger</code> <p>class <code>qtasks.logs.Logger</code>. Default: <code>qtasks._state.log_main</code>.</p> <code>None</code> <code>plugins</code> <code>Dict[str, List[BasePlugin]]</code> <p>Plugin dictionary. Default: <code>Empty dictionary</code>.</p> <code>None</code> Source code in <code>src/qtasks/executors/sync_task_executor.py</code> <pre><code>def __init__(\n    self,\n    task_func: Annotated[\n        TaskExecSchema,\n        Doc(\"\"\"\n                `TaskExecSchema` schema.\n                \"\"\"),\n    ],\n    task_broker: Annotated[\n        TaskPrioritySchema,\n        Doc(\"\"\"\n                `TaskPrioritySchema` schema.\n                \"\"\"),\n    ],\n    log: Annotated[\n        Logger | None,\n        Doc(\"\"\"\n                Logger.\n\n                Default: `qtasks.logs.Logger`.\n                \"\"\"),\n    ] = None,\n    plugins: Annotated[\n        dict[str, list[BasePlugin]] | None,\n        Doc(\"\"\"\n                Array of Plugins.\n\n                Default: `Empty array`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    Initializing the class. Occurs inside a `Worker` before a task is processed.\n\n    Args:\n        task_func (TaskExecSchema): Schema `TaskExecSchema`.\n        task_broker(TaskPrioritySchema): Schema `TaskPrioritySchema`.\n        log (Logger, optional): class `qtasks.logs.Logger`. Default: `qtasks._state.log_main`.\n        plugins (Dict[str, List[BasePlugin]], optional): Plugin dictionary. Default: `Empty dictionary`.\n    \"\"\"\n    super().__init__(\n        task_func=task_func,\n        task_broker=task_broker,\n        log=log,\n        plugins=plugins,\n    )\n</code></pre>"},{"location":"api/executors/sync_task_executor/#qtasks.executors.sync_task_executor.SyncTaskExecutor.after_execute","title":"<code>after_execute()</code>","text":"<p>Called after a task has completed.</p> Source code in <code>src/qtasks/executors/sync_task_executor.py</code> <pre><code>def after_execute(self):\n    \"\"\"Called after a task has completed.\"\"\"\n    self._plugin_trigger(\"task_executor_after_execute\", task_executor=self)\n    result = self._plugin_trigger(\n        \"task_executor_after_execute_result_replace\",\n        task_executor=self,\n        result=self._result,\n        return_last=True,\n    )\n    if result:\n        self._result = result.get(\"result\", self._result)\n    return\n</code></pre>"},{"location":"api/executors/sync_task_executor/#qtasks.executors.sync_task_executor.SyncTaskExecutor.before_execute","title":"<code>before_execute()</code>","text":"<p>Called before a task is executed.</p> Source code in <code>src/qtasks/executors/sync_task_executor.py</code> <pre><code>def before_execute(self):\n    \"\"\"Called before a task is executed.\"\"\"\n    if self.task_func.echo:\n        self.echo = SyncTask(\n            task_name=self.task_broker.name,\n            priority=self.task_broker.priority,\n            echo=self.task_func.echo,\n            retry=self.task_func.retry,\n            retry_on_exc=self.task_func.retry_on_exc,\n            decode=self.task_func.decode,\n            tags=self.task_func.tags,\n            description=self.task_func.description,\n            executor=self.task_func.executor,\n            middlewares_before=self.task_func.middlewares_before,\n            middlewares_after=self.task_func.middlewares_after,\n            extra=self.task_func.extra,\n        )\n        self.echo.ctx._update(task_uuid=self.task_broker.uuid)\n        self._args.insert(0, self.echo)\n\n    args_from_func = self._extract_args_kwargs_from_func(self.task_func.func)\n    args_info = self._build_args_info(args_from_func[0], args_from_func[1])\n    new_args = self._plugin_trigger(\n        \"task_executor_args_replace\",\n        task_executor=self,\n        **{\n            \"args\": self._args,\n            \"kw\": self._kwargs,\n            \"args_info\": args_info,\n        },\n        return_last=True,\n    )\n    if new_args:\n        kw: dict = new_args.get(\"kw\")  # type: ignore\n        if not kw:\n            self._args = kw.get(\"args\", self._args)\n            self._kwargs = kw.get(\"kw\", self._kwargs)\n\n    self._plugin_trigger(\"task_executor_before_execute\", task_executor=self)\n</code></pre>"},{"location":"api/executors/sync_task_executor/#qtasks.executors.sync_task_executor.SyncTaskExecutor.decode","title":"<code>decode()</code>","text":"<p>Decoding the task.</p> <p>Returns:</p> Name Type Description <code>Any</code> <code>Any</code> <p>Result of the task.</p> Source code in <code>src/qtasks/executors/sync_task_executor.py</code> <pre><code>def decode(self) -&gt; Any:\n    \"\"\"\n    Decoding the task.\n\n    Returns:\n        Any: Result of the task.\n    \"\"\"\n    if self.task_func.decode is not None:\n        result = self.task_func.decode(self._result)\n    else:\n        result = json.dumps(self._result, ensure_ascii=False)\n    new_result = self._plugin_trigger(\n        \"task_executor_decode\", task_executor=self, result=result\n    )\n    if new_result:\n        result = new_result.get(\"result\", result)\n    return result\n</code></pre>"},{"location":"api/executors/sync_task_executor/#qtasks.executors.sync_task_executor.SyncTaskExecutor.execute","title":"<code>execute(decode=True)</code>","text":"<p>Calling a task.</p> <p>Parameters:</p> Name Type Description Default <code>decode</code> <code>bool</code> <p>Decoding the result of the task. Default: True.</p> <code>True</code> <p>Returns:</p> Type Description <code>Any | str</code> <p>Any|str: Result of the task.</p> Source code in <code>src/qtasks/executors/sync_task_executor.py</code> <pre><code>def execute(self, decode: bool = True) -&gt; Any | str:\n    \"\"\"\n    Calling a task.\n\n    Args:\n        decode (bool, optional): Decoding the result of the task. Default: True.\n\n    Returns:\n        Any|str: Result of the task.\n    \"\"\"\n    if self.log:\n        self.log.debug(f\"Called execute for {self.task_func.name}\")\n\n    self.before_execute()\n    self.execute_middlewares_before()\n    try:\n        if self.task_func.max_time:\n            with ThreadPoolExecutor(max_workers=1) as executor:\n                future = executor.submit(self.run_task)\n                self._result = future.result(timeout=self.task_func.max_time)\n        else:\n            self._result = self.run_task()\n    except TaskPluginTriggerError as e:\n        new_result = self._plugin_trigger(\n            \"task_executor_run_task_trigger_error\",\n            task_executor=self,\n            task_func=self.task_func,\n            task_broker=self.task_broker,\n            e=e,\n            return_last=True,\n        )\n        if new_result:\n            self._result = new_result.get(\"result\", self._result)\n        else:\n            raise e\n    except TimeoutError as exc:\n        msg = f\"Time limit exceeded for task {self.task_func.name}: {self.task_func.max_time} seconds\"\n        if self.log:\n            self.log.error(msg)\n        raise TimeoutError(msg) from exc\n\n    self.after_execute()\n    self.execute_middlewares_after()\n    if decode:\n        self._result = self.decode()\n\n    self._plugin_trigger(\n        \"task_executor_task_close\",\n        task_executor=self,\n        task_func=self.task_func,\n        task_broker=self.task_broker\n    )\n    return self._result\n</code></pre>"},{"location":"api/executors/sync_task_executor/#qtasks.executors.sync_task_executor.SyncTaskExecutor.execute_middlewares_after","title":"<code>execute_middlewares_after()</code>","text":"<p>Calling middleware after completing a task.</p> Source code in <code>src/qtasks/executors/sync_task_executor.py</code> <pre><code>def execute_middlewares_after(self):\n    \"\"\"Calling middleware after completing a task.\"\"\"\n    self._plugin_trigger(\n        \"task_executor_middlewares_execute\",\n        task_executor=self,\n        middlewares_after=self.task_func.middlewares_after,\n    )\n    for m in self.task_func.middlewares_after:\n        m = m(self)\n        new_task_executor: BaseTaskExecutor = m()\n        if new_task_executor:\n            self = new_task_executor\n        self.log.debug(f\"Middleware {m.name} for {self.task_func.name} was called.\")\n</code></pre>"},{"location":"api/executors/sync_task_executor/#qtasks.executors.sync_task_executor.SyncTaskExecutor.execute_middlewares_before","title":"<code>execute_middlewares_before()</code>","text":"<p>Calling middleware before the task is completed.</p> Source code in <code>src/qtasks/executors/sync_task_executor.py</code> <pre><code>def execute_middlewares_before(self):\n    \"\"\"Calling middleware before the task is completed.\"\"\"\n    self._plugin_trigger(\n        \"task_executor_middlewares_execute\",\n        task_executor=self,\n        middlewares_before=self.task_func.middlewares_before,\n    )\n    for m in self.task_func.middlewares_before:\n        m = m(self)\n        new_task_executor: BaseTaskExecutor = m()\n        if new_task_executor:\n            self = new_task_executor\n        self.log.debug(f\"Middleware {m.name} for {self.task_func.name} was called.\")\n</code></pre>"},{"location":"api/executors/sync_task_executor/#qtasks.executors.sync_task_executor.SyncTaskExecutor.run_task","title":"<code>run_task()</code>","text":"<p>Calling a task.</p> <p>Returns:</p> Name Type Description <code>Any</code> <code>Any | list</code> <p>Result of the task.</p> Source code in <code>src/qtasks/executors/sync_task_executor.py</code> <pre><code>def run_task(self) -&gt; Any | list:\n    \"\"\"\n    Calling a task.\n\n    Returns:\n        Any: Result of the task.\n    \"\"\"\n    if self._args and self._kwargs:\n        result = self.task_func.func(*self._args, **self._kwargs)\n    elif self._args:\n        result = self.task_func.func(*self._args)\n    elif self._kwargs:\n        result = self.task_func.func(**self._kwargs)\n    else:\n        result = self.task_func.func()\n\n    if self.task_func.generating:\n        return self.run_task_gen(result)\n\n    new_result = self._plugin_trigger(\n        \"task_executor_run_task\", task_executor=self, result=result\n    )\n    if new_result:\n        result = new_result.get(\"result\", result)\n\n    return result\n</code></pre>"},{"location":"api/executors/sync_task_executor/#qtasks.executors.sync_task_executor.SyncTaskExecutor.run_task_gen","title":"<code>run_task_gen(func)</code>","text":"<p>Calling the task generator.</p> <p>Parameters:</p> Name Type Description Default <code>func</code> <code>FunctionType</code> <p>Function.</p> required <p>Raises:</p> Type Description <code>RuntimeError</code> <p>Unable to run synchronous task generator in synchronous form!</p> <p>Returns:</p> Name Type Description <code>Any</code> <code>list[Any]</code> <p>Result of the task.</p> Source code in <code>src/qtasks/executors/sync_task_executor.py</code> <pre><code>def run_task_gen(self, func: Generator) -&gt; list[Any]:\n    \"\"\"\n    Calling the task generator.\n\n    Args:\n        func(FunctionType): Function.\n\n    Raises:\n        RuntimeError: Unable to run synchronous task generator in synchronous form!\n\n    Returns:\n        Any: Result of the task.\n    \"\"\"\n    if self.echo:\n        self.echo.ctx._update(generate_handler=self.task_func.generate_handler)\n\n    results = []\n    if self.task_func.generating == \"async\":\n        raise RuntimeError(\n            \"Cannot run an async task generator in synchronous mode!\"\n        )\n\n    elif self.task_func.generating == \"sync\":\n        try:\n            while True:\n                result = next(func)\n                if self.task_func.generate_handler:\n                    result = self.task_func.generate_handler(result)\n                results.append(result)\n        except StopIteration:\n            pass\n\n    new_results = self._plugin_trigger(\n        \"task_executor_run_task_gen\", task_executor=self, results=results\n    )\n    if new_results:\n        results = new_results.get(\"results\", results)\n    return results\n</code></pre>"},{"location":"api/globalconfig/async_redisglobalconfig/","title":"AsyncRedisGlobalConfig","text":"<p>Async Redis Global Config.</p>"},{"location":"api/globalconfig/async_redisglobalconfig/#qtasks.configs.async_redisglobalconfig.AsyncRedisGlobalConfig","title":"<code>AsyncRedisGlobalConfig</code>","text":"<p>               Bases: <code>BaseGlobalConfig[Literal[True]]</code>, <code>AsyncPluginMixin</code></p> <p>Global Config running through Redis and working with global values.</p>"},{"location":"api/globalconfig/async_redisglobalconfig/#qtasks.configs.async_redisglobalconfig.AsyncRedisGlobalConfig--example","title":"Example","text":"<pre><code>from qtasks import QueueTasks\nfrom qtasks.configs import AsyncRedisGlobalConfig\nfrom qtasks.storage import AsyncRedisStorage\nfrom qtasks.brokers import AsyncRedisBroker\n\nglobal_config = AsyncRedisGlobalConfig(name=\"QueueTasks\", url=\"redis://localhost:6379/2\")\n\nstorage = AsyncRedisStorage(name=\"QueueTasks\", global_config=global_config, url=\"redis://localhost:6379/2\")\n\nbroker = AsyncRedisBroker(name=\"QueueTasks\", storage=storage, url=\"redis://localhost:6379/2\")\n\napp = QueueTasks(broker=broker)\n</code></pre> Source code in <code>src/qtasks/configs/async_redisglobalconfig.py</code> <pre><code>class AsyncRedisGlobalConfig(BaseGlobalConfig[Literal[True]], AsyncPluginMixin):\n    \"\"\"\n    Global Config running through Redis and working with global values.\n\n    ## Example\n\n    ```python\n    from qtasks import QueueTasks\n    from qtasks.configs import AsyncRedisGlobalConfig\n    from qtasks.storage import AsyncRedisStorage\n    from qtasks.brokers import AsyncRedisBroker\n\n    global_config = AsyncRedisGlobalConfig(name=\"QueueTasks\", url=\"redis://localhost:6379/2\")\n\n    storage = AsyncRedisStorage(name=\"QueueTasks\", global_config=global_config, url=\"redis://localhost:6379/2\")\n\n    broker = AsyncRedisBroker(name=\"QueueTasks\", storage=storage, url=\"redis://localhost:6379/2\")\n\n    app = QueueTasks(broker=broker)\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Project name. This name is also used by the broker.\n\n                    Default: `QueueTasks`.\n                    \"\"\"),\n        ] = \"QueueTasks\",\n        url: Annotated[\n            str,\n            Doc(\"\"\"\n                    URL to connect to Redis.\n\n                    Default: `redis://localhost:6379/0`.\n                    \"\"\"),\n        ] = \"redis://localhost:6379/0\",\n        redis_connect: Annotated[\n            aioredis.Redis | None,\n            Doc(\"\"\"\n                    External connection class to Redis.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        config_name: Annotated[\n            str | None,\n            Doc(\"\"\"\n                    Folder name with Hash. The name is updated to: `name:queue_name`.\n\n                    Default: `name:GlobalConfig`.\n                    \"\"\"),\n        ] = None,\n        log: Annotated[\n            Logger | None,\n            Doc(\"\"\"\n                    Logger.\n\n                    Default: `qtasks.logs.Logger`.\n                    \"\"\"),\n        ] = None,\n        config: Annotated[\n            QueueConfig | None,\n            Doc(\"\"\"\n                    Config.\n\n                    Default: `qtasks.configs.config.QueueConfig`.\n                    \"\"\"),\n        ] = None,\n        events: Annotated[\n            Optional[BaseEvents],\n            Doc(\"\"\"\n                    Events.\n\n                    Default: `qtasks.events.AsyncEvents`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Initializing the asynchronous Redis global config.\n\n        Args:\n            name (str, optional): Project name. Default: \"QueueTasks\".\n            url (str, optional): URL to connect to Redis. Default: \"redis://localhost:6379/0\".\n            redis_connect (aioredis.Redis, optional): External Redis connection class. Default: None.\n            config_name (str, optional): Name of the Hash Folder. Default: None.\n            log (Logger, optional): Logger. Default: None.\n            config (QueueConfig, optional): Configuration. Default: None.\n            events (BaseEvents, optional): Events. Default: `qtasks.events.AsyncEvents`.\n        \"\"\"\n        super().__init__(name=name, log=log, config=config, events=events)\n        self.name = name\n        self.url = url\n        self.config_name = f\"{self.name}:{config_name or 'GlobalConfig'}\"\n        self.events = self.events or AsyncEvents()\n\n        self.client = redis_connect or aioredis.from_url(\n            self.url, decode_responses=True, encoding=\"utf-8\"\n        )\n\n        self.status_event = None\n        self.running = False\n\n    async def set(self, name: str, key: str, value: str) -&gt; None:\n        \"\"\"\n        Add new value.\n\n        Args:\n            name (str): Name.\n            key (str): Key.\n            value(str): Value.\n        \"\"\"\n        new_data = await self._plugin_trigger(\n            \"global_config_set\",\n            global_config=self,\n            name_=name,\n            key=key,\n            value=value,\n            return_last=True,\n        )\n        if new_data:\n            name = new_data.get(\"name\", name)\n            key = new_data.get(\"key\", key)\n            value = new_data.get(\"value\", value)\n\n        raw = self.client.hset(name=f\"{self.config_name}:{name}\", key=key, value=value)\n        await cast(Awaitable[int], raw)\n        return\n\n    async def get(self, key: str, name: str) -&gt; Any:\n        \"\"\"\n        Get value.\n\n        Args:\n            key (str): Key.\n            name (str): Name.\n\n        Returns:\n            Any: Value.\n        \"\"\"\n        raw = self.client.hget(name=f\"{self.config_name}:{key}\", key=name)\n        result = await cast(Awaitable[str | None], raw)\n\n        new_result = await self._plugin_trigger(\n            \"global_config_get\", global_config=self, get=result, return_last=True\n        )\n        if new_result:\n            result = new_result.get(\"get\", result)\n        return result\n\n    async def get_all(self, key: str) -&gt; dict[str, Any]:\n        \"\"\"\n        Get all values.\n\n        Args:\n            key (str): Key.\n\n        Returns:\n            Dict[str, Any]: Values.\n        \"\"\"\n        raw = self.client.hgetall(name=f\"{self.config_name}:{key}\")\n        result = await cast(Awaitable[dict], raw)\n        new_result = await self._plugin_trigger(\n            \"global_config_get_all\", global_config=self, get=result, return_last=True\n        )\n        if new_result:\n            result = new_result.get(\"get\", result)\n        return result\n\n    async def get_match(self, match: str) -&gt; Any | dict:\n        \"\"\"\n        Get values \u200b\u200bby pattern.\n\n        Args:\n            match (str): Pattern.\n\n        Returns:\n            Any | Dict[str, Any]: Value or Values.\n        \"\"\"\n        self.config_name: str\n        raw = self.client.hscan(self.config_name, match=match)\n        result = await cast(Awaitable[Any], raw)\n        new_result = await self._plugin_trigger(\n            \"global_config_get_match\", global_config=self, get=result, return_last=True\n        )\n        if new_result:\n            result = new_result.get(\"get\", result)\n        return result\n\n    async def start(self) -&gt; None:\n        \"\"\"Launching the Broker. This function is enabled by the main instance of `QueueTasks` via `run_forever.\"\"\"\n        await self._plugin_trigger(\"global_config_start\", global_config=self)\n        self.running = True\n        loop = asyncio.get_running_loop()\n        self.status_event = loop.create_task(self._set_status())\n        global_config = GlobalConfigSchema(name=self.name, status=\"running\")\n        raw = self.client.hset(\n            name=f\"{self.config_name}:main\", mapping=global_config.__dict__\n        )\n        await cast(Awaitable[int], raw)\n\n    async def stop(self) -&gt; None:\n        \"\"\"Stops Global Config. This function is invoked by the main `QueueTasks` instance after the `run_forever` function completes.\"\"\"\n        await self._plugin_trigger(\"global_config_stop\", global_config=self)\n        self.running = False\n        if self.status_event:\n            self.status_event.cancel()\n        await self.client.aclose()\n\n    async def _set_status(self):\n        \"\"\"Updates the startup status of the global config.\"\"\"\n        await self._plugin_trigger(\"global_config_set_status\", global_config=self)\n        ttl = self.config.global_config_status_ttl\n        interval = self.config.global_config_status_set_periodic\n        while self.running:\n            await self.client.expire(f\"{self.config_name}:main\", ttl)\n            await asyncio.sleep(interval)\n</code></pre>"},{"location":"api/globalconfig/async_redisglobalconfig/#qtasks.configs.async_redisglobalconfig.AsyncRedisGlobalConfig.__init__","title":"<code>__init__(name='QueueTasks', url='redis://localhost:6379/0', redis_connect=None, config_name=None, log=None, config=None, events=None)</code>","text":"<p>Initializing the asynchronous Redis global config.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Project name. Default: \"QueueTasks\".</p> <code>'QueueTasks'</code> <code>url</code> <code>str</code> <p>URL to connect to Redis. Default: \"redis://localhost:6379/0\".</p> <code>'redis://localhost:6379/0'</code> <code>redis_connect</code> <code>Redis</code> <p>External Redis connection class. Default: None.</p> <code>None</code> <code>config_name</code> <code>str</code> <p>Name of the Hash Folder. Default: None.</p> <code>None</code> <code>log</code> <code>Logger</code> <p>Logger. Default: None.</p> <code>None</code> <code>config</code> <code>QueueConfig</code> <p>Configuration. Default: None.</p> <code>None</code> <code>events</code> <code>BaseEvents</code> <p>Events. Default: <code>qtasks.events.AsyncEvents</code>.</p> <code>None</code> Source code in <code>src/qtasks/configs/async_redisglobalconfig.py</code> <pre><code>def __init__(\n    self,\n    name: Annotated[\n        str,\n        Doc(\"\"\"\n                Project name. This name is also used by the broker.\n\n                Default: `QueueTasks`.\n                \"\"\"),\n    ] = \"QueueTasks\",\n    url: Annotated[\n        str,\n        Doc(\"\"\"\n                URL to connect to Redis.\n\n                Default: `redis://localhost:6379/0`.\n                \"\"\"),\n    ] = \"redis://localhost:6379/0\",\n    redis_connect: Annotated[\n        aioredis.Redis | None,\n        Doc(\"\"\"\n                External connection class to Redis.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    config_name: Annotated[\n        str | None,\n        Doc(\"\"\"\n                Folder name with Hash. The name is updated to: `name:queue_name`.\n\n                Default: `name:GlobalConfig`.\n                \"\"\"),\n    ] = None,\n    log: Annotated[\n        Logger | None,\n        Doc(\"\"\"\n                Logger.\n\n                Default: `qtasks.logs.Logger`.\n                \"\"\"),\n    ] = None,\n    config: Annotated[\n        QueueConfig | None,\n        Doc(\"\"\"\n                Config.\n\n                Default: `qtasks.configs.config.QueueConfig`.\n                \"\"\"),\n    ] = None,\n    events: Annotated[\n        Optional[BaseEvents],\n        Doc(\"\"\"\n                Events.\n\n                Default: `qtasks.events.AsyncEvents`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    Initializing the asynchronous Redis global config.\n\n    Args:\n        name (str, optional): Project name. Default: \"QueueTasks\".\n        url (str, optional): URL to connect to Redis. Default: \"redis://localhost:6379/0\".\n        redis_connect (aioredis.Redis, optional): External Redis connection class. Default: None.\n        config_name (str, optional): Name of the Hash Folder. Default: None.\n        log (Logger, optional): Logger. Default: None.\n        config (QueueConfig, optional): Configuration. Default: None.\n        events (BaseEvents, optional): Events. Default: `qtasks.events.AsyncEvents`.\n    \"\"\"\n    super().__init__(name=name, log=log, config=config, events=events)\n    self.name = name\n    self.url = url\n    self.config_name = f\"{self.name}:{config_name or 'GlobalConfig'}\"\n    self.events = self.events or AsyncEvents()\n\n    self.client = redis_connect or aioredis.from_url(\n        self.url, decode_responses=True, encoding=\"utf-8\"\n    )\n\n    self.status_event = None\n    self.running = False\n</code></pre>"},{"location":"api/globalconfig/async_redisglobalconfig/#qtasks.configs.async_redisglobalconfig.AsyncRedisGlobalConfig.get","title":"<code>get(key, name)</code>  <code>async</code>","text":"<p>Get value.</p> <p>Parameters:</p> Name Type Description Default <code>key</code> <code>str</code> <p>Key.</p> required <code>name</code> <code>str</code> <p>Name.</p> required <p>Returns:</p> Name Type Description <code>Any</code> <code>Any</code> <p>Value.</p> Source code in <code>src/qtasks/configs/async_redisglobalconfig.py</code> <pre><code>async def get(self, key: str, name: str) -&gt; Any:\n    \"\"\"\n    Get value.\n\n    Args:\n        key (str): Key.\n        name (str): Name.\n\n    Returns:\n        Any: Value.\n    \"\"\"\n    raw = self.client.hget(name=f\"{self.config_name}:{key}\", key=name)\n    result = await cast(Awaitable[str | None], raw)\n\n    new_result = await self._plugin_trigger(\n        \"global_config_get\", global_config=self, get=result, return_last=True\n    )\n    if new_result:\n        result = new_result.get(\"get\", result)\n    return result\n</code></pre>"},{"location":"api/globalconfig/async_redisglobalconfig/#qtasks.configs.async_redisglobalconfig.AsyncRedisGlobalConfig.get_all","title":"<code>get_all(key)</code>  <code>async</code>","text":"<p>Get all values.</p> <p>Parameters:</p> Name Type Description Default <code>key</code> <code>str</code> <p>Key.</p> required <p>Returns:</p> Type Description <code>dict[str, Any]</code> <p>Dict[str, Any]: Values.</p> Source code in <code>src/qtasks/configs/async_redisglobalconfig.py</code> <pre><code>async def get_all(self, key: str) -&gt; dict[str, Any]:\n    \"\"\"\n    Get all values.\n\n    Args:\n        key (str): Key.\n\n    Returns:\n        Dict[str, Any]: Values.\n    \"\"\"\n    raw = self.client.hgetall(name=f\"{self.config_name}:{key}\")\n    result = await cast(Awaitable[dict], raw)\n    new_result = await self._plugin_trigger(\n        \"global_config_get_all\", global_config=self, get=result, return_last=True\n    )\n    if new_result:\n        result = new_result.get(\"get\", result)\n    return result\n</code></pre>"},{"location":"api/globalconfig/async_redisglobalconfig/#qtasks.configs.async_redisglobalconfig.AsyncRedisGlobalConfig.get_match","title":"<code>get_match(match)</code>  <code>async</code>","text":"<p>Get values \u200b\u200bby pattern.</p> <p>Parameters:</p> Name Type Description Default <code>match</code> <code>str</code> <p>Pattern.</p> required <p>Returns:</p> Type Description <code>Any | dict</code> <p>Any | Dict[str, Any]: Value or Values.</p> Source code in <code>src/qtasks/configs/async_redisglobalconfig.py</code> <pre><code>async def get_match(self, match: str) -&gt; Any | dict:\n    \"\"\"\n    Get values \u200b\u200bby pattern.\n\n    Args:\n        match (str): Pattern.\n\n    Returns:\n        Any | Dict[str, Any]: Value or Values.\n    \"\"\"\n    self.config_name: str\n    raw = self.client.hscan(self.config_name, match=match)\n    result = await cast(Awaitable[Any], raw)\n    new_result = await self._plugin_trigger(\n        \"global_config_get_match\", global_config=self, get=result, return_last=True\n    )\n    if new_result:\n        result = new_result.get(\"get\", result)\n    return result\n</code></pre>"},{"location":"api/globalconfig/async_redisglobalconfig/#qtasks.configs.async_redisglobalconfig.AsyncRedisGlobalConfig.set","title":"<code>set(name, key, value)</code>  <code>async</code>","text":"<p>Add new value.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Name.</p> required <code>key</code> <code>str</code> <p>Key.</p> required <code>value</code> <code>str</code> <p>Value.</p> required Source code in <code>src/qtasks/configs/async_redisglobalconfig.py</code> <pre><code>async def set(self, name: str, key: str, value: str) -&gt; None:\n    \"\"\"\n    Add new value.\n\n    Args:\n        name (str): Name.\n        key (str): Key.\n        value(str): Value.\n    \"\"\"\n    new_data = await self._plugin_trigger(\n        \"global_config_set\",\n        global_config=self,\n        name_=name,\n        key=key,\n        value=value,\n        return_last=True,\n    )\n    if new_data:\n        name = new_data.get(\"name\", name)\n        key = new_data.get(\"key\", key)\n        value = new_data.get(\"value\", value)\n\n    raw = self.client.hset(name=f\"{self.config_name}:{name}\", key=key, value=value)\n    await cast(Awaitable[int], raw)\n    return\n</code></pre>"},{"location":"api/globalconfig/async_redisglobalconfig/#qtasks.configs.async_redisglobalconfig.AsyncRedisGlobalConfig.start","title":"<code>start()</code>  <code>async</code>","text":"<p>Launching the Broker. This function is enabled by the main instance of <code>QueueTasks</code> via `run_forever.</p> Source code in <code>src/qtasks/configs/async_redisglobalconfig.py</code> <pre><code>async def start(self) -&gt; None:\n    \"\"\"Launching the Broker. This function is enabled by the main instance of `QueueTasks` via `run_forever.\"\"\"\n    await self._plugin_trigger(\"global_config_start\", global_config=self)\n    self.running = True\n    loop = asyncio.get_running_loop()\n    self.status_event = loop.create_task(self._set_status())\n    global_config = GlobalConfigSchema(name=self.name, status=\"running\")\n    raw = self.client.hset(\n        name=f\"{self.config_name}:main\", mapping=global_config.__dict__\n    )\n    await cast(Awaitable[int], raw)\n</code></pre>"},{"location":"api/globalconfig/async_redisglobalconfig/#qtasks.configs.async_redisglobalconfig.AsyncRedisGlobalConfig.stop","title":"<code>stop()</code>  <code>async</code>","text":"<p>Stops Global Config. This function is invoked by the main <code>QueueTasks</code> instance after the <code>run_forever</code> function completes.</p> Source code in <code>src/qtasks/configs/async_redisglobalconfig.py</code> <pre><code>async def stop(self) -&gt; None:\n    \"\"\"Stops Global Config. This function is invoked by the main `QueueTasks` instance after the `run_forever` function completes.\"\"\"\n    await self._plugin_trigger(\"global_config_stop\", global_config=self)\n    self.running = False\n    if self.status_event:\n        self.status_event.cancel()\n    await self.client.aclose()\n</code></pre>"},{"location":"api/globalconfig/baseglobalconfig/","title":"BaseGlobalConfig - \u043f\u0438\u0448\u0435\u043c \u0441\u0432\u043e\u0439 GlobalConfig","text":"<p>Base Configurations.</p>"},{"location":"api/globalconfig/baseglobalconfig/#qtasks.configs.base.BaseGlobalConfig","title":"<code>BaseGlobalConfig</code>","text":"<p>               Bases: <code>Generic[TAsyncFlag]</code>, <code>ABC</code></p> <p><code>BaseGlobalConfig</code> - An abstract class that is the foundation for the Global Config.</p>"},{"location":"api/globalconfig/baseglobalconfig/#qtasks.configs.base.BaseGlobalConfig--example","title":"Example","text":"<pre><code>from qtasks import QueueTasks\nfrom qtasks.configs.base import BaseGlobalConfig\n\nclass MyGlobalConfig(BaseGlobalConfig):\n    def __init__(self, name: str = None):\n        super().__init__(name=name)\n        pass\n</code></pre> Source code in <code>src/qtasks/configs/base.py</code> <pre><code>class BaseGlobalConfig(Generic[TAsyncFlag], ABC):\n    \"\"\"\n    `BaseGlobalConfig` - An abstract class that is the foundation for the Global Config.\n\n    ## Example\n\n    ```python\n    from qtasks import QueueTasks\n    from qtasks.configs.base import BaseGlobalConfig\n\n    class MyGlobalConfig(BaseGlobalConfig):\n        def __init__(self, name: str = None):\n            super().__init__(name=name)\n            pass\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        name: Annotated[\n            str | None,\n            Doc(\"\"\"\n                    Project name. This name can be used for tags for GlobalConfig.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        log: Annotated[\n            Logger | None,\n            Doc(\"\"\"\n                    Logger.\n\n                    Default: `qtasks.logs.Logger`.\n                    \"\"\"),\n        ] = None,\n        config: Annotated[\n            QueueConfig | None,\n            Doc(\"\"\"\n                    Config.\n\n                    Default: `qtasks.configs.config.QueueConfig`.\n                    \"\"\"),\n        ] = None,\n        events: Annotated[\n            Optional[BaseEvents],\n            Doc(\"\"\"\n                    Events.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Initializing the context.\n\n        Args:\n            name (str, optional): Project name. Default: `None`.\n            log (Logger, optional): Logger. Default: `None`.\n            config (QueueConfig, optional): Configuration. Default: `None`.\n            events (BaseEvents, optional): Events. Default: `None`.\n        \"\"\"\n        self.name = name\n        self.config_name: str | None = None\n\n        self.config = config or QueueConfig()\n        self.log = (\n            log.with_subname(\"GlobalConfig\")\n            if log\n            else Logger(\n                name=self.name or \"QueueTasks\",\n                subname=\"GlobalConfig\",\n                default_level=self.config.logs_default_level_server,\n                format=self.config.logs_format,\n            )\n        )\n        self.events = events\n        self.client = None\n        self.plugins: dict[str, list[BasePlugin]] = {}\n\n        self.init_plugins()\n\n    @overload\n    def set(self: BaseGlobalConfig[Literal[False]], **kwargs) -&gt; None: ...\n\n    @overload\n    async def set(self: BaseGlobalConfig[Literal[True]], **kwargs) -&gt; None: ...\n\n    @abstractmethod\n    def set(self, **kwargs) -&gt; None | Awaitable[None]:\n        \"\"\"\n        Add new value.\n\n        Args:\n            kwargs (dict, optional): kwags tasks. Defaults to `{}`.\n        \"\"\"\n        pass\n\n    @overload\n    def get(self: BaseGlobalConfig[Literal[False]], key: str, name: str) -&gt; Any: ...\n\n    @overload\n    async def get(\n        self: BaseGlobalConfig[Literal[True]], key: str, name: str\n    ) -&gt; Any: ...\n\n    @abstractmethod\n    def get(self, key: str, name: str) -&gt; Any | Awaitable[Any]:\n        \"\"\"\n        Get value.\n\n        Args:\n            key (str): Key.\n            name (str): Name.\n\n        Returns:\n            Any: Value.\n        \"\"\"\n        pass\n\n    @overload\n    def get_all(\n        self: BaseGlobalConfig[Literal[False]], key: str\n    ) -&gt; dict | list | tuple: ...\n\n    @overload\n    async def get_all(\n        self: BaseGlobalConfig[Literal[True]], key: str\n    ) -&gt; dict | list | tuple: ...\n\n    @abstractmethod\n    def get_all(\n        self, key: str\n    ) -&gt; dict | list | tuple | Awaitable[dict | list | tuple]:\n        \"\"\"\n        Get all values.\n\n        Args:\n            key (str): Key.\n\n        Returns:\n            Dict[str, Any] | List[Any] | Tuple[Any]: Values.\n        \"\"\"\n        pass\n\n    @overload\n    def get_match(self: BaseGlobalConfig[Literal[False]], match: str) -&gt; Any: ...\n\n    @overload\n    async def get_match(self: BaseGlobalConfig[Literal[True]], match: str) -&gt; Any: ...\n\n    @abstractmethod\n    def get_match(\n        self, match: str\n    ) -&gt; dict | list | tuple | Awaitable[dict | list | tuple]:\n        \"\"\"\n        Get values by pattern.\n\n        Args:\n            match (str): Pattern.\n\n        Returns:\n            Any | Dict[str, Any] | List[Any] | Tuple[Any]: Value or Values.\n        \"\"\"\n        pass\n\n    @overload\n    def start(self: BaseGlobalConfig[Literal[False]]) -&gt; None: ...\n\n    @overload\n    async def start(self: BaseGlobalConfig[Literal[True]]) -&gt; None: ...\n\n    @abstractmethod\n    def start(self) -&gt; None | Awaitable[None]:\n        \"\"\"Launching the Broker. This function is enabled by the main instance of `QueueTasks` via `run_forever.\"\"\"\n        pass\n\n    @overload\n    def stop(self: BaseGlobalConfig[Literal[False]]) -&gt; None: ...\n\n    @overload\n    async def stop(self: BaseGlobalConfig[Literal[True]]) -&gt; None: ...\n\n    @abstractmethod\n    def stop(self) -&gt; None | Awaitable[None]:\n        \"\"\"Stops Global Config. This function is invoked by the main instance of `QueueTasks` after the `run_forever' function completes.\"\"\"\n        pass\n\n    def update_config(\n        self,\n        config: Annotated[\n            QueueConfig,\n            Doc(\"\"\"\n                    Config.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Updates the broker config.\n\n        Args:\n            config (QueueConfig): Config.\n        \"\"\"\n        self.config = config\n        return\n\n    def add_plugin(\n        self,\n        plugin: Annotated[\n            BasePlugin,\n            Doc(\"\"\"\n                    Plugin.\n                    \"\"\"),\n        ],\n        trigger_names: Annotated[\n            list[str] | None,\n            Doc(\"\"\"\n                    The name of the triggers for the plugin.\n\n                    Default: Default: will be added to `Globals`.\n                    \"\"\"),\n        ] = None,\n    ) -&gt; None:\n        \"\"\"\n        Add a plugin to the class.\n\n        Args:\n            plugin (BasePlugin): Plugin\n            trigger_names (List[str], optional): The name of the triggers for the plugin. Default: will be added to `Globals`.\n        \"\"\"\n        trigger_names = trigger_names or [\"Globals\"]\n\n        for name in trigger_names:\n            if name not in self.plugins:\n                self.plugins.update({name: [plugin]})\n            else:\n                self.plugins[name].append(plugin)\n        return\n\n    def init_plugins(self):\n        \"\"\"Initializing plugins.\"\"\"\n        pass\n</code></pre>"},{"location":"api/globalconfig/baseglobalconfig/#qtasks.configs.base.BaseGlobalConfig.__init__","title":"<code>__init__(name=None, log=None, config=None, events=None)</code>","text":"<p>Initializing the context.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Project name. Default: <code>None</code>.</p> <code>None</code> <code>log</code> <code>Logger</code> <p>Logger. Default: <code>None</code>.</p> <code>None</code> <code>config</code> <code>QueueConfig</code> <p>Configuration. Default: <code>None</code>.</p> <code>None</code> <code>events</code> <code>BaseEvents</code> <p>Events. Default: <code>None</code>.</p> <code>None</code> Source code in <code>src/qtasks/configs/base.py</code> <pre><code>def __init__(\n    self,\n    name: Annotated[\n        str | None,\n        Doc(\"\"\"\n                Project name. This name can be used for tags for GlobalConfig.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    log: Annotated[\n        Logger | None,\n        Doc(\"\"\"\n                Logger.\n\n                Default: `qtasks.logs.Logger`.\n                \"\"\"),\n    ] = None,\n    config: Annotated[\n        QueueConfig | None,\n        Doc(\"\"\"\n                Config.\n\n                Default: `qtasks.configs.config.QueueConfig`.\n                \"\"\"),\n    ] = None,\n    events: Annotated[\n        Optional[BaseEvents],\n        Doc(\"\"\"\n                Events.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    Initializing the context.\n\n    Args:\n        name (str, optional): Project name. Default: `None`.\n        log (Logger, optional): Logger. Default: `None`.\n        config (QueueConfig, optional): Configuration. Default: `None`.\n        events (BaseEvents, optional): Events. Default: `None`.\n    \"\"\"\n    self.name = name\n    self.config_name: str | None = None\n\n    self.config = config or QueueConfig()\n    self.log = (\n        log.with_subname(\"GlobalConfig\")\n        if log\n        else Logger(\n            name=self.name or \"QueueTasks\",\n            subname=\"GlobalConfig\",\n            default_level=self.config.logs_default_level_server,\n            format=self.config.logs_format,\n        )\n    )\n    self.events = events\n    self.client = None\n    self.plugins: dict[str, list[BasePlugin]] = {}\n\n    self.init_plugins()\n</code></pre>"},{"location":"api/globalconfig/baseglobalconfig/#qtasks.configs.base.BaseGlobalConfig.add_plugin","title":"<code>add_plugin(plugin, trigger_names=None)</code>","text":"<p>Add a plugin to the class.</p> <p>Parameters:</p> Name Type Description Default <code>plugin</code> <code>BasePlugin</code> <p>Plugin</p> required <code>trigger_names</code> <code>List[str]</code> <p>The name of the triggers for the plugin. Default: will be added to <code>Globals</code>.</p> <code>None</code> Source code in <code>src/qtasks/configs/base.py</code> <pre><code>def add_plugin(\n    self,\n    plugin: Annotated[\n        BasePlugin,\n        Doc(\"\"\"\n                Plugin.\n                \"\"\"),\n    ],\n    trigger_names: Annotated[\n        list[str] | None,\n        Doc(\"\"\"\n                The name of the triggers for the plugin.\n\n                Default: Default: will be added to `Globals`.\n                \"\"\"),\n    ] = None,\n) -&gt; None:\n    \"\"\"\n    Add a plugin to the class.\n\n    Args:\n        plugin (BasePlugin): Plugin\n        trigger_names (List[str], optional): The name of the triggers for the plugin. Default: will be added to `Globals`.\n    \"\"\"\n    trigger_names = trigger_names or [\"Globals\"]\n\n    for name in trigger_names:\n        if name not in self.plugins:\n            self.plugins.update({name: [plugin]})\n        else:\n            self.plugins[name].append(plugin)\n    return\n</code></pre>"},{"location":"api/globalconfig/baseglobalconfig/#qtasks.configs.base.BaseGlobalConfig.get","title":"<code>get(key, name)</code>  <code>abstractmethod</code>","text":"<pre><code>get(key: str, name: str) -&gt; Any\n</code></pre><pre><code>get(key: str, name: str) -&gt; Any\n</code></pre> <p>Get value.</p> <p>Parameters:</p> Name Type Description Default <code>key</code> <code>str</code> <p>Key.</p> required <code>name</code> <code>str</code> <p>Name.</p> required <p>Returns:</p> Name Type Description <code>Any</code> <code>Any | Awaitable[Any]</code> <p>Value.</p> Source code in <code>src/qtasks/configs/base.py</code> <pre><code>@abstractmethod\ndef get(self, key: str, name: str) -&gt; Any | Awaitable[Any]:\n    \"\"\"\n    Get value.\n\n    Args:\n        key (str): Key.\n        name (str): Name.\n\n    Returns:\n        Any: Value.\n    \"\"\"\n    pass\n</code></pre>"},{"location":"api/globalconfig/baseglobalconfig/#qtasks.configs.base.BaseGlobalConfig.get_all","title":"<code>get_all(key)</code>  <code>abstractmethod</code>","text":"<pre><code>get_all(key: str) -&gt; dict | list | tuple\n</code></pre><pre><code>get_all(key: str) -&gt; dict | list | tuple\n</code></pre> <p>Get all values.</p> <p>Parameters:</p> Name Type Description Default <code>key</code> <code>str</code> <p>Key.</p> required <p>Returns:</p> Type Description <code>dict | list | tuple | Awaitable[dict | list | tuple]</code> <p>Dict[str, Any] | List[Any] | Tuple[Any]: Values.</p> Source code in <code>src/qtasks/configs/base.py</code> <pre><code>@abstractmethod\ndef get_all(\n    self, key: str\n) -&gt; dict | list | tuple | Awaitable[dict | list | tuple]:\n    \"\"\"\n    Get all values.\n\n    Args:\n        key (str): Key.\n\n    Returns:\n        Dict[str, Any] | List[Any] | Tuple[Any]: Values.\n    \"\"\"\n    pass\n</code></pre>"},{"location":"api/globalconfig/baseglobalconfig/#qtasks.configs.base.BaseGlobalConfig.get_match","title":"<code>get_match(match)</code>  <code>abstractmethod</code>","text":"<pre><code>get_match(match: str) -&gt; Any\n</code></pre><pre><code>get_match(match: str) -&gt; Any\n</code></pre> <p>Get values by pattern.</p> <p>Parameters:</p> Name Type Description Default <code>match</code> <code>str</code> <p>Pattern.</p> required <p>Returns:</p> Type Description <code>dict | list | tuple | Awaitable[dict | list | tuple]</code> <p>Any | Dict[str, Any] | List[Any] | Tuple[Any]: Value or Values.</p> Source code in <code>src/qtasks/configs/base.py</code> <pre><code>@abstractmethod\ndef get_match(\n    self, match: str\n) -&gt; dict | list | tuple | Awaitable[dict | list | tuple]:\n    \"\"\"\n    Get values by pattern.\n\n    Args:\n        match (str): Pattern.\n\n    Returns:\n        Any | Dict[str, Any] | List[Any] | Tuple[Any]: Value or Values.\n    \"\"\"\n    pass\n</code></pre>"},{"location":"api/globalconfig/baseglobalconfig/#qtasks.configs.base.BaseGlobalConfig.init_plugins","title":"<code>init_plugins()</code>","text":"<p>Initializing plugins.</p> Source code in <code>src/qtasks/configs/base.py</code> <pre><code>def init_plugins(self):\n    \"\"\"Initializing plugins.\"\"\"\n    pass\n</code></pre>"},{"location":"api/globalconfig/baseglobalconfig/#qtasks.configs.base.BaseGlobalConfig.set","title":"<code>set(**kwargs)</code>  <code>abstractmethod</code>","text":"<pre><code>set(**kwargs) -&gt; None\n</code></pre><pre><code>set(**kwargs) -&gt; None\n</code></pre> <p>Add new value.</p> <p>Parameters:</p> Name Type Description Default <code>kwargs</code> <code>dict</code> <p>kwags tasks. Defaults to <code>{}</code>.</p> <code>{}</code> Source code in <code>src/qtasks/configs/base.py</code> <pre><code>@abstractmethod\ndef set(self, **kwargs) -&gt; None | Awaitable[None]:\n    \"\"\"\n    Add new value.\n\n    Args:\n        kwargs (dict, optional): kwags tasks. Defaults to `{}`.\n    \"\"\"\n    pass\n</code></pre>"},{"location":"api/globalconfig/baseglobalconfig/#qtasks.configs.base.BaseGlobalConfig.start","title":"<code>start()</code>  <code>abstractmethod</code>","text":"<pre><code>start() -&gt; None\n</code></pre><pre><code>start() -&gt; None\n</code></pre> <p>Launching the Broker. This function is enabled by the main instance of <code>QueueTasks</code> via `run_forever.</p> Source code in <code>src/qtasks/configs/base.py</code> <pre><code>@abstractmethod\ndef start(self) -&gt; None | Awaitable[None]:\n    \"\"\"Launching the Broker. This function is enabled by the main instance of `QueueTasks` via `run_forever.\"\"\"\n    pass\n</code></pre>"},{"location":"api/globalconfig/baseglobalconfig/#qtasks.configs.base.BaseGlobalConfig.stop","title":"<code>stop()</code>  <code>abstractmethod</code>","text":"<pre><code>stop() -&gt; None\n</code></pre><pre><code>stop() -&gt; None\n</code></pre> <p>Stops Global Config. This function is invoked by the main instance of <code>QueueTasks</code> after the `run_forever' function completes.</p> Source code in <code>src/qtasks/configs/base.py</code> <pre><code>@abstractmethod\ndef stop(self) -&gt; None | Awaitable[None]:\n    \"\"\"Stops Global Config. This function is invoked by the main instance of `QueueTasks` after the `run_forever' function completes.\"\"\"\n    pass\n</code></pre>"},{"location":"api/globalconfig/baseglobalconfig/#qtasks.configs.base.BaseGlobalConfig.update_config","title":"<code>update_config(config)</code>","text":"<p>Updates the broker config.</p> <p>Parameters:</p> Name Type Description Default <code>config</code> <code>QueueConfig</code> <p>Config.</p> required Source code in <code>src/qtasks/configs/base.py</code> <pre><code>def update_config(\n    self,\n    config: Annotated[\n        QueueConfig,\n        Doc(\"\"\"\n                Config.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Updates the broker config.\n\n    Args:\n        config (QueueConfig): Config.\n    \"\"\"\n    self.config = config\n    return\n</code></pre>"},{"location":"api/globalconfig/sync_redisglobalconfig/","title":"SyncRedisGlobalConfig","text":"<p>Sync Redis Global Config.</p>"},{"location":"api/globalconfig/sync_redisglobalconfig/#qtasks.configs.sync_redisglobalconfig.SyncRedisGlobalConfig","title":"<code>SyncRedisGlobalConfig</code>","text":"<p>               Bases: <code>BaseGlobalConfig[Literal[False]]</code>, <code>SyncPluginMixin</code></p> <p>Global Config running through Redis and working with global values.</p>"},{"location":"api/globalconfig/sync_redisglobalconfig/#qtasks.configs.sync_redisglobalconfig.SyncRedisGlobalConfig--example","title":"Example","text":"<pre><code>from qtasks import QueueTasks\nfrom qtasks.configs import SyncRedisGlobalConfig\nfrom qtasks.storage import SyncRedisStorage\nfrom qtasks.brokers import SyncRedisBroker\n\nglobal_config = SyncRedisGlobalConfig(name=\"QueueTasks\", url=\"redis://localhost:6379/2\")\n\nstorage = SyncRedisStorage(name=\"QueueTasks\", global_config=global_config, url=\"redis://localhost:6379/2\")\n\nbroker = SyncRedisBroker(name=\"QueueTasks\", storage=storage, url=\"redis://localhost:6379/2\")\n\napp = QueueTasks(broker=broker)\n</code></pre> Source code in <code>src/qtasks/configs/sync_redisglobalconfig.py</code> <pre><code>class SyncRedisGlobalConfig(BaseGlobalConfig[Literal[False]], SyncPluginMixin):\n    \"\"\"\n    Global Config running through Redis and working with global values.\n\n    ## Example\n\n    ```python\n    from qtasks import QueueTasks\n    from qtasks.configs import SyncRedisGlobalConfig\n    from qtasks.storage import SyncRedisStorage\n    from qtasks.brokers import SyncRedisBroker\n\n    global_config = SyncRedisGlobalConfig(name=\"QueueTasks\", url=\"redis://localhost:6379/2\")\n\n    storage = SyncRedisStorage(name=\"QueueTasks\", global_config=global_config, url=\"redis://localhost:6379/2\")\n\n    broker = SyncRedisBroker(name=\"QueueTasks\", storage=storage, url=\"redis://localhost:6379/2\")\n\n    app = QueueTasks(broker=broker)\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Project name. This name is also used by the broker.\n\n                    Default: `QueueTasks`.\n                    \"\"\"),\n        ] = \"QueueTasks\",\n        url: Annotated[\n            str,\n            Doc(\"\"\"\n                    URL to connect to Redis.\n\n                    Default: `redis://localhost:6379/0`.\n                    \"\"\"),\n        ] = \"redis://localhost:6379/0\",\n        redis_connect: Annotated[\n            redis.Redis | None,\n            Doc(\"\"\"\n                    External connection class to Redis.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        config_name: Annotated[\n            str | None,\n            Doc(\"\"\"\n                    Folder name with Hash. The name is updated to: `name:queue_name`.\n\n                    Default: `name:GlobalConfig`.\n                    \"\"\"),\n        ] = None,\n        log: Annotated[\n            Logger | None,\n            Doc(\"\"\"\n                    Logger.\n\n                    Default: `qtasks.logs.Logger`.\n                    \"\"\"),\n        ] = None,\n        config: Annotated[\n            QueueConfig | None,\n            Doc(\"\"\"\n                    Config.\n\n                    Default: `qtasks.configs.config.QueueConfig`.\n                    \"\"\"),\n        ] = None,\n        events: Annotated[\n            Optional[BaseEvents],\n            Doc(\"\"\"\n                    Events.\n\n                    Default: `qtasks.events.SyncEvents`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Initializing the Redis global config.\n\n        Args:\n            name (str, optional): Project name. Default: `QueueTasks`.\n            url (str, optional): URL to connect to Redis. Default: `redis://localhost:6379/0`.\n            redis_connect (redis.Redis, optional): External Redis connection class. Default: None.\n            config_name (str, optional): Name of the Hash Folder. Default: `None`.\n            log (Logger, optional): Logger. Default: `None`.\n            config (QueueConfig, optional): Configuration. Default: `None`.\n            events (BaseEvents, optional): Events. Default: `qtasks.events.SyncEvents`.\n        \"\"\"\n        super().__init__(name=name, log=log, config=config, events=events)\n        self.name = name\n        self.url = url\n        self.config_name = f\"{self.name}:{config_name or 'GlobalConfig'}\"\n        self.events = self.events or SyncEvents()\n\n        self.client = redis_connect or redis.from_url(\n            self.url, decode_responses=True, encoding=\"utf-8\"\n        )\n        self.running = False\n\n    def set(self, name: str, key: str, value: str) -&gt; None:\n        \"\"\"\n        Add new value.\n\n        Args:\n            name (str): Name.\n            key (str): Key.\n            value(str): Value.\n        \"\"\"\n        new_data = self._plugin_trigger(\n            \"global_config_set\",\n            global_config=self,\n            name_=name,\n            key=key,\n            value=value,\n            return_last=True,\n        )\n        if new_data:\n            name = new_data.get(\"name\", name)\n            key = new_data.get(\"key\", key)\n            value = new_data.get(\"value\", value)\n\n        self.client.hset(name=f\"{self.config_name}:{name}\", key=key, value=value)\n        return\n\n    def get(self, key: str, name: str) -&gt; Any:\n        \"\"\"\n        Get value.\n\n        Args:\n            key (str): Key.\n            name (str): Name.\n\n        Returns:\n            Any: Value.\n        \"\"\"\n        result = self.client.hget(name=f\"{self.config_name}:{key}\", key=name)\n        new_result = self._plugin_trigger(\n            \"global_config_get\", global_config=self, get=result, return_last=True\n        )\n        if new_result:\n            result = new_result.get(\"get\", result)\n        return result\n\n    def get_all(self, key: str) -&gt; dict[str, Any]:\n        \"\"\"\n        Get all values.\n\n        Args:\n            key (str): Key.\n\n        Returns:\n            Dict[str, Any]: Values.\n        \"\"\"\n        raw = self.client.hgetall(name=f\"{self.config_name}:{key}\")\n        result = cast(dict, raw)\n        new_result = self._plugin_trigger(\n            \"global_config_get_all\", global_config=self, get=result, return_last=True\n        )\n        if new_result:\n            result = new_result.get(\"get\", result)\n        return result\n\n    def get_match(self, match: str) -&gt; Any | dict:\n        \"\"\"\n        Get value by pattern.\n\n        Args:\n            match (str): Pattern.\n\n        Returns:\n            Any | Dict[str, Any]: Value or Values.\n        \"\"\"\n        self.config_name: str\n        result = self.client.hscan(self.config_name, match=match)\n        new_result = self._plugin_trigger(\n            \"global_config_get_match\", global_config=self, get=result, return_last=True\n        )\n        if new_result:\n            result = new_result.get(\"get\", result)\n        return result\n\n    def start(self) -&gt; None:\n        \"\"\"Launching the Broker. This function is enabled by the main instance of `QueueTasks` via `run_forever.\"\"\"\n        self._plugin_trigger(\"global_config_start\", global_config=self)\n        self.running = True\n        global_config = GlobalConfigSchema(name=self.name, status=\"running\")\n        self.client.hset(\n            name=f\"{self.config_name}:main\", mapping=global_config.__dict__\n        )\n        Thread(target=self._set_status, daemon=True).start()\n\n    def stop(self) -&gt; None:\n        \"\"\"Stops Global Config. This function is invoked by the main `QueueTasks` instance after the `run_forever` function completes.\"\"\"\n        self._plugin_trigger(\"global_config_stop\", global_config=self)\n        self.running = False\n        self.client.close()\n        return\n\n    def _set_status(self):\n        \"\"\"Updates the startup status of the global config.\"\"\"\n        self._plugin_trigger(\"global_config_set_status\", global_config=self)\n        ttl = self.config.global_config_status_ttl\n        interval = self.config.global_config_status_set_periodic\n        while self.running:\n            self.client.expire(f\"{self.config_name}:main\", ttl)\n            time.sleep(interval)\n</code></pre>"},{"location":"api/globalconfig/sync_redisglobalconfig/#qtasks.configs.sync_redisglobalconfig.SyncRedisGlobalConfig.__init__","title":"<code>__init__(name='QueueTasks', url='redis://localhost:6379/0', redis_connect=None, config_name=None, log=None, config=None, events=None)</code>","text":"<p>Initializing the Redis global config.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Project name. Default: <code>QueueTasks</code>.</p> <code>'QueueTasks'</code> <code>url</code> <code>str</code> <p>URL to connect to Redis. Default: <code>redis://localhost:6379/0</code>.</p> <code>'redis://localhost:6379/0'</code> <code>redis_connect</code> <code>Redis</code> <p>External Redis connection class. Default: None.</p> <code>None</code> <code>config_name</code> <code>str</code> <p>Name of the Hash Folder. Default: <code>None</code>.</p> <code>None</code> <code>log</code> <code>Logger</code> <p>Logger. Default: <code>None</code>.</p> <code>None</code> <code>config</code> <code>QueueConfig</code> <p>Configuration. Default: <code>None</code>.</p> <code>None</code> <code>events</code> <code>BaseEvents</code> <p>Events. Default: <code>qtasks.events.SyncEvents</code>.</p> <code>None</code> Source code in <code>src/qtasks/configs/sync_redisglobalconfig.py</code> <pre><code>def __init__(\n    self,\n    name: Annotated[\n        str,\n        Doc(\"\"\"\n                Project name. This name is also used by the broker.\n\n                Default: `QueueTasks`.\n                \"\"\"),\n    ] = \"QueueTasks\",\n    url: Annotated[\n        str,\n        Doc(\"\"\"\n                URL to connect to Redis.\n\n                Default: `redis://localhost:6379/0`.\n                \"\"\"),\n    ] = \"redis://localhost:6379/0\",\n    redis_connect: Annotated[\n        redis.Redis | None,\n        Doc(\"\"\"\n                External connection class to Redis.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    config_name: Annotated[\n        str | None,\n        Doc(\"\"\"\n                Folder name with Hash. The name is updated to: `name:queue_name`.\n\n                Default: `name:GlobalConfig`.\n                \"\"\"),\n    ] = None,\n    log: Annotated[\n        Logger | None,\n        Doc(\"\"\"\n                Logger.\n\n                Default: `qtasks.logs.Logger`.\n                \"\"\"),\n    ] = None,\n    config: Annotated[\n        QueueConfig | None,\n        Doc(\"\"\"\n                Config.\n\n                Default: `qtasks.configs.config.QueueConfig`.\n                \"\"\"),\n    ] = None,\n    events: Annotated[\n        Optional[BaseEvents],\n        Doc(\"\"\"\n                Events.\n\n                Default: `qtasks.events.SyncEvents`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    Initializing the Redis global config.\n\n    Args:\n        name (str, optional): Project name. Default: `QueueTasks`.\n        url (str, optional): URL to connect to Redis. Default: `redis://localhost:6379/0`.\n        redis_connect (redis.Redis, optional): External Redis connection class. Default: None.\n        config_name (str, optional): Name of the Hash Folder. Default: `None`.\n        log (Logger, optional): Logger. Default: `None`.\n        config (QueueConfig, optional): Configuration. Default: `None`.\n        events (BaseEvents, optional): Events. Default: `qtasks.events.SyncEvents`.\n    \"\"\"\n    super().__init__(name=name, log=log, config=config, events=events)\n    self.name = name\n    self.url = url\n    self.config_name = f\"{self.name}:{config_name or 'GlobalConfig'}\"\n    self.events = self.events or SyncEvents()\n\n    self.client = redis_connect or redis.from_url(\n        self.url, decode_responses=True, encoding=\"utf-8\"\n    )\n    self.running = False\n</code></pre>"},{"location":"api/globalconfig/sync_redisglobalconfig/#qtasks.configs.sync_redisglobalconfig.SyncRedisGlobalConfig.get","title":"<code>get(key, name)</code>","text":"<p>Get value.</p> <p>Parameters:</p> Name Type Description Default <code>key</code> <code>str</code> <p>Key.</p> required <code>name</code> <code>str</code> <p>Name.</p> required <p>Returns:</p> Name Type Description <code>Any</code> <code>Any</code> <p>Value.</p> Source code in <code>src/qtasks/configs/sync_redisglobalconfig.py</code> <pre><code>def get(self, key: str, name: str) -&gt; Any:\n    \"\"\"\n    Get value.\n\n    Args:\n        key (str): Key.\n        name (str): Name.\n\n    Returns:\n        Any: Value.\n    \"\"\"\n    result = self.client.hget(name=f\"{self.config_name}:{key}\", key=name)\n    new_result = self._plugin_trigger(\n        \"global_config_get\", global_config=self, get=result, return_last=True\n    )\n    if new_result:\n        result = new_result.get(\"get\", result)\n    return result\n</code></pre>"},{"location":"api/globalconfig/sync_redisglobalconfig/#qtasks.configs.sync_redisglobalconfig.SyncRedisGlobalConfig.get_all","title":"<code>get_all(key)</code>","text":"<p>Get all values.</p> <p>Parameters:</p> Name Type Description Default <code>key</code> <code>str</code> <p>Key.</p> required <p>Returns:</p> Type Description <code>dict[str, Any]</code> <p>Dict[str, Any]: Values.</p> Source code in <code>src/qtasks/configs/sync_redisglobalconfig.py</code> <pre><code>def get_all(self, key: str) -&gt; dict[str, Any]:\n    \"\"\"\n    Get all values.\n\n    Args:\n        key (str): Key.\n\n    Returns:\n        Dict[str, Any]: Values.\n    \"\"\"\n    raw = self.client.hgetall(name=f\"{self.config_name}:{key}\")\n    result = cast(dict, raw)\n    new_result = self._plugin_trigger(\n        \"global_config_get_all\", global_config=self, get=result, return_last=True\n    )\n    if new_result:\n        result = new_result.get(\"get\", result)\n    return result\n</code></pre>"},{"location":"api/globalconfig/sync_redisglobalconfig/#qtasks.configs.sync_redisglobalconfig.SyncRedisGlobalConfig.get_match","title":"<code>get_match(match)</code>","text":"<p>Get value by pattern.</p> <p>Parameters:</p> Name Type Description Default <code>match</code> <code>str</code> <p>Pattern.</p> required <p>Returns:</p> Type Description <code>Any | dict</code> <p>Any | Dict[str, Any]: Value or Values.</p> Source code in <code>src/qtasks/configs/sync_redisglobalconfig.py</code> <pre><code>def get_match(self, match: str) -&gt; Any | dict:\n    \"\"\"\n    Get value by pattern.\n\n    Args:\n        match (str): Pattern.\n\n    Returns:\n        Any | Dict[str, Any]: Value or Values.\n    \"\"\"\n    self.config_name: str\n    result = self.client.hscan(self.config_name, match=match)\n    new_result = self._plugin_trigger(\n        \"global_config_get_match\", global_config=self, get=result, return_last=True\n    )\n    if new_result:\n        result = new_result.get(\"get\", result)\n    return result\n</code></pre>"},{"location":"api/globalconfig/sync_redisglobalconfig/#qtasks.configs.sync_redisglobalconfig.SyncRedisGlobalConfig.set","title":"<code>set(name, key, value)</code>","text":"<p>Add new value.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Name.</p> required <code>key</code> <code>str</code> <p>Key.</p> required <code>value</code> <code>str</code> <p>Value.</p> required Source code in <code>src/qtasks/configs/sync_redisglobalconfig.py</code> <pre><code>def set(self, name: str, key: str, value: str) -&gt; None:\n    \"\"\"\n    Add new value.\n\n    Args:\n        name (str): Name.\n        key (str): Key.\n        value(str): Value.\n    \"\"\"\n    new_data = self._plugin_trigger(\n        \"global_config_set\",\n        global_config=self,\n        name_=name,\n        key=key,\n        value=value,\n        return_last=True,\n    )\n    if new_data:\n        name = new_data.get(\"name\", name)\n        key = new_data.get(\"key\", key)\n        value = new_data.get(\"value\", value)\n\n    self.client.hset(name=f\"{self.config_name}:{name}\", key=key, value=value)\n    return\n</code></pre>"},{"location":"api/globalconfig/sync_redisglobalconfig/#qtasks.configs.sync_redisglobalconfig.SyncRedisGlobalConfig.start","title":"<code>start()</code>","text":"<p>Launching the Broker. This function is enabled by the main instance of <code>QueueTasks</code> via `run_forever.</p> Source code in <code>src/qtasks/configs/sync_redisglobalconfig.py</code> <pre><code>def start(self) -&gt; None:\n    \"\"\"Launching the Broker. This function is enabled by the main instance of `QueueTasks` via `run_forever.\"\"\"\n    self._plugin_trigger(\"global_config_start\", global_config=self)\n    self.running = True\n    global_config = GlobalConfigSchema(name=self.name, status=\"running\")\n    self.client.hset(\n        name=f\"{self.config_name}:main\", mapping=global_config.__dict__\n    )\n    Thread(target=self._set_status, daemon=True).start()\n</code></pre>"},{"location":"api/globalconfig/sync_redisglobalconfig/#qtasks.configs.sync_redisglobalconfig.SyncRedisGlobalConfig.stop","title":"<code>stop()</code>","text":"<p>Stops Global Config. This function is invoked by the main <code>QueueTasks</code> instance after the <code>run_forever</code> function completes.</p> Source code in <code>src/qtasks/configs/sync_redisglobalconfig.py</code> <pre><code>def stop(self) -&gt; None:\n    \"\"\"Stops Global Config. This function is invoked by the main `QueueTasks` instance after the `run_forever` function completes.\"\"\"\n    self._plugin_trigger(\"global_config_stop\", global_config=self)\n    self.running = False\n    self.client.close()\n    return\n</code></pre>"},{"location":"api/libraries/django/","title":"\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 Django","text":"<p>Django Autodiscover.</p>"},{"location":"api/libraries/django/#qtasks.contrib.django.autodiscover.autodiscover_tasks","title":"<code>autodiscover_tasks(app, modules=None)</code>","text":"<p>Automatically imports the specified modules from all INSTALLED_APPS to register tasks with QTasks.</p> <p>Parameters:</p> Name Type Description Default <code>app</code> <code>QueueTasks</code> <p>application.</p> required <code>modules</code> <code>List[str]</code> <p>Modules for auto-discovery. Default: <code>[\"tasks\"]</code>.</p> <code>None</code> Source code in <code>src/qtasks/contrib/django/autodiscover.py</code> <pre><code>def autodiscover_tasks(app, modules: Optional[list[str]] = None):\n    \"\"\"\n    Automatically imports the specified modules from all INSTALLED_APPS to register tasks with QTasks.\n\n    Args:\n        app(QueueTasks): application.\n        modules (List[str]): Modules for auto-discovery. Default: `[\"tasks\"]`.\n    \"\"\"\n    modules = modules or [\"tasks\"]\n\n    for app_name in settings.INSTALLED_APPS:\n        try:\n            module = importlib.import_module(app_name)\n        except Exception as e:\n            logger.warning(f\"[QTasks] Failed to import {app_name}: {e}\")\n            continue\n\n        try:\n            for module_name in modules:\n                if module_has_submodule(module, module_name) or find_spec(\n                    f\"{app_name}.{module_name}\"\n                ):\n                    importlib.import_module(f\"{app_name}.{module_name}\")\n                    logger.debug(f\"[QTasks] Found {module_name}.py in {app_name}\")\n        except Exception as e:\n            logger.exception(\n                f\"[QTasks] Error importing {app_name}.{module_name}: {e}\"\n            )\n</code></pre>"},{"location":"api/middlewares/basemiddleware/","title":"BaseMiddleware","text":"<p>Base middleware.</p>"},{"location":"api/middlewares/basemiddleware/#qtasks.middlewares.base.BaseMiddleware","title":"<code>BaseMiddleware</code>","text":"<p><code>BaseMiddleware</code> - An abstract class that is the foundation for Middleware classes.</p>"},{"location":"api/middlewares/basemiddleware/#qtasks.middlewares.base.BaseMiddleware--example","title":"Example","text":"<pre><code>from qtasks.middlewares.base import BaseMiddleware\n\nclass MyMiddleware(BaseMiddleware):\n    def __init__(self, name: str):\n        super().__init__(name=name)\n</code></pre> Source code in <code>src/qtasks/middlewares/base.py</code> <pre><code>class BaseMiddleware:\n    \"\"\"\n    `BaseMiddleware` - An abstract class that is the foundation for Middleware classes.\n\n    ## Example\n\n    ```python\n    from qtasks.middlewares.base import BaseMiddleware\n\n    class MyMiddleware(BaseMiddleware):\n        def __init__(self, name: str):\n            super().__init__(name=name)\n    ```\n    \"\"\"\n\n    def __init__(self, name: str):\n        \"\"\"\n        An instance of a class.\n\n        Args:\n            name (str): Name.\n        \"\"\"\n        self.name = name\n</code></pre>"},{"location":"api/middlewares/basemiddleware/#qtasks.middlewares.base.BaseMiddleware.__init__","title":"<code>__init__(name)</code>","text":"<p>An instance of a class.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Name.</p> required Source code in <code>src/qtasks/middlewares/base.py</code> <pre><code>def __init__(self, name: str):\n    \"\"\"\n    An instance of a class.\n\n    Args:\n        name (str): Name.\n    \"\"\"\n    self.name = name\n</code></pre>"},{"location":"api/middlewares/task_middleware/","title":"TaskMiddleware","text":"<p>Base Task Middleware.</p>"},{"location":"api/middlewares/task_middleware/#qtasks.middlewares.task.TaskMiddleware","title":"<code>TaskMiddleware</code>","text":"<p>               Bases: <code>BaseMiddleware</code></p> <p><code>TaskMiddleware</code> - An abstract class that is the foundation for task Middleware classes for <code>TaskExecutor</code>.</p>"},{"location":"api/middlewares/task_middleware/#qtasks.middlewares.task.TaskMiddleware--example","title":"Example","text":"<pre><code>from qtasks.middlewares import TaskMiddleware\nfrom qtasks.executors.base import BaseTaskExecutor\n\nclass MyTaskMiddleware(TaskMiddleware):\n    def __init__(self, task_executor: BaseTaskExecutor):\n        super().__init__(name=\"MyTaskMiddleware\")\n        self.task_executor = task_executor\n</code></pre> Source code in <code>src/qtasks/middlewares/task.py</code> <pre><code>class TaskMiddleware(BaseMiddleware):\n    \"\"\"\n    `TaskMiddleware` - An abstract class that is the foundation for task Middleware classes for `TaskExecutor`.\n\n    ## Example\n\n    ```python\n    from qtasks.middlewares import TaskMiddleware\n    from qtasks.executors.base import BaseTaskExecutor\n\n    class MyTaskMiddleware(TaskMiddleware):\n        def __init__(self, task_executor: BaseTaskExecutor):\n            super().__init__(name=\"MyTaskMiddleware\")\n            self.task_executor = task_executor\n    ```\n    \"\"\"\n\n    def __init__(self, task_executor: BaseTaskExecutor):\n        \"\"\"\n        Initializing the task middleware.\n\n        Args:\n            task_executor (BaseTaskExecutor): A task executor instance.\n        \"\"\"\n        super().__init__(name=\"TaskMiddleware\")\n        self.task_executor = task_executor\n\n    def __call__(self, *args, **kwargs) -&gt; Any:\n        \"\"\"\n        Processing the task middleware call.\n\n        Returns:\n            Any: Processing result.\n        \"\"\"\n        pass\n</code></pre>"},{"location":"api/middlewares/task_middleware/#qtasks.middlewares.task.TaskMiddleware.__call__","title":"<code>__call__(*args, **kwargs)</code>","text":"<p>Processing the task middleware call.</p> <p>Returns:</p> Name Type Description <code>Any</code> <code>Any</code> <p>Processing result.</p> Source code in <code>src/qtasks/middlewares/task.py</code> <pre><code>def __call__(self, *args, **kwargs) -&gt; Any:\n    \"\"\"\n    Processing the task middleware call.\n\n    Returns:\n        Any: Processing result.\n    \"\"\"\n    pass\n</code></pre>"},{"location":"api/middlewares/task_middleware/#qtasks.middlewares.task.TaskMiddleware.__init__","title":"<code>__init__(task_executor)</code>","text":"<p>Initializing the task middleware.</p> <p>Parameters:</p> Name Type Description Default <code>task_executor</code> <code>BaseTaskExecutor</code> <p>A task executor instance.</p> required Source code in <code>src/qtasks/middlewares/task.py</code> <pre><code>def __init__(self, task_executor: BaseTaskExecutor):\n    \"\"\"\n    Initializing the task middleware.\n\n    Args:\n        task_executor (BaseTaskExecutor): A task executor instance.\n    \"\"\"\n    super().__init__(name=\"TaskMiddleware\")\n    self.task_executor = task_executor\n</code></pre>"},{"location":"api/models/task/","title":"Task","text":"<p>Task Schema.</p>"},{"location":"api/models/task/#qtasks.schemas.task.Task","title":"<code>Task</code>  <code>dataclass</code>","text":"<p><code>Task</code> model.</p> <p>Parameters:</p> Name Type Description Default <code>status</code> <code>str</code> <p>Status.</p> required <code>uuid</code> <code>UUID</code> <p>UUID.</p> required <code>priority</code> <code>int</code> <p>Priority.</p> required <code>task_name</code> <code>str</code> <p>Name.</p> required <code>args</code> <code>Tuple[str]</code> <p>Arguments of type args.</p> required <code>kwargs</code> <code>Dict[str, Any]</code> <p>Arguments of type kwargs.</p> required <code>created_at</code> <code>datetime</code> <p>Created date.</p> required <code>updated_at</code> <code>datetime</code> <p>Date of update.</p> required <code>returning</code> <code>str | None</code> <p>Result. Default: <code>None</code>.</p> <code>None</code> <code>traceback</code> <code>str | None</code> <p>Trace errors. Default: <code>None</code>.</p> <code>None</code> Source code in <code>src/qtasks/schemas/task.py</code> <pre><code>@dataclass\nclass Task:\n    \"\"\"\n    `Task` model.\n\n    Args:\n        status (str): Status.\n        uuid (UUID): UUID.\n        priority (int): Priority.\n        task_name (str): Name.\n\n        args (Tuple[str]): Arguments of type args.\n        kwargs (Dict[str, Any]): Arguments of type kwargs.\n\n        created_at (datetime): Created date.\n        updated_at (datetime): Date of update.\n\n        returning (str | None): Result. Default: `None`.\n        traceback (str | None): Trace errors. Default: `None`.\n    \"\"\"\n\n    status: str\n    uuid: UUID\n    priority: int\n    task_name: str\n\n    args: tuple[str]\n    kwargs: dict[str, Any]\n\n    created_at: datetime\n    updated_at: datetime\n\n    returning: Any | None = None\n    traceback: Any | None = None\n\n    # retry\n    retry: int | None = None\n    retry_child_uuid: UUID | None = None\n    retry_parent_uuid: UUID | None = None\n\n    def wait_result(\n        self,\n        timeout: Annotated[\n            float,\n            Doc(\"\"\"\n                    Task timeout.\n                    \"\"\"),\n        ] = 100.0,\n    ) -&gt; Union[\"Task\", None]:\n        \"\"\"\n        Waiting for task result Synchronously.\n\n        Args:\n            timeout (Annotated[Optional[float], Doc], optional): Timeout for waiting for the result. Default: `100.0`.\n        \"\"\"\n        return SyncResult(uuid=self.uuid).result(timeout=timeout)\n\n    async def wait_result_async(\n        self,\n        timeout: Annotated[\n            float,\n            Doc(\"\"\"\n                    Task timeout.\n                    \"\"\"),\n        ] = 100.0,\n    ) -&gt; Union[\"Task\", None]:\n        \"\"\"\n        Waiting for task result Asynchronously.\n\n        Args:\n            timeout (Annotated[Optional[float], Doc], optional): Timeout for waiting for the result. Default: `100.0`.\n        \"\"\"\n        return await AsyncResult(uuid=self.uuid).result(timeout=timeout)\n</code></pre>"},{"location":"api/models/task/#qtasks.schemas.task.Task.wait_result","title":"<code>wait_result(timeout=100.0)</code>","text":"<p>Waiting for task result Synchronously.</p> <p>Parameters:</p> Name Type Description Default <code>timeout</code> <code>Annotated[Optional[float], Doc]</code> <p>Timeout for waiting for the result. Default: <code>100.0</code>.</p> <code>100.0</code> Source code in <code>src/qtasks/schemas/task.py</code> <pre><code>def wait_result(\n    self,\n    timeout: Annotated[\n        float,\n        Doc(\"\"\"\n                Task timeout.\n                \"\"\"),\n    ] = 100.0,\n) -&gt; Union[\"Task\", None]:\n    \"\"\"\n    Waiting for task result Synchronously.\n\n    Args:\n        timeout (Annotated[Optional[float], Doc], optional): Timeout for waiting for the result. Default: `100.0`.\n    \"\"\"\n    return SyncResult(uuid=self.uuid).result(timeout=timeout)\n</code></pre>"},{"location":"api/models/task/#qtasks.schemas.task.Task.wait_result_async","title":"<code>wait_result_async(timeout=100.0)</code>  <code>async</code>","text":"<p>Waiting for task result Asynchronously.</p> <p>Parameters:</p> Name Type Description Default <code>timeout</code> <code>Annotated[Optional[float], Doc]</code> <p>Timeout for waiting for the result. Default: <code>100.0</code>.</p> <code>100.0</code> Source code in <code>src/qtasks/schemas/task.py</code> <pre><code>async def wait_result_async(\n    self,\n    timeout: Annotated[\n        float,\n        Doc(\"\"\"\n                Task timeout.\n                \"\"\"),\n    ] = 100.0,\n) -&gt; Union[\"Task\", None]:\n    \"\"\"\n    Waiting for task result Asynchronously.\n\n    Args:\n        timeout (Annotated[Optional[float], Doc], optional): Timeout for waiting for the result. Default: `100.0`.\n    \"\"\"\n    return await AsyncResult(uuid=self.uuid).result(timeout=timeout)\n</code></pre>"},{"location":"api/plugins/errors/","title":"Error handling via plugins","text":"<p>QTasks provides a system for intercepting task errors via plugins. This allows you to:</p> <ul> <li>centrally handle exceptions;</li> <li>return an alternative result in case of an error;</li> <li>implement custom logic (e.g., logging, notifications, recovery).</li> </ul>"},{"location":"api/plugins/errors/#trigger-used","title":"\ud83d\udccc Trigger used","text":"<p>Trigger: <code>task_executor_run_task_trigger_error</code></p> <ul> <li>Component: <code>TaskExecutor</code></li> <li>Call: occurs when a <code>TaskPluginTriggerError</code> exception occurs</li> <li>Parameters:</li> <li><code>task_executor</code> \u2014 TaskExecutor instance</li> <li><code>task_func</code> \u2014 task being executed</li> <li><code>task_broker</code> \u2014 task broker</li> <li><code>e</code> \u2014 instance of the <code>TaskPluginTriggerError</code> error</li> </ul>"},{"location":"api/plugins/errors/#handling-mechanism","title":"\ud83e\udde0 Handling mechanism","text":"<p>If the following is called in the task:</p> <pre><code>self.ctx.plugin_error()\n</code></pre> <p>an exception will be thrown:</p> <pre><code>from qtasks.exc import TaskPluginTriggerError\n\nraise TaskPluginTriggerError(**kwargs)\n</code></pre> <p>Inside <code>TaskExecutor</code>, the exception will be handled as follows:</p> <pre><code>try:\n    self._result = await self.run_task()\nexcept TaskPluginTriggerError as e:\n    new_result = await self._plugin_trigger(\n        \"task_executor_run_task_trigger_error\",\n        task_executor=self,\n        task_func=self.task_func,\n        task_broker=self.task_broker,\n        e=e,\n        return_last=True\n    )\n    if new_result:\n        self._result = new_result\n    else:\n        raise e\n</code></pre> <p>If at least one plugin returns a value, it will become the result of the task. Otherwise, the exception is thrown further.</p>"},{"location":"api/plugins/errors/#example-of-a-task-with-an-error-call","title":"\ud83d\udd27 Example of a task with an error call","text":"<pre><code>from qtasks.exc import TaskPluginTriggerError\n\n@app.task(echo=True)\nasync def test_task(self: AsyncTask):\n    self.ctx.plugin_error(message=\"Non-standard situation\")\n    # Alternative: raise TaskPluginTriggerError(\"Direct error\")\n</code></pre>"},{"location":"api/plugins/errors/#processing-in-the-plugin","title":"\ud83d\udd0c Processing in the plugin","text":"<pre><code>class TestPlugin(BasePlugin):\n    def __init__(self, name=None):\n        super().__init__(name)\n        self.handlers = {\n            \"task_executor_run_task_trigger_error\": self.task_trigger_error\n        }\n\n    async def start(self, *args, **kwargs):\n        return super().start(*args, **kwargs)\n\n    async def stop(self, *args, **kwargs):\n        return super().stop(*args, **kwargs)\n\n    async def trigger(self, name, **kwargs):\n        handler = self.handlers.get(name)\n        if handler:\n            return handler(**kwargs)\n        return None\n\n    def task_trigger_error(self, **kwargs):\n        print(kwargs)\n        return 123\n</code></pre>"},{"location":"api/plugins/errors/#related-resources","title":"\ud83d\udcd8 Related resources","text":"<ul> <li>\ud83d\udcc4 Component triggers</li> <li>\u26a0\ufe0f Exceptions</li> </ul> <p>The <code>plugin_error</code> system gives you control over error logic and can be used as an extension point for task behavior.</p>"},{"location":"api/plugins/triggers/","title":"Plugin Trigger Reference Guide","text":"<p>QTasks provides a flexible mechanism for integrating plugins using a system of triggers. These triggers are called within components and allow you to:</p> <ul> <li>Change task input arguments</li> <li>Replace function execution results</li> <li>Respond to events without interfering with the main logic</li> </ul>"},{"location":"api/plugins/triggers/#naming-rules","title":"\ud83d\udcd8 Naming rules","text":"<ul> <li>Template: <code>{component}_{function}_{addition}</code></li> <li>Exception: the <code>QueueTasks</code> component is denoted as <code>qtasks</code></li> <li>Parameters: the main component always comes first (e.g., <code>self</code>), followed by related components and context parameters.</li> </ul>"},{"location":"api/plugins/triggers/#return-behavior","title":"\ud83d\udccc <code>return</code> behavior","text":"<ul> <li><code>new_args</code> / <code>new_model</code> / <code>new_data</code> / <code>new_result</code> replace the corresponding variables if present.</li> <li>If <code>return</code> is absent or <code>None</code>, the variables remain unchanged.</li> <li>The next plugin receives the result from the previous one. If the previous plugin's result is <code>None</code>, the last value or the very first value is used.</li> <li>The last plugin that worked has priority for replacement.</li> </ul> <p>Example: if <code>new_args</code>, then it stores <code>{\"args\": (123,), \"kw\": {\"test\": 123}}</code>. If one of its parameters is <code>None</code>, then the logic above applies.</p>"},{"location":"api/plugins/triggers/#components","title":"\ud83d\udd37 Components","text":""},{"location":"api/plugins/triggers/#queuetasks-qtasks","title":"\ud83d\udd39 QueueTasks (<code>qtasks</code>)","text":"Trigger Return Purpose <code>qtasks_add_task_before_broker</code> <code>new_args: dict</code> Replaces task parameters before passing to broker <code>qtasks_add_task_after_broker</code> \u2014 Called after the task is transferred to the broker <code>qtasks_get</code> <code>new_result: Task</code> Replaces the result of receiving the task <code>qtasks_stop</code> \u2014 Called when the application is stopped <code>qtasks_ping</code> \u2014 Pings global_config <code>qtasks_flush_all</code> \u2014 Resets queues and stores"},{"location":"api/plugins/triggers/#broker","title":"\ud83d\udd39 Broker","text":"Trigger Return Purpose <code>broker_listen_start</code> \u2014 Initializes listening <code>broker_add_worker</code> <code>new_args: dict</code> Replaces the task input parameters for the worker <code>broker_add_before</code> <code>new_model: TaskStatusNewSchema</code> Replaces the model before writing to storage <code>broker_add_after</code> \u2014 Called after adding to storage <code>broker_get</code> <code>new_task: Task</code> Replaces the result of getting the task <code>broker_update</code> <code>new_kw: dict</code> Replaces kwargs when updating a task <code>broker_start</code> \u2014 Starts the broker <code>broker_stop</code> \u2014 Stops the broker <code>broker_remove_finished_task</code> <code>new_model</code> Replaces the model for deleting a completed task <code>broker_running_older_tasks</code> \u2014 Called when restoring old tasks <code>broker_flush_all</code> \u2014 Resets queues"},{"location":"api/plugins/triggers/#globalconfig","title":"\ud83d\udd39 GlobalConfig","text":"Trigger Return Purpose <code>global_config_set</code> <code>new_data: dict</code> Replaces parameters before setting the value <code>global_config_get</code> <code>new_result</code> Replaces the retrieved value <code>global_config_get_all</code> <code>new_result</code> Replaces the result of obtaining all values <code>global_config_get_match</code> <code>new_result</code> Replaces the result of searching by pattern <code>global_config_start</code> \u2014 Component startup <code>global_config_stop</code> \u2014 Stops the component <code>global_config_set_status</code> \u2014 Status setting signal"},{"location":"api/plugins/triggers/#taskexecutor","title":"\ud83d\udd39 TaskExecutor","text":"Trigger Return Assignment <code>task_executor_args_replace</code> <code>new_args: Tuple[list, dict]</code> Replaces args and kwargs before execution <code>task_executor_middlewares_execute</code> \u2014 Called before task execution with middlewares <code>task_executor_run_task</code> <code>new_result</code> Replaces the task execution result <code>task_executor_run_task_gen</code> <code>new_results</code> Replaces the generator results <code>task_executor_run_task_trigger_error</code> <code>new_result</code> Replaces the result when <code>TaskPluginTriggerError</code> is raised <code>task_executor_decode</code> <code>new_result</code> Replaces the result of decoding the result"},{"location":"api/plugins/triggers/#starter","title":"\ud83d\udd39 Starter","text":"Trigger Return Assignment <code>starter_start</code> \u2014 Start the Starter component <code>starter_stop</code> \u2014 Stop the Starter component"},{"location":"api/plugins/triggers/#storage","title":"\ud83d\udd39 Storage","text":"Trigger Return Purpose <code>storage_add</code> <code>new_data</code> Replaces parameters before adding a task <code>storage_get</code> <code>new_result: Task</code> Replaces the result of receiving a task <code>storage_get_all</code> <code>new_results: List[Task]</code> Replaces the list of received tasks <code>storage_update</code> <code>new_kw: dict</code> Replaces kwargs when updating <code>storage_remove_finished_task</code> \u2014 Deletes a completed task <code>storage_start</code> \u2014 Starts the component <code>storage_stop</code> \u2014 Stops the component <code>storage_add_process</code> <code>new_data</code> Replaces parameters when adding to processing <code>storage_running_older_tasks</code> <code>new_data</code> Replaces data when restoring tasks <code>storage_delete_finished_tasks</code> \u2014 Clears completed tasks <code>storage_flush_all</code> \u2014 Resets storage"},{"location":"api/plugins/triggers/#worker","title":"\ud83d\udd39 Worker","text":"Trigger Return Assignment <code>worker_execute_before</code> <code>new_model</code> Replaces the model before execution <code>worker_execute_after</code> \u2014 Called after task execution <code>worker_add</code> <code>new_data</code> Replaces task creation parameters <code>worker_start</code> \u2014 Starts the worker <code>worker_stop</code> \u2014 Stops the worker <code>worker_run_task_before</code> <code>new_data</code> Replaces data before task execution <code>worker_task_error_retry</code> <code>plugin_result</code> Replaces TaskStatusErrorSchema on retry <code>worker_remove_finished_task</code> <code>new_data</code> Replaces TaskPrioritySchema and TaskStatus... for removal from the queue"},{"location":"api/plugins/triggers/#stats","title":"\ud83d\udd39 Stats","text":"\u0422\u0440\u0438\u0433\u0433\u0435\u0440 Return \u041d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 <code>stats_inspect</code> \u2014 Called before <code>InspectStats</code> is defined. <p>This reference can be used when developing plugins, integrations, or system logic on top of QTasks.</p>"},{"location":"api/registries/async_task_decorator/","title":"AsyncTask","text":"<p>Async Task.</p>"},{"location":"api/registries/async_task_decorator/#qtasks.registries.async_task_decorator.AsyncTask","title":"<code>AsyncTask</code>","text":"<p>               Bases: <code>Generic[P, R]</code></p> <p><code>AsyncTask</code> - class for replacing a function with a <code>@app.task</code> and <code>@shared_task</code> decorator.</p>"},{"location":"api/registries/async_task_decorator/#qtasks.registries.async_task_decorator.AsyncTask--example","title":"Example","text":"<pre><code>import asyncio\nfrom qtasks import QueueTasks\n\napp = QueueTasks()\n\n@app.task(\"test\")\nasync def test():\n    print(\"This is a test!\")\n\nasyncio.run(await test.add_task())\n</code></pre> Source code in <code>src/qtasks/registries/async_task_decorator.py</code> <pre><code>class AsyncTask(Generic[P, R]):\n    \"\"\"\n    `AsyncTask` - class for replacing a function with a `@app.task` and `@shared_task` decorator.\n\n    ## Example\n\n    ```python\n    import asyncio\n    from qtasks import QueueTasks\n\n    app = QueueTasks()\n\n    @app.task(\"test\")\n    async def test():\n        print(\"This is a test!\")\n\n    asyncio.run(await test.add_task())\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        task_name: Annotated[\n            str | None,\n            Doc(\"\"\"\n                    Task name.\n\n                    Default: `func.__name__`.\n                    \"\"\"),\n        ] = None,\n        priority: Annotated[\n            int | None,\n            Doc(\"\"\"\n                    The task has priority by default.\n\n                    Default: `config.task_default_priority`.\n                    \"\"\"),\n        ] = None,\n        echo: Annotated[\n            bool,\n            Doc(\"\"\"\n                    Add AsyncTask as the first parameter.\n\n                    Default: `False`.\n                    \"\"\"),\n        ] = False,\n        max_time: Annotated[\n            float | None,\n            Doc(\"\"\"\n                    The maximum time it takes to complete a task in seconds.\n\n                    Default: `None`.\n                \"\"\"),\n        ] = None,\n        retry: Annotated[\n            int | None,\n            Doc(\"\"\"\n                    The number of attempts to retry the task.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        retry_on_exc: Annotated[\n            list[type[Exception]] | None,\n            Doc(\"\"\"\n                    Exceptions under which the task will be re-executed.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        decode: Annotated[\n            Callable | None,\n            Doc(\"\"\"\n                    Task result decoder.\n\n                    Default: `None`.\n                \"\"\"),\n        ] = None,\n        tags: Annotated[\n            list[str] | None,\n            Doc(\"\"\"\n                    Task tags.\n\n                    Default: `None`.\n                \"\"\"),\n        ] = None,\n        description: Annotated[\n            str | None,\n            Doc(\"\"\"\n                    Description of the task.\n\n                    Default: `None`.\n                \"\"\"),\n        ] = None,\n        generate_handler: Annotated[\n            Callable | None,\n            Doc(\"\"\"\n                    Handler generator.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        executor: Annotated[\n            type[BaseTaskExecutor] | None,\n            Doc(\"\"\"\n                    Class `BaseTaskExecutor`.\n\n                    Default: `SyncTaskExecutor`.\n                    \"\"\"),\n        ] = None,\n        middlewares_before: Annotated[\n            list[type[TaskMiddleware]] | None,\n            Doc(\"\"\"\n                    Middleware that will be executed before the task.\n\n                    Default: `Empty array`.\n                    \"\"\"),\n        ] = None,\n        middlewares_after: Annotated[\n            list[type[TaskMiddleware]] | None,\n            Doc(\"\"\"\n                    Middleware that will be executed after the task.\n\n                    Default: `Empty array`.\n                    \"\"\"),\n        ] = None,\n        extra: Annotated[\n            dict[str, Any] | None,\n            Doc(\"\"\"\n                    Additional options.\n\n                    Default: `Empty dictionary`.\n                    \"\"\"),\n        ] = None,\n        app: Annotated[\n            Optional[QueueTasks],\n            Doc(\"\"\"\n                    `QueueTasks` instance.\n\n                    Default: `qtasks._state.app_main`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Initializing an asynchronous task.\n\n        Args:\n            task_name (str, optional): Task name. Default: `None`.\n            priority (int, optional): Task priority. Default: `None`.\n            echo (bool, optional): Add AsyncTask as the first parameter. Default: `False`.\n            max_time (float, optional): The maximum time the task will take to complete in seconds. Default: `None`.\n            retry (int, optional): Number of attempts to retry the task. Default: `None`.\n            retry_on_exc (List[Type[Exception]], optional): Exceptions under which the task will be re-executed. Default: `None`.\n            decode (Callable, optional): Decoder of the task result. Default: `None`.\n            tags (List[str], optional): Task tags. Default: `None`.\n            description (str, optional): Description of the task. Default: `None`.\n            generate_handler (Callable, optional): Handler generator. Default: `None`.\n            executor (Type[\"BaseTaskExecutor\"], optional): Class `BaseTaskExecutor`. Default: `None`.\n            middlewares_before (List[Type[\"TaskMiddleware\"]], optional): Middleware that will be executed before the task. Default: `Empty array`.\n            middlewares_after (List[Type[\"TaskMiddleware\"]], optional): Middleware that will be executed after the task. Default: `Empty array`.\n            extra (Dict[str, Any], optional): Additional parameters. Default: `Empty dictionary`.\n            app (QueueTasks, optional): `QueueTasks` instance. Default: `None`.\n        \"\"\"\n        self.task_name = task_name\n        self.priority = priority\n\n        self.echo = echo\n\n        self.max_time = max_time\n\n        self.retry = retry\n        self.retry_on_exc = retry_on_exc\n\n        self.decode = decode\n        self.tags = tags\n        self.description = description\n\n        self.executor = executor\n        self.middlewares_before = middlewares_before or []\n        self.middlewares_after = middlewares_after or []\n\n        self.extra = extra or {}\n\n        self._app: QueueTasks | None = app\n\n        self.ctx = AsyncContext(\n            task_name=task_name,\n            generate_handler=generate_handler,\n            executor=executor,\n            app=app,\n        )\n\n    async def add_task(\n        self,\n        *args: Annotated[\n            Any,\n            Doc(\"\"\"\n                    args of the task.\n\n                    Default: `()`.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int | None,\n            Doc(\"\"\"\n                    Task priority.\n\n                    Default: Task priority value.\n                    \"\"\"),\n        ] = None,\n        timeout: Annotated[\n            float | None,\n            Doc(\"\"\"\n                    Task timeout.\n\n                    If specified, the task is returned via `qtasks.results.AsyncTask`.\n                    \"\"\"),\n        ] = None,\n        task_name: Annotated[\n            str | None,\n            Doc(\"\"\"\n                    Task name.\n\n                    Default: The value of the task name.\n                    \"\"\"),\n        ] = None,\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    kwargs tasks.\n\n                    Default: `{}`.\n                    \"\"\"),\n        ],\n    ) -&gt; Union[Task, None]:\n        \"\"\"\n        Add a task.\n\n        Args:\n            priority (int, optional): Task priority. Default: Task priority value.\n            args (tuple, optional): task args. Default: `()`.\n            kwargs (dict, optional): kwargs of tasks. Default: `{}`.\n            timeout (float, optional): Task timeout. If specified, the task is returned via `qtasks.results.SyncTask`.\n            task_name (str, optional): Task name. Default: The value of the task name.\n\n        Returns:\n            Task|None: Result of the task or `None`.\n\n        Raises:\n            ValueError: Task name is not specified.\n        \"\"\"\n        if not task_name and not self.task_name:\n            raise ValueError(\"Task name is not specified.\")\n\n        if not self._app:\n            self._update_app()\n\n        if priority is None:\n            priority = self.priority\n\n        return await self._app.add_task(  # type: ignore\n            task_name or self.task_name,  # type: ignore\n            *args,\n            priority=priority,\n            timeout=timeout,\n            **kwargs,\n        )\n\n    def __call__(\n            self,\n            *args: Annotated[\n                Any,\n                Doc(\"\"\"\n                        args of the task.\n\n                        Default: `()`.\n                        \"\"\"),\n            ],\n            priority: Annotated[\n                int | None,\n                Doc(\"\"\"\n                        Task priority.\n\n                        Default: Task priority value.\n                        \"\"\"),\n            ] = None,\n            timeout: Annotated[\n                float | None,\n                Doc(\"\"\"\n                        Task timeout.\n\n                        If specified, the task is returned via `qtasks.results.AsyncTask`.\n                        \"\"\"),\n            ] = None,\n            task_name: Annotated[\n                str | None,\n                Doc(\"\"\"\n                        Task name.\n\n                        Default: The value of the task name.\n                        \"\"\"),\n            ] = None,\n            **kwargs: Annotated[\n                Any,\n                Doc(\"\"\"\n                        kwargs tasks.\n\n                        Default: `{}`.\n                        \"\"\"),\n            ]\n    ) -&gt; AsyncTaskCls:\n        \"\"\"Create AsyncTaskCls instance.\n\n        Args:\n            priority (int, optional): Task priority. Default: Task priority value.\n            args (tuple, optional): task args. Default: `()`.\n            kwargs (dict, optional): kwargs of tasks. Default: `{}`.\n            timeout (float, optional): Task timeout. If specified, the task is returned via `qtasks.results.AsyncTask`.\n            task_name (str, optional): Task name. Default: The value of the task name.\n        \"\"\"\n        task_cls = AsyncTaskCls(\n            task_name=task_name or self.task_name,\n            priority=priority or self.priority,\n            timeout=timeout,\n            args=args,\n            kwargs=kwargs\n        )\n        task_cls.bind(self)\n        return task_cls\n\n    def _update_app(self):\n        \"\"\"Application update.\"\"\"\n        if not self._app:\n            import qtasks._state\n\n            if qtasks._state.app_main is None:\n                raise ImportError(\"Unable to get app!\")\n            self._app = qtasks._state.app_main  # type: ignore\n        return\n</code></pre>"},{"location":"api/registries/async_task_decorator/#qtasks.registries.async_task_decorator.AsyncTask.__call__","title":"<code>__call__(*args, priority=None, timeout=None, task_name=None, **kwargs)</code>","text":"<p>Create AsyncTaskCls instance.</p> <p>Parameters:</p> Name Type Description Default <code>priority</code> <code>int</code> <p>Task priority. Default: Task priority value.</p> <code>None</code> <code>args</code> <code>tuple</code> <p>task args. Default: <code>()</code>.</p> <code>()</code> <code>kwargs</code> <code>dict</code> <p>kwargs of tasks. Default: <code>{}</code>.</p> <code>{}</code> <code>timeout</code> <code>float</code> <p>Task timeout. If specified, the task is returned via <code>qtasks.results.AsyncTask</code>.</p> <code>None</code> <code>task_name</code> <code>str</code> <p>Task name. Default: The value of the task name.</p> <code>None</code> Source code in <code>src/qtasks/registries/async_task_decorator.py</code> <pre><code>def __call__(\n        self,\n        *args: Annotated[\n            Any,\n            Doc(\"\"\"\n                    args of the task.\n\n                    Default: `()`.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int | None,\n            Doc(\"\"\"\n                    Task priority.\n\n                    Default: Task priority value.\n                    \"\"\"),\n        ] = None,\n        timeout: Annotated[\n            float | None,\n            Doc(\"\"\"\n                    Task timeout.\n\n                    If specified, the task is returned via `qtasks.results.AsyncTask`.\n                    \"\"\"),\n        ] = None,\n        task_name: Annotated[\n            str | None,\n            Doc(\"\"\"\n                    Task name.\n\n                    Default: The value of the task name.\n                    \"\"\"),\n        ] = None,\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    kwargs tasks.\n\n                    Default: `{}`.\n                    \"\"\"),\n        ]\n) -&gt; AsyncTaskCls:\n    \"\"\"Create AsyncTaskCls instance.\n\n    Args:\n        priority (int, optional): Task priority. Default: Task priority value.\n        args (tuple, optional): task args. Default: `()`.\n        kwargs (dict, optional): kwargs of tasks. Default: `{}`.\n        timeout (float, optional): Task timeout. If specified, the task is returned via `qtasks.results.AsyncTask`.\n        task_name (str, optional): Task name. Default: The value of the task name.\n    \"\"\"\n    task_cls = AsyncTaskCls(\n        task_name=task_name or self.task_name,\n        priority=priority or self.priority,\n        timeout=timeout,\n        args=args,\n        kwargs=kwargs\n    )\n    task_cls.bind(self)\n    return task_cls\n</code></pre>"},{"location":"api/registries/async_task_decorator/#qtasks.registries.async_task_decorator.AsyncTask.__init__","title":"<code>__init__(task_name=None, priority=None, echo=False, max_time=None, retry=None, retry_on_exc=None, decode=None, tags=None, description=None, generate_handler=None, executor=None, middlewares_before=None, middlewares_after=None, extra=None, app=None)</code>","text":"<p>Initializing an asynchronous task.</p> <p>Parameters:</p> Name Type Description Default <code>task_name</code> <code>str</code> <p>Task name. Default: <code>None</code>.</p> <code>None</code> <code>priority</code> <code>int</code> <p>Task priority. Default: <code>None</code>.</p> <code>None</code> <code>echo</code> <code>bool</code> <p>Add AsyncTask as the first parameter. Default: <code>False</code>.</p> <code>False</code> <code>max_time</code> <code>float</code> <p>The maximum time the task will take to complete in seconds. Default: <code>None</code>.</p> <code>None</code> <code>retry</code> <code>int</code> <p>Number of attempts to retry the task. Default: <code>None</code>.</p> <code>None</code> <code>retry_on_exc</code> <code>List[Type[Exception]]</code> <p>Exceptions under which the task will be re-executed. Default: <code>None</code>.</p> <code>None</code> <code>decode</code> <code>Callable</code> <p>Decoder of the task result. Default: <code>None</code>.</p> <code>None</code> <code>tags</code> <code>List[str]</code> <p>Task tags. Default: <code>None</code>.</p> <code>None</code> <code>description</code> <code>str</code> <p>Description of the task. Default: <code>None</code>.</p> <code>None</code> <code>generate_handler</code> <code>Callable</code> <p>Handler generator. Default: <code>None</code>.</p> <code>None</code> <code>executor</code> <code>Type['BaseTaskExecutor']</code> <p>Class <code>BaseTaskExecutor</code>. Default: <code>None</code>.</p> <code>None</code> <code>middlewares_before</code> <code>List[Type['TaskMiddleware']]</code> <p>Middleware that will be executed before the task. Default: <code>Empty array</code>.</p> <code>None</code> <code>middlewares_after</code> <code>List[Type['TaskMiddleware']]</code> <p>Middleware that will be executed after the task. Default: <code>Empty array</code>.</p> <code>None</code> <code>extra</code> <code>Dict[str, Any]</code> <p>Additional parameters. Default: <code>Empty dictionary</code>.</p> <code>None</code> <code>app</code> <code>QueueTasks</code> <p><code>QueueTasks</code> instance. Default: <code>None</code>.</p> <code>None</code> Source code in <code>src/qtasks/registries/async_task_decorator.py</code> <pre><code>def __init__(\n    self,\n    task_name: Annotated[\n        str | None,\n        Doc(\"\"\"\n                Task name.\n\n                Default: `func.__name__`.\n                \"\"\"),\n    ] = None,\n    priority: Annotated[\n        int | None,\n        Doc(\"\"\"\n                The task has priority by default.\n\n                Default: `config.task_default_priority`.\n                \"\"\"),\n    ] = None,\n    echo: Annotated[\n        bool,\n        Doc(\"\"\"\n                Add AsyncTask as the first parameter.\n\n                Default: `False`.\n                \"\"\"),\n    ] = False,\n    max_time: Annotated[\n        float | None,\n        Doc(\"\"\"\n                The maximum time it takes to complete a task in seconds.\n\n                Default: `None`.\n            \"\"\"),\n    ] = None,\n    retry: Annotated[\n        int | None,\n        Doc(\"\"\"\n                The number of attempts to retry the task.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    retry_on_exc: Annotated[\n        list[type[Exception]] | None,\n        Doc(\"\"\"\n                Exceptions under which the task will be re-executed.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    decode: Annotated[\n        Callable | None,\n        Doc(\"\"\"\n                Task result decoder.\n\n                Default: `None`.\n            \"\"\"),\n    ] = None,\n    tags: Annotated[\n        list[str] | None,\n        Doc(\"\"\"\n                Task tags.\n\n                Default: `None`.\n            \"\"\"),\n    ] = None,\n    description: Annotated[\n        str | None,\n        Doc(\"\"\"\n                Description of the task.\n\n                Default: `None`.\n            \"\"\"),\n    ] = None,\n    generate_handler: Annotated[\n        Callable | None,\n        Doc(\"\"\"\n                Handler generator.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    executor: Annotated[\n        type[BaseTaskExecutor] | None,\n        Doc(\"\"\"\n                Class `BaseTaskExecutor`.\n\n                Default: `SyncTaskExecutor`.\n                \"\"\"),\n    ] = None,\n    middlewares_before: Annotated[\n        list[type[TaskMiddleware]] | None,\n        Doc(\"\"\"\n                Middleware that will be executed before the task.\n\n                Default: `Empty array`.\n                \"\"\"),\n    ] = None,\n    middlewares_after: Annotated[\n        list[type[TaskMiddleware]] | None,\n        Doc(\"\"\"\n                Middleware that will be executed after the task.\n\n                Default: `Empty array`.\n                \"\"\"),\n    ] = None,\n    extra: Annotated[\n        dict[str, Any] | None,\n        Doc(\"\"\"\n                Additional options.\n\n                Default: `Empty dictionary`.\n                \"\"\"),\n    ] = None,\n    app: Annotated[\n        Optional[QueueTasks],\n        Doc(\"\"\"\n                `QueueTasks` instance.\n\n                Default: `qtasks._state.app_main`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    Initializing an asynchronous task.\n\n    Args:\n        task_name (str, optional): Task name. Default: `None`.\n        priority (int, optional): Task priority. Default: `None`.\n        echo (bool, optional): Add AsyncTask as the first parameter. Default: `False`.\n        max_time (float, optional): The maximum time the task will take to complete in seconds. Default: `None`.\n        retry (int, optional): Number of attempts to retry the task. Default: `None`.\n        retry_on_exc (List[Type[Exception]], optional): Exceptions under which the task will be re-executed. Default: `None`.\n        decode (Callable, optional): Decoder of the task result. Default: `None`.\n        tags (List[str], optional): Task tags. Default: `None`.\n        description (str, optional): Description of the task. Default: `None`.\n        generate_handler (Callable, optional): Handler generator. Default: `None`.\n        executor (Type[\"BaseTaskExecutor\"], optional): Class `BaseTaskExecutor`. Default: `None`.\n        middlewares_before (List[Type[\"TaskMiddleware\"]], optional): Middleware that will be executed before the task. Default: `Empty array`.\n        middlewares_after (List[Type[\"TaskMiddleware\"]], optional): Middleware that will be executed after the task. Default: `Empty array`.\n        extra (Dict[str, Any], optional): Additional parameters. Default: `Empty dictionary`.\n        app (QueueTasks, optional): `QueueTasks` instance. Default: `None`.\n    \"\"\"\n    self.task_name = task_name\n    self.priority = priority\n\n    self.echo = echo\n\n    self.max_time = max_time\n\n    self.retry = retry\n    self.retry_on_exc = retry_on_exc\n\n    self.decode = decode\n    self.tags = tags\n    self.description = description\n\n    self.executor = executor\n    self.middlewares_before = middlewares_before or []\n    self.middlewares_after = middlewares_after or []\n\n    self.extra = extra or {}\n\n    self._app: QueueTasks | None = app\n\n    self.ctx = AsyncContext(\n        task_name=task_name,\n        generate_handler=generate_handler,\n        executor=executor,\n        app=app,\n    )\n</code></pre>"},{"location":"api/registries/async_task_decorator/#qtasks.registries.async_task_decorator.AsyncTask.add_task","title":"<code>add_task(*args, priority=None, timeout=None, task_name=None, **kwargs)</code>  <code>async</code>","text":"<p>Add a task.</p> <p>Parameters:</p> Name Type Description Default <code>priority</code> <code>int</code> <p>Task priority. Default: Task priority value.</p> <code>None</code> <code>args</code> <code>tuple</code> <p>task args. Default: <code>()</code>.</p> <code>()</code> <code>kwargs</code> <code>dict</code> <p>kwargs of tasks. Default: <code>{}</code>.</p> <code>{}</code> <code>timeout</code> <code>float</code> <p>Task timeout. If specified, the task is returned via <code>qtasks.results.SyncTask</code>.</p> <code>None</code> <code>task_name</code> <code>str</code> <p>Task name. Default: The value of the task name.</p> <code>None</code> <p>Returns:</p> Type Description <code>Union[Task, None]</code> <p>Task|None: Result of the task or <code>None</code>.</p> <p>Raises:</p> Type Description <code>ValueError</code> <p>Task name is not specified.</p> Source code in <code>src/qtasks/registries/async_task_decorator.py</code> <pre><code>async def add_task(\n    self,\n    *args: Annotated[\n        Any,\n        Doc(\"\"\"\n                args of the task.\n\n                Default: `()`.\n                \"\"\"),\n    ],\n    priority: Annotated[\n        int | None,\n        Doc(\"\"\"\n                Task priority.\n\n                Default: Task priority value.\n                \"\"\"),\n    ] = None,\n    timeout: Annotated[\n        float | None,\n        Doc(\"\"\"\n                Task timeout.\n\n                If specified, the task is returned via `qtasks.results.AsyncTask`.\n                \"\"\"),\n    ] = None,\n    task_name: Annotated[\n        str | None,\n        Doc(\"\"\"\n                Task name.\n\n                Default: The value of the task name.\n                \"\"\"),\n    ] = None,\n    **kwargs: Annotated[\n        Any,\n        Doc(\"\"\"\n                kwargs tasks.\n\n                Default: `{}`.\n                \"\"\"),\n    ],\n) -&gt; Union[Task, None]:\n    \"\"\"\n    Add a task.\n\n    Args:\n        priority (int, optional): Task priority. Default: Task priority value.\n        args (tuple, optional): task args. Default: `()`.\n        kwargs (dict, optional): kwargs of tasks. Default: `{}`.\n        timeout (float, optional): Task timeout. If specified, the task is returned via `qtasks.results.SyncTask`.\n        task_name (str, optional): Task name. Default: The value of the task name.\n\n    Returns:\n        Task|None: Result of the task or `None`.\n\n    Raises:\n        ValueError: Task name is not specified.\n    \"\"\"\n    if not task_name and not self.task_name:\n        raise ValueError(\"Task name is not specified.\")\n\n    if not self._app:\n        self._update_app()\n\n    if priority is None:\n        priority = self.priority\n\n    return await self._app.add_task(  # type: ignore\n        task_name or self.task_name,  # type: ignore\n        *args,\n        priority=priority,\n        timeout=timeout,\n        **kwargs,\n    )\n</code></pre>"},{"location":"api/registries/sync_task_decorator/","title":"SyncTask","text":"<p>Sync Task.</p>"},{"location":"api/registries/sync_task_decorator/#qtasks.registries.sync_task_decorator.SyncTask","title":"<code>SyncTask</code>","text":"<p>               Bases: <code>Generic[P, R]</code></p> <p><code>SyncTask</code> - a class for replacing a function with a <code>@app.task</code> and <code>@shared_task</code> decorator.</p>"},{"location":"api/registries/sync_task_decorator/#qtasks.registries.sync_task_decorator.SyncTask--example","title":"Example","text":"<pre><code>from qtasks import QueueTasks\n\napp = QueueTasks()\n\n@app.task(\"test\")\ndef test():\n    print(\"This is a test!\")\n\ntest.add_task()\n</code></pre> Source code in <code>src/qtasks/registries/sync_task_decorator.py</code> <pre><code>class SyncTask(Generic[P, R]):\n    \"\"\"\n    `SyncTask` - a class for replacing a function with a `@app.task` and `@shared_task` decorator.\n\n    ## Example\n\n    ```python\n    from qtasks import QueueTasks\n\n    app = QueueTasks()\n\n    @app.task(\"test\")\n    def test():\n        print(\"This is a test!\")\n\n    test.add_task()\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        task_name: Annotated[\n            str | None,\n            Doc(\"\"\"\n                    Task name.\n\n                    Default: `func.__name__`.\n                    \"\"\"),\n        ] = None,\n        priority: Annotated[\n            int | None,\n            Doc(\"\"\"\n                    The task has priority by default.\n\n                    Default: `config.task_default_priority`.\n                    \"\"\"),\n        ] = None,\n        echo: Annotated[\n            bool,\n            Doc(\"\"\"\n                    Add SyncTask as the first parameter.\n\n                    Default: `False`.\n                    \"\"\"),\n        ] = False,\n        max_time: Annotated[\n            float | None,\n            Doc(\"\"\"\n                    The maximum time it takes to complete a task in seconds.\n\n                    Default: `None`.\n                \"\"\"),\n        ] = None,\n        retry: Annotated[\n            int | None,\n            Doc(\"\"\"\n                    The number of attempts to retry the task.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        retry_on_exc: Annotated[\n            list[type[Exception]] | None,\n            Doc(\"\"\"\n                    Exceptions under which the task will be re-executed.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        decode: Annotated[\n            Callable | None,\n            Doc(\"\"\"\n                    Task result decoder.\n                \"\"\"),\n        ] = None,\n        tags: Annotated[\n            list[str] | None,\n            Doc(\"\"\"\n                    Task tags.\n\n                    Default: `None`.\n                \"\"\"),\n        ] = None,\n        description: Annotated[\n            str | None,\n            Doc(\"\"\"\n                    Description of the task.\n\n                    Default: `None`.\n                \"\"\"),\n        ] = None,\n        generate_handler: Annotated[\n            Callable | None,\n            Doc(\"\"\"\n                    Handler generator.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        executor: Annotated[\n            type[BaseTaskExecutor] | None,\n            Doc(\"\"\"\n                    Class `BaseTaskExecutor`.\n\n                    Default: `SyncTaskExecutor`.\n                    \"\"\"),\n        ] = None,\n        middlewares_before: Annotated[\n            list[type[TaskMiddleware]] | None,\n            Doc(\"\"\"\n                    Middleware that will be executed before the task.\n\n                    Default: `Empty array`.\n                    \"\"\"),\n        ] = None,\n        middlewares_after: Annotated[\n            list[type[TaskMiddleware]] | None,\n            Doc(\"\"\"\n                    Middleware that will be executed after the task.\n\n                    Default: `Empty array`.\n                    \"\"\"),\n        ] = None,\n        extra: Annotated[\n            dict[str, Any] | None,\n            Doc(\"\"\"\n                    Additional options.\n\n                    Default: `Empty dictionary`.\n                    \"\"\"),\n        ] = None,\n        app: Annotated[\n            Optional[QueueTasks],\n            Doc(\"\"\"\n                    `QueueTasks` instance.\n\n                    Default: `qtasks._state.app_main`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Initializing a synchronous task.\n\n        Args:\n            task_name (str, optional): Task name. Default: `None`.\n            priority (int, optional): Task priority. Default: `None`.\n            echo (bool, optional): Add SyncTask as the first parameter. Default: `False`.\n            max_time (float, optional): The maximum time the task will take to complete in seconds. Default: `None`.\n            retry (int, optional): Number of attempts to retry the task. Default: `None`.\n            retry_on_exc (List[Type[Exception]], optional): Exceptions under which the task will be re-executed. Default: `None`.\n            decode (Callable, optional): Decoder of the task result. Default: `None`.\n            tags (List[str], optional): Task tags. Default: `None`.\n            description (str, optional): Description of the task. Default: `None`.\n            generate_handler (Callable, optional): Handler generator. Default: `None`.\n            executor (Type[\"BaseTaskExecutor\"], optional): Class `BaseTaskExecutor`. Default: `None`.\n            middlewares_before (List[Type[\"TaskMiddleware\"]], optional): Middleware that will be executed before the task. Default: `Empty array`.\n            middlewares_after (List[Type[\"TaskMiddleware\"]], optional): Middleware that will be executed after the task. Default: `Empty array`.\n            extra (Dict[str, Any], optional): Additional parameters. Default: `Empty dictionary`.\n            app (QueueTasks, optional): `QueueTasks` instance. Default: `None`.\n        \"\"\"\n        self.task_name = task_name\n        self.priority = priority\n\n        self.echo = echo\n\n        self.max_time = max_time\n\n        self.retry = retry\n        self.retry_on_exc = retry_on_exc\n\n        self.decode = decode\n        self.tags = tags\n        self.description = description\n\n        self.executor = executor\n        self.middlewares_before = middlewares_before or []\n        self.middlewares_after = middlewares_after or []\n\n        self.extra = extra or {}\n\n        self._app = app\n\n        self.ctx = SyncContext(\n            task_name=task_name,\n            generate_handler=generate_handler,\n            executor=executor,\n            app=app,\n        )\n\n    def add_task(\n        self,\n        *args: Annotated[\n            Any,\n            Doc(\"\"\"\n                    args of the task.\n\n                    Default: `()`.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int | None,\n            Doc(\"\"\"\n                    The task has priority.\n\n                    Default: Task priority value.\n                    \"\"\"),\n        ] = None,\n        timeout: Annotated[\n            float | None,\n            Doc(\"\"\"\n                    Task timeout.\n\n                    If specified, the task is returned via `qtasks.results.AsyncTask`.\n                    \"\"\"),\n        ] = None,\n        task_name: Annotated[\n            str | None,\n            Doc(\"\"\"\n                    Task name.\n\n                    Default: The value of the task name.\n                    \"\"\"),\n        ] = None,\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    kwargs tasks.\n\n                    Default: `{}`.\n                    \"\"\"),\n        ],\n    ) -&gt; Union[Task, None]:\n        \"\"\"\n        Add a task.\n\n        Args:\n            priority (int, optional): Task priority. Default: Task priority value.\n            args (tuple, optional): task args. Default: `()`.\n            kwargs (dict, optional): kwargs of tasks. Default: `{}`.\n            timeout (float, optional): Task timeout. If specified, the task is returned via `qtasks.results.SyncTask`.\n            task_name (str, optional): Task name. Default: The value of the task name.\n\n        Returns:\n            Task|None: Result of the task or `None`.\n\n        Raises:\n            ValueError: Task name is not specified.\n        \"\"\"\n        if not task_name and not self.task_name:\n            raise ValueError(\"Task name is not specified.\")\n\n        if not self._app:\n            self._update_app()\n\n        if priority is None:\n            priority = self.priority\n\n        return self._app.add_task(  # type: ignore\n            task_name or self.task_name,  # type: ignore\n            *args,\n            priority=priority,\n            timeout=timeout,\n            **kwargs,\n        )\n\n    def __call__(\n            self,\n            *args: Annotated[\n                Any,\n                Doc(\"\"\"\n                        args of the task.\n\n                        Default: `()`.\n                        \"\"\"),\n            ],\n            priority: Annotated[\n                int | None,\n                Doc(\"\"\"\n                        Task priority.\n\n                        Default: Task priority value.\n                        \"\"\"),\n            ] = None,\n            timeout: Annotated[\n                float | None,\n                Doc(\"\"\"\n                        Task timeout.\n\n                        If specified, the task is returned via `qtasks.results.AsyncTask`.\n                        \"\"\"),\n            ] = None,\n            task_name: Annotated[\n                str | None,\n                Doc(\"\"\"\n                        Task name.\n\n                        Default: The value of the task name.\n                        \"\"\"),\n            ] = None,\n            **kwargs: Annotated[\n                Any,\n                Doc(\"\"\"\n                        kwargs tasks.\n\n                        Default: `{}`.\n                        \"\"\"),\n            ]\n    ) -&gt; SyncTaskCls:\n        \"\"\"Create SyncTaskCls instance.\n\n        Args:\n            priority (int, optional): Task priority. Default: Task priority value.\n            args (tuple, optional): task args. Default: `()`.\n            kwargs (dict, optional): kwargs of tasks. Default: `{}`.\n            timeout (float, optional): Task timeout. If specified, the task is returned via `qtasks.results.SyncTask`.\n            task_name (str, optional): Task name. Default: The value of the task name.\n        \"\"\"\n        task_cls = SyncTaskCls(\n            task_name=task_name or self.task_name,\n            priority=priority or self.priority,\n            timeout=timeout,\n            args=args,\n            kwargs=kwargs\n        )\n        task_cls.bind(self)\n        return task_cls\n\n    def _update_app(self):\n        if not self._app:\n            import qtasks._state\n\n            if qtasks._state.app_main is None:\n                raise ImportError(\"Unable to get app!\")\n            self._app = qtasks._state.app_main\n        return\n</code></pre>"},{"location":"api/registries/sync_task_decorator/#qtasks.registries.sync_task_decorator.SyncTask.__call__","title":"<code>__call__(*args, priority=None, timeout=None, task_name=None, **kwargs)</code>","text":"<p>Create SyncTaskCls instance.</p> <p>Parameters:</p> Name Type Description Default <code>priority</code> <code>int</code> <p>Task priority. Default: Task priority value.</p> <code>None</code> <code>args</code> <code>tuple</code> <p>task args. Default: <code>()</code>.</p> <code>()</code> <code>kwargs</code> <code>dict</code> <p>kwargs of tasks. Default: <code>{}</code>.</p> <code>{}</code> <code>timeout</code> <code>float</code> <p>Task timeout. If specified, the task is returned via <code>qtasks.results.SyncTask</code>.</p> <code>None</code> <code>task_name</code> <code>str</code> <p>Task name. Default: The value of the task name.</p> <code>None</code> Source code in <code>src/qtasks/registries/sync_task_decorator.py</code> <pre><code>def __call__(\n        self,\n        *args: Annotated[\n            Any,\n            Doc(\"\"\"\n                    args of the task.\n\n                    Default: `()`.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int | None,\n            Doc(\"\"\"\n                    Task priority.\n\n                    Default: Task priority value.\n                    \"\"\"),\n        ] = None,\n        timeout: Annotated[\n            float | None,\n            Doc(\"\"\"\n                    Task timeout.\n\n                    If specified, the task is returned via `qtasks.results.AsyncTask`.\n                    \"\"\"),\n        ] = None,\n        task_name: Annotated[\n            str | None,\n            Doc(\"\"\"\n                    Task name.\n\n                    Default: The value of the task name.\n                    \"\"\"),\n        ] = None,\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    kwargs tasks.\n\n                    Default: `{}`.\n                    \"\"\"),\n        ]\n) -&gt; SyncTaskCls:\n    \"\"\"Create SyncTaskCls instance.\n\n    Args:\n        priority (int, optional): Task priority. Default: Task priority value.\n        args (tuple, optional): task args. Default: `()`.\n        kwargs (dict, optional): kwargs of tasks. Default: `{}`.\n        timeout (float, optional): Task timeout. If specified, the task is returned via `qtasks.results.SyncTask`.\n        task_name (str, optional): Task name. Default: The value of the task name.\n    \"\"\"\n    task_cls = SyncTaskCls(\n        task_name=task_name or self.task_name,\n        priority=priority or self.priority,\n        timeout=timeout,\n        args=args,\n        kwargs=kwargs\n    )\n    task_cls.bind(self)\n    return task_cls\n</code></pre>"},{"location":"api/registries/sync_task_decorator/#qtasks.registries.sync_task_decorator.SyncTask.__init__","title":"<code>__init__(task_name=None, priority=None, echo=False, max_time=None, retry=None, retry_on_exc=None, decode=None, tags=None, description=None, generate_handler=None, executor=None, middlewares_before=None, middlewares_after=None, extra=None, app=None)</code>","text":"<p>Initializing a synchronous task.</p> <p>Parameters:</p> Name Type Description Default <code>task_name</code> <code>str</code> <p>Task name. Default: <code>None</code>.</p> <code>None</code> <code>priority</code> <code>int</code> <p>Task priority. Default: <code>None</code>.</p> <code>None</code> <code>echo</code> <code>bool</code> <p>Add SyncTask as the first parameter. Default: <code>False</code>.</p> <code>False</code> <code>max_time</code> <code>float</code> <p>The maximum time the task will take to complete in seconds. Default: <code>None</code>.</p> <code>None</code> <code>retry</code> <code>int</code> <p>Number of attempts to retry the task. Default: <code>None</code>.</p> <code>None</code> <code>retry_on_exc</code> <code>List[Type[Exception]]</code> <p>Exceptions under which the task will be re-executed. Default: <code>None</code>.</p> <code>None</code> <code>decode</code> <code>Callable</code> <p>Decoder of the task result. Default: <code>None</code>.</p> <code>None</code> <code>tags</code> <code>List[str]</code> <p>Task tags. Default: <code>None</code>.</p> <code>None</code> <code>description</code> <code>str</code> <p>Description of the task. Default: <code>None</code>.</p> <code>None</code> <code>generate_handler</code> <code>Callable</code> <p>Handler generator. Default: <code>None</code>.</p> <code>None</code> <code>executor</code> <code>Type['BaseTaskExecutor']</code> <p>Class <code>BaseTaskExecutor</code>. Default: <code>None</code>.</p> <code>None</code> <code>middlewares_before</code> <code>List[Type['TaskMiddleware']]</code> <p>Middleware that will be executed before the task. Default: <code>Empty array</code>.</p> <code>None</code> <code>middlewares_after</code> <code>List[Type['TaskMiddleware']]</code> <p>Middleware that will be executed after the task. Default: <code>Empty array</code>.</p> <code>None</code> <code>extra</code> <code>Dict[str, Any]</code> <p>Additional parameters. Default: <code>Empty dictionary</code>.</p> <code>None</code> <code>app</code> <code>QueueTasks</code> <p><code>QueueTasks</code> instance. Default: <code>None</code>.</p> <code>None</code> Source code in <code>src/qtasks/registries/sync_task_decorator.py</code> <pre><code>def __init__(\n    self,\n    task_name: Annotated[\n        str | None,\n        Doc(\"\"\"\n                Task name.\n\n                Default: `func.__name__`.\n                \"\"\"),\n    ] = None,\n    priority: Annotated[\n        int | None,\n        Doc(\"\"\"\n                The task has priority by default.\n\n                Default: `config.task_default_priority`.\n                \"\"\"),\n    ] = None,\n    echo: Annotated[\n        bool,\n        Doc(\"\"\"\n                Add SyncTask as the first parameter.\n\n                Default: `False`.\n                \"\"\"),\n    ] = False,\n    max_time: Annotated[\n        float | None,\n        Doc(\"\"\"\n                The maximum time it takes to complete a task in seconds.\n\n                Default: `None`.\n            \"\"\"),\n    ] = None,\n    retry: Annotated[\n        int | None,\n        Doc(\"\"\"\n                The number of attempts to retry the task.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    retry_on_exc: Annotated[\n        list[type[Exception]] | None,\n        Doc(\"\"\"\n                Exceptions under which the task will be re-executed.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    decode: Annotated[\n        Callable | None,\n        Doc(\"\"\"\n                Task result decoder.\n            \"\"\"),\n    ] = None,\n    tags: Annotated[\n        list[str] | None,\n        Doc(\"\"\"\n                Task tags.\n\n                Default: `None`.\n            \"\"\"),\n    ] = None,\n    description: Annotated[\n        str | None,\n        Doc(\"\"\"\n                Description of the task.\n\n                Default: `None`.\n            \"\"\"),\n    ] = None,\n    generate_handler: Annotated[\n        Callable | None,\n        Doc(\"\"\"\n                Handler generator.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    executor: Annotated[\n        type[BaseTaskExecutor] | None,\n        Doc(\"\"\"\n                Class `BaseTaskExecutor`.\n\n                Default: `SyncTaskExecutor`.\n                \"\"\"),\n    ] = None,\n    middlewares_before: Annotated[\n        list[type[TaskMiddleware]] | None,\n        Doc(\"\"\"\n                Middleware that will be executed before the task.\n\n                Default: `Empty array`.\n                \"\"\"),\n    ] = None,\n    middlewares_after: Annotated[\n        list[type[TaskMiddleware]] | None,\n        Doc(\"\"\"\n                Middleware that will be executed after the task.\n\n                Default: `Empty array`.\n                \"\"\"),\n    ] = None,\n    extra: Annotated[\n        dict[str, Any] | None,\n        Doc(\"\"\"\n                Additional options.\n\n                Default: `Empty dictionary`.\n                \"\"\"),\n    ] = None,\n    app: Annotated[\n        Optional[QueueTasks],\n        Doc(\"\"\"\n                `QueueTasks` instance.\n\n                Default: `qtasks._state.app_main`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    Initializing a synchronous task.\n\n    Args:\n        task_name (str, optional): Task name. Default: `None`.\n        priority (int, optional): Task priority. Default: `None`.\n        echo (bool, optional): Add SyncTask as the first parameter. Default: `False`.\n        max_time (float, optional): The maximum time the task will take to complete in seconds. Default: `None`.\n        retry (int, optional): Number of attempts to retry the task. Default: `None`.\n        retry_on_exc (List[Type[Exception]], optional): Exceptions under which the task will be re-executed. Default: `None`.\n        decode (Callable, optional): Decoder of the task result. Default: `None`.\n        tags (List[str], optional): Task tags. Default: `None`.\n        description (str, optional): Description of the task. Default: `None`.\n        generate_handler (Callable, optional): Handler generator. Default: `None`.\n        executor (Type[\"BaseTaskExecutor\"], optional): Class `BaseTaskExecutor`. Default: `None`.\n        middlewares_before (List[Type[\"TaskMiddleware\"]], optional): Middleware that will be executed before the task. Default: `Empty array`.\n        middlewares_after (List[Type[\"TaskMiddleware\"]], optional): Middleware that will be executed after the task. Default: `Empty array`.\n        extra (Dict[str, Any], optional): Additional parameters. Default: `Empty dictionary`.\n        app (QueueTasks, optional): `QueueTasks` instance. Default: `None`.\n    \"\"\"\n    self.task_name = task_name\n    self.priority = priority\n\n    self.echo = echo\n\n    self.max_time = max_time\n\n    self.retry = retry\n    self.retry_on_exc = retry_on_exc\n\n    self.decode = decode\n    self.tags = tags\n    self.description = description\n\n    self.executor = executor\n    self.middlewares_before = middlewares_before or []\n    self.middlewares_after = middlewares_after or []\n\n    self.extra = extra or {}\n\n    self._app = app\n\n    self.ctx = SyncContext(\n        task_name=task_name,\n        generate_handler=generate_handler,\n        executor=executor,\n        app=app,\n    )\n</code></pre>"},{"location":"api/registries/sync_task_decorator/#qtasks.registries.sync_task_decorator.SyncTask.add_task","title":"<code>add_task(*args, priority=None, timeout=None, task_name=None, **kwargs)</code>","text":"<p>Add a task.</p> <p>Parameters:</p> Name Type Description Default <code>priority</code> <code>int</code> <p>Task priority. Default: Task priority value.</p> <code>None</code> <code>args</code> <code>tuple</code> <p>task args. Default: <code>()</code>.</p> <code>()</code> <code>kwargs</code> <code>dict</code> <p>kwargs of tasks. Default: <code>{}</code>.</p> <code>{}</code> <code>timeout</code> <code>float</code> <p>Task timeout. If specified, the task is returned via <code>qtasks.results.SyncTask</code>.</p> <code>None</code> <code>task_name</code> <code>str</code> <p>Task name. Default: The value of the task name.</p> <code>None</code> <p>Returns:</p> Type Description <code>Union[Task, None]</code> <p>Task|None: Result of the task or <code>None</code>.</p> <p>Raises:</p> Type Description <code>ValueError</code> <p>Task name is not specified.</p> Source code in <code>src/qtasks/registries/sync_task_decorator.py</code> <pre><code>def add_task(\n    self,\n    *args: Annotated[\n        Any,\n        Doc(\"\"\"\n                args of the task.\n\n                Default: `()`.\n                \"\"\"),\n    ],\n    priority: Annotated[\n        int | None,\n        Doc(\"\"\"\n                The task has priority.\n\n                Default: Task priority value.\n                \"\"\"),\n    ] = None,\n    timeout: Annotated[\n        float | None,\n        Doc(\"\"\"\n                Task timeout.\n\n                If specified, the task is returned via `qtasks.results.AsyncTask`.\n                \"\"\"),\n    ] = None,\n    task_name: Annotated[\n        str | None,\n        Doc(\"\"\"\n                Task name.\n\n                Default: The value of the task name.\n                \"\"\"),\n    ] = None,\n    **kwargs: Annotated[\n        Any,\n        Doc(\"\"\"\n                kwargs tasks.\n\n                Default: `{}`.\n                \"\"\"),\n    ],\n) -&gt; Union[Task, None]:\n    \"\"\"\n    Add a task.\n\n    Args:\n        priority (int, optional): Task priority. Default: Task priority value.\n        args (tuple, optional): task args. Default: `()`.\n        kwargs (dict, optional): kwargs of tasks. Default: `{}`.\n        timeout (float, optional): Task timeout. If specified, the task is returned via `qtasks.results.SyncTask`.\n        task_name (str, optional): Task name. Default: The value of the task name.\n\n    Returns:\n        Task|None: Result of the task or `None`.\n\n    Raises:\n        ValueError: Task name is not specified.\n    \"\"\"\n    if not task_name and not self.task_name:\n        raise ValueError(\"Task name is not specified.\")\n\n    if not self._app:\n        self._update_app()\n\n    if priority is None:\n        priority = self.priority\n\n    return self._app.add_task(  # type: ignore\n        task_name or self.task_name,  # type: ignore\n        *args,\n        priority=priority,\n        timeout=timeout,\n        **kwargs,\n    )\n</code></pre>"},{"location":"api/results/async_result/","title":"AsyncResult","text":"<p>Async Result.</p>"},{"location":"api/results/async_result/#qtasks.results.async_result.AsyncResult","title":"<code>AsyncResult</code>","text":"<p><code>AsyncResult</code> - Asynchronous class for waiting for the result of a task.</p>"},{"location":"api/results/async_result/#qtasks.results.async_result.AsyncResult--example","title":"Example","text":"<pre><code>import asyncio\n\nfrom qtasks import QueueTasks\nfrom qtasks.results import AsyncResult\n\napp = QueueTasks()\n\nasync def main():\n    task = await app.add_task(task_name=\"test\")\n    result = await AsyncResult(uuid=task.uuid).result(timeout=50)\n\nasyncio.run(main())\n</code></pre> Source code in <code>src/qtasks/results/async_result.py</code> <pre><code>class AsyncResult:\n    \"\"\"\n    `AsyncResult` - Asynchronous class for waiting for the result of a task.\n\n    ## Example\n\n    ```python\n    import asyncio\n\n    from qtasks import QueueTasks\n    from qtasks.results import AsyncResult\n\n    app = QueueTasks()\n\n    async def main():\n        task = await app.add_task(task_name=\"test\")\n        result = await AsyncResult(uuid=task.uuid).result(timeout=50)\n\n    asyncio.run(main())\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        uuid: Annotated[\n            UUID | str | None,\n            Doc(\"\"\"\n                    UUID of the task.\n                    \"\"\"),\n        ] = None,\n        app: Annotated[\n            Optional[QueueTasks],\n            Doc(\"\"\"\n                    `QueueTasks` instance.\n\n                    Default: `qtasks._state.app_main`.\n                    \"\"\"),\n        ] = None,\n        log: Annotated[\n            Logger | None,\n            Doc(\"\"\"\n                    Logger.\n\n                    Default: `qtasks.logs.Logger`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Initializing an asynchronous result.\n\n        Args:\n            uuid (UUID | str, optional): UUID of the task. Default: None.\n            app (QueueTasks, optional): `QueueTasks` instance. Default: None.\n            log (Logger, optional): Logger. Default: None.\n        \"\"\"\n        self._app = app or self._update_state()\n\n        self.log = (\n            log.with_subname(\n                \"AsyncResult\", default_level=self._app.config.logs_default_level_client\n            )\n            if log\n            else Logger(\n                name=self._app.name,\n                subname=\"AsyncResult\",\n                default_level=self._app.config.logs_default_level_client,\n                format=self._app.config.logs_format,\n            )\n        )\n        self._stop_event = asyncio.Event()\n\n        self.uuid = uuid\n\n    async def result(\n        self,\n        timeout: Annotated[\n            float,\n            Doc(\"\"\"\n                    Task timeout\n\n                    Default: `100`.\n                    \"\"\"),\n        ] = 100,\n    ) -&gt; Union[Task, None]:\n        \"\"\"\n        Waiting for the task result.\n\n        Args:\n            timeout (float, optional): Task timeout. Default: `100`.\n\n        Returns:\n            Task | None: Task or None.\n        \"\"\"\n        self._stop_event.clear()\n        try:\n            result = await asyncio.wait_for(self._execute_task(), timeout)\n            self.log.debug(f\"Task {result.uuid if result else None} is completed!\")\n            return result\n        except asyncio.TimeoutError:\n            self.log.warning(f\"Task timed out after {timeout} seconds!\")\n            self._stop_event.set()\n            return None\n\n    async def _execute_task(self) -&gt; Union[Task, None]:\n        if not self.uuid:\n            raise ValueError(\"Task UUID is not set.\")\n\n        uuid = self.uuid\n        while True:\n            if self._stop_event.is_set():\n                break\n\n            task = await self._app.get(uuid=uuid)\n\n            if not task:\n                self.log.warning(f\"Task {uuid} not found!\")\n                return None\n\n            if task.retry and task.retry &gt; 0 and task.retry_child_uuid:\n                uuid = task.retry_child_uuid\n                continue\n\n            if not task or task.status not in self._app.config.result_statuses_end:\n                await asyncio.sleep(self._app.config.result_time_interval)\n                continue\n\n            return task\n\n    def _update_state(self) -&gt; QueueTasks:\n        import qtasks._state\n\n        if qtasks._state.app_main is None:\n            raise ImportError(\"Unable to get app!\")\n        app = qtasks._state.app_main\n        return app  # type: ignore\n</code></pre>"},{"location":"api/results/async_result/#qtasks.results.async_result.AsyncResult.__init__","title":"<code>__init__(uuid=None, app=None, log=None)</code>","text":"<p>Initializing an asynchronous result.</p> <p>Parameters:</p> Name Type Description Default <code>uuid</code> <code>UUID | str</code> <p>UUID of the task. Default: None.</p> <code>None</code> <code>app</code> <code>QueueTasks</code> <p><code>QueueTasks</code> instance. Default: None.</p> <code>None</code> <code>log</code> <code>Logger</code> <p>Logger. Default: None.</p> <code>None</code> Source code in <code>src/qtasks/results/async_result.py</code> <pre><code>def __init__(\n    self,\n    uuid: Annotated[\n        UUID | str | None,\n        Doc(\"\"\"\n                UUID of the task.\n                \"\"\"),\n    ] = None,\n    app: Annotated[\n        Optional[QueueTasks],\n        Doc(\"\"\"\n                `QueueTasks` instance.\n\n                Default: `qtasks._state.app_main`.\n                \"\"\"),\n    ] = None,\n    log: Annotated[\n        Logger | None,\n        Doc(\"\"\"\n                Logger.\n\n                Default: `qtasks.logs.Logger`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    Initializing an asynchronous result.\n\n    Args:\n        uuid (UUID | str, optional): UUID of the task. Default: None.\n        app (QueueTasks, optional): `QueueTasks` instance. Default: None.\n        log (Logger, optional): Logger. Default: None.\n    \"\"\"\n    self._app = app or self._update_state()\n\n    self.log = (\n        log.with_subname(\n            \"AsyncResult\", default_level=self._app.config.logs_default_level_client\n        )\n        if log\n        else Logger(\n            name=self._app.name,\n            subname=\"AsyncResult\",\n            default_level=self._app.config.logs_default_level_client,\n            format=self._app.config.logs_format,\n        )\n    )\n    self._stop_event = asyncio.Event()\n\n    self.uuid = uuid\n</code></pre>"},{"location":"api/results/async_result/#qtasks.results.async_result.AsyncResult.result","title":"<code>result(timeout=100)</code>  <code>async</code>","text":"<p>Waiting for the task result.</p> <p>Parameters:</p> Name Type Description Default <code>timeout</code> <code>float</code> <p>Task timeout. Default: <code>100</code>.</p> <code>100</code> <p>Returns:</p> Type Description <code>Union[Task, None]</code> <p>Task | None: Task or None.</p> Source code in <code>src/qtasks/results/async_result.py</code> <pre><code>async def result(\n    self,\n    timeout: Annotated[\n        float,\n        Doc(\"\"\"\n                Task timeout\n\n                Default: `100`.\n                \"\"\"),\n    ] = 100,\n) -&gt; Union[Task, None]:\n    \"\"\"\n    Waiting for the task result.\n\n    Args:\n        timeout (float, optional): Task timeout. Default: `100`.\n\n    Returns:\n        Task | None: Task or None.\n    \"\"\"\n    self._stop_event.clear()\n    try:\n        result = await asyncio.wait_for(self._execute_task(), timeout)\n        self.log.debug(f\"Task {result.uuid if result else None} is completed!\")\n        return result\n    except asyncio.TimeoutError:\n        self.log.warning(f\"Task timed out after {timeout} seconds!\")\n        self._stop_event.set()\n        return None\n</code></pre>"},{"location":"api/results/sync_result/","title":"SyncResult","text":"<p>Sync Result.</p>"},{"location":"api/results/sync_result/#qtasks.results.sync_result.SyncResult","title":"<code>SyncResult</code>","text":"<p><code>SyncResult</code> - Synchronous class for waiting for the result of a task.</p>"},{"location":"api/results/sync_result/#qtasks.results.sync_result.SyncResult--example","title":"Example","text":"<pre><code>from qtasks import QueueTasks\nfrom qtasks.results import SyncResult\n\napp = QueueTasks()\n\ntask = app.add_task(task_name=\"test\")\nresult = SyncResult(uuid=task.uuid).result(timeout=50)\n</code></pre> Source code in <code>src/qtasks/results/sync_result.py</code> <pre><code>class SyncResult:\n    \"\"\"\n    `SyncResult` - Synchronous class for waiting for the result of a task.\n\n    ## Example\n\n    ```python\n\n    from qtasks import QueueTasks\n    from qtasks.results import SyncResult\n\n    app = QueueTasks()\n\n    task = app.add_task(task_name=\"test\")\n    result = SyncResult(uuid=task.uuid).result(timeout=50)\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        uuid: Annotated[\n            UUID | str | None,\n            Doc(\"\"\"\n                    UUID of the task.\n                    \"\"\"),\n        ] = None,\n        app: Annotated[\n            Optional[QueueTasks],\n            Doc(\"\"\"\n                    `QueueTasks` instance.\n\n                    Default: `qtasks._state.app_main`.\n                    \"\"\"),\n        ] = None,\n        log: Annotated[\n            Logger | None,\n            Doc(\"\"\"\n                    Logger.\n\n                    Default: `qtasks.logs.Logger`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Initializing a synchronous result.\n\n        Args:\n            uuid (UUID | str, optional): UUID of the task. Default: None.\n            app (QueueTasks, optional): `QueueTasks` instance. Default: None.\n            log (Logger, optional): Logger. Default: None.\n        \"\"\"\n        self._app = app or self._update_state()\n\n        self.log = (\n            log.with_subname(\n                \"SyncResult\", default_level=self._app.config.logs_default_level_client\n            )\n            if log\n            else Logger(\n                name=self._app.name,\n                subname=\"SyncResult\",\n                default_level=self._app.config.logs_default_level_client,\n                format=self._app.config.logs_format,\n            )\n        )\n        self._stop_event = threading.Event()\n\n        self.uuid = uuid\n\n    def result(\n        self,\n        timeout: Annotated[\n            float,\n            Doc(\"\"\"\n                    Task timeout\n\n                    Default: `100`.\n                    \"\"\"),\n        ] = 100,\n    ) -&gt; Union[Task, None]:\n        \"\"\"\n        Waiting for the task result.\n\n        Args:\n            timeout (float, optional): Task timeout. Default: `100`.\n\n        Returns:\n            Task | None: Task or None.\n        \"\"\"\n        self._stop_event.clear()\n        with ThreadPoolExecutor(max_workers=1) as executor:\n            future = executor.submit(self._execute_task)\n            try:\n                result = future.result(timeout=timeout)\n                self.log.debug(f\"Task {result.uuid if result else None} is completed!\")\n                return result\n            except TimeoutError:\n                self.log.warning(f\"Task timed out after {timeout} seconds!\")\n                self._stop_event.set()\n                return None\n\n    def _execute_task(self) -&gt; Union[Task, None]:\n        if not self.uuid:\n            raise ValueError(\"Task UUID is not set.\")\n\n        uuid = self.uuid\n        while True:\n            if self._stop_event.is_set():\n                break\n\n            task = self._app.get(uuid=uuid)\n\n            if not task:\n                self.log.warning(f\"Task {uuid} not found!\")\n                return None\n\n            if task.retry and task.retry &gt; 0 and task.retry_child_uuid:\n                uuid = task.retry_child_uuid\n                continue\n\n            if not task or task.status not in self._app.config.result_statuses_end:\n                time.sleep(self._app.config.result_time_interval)\n                continue\n\n            return task\n\n    def _update_state(self) -&gt; QueueTasks:\n        import qtasks._state\n\n        if qtasks._state.app_main is None:\n            raise ImportError(\"Unable to get app!\")\n        app = qtasks._state.app_main\n        return app  # type: ignore\n</code></pre>"},{"location":"api/results/sync_result/#qtasks.results.sync_result.SyncResult.__init__","title":"<code>__init__(uuid=None, app=None, log=None)</code>","text":"<p>Initializing a synchronous result.</p> <p>Parameters:</p> Name Type Description Default <code>uuid</code> <code>UUID | str</code> <p>UUID of the task. Default: None.</p> <code>None</code> <code>app</code> <code>QueueTasks</code> <p><code>QueueTasks</code> instance. Default: None.</p> <code>None</code> <code>log</code> <code>Logger</code> <p>Logger. Default: None.</p> <code>None</code> Source code in <code>src/qtasks/results/sync_result.py</code> <pre><code>def __init__(\n    self,\n    uuid: Annotated[\n        UUID | str | None,\n        Doc(\"\"\"\n                UUID of the task.\n                \"\"\"),\n    ] = None,\n    app: Annotated[\n        Optional[QueueTasks],\n        Doc(\"\"\"\n                `QueueTasks` instance.\n\n                Default: `qtasks._state.app_main`.\n                \"\"\"),\n    ] = None,\n    log: Annotated[\n        Logger | None,\n        Doc(\"\"\"\n                Logger.\n\n                Default: `qtasks.logs.Logger`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    Initializing a synchronous result.\n\n    Args:\n        uuid (UUID | str, optional): UUID of the task. Default: None.\n        app (QueueTasks, optional): `QueueTasks` instance. Default: None.\n        log (Logger, optional): Logger. Default: None.\n    \"\"\"\n    self._app = app or self._update_state()\n\n    self.log = (\n        log.with_subname(\n            \"SyncResult\", default_level=self._app.config.logs_default_level_client\n        )\n        if log\n        else Logger(\n            name=self._app.name,\n            subname=\"SyncResult\",\n            default_level=self._app.config.logs_default_level_client,\n            format=self._app.config.logs_format,\n        )\n    )\n    self._stop_event = threading.Event()\n\n    self.uuid = uuid\n</code></pre>"},{"location":"api/results/sync_result/#qtasks.results.sync_result.SyncResult.result","title":"<code>result(timeout=100)</code>","text":"<p>Waiting for the task result.</p> <p>Parameters:</p> Name Type Description Default <code>timeout</code> <code>float</code> <p>Task timeout. Default: <code>100</code>.</p> <code>100</code> <p>Returns:</p> Type Description <code>Union[Task, None]</code> <p>Task | None: Task or None.</p> Source code in <code>src/qtasks/results/sync_result.py</code> <pre><code>def result(\n    self,\n    timeout: Annotated[\n        float,\n        Doc(\"\"\"\n                Task timeout\n\n                Default: `100`.\n                \"\"\"),\n    ] = 100,\n) -&gt; Union[Task, None]:\n    \"\"\"\n    Waiting for the task result.\n\n    Args:\n        timeout (float, optional): Task timeout. Default: `100`.\n\n    Returns:\n        Task | None: Task or None.\n    \"\"\"\n    self._stop_event.clear()\n    with ThreadPoolExecutor(max_workers=1) as executor:\n        future = executor.submit(self._execute_task)\n        try:\n            result = future.result(timeout=timeout)\n            self.log.debug(f\"Task {result.uuid if result else None} is completed!\")\n            return result\n        except TimeoutError:\n            self.log.warning(f\"Task timed out after {timeout} seconds!\")\n            self._stop_event.set()\n            return None\n</code></pre>"},{"location":"api/schemas/global_config/","title":"GlobalConfig","text":"<p>Global Config Schema.</p>"},{"location":"api/schemas/global_config/#qtasks.schemas.global_config.GlobalConfigSchema","title":"<code>GlobalConfigSchema</code>  <code>dataclass</code>","text":"<p><code>GlobalConfigSchema</code> schema.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Name <code>GlobalConfig.name</code>.</p> required <code>status</code> <code>str</code> <p>Name <code>GlobalConfig.status</code>.</p> required Source code in <code>src/qtasks/schemas/global_config.py</code> <pre><code>@dataclass\nclass GlobalConfigSchema:\n    \"\"\"\n    `GlobalConfigSchema` schema.\n\n    Args:\n        name (str): Name `GlobalConfig.name`.\n        status (str): Name `GlobalConfig.status`.\n    \"\"\"\n\n    name: str\n    status: str\n</code></pre>"},{"location":"api/schemas/inits/","title":"Inits","text":"<p>Init Inits.</p>"},{"location":"api/schemas/inits/#qtasks.schemas.inits.InitsExecSchema","title":"<code>InitsExecSchema</code>  <code>dataclass</code>","text":"<p><code>InitsExecSchema</code> schema.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Event name.</p> required <code>func</code> <code>FunctionType</code> <p>Initialization function.</p> required <code>awaiting</code> <code>bool</code> <p>Asynchronous initialization. Default: False</p> <code>False</code> Source code in <code>src/qtasks/schemas/inits.py</code> <pre><code>@dataclass\nclass InitsExecSchema:\n    \"\"\"\n    `InitsExecSchema` schema.\n\n    Args:\n        name (str): Event name.\n        func (FunctionType): Initialization function.\n\n        awaiting (bool): Asynchronous initialization. Default: False\n    \"\"\"\n\n    name: str\n    func: FunctionType\n\n    awaiting: bool = False\n</code></pre>"},{"location":"api/schemas/queueconfig/","title":"QueueConfig","text":"<p>QueueConfig Schema.</p>"},{"location":"api/schemas/queueconfig/#qtasks.configs.config.QueueConfig","title":"<code>QueueConfig</code>  <code>dataclass</code>","text":"<p>Configuration of task queues.</p> <p>Attributes:</p> Name Type Description <code>max_tasks_process</code> <code>int</code> <p>Maximum tasks in process. Default: <code>10</code></p> <code>running_older_tasks</code> <code>bool</code> <p>Run past tasks. Default: <code>False</code></p> <code>delete_finished_tasks</code> <code>bool</code> <p>Deleting completed tasks. Default: <code>False</code></p> <code>task_default_priority</code> <code>int</code> <p>Default task priority. Default: <code>0</code></p> <code>task_default_decode</code> <code>Callable | None</code> <p>Default task result decoder. Default: <code>None</code></p> <code>logs_default_level_server</code> <code>int</code> <p>Logging level for the server. Default: <code>logging.INFO(20)</code></p> <code>logs_default_level_client</code> <code>int | None</code> <p>Logging level for the client. Default: <code>logging.INFO(20)</code></p> <code>logs_format</code> <code>str</code> <p>Logging format. Default: <code>%(asctime)s [%(name)s: %(levelname)s] (%(subname)s) %(message)s</code></p> <code>result_time_interval</code> <code>float</code> <p>Time interval for results. Default: <code>1.0</code></p> <code>result_statuses_end</code> <code>list[str]</code> <p>Results end statuses. Default: <code>[\"success\", \"error\", \"cancel\"]</code></p> <code>environ_prefix</code> <code>str</code> <p>Prefix for environment variables. Default: <code>QTASKS_</code></p> Source code in <code>src/qtasks/configs/config.py</code> <pre><code>@dataclass\nclass QueueConfig:\n    \"\"\"\n    Configuration of task queues.\n\n    Attributes:\n        max_tasks_process (int): Maximum tasks in process. Default: `10`\n        running_older_tasks (bool): Run past tasks. Default: `False`\n        delete_finished_tasks (bool): Deleting completed tasks. Default: `False`\n\n        task_default_priority (int): Default task priority. Default: `0`\n        task_default_decode (Callable | None): Default task result decoder. Default: `None`\n\n        logs_default_level_server (int): Logging level for the server. Default: `logging.INFO(20)`\n        logs_default_level_client (int | None): Logging level for the client. Default: `logging.INFO(20)`\n        logs_format (str): Logging format. Default: `%(asctime)s [%(name)s: %(levelname)s] (%(subname)s) %(message)s`\n\n        result_time_interval (float): Time interval for results. Default: `1.0`\n        result_statuses_end (list[str]): Results end statuses. Default: `[\"success\", \"error\", \"cancel\"]`\n\n        environ_prefix (str): Prefix for environment variables. Default: `QTASKS_`\n    \"\"\"\n\n    max_tasks_process: int = 10\n    running_older_tasks: bool = False\n    delete_finished_tasks: bool = False\n\n    task_default_priority: int = 0\n    task_default_decode: Optional[Callable] = None\n\n    global_config_status_ttl = 20\n    global_config_status_set_periodic = 17\n\n    logs_default_level_server: int = logging.INFO\n    logs_default_level_client: int = logging.INFO\n    logs_format: str = \"%(asctime)s [%(name)s: %(levelname)s] (%(subname)s) %(message)s\"\n\n    result_time_interval: float = 1.0\n    result_statuses_end: list[str] = field(\n        default_factory=lambda: [\n            TaskStatusEnum.SUCCESS.value,\n            TaskStatusEnum.ERROR.value,\n            TaskStatusEnum.CANCEL.value,\n        ]\n    )\n\n    environ_prefix: str = \"QTASKS_\"\n\n    _callbacks: list[Callable[[\"QueueConfig\", str, Any], None]] = field(\n        default_factory=list, init=False, repr=False\n    )\n    _dynamic_fields: dict[str, Any] = field(\n        default_factory=dict, init=False, repr=False\n    )\n\n    def subscribe(self, callback: Callable[[\"QueueConfig\", str, Any], None]):\n        \"\"\"Subscribe to change.\"\"\"\n        self._callbacks.append(callback)\n\n    def _notify(self, key: str, value: Any):\n        for callback in self._callbacks:\n            callback(self, key, value)\n\n    def __getattr__(self, item):\n        \"\"\"Getting an attribute.\"\"\"\n        # Checking dynamic fields\n        if item in self._dynamic_fields:\n            return self._dynamic_fields[item]\n        # Calling the default behavior of dataclass\n        raise AttributeError(f\"{type(self).__name__} has no attribute '{item}'\")\n\n    def __setattr__(self, key, value):\n        \"\"\"Setting the attribute.\"\"\"\n        # For dataclass fields\n        if key in self.__annotations__:\n            object.__setattr__(self, key, value)\n            if (\n                \"_callbacks\" in self.__dict__\n            ):  # Checking for presence to avoid recursion\n                self._notify(key, value)\n        # For internal attributes\n        elif key.startswith(\"_\"):\n            object.__setattr__(self, key, value)\n        # For dynamic fields\n        else:\n            dynamic_fields = object.__getattribute__(self, \"_dynamic_fields\")\n            dynamic_fields[key] = value\n            self._notify(key, value)\n\n    def __post_init__(self):\n        \"\"\"Initialization after creation.\"\"\"\n        env_vars = self._get_env_all()\n        for key, value in env_vars.items():\n            attr_key = key[len(self.environ_prefix) :].lower()\n            if hasattr(self, attr_key):\n                attr_type = type(getattr(self, attr_key))\n                try:\n                    if attr_type is bool:\n                        casted_value = value.lower() in (\"1\", \"true\", \"yes\", \"on\")\n                    else:\n                        casted_value = attr_type(value)\n                    setattr(self, attr_key, casted_value)\n                except (ValueError, TypeError):\n                    pass\n\n\n    def _get_env_all(self) -&gt; dict[str, Any]:\n        \"\"\"Getting environment variables with prefix.\"\"\"\n        return {k: v for k, v in os.environ.items() if k.startswith(self.environ_prefix)}\n</code></pre>"},{"location":"api/schemas/queueconfig/#qtasks.configs.config.QueueConfig.__getattr__","title":"<code>__getattr__(item)</code>","text":"<p>Getting an attribute.</p> Source code in <code>src/qtasks/configs/config.py</code> <pre><code>def __getattr__(self, item):\n    \"\"\"Getting an attribute.\"\"\"\n    # Checking dynamic fields\n    if item in self._dynamic_fields:\n        return self._dynamic_fields[item]\n    # Calling the default behavior of dataclass\n    raise AttributeError(f\"{type(self).__name__} has no attribute '{item}'\")\n</code></pre>"},{"location":"api/schemas/queueconfig/#qtasks.configs.config.QueueConfig.__post_init__","title":"<code>__post_init__()</code>","text":"<p>Initialization after creation.</p> Source code in <code>src/qtasks/configs/config.py</code> <pre><code>def __post_init__(self):\n    \"\"\"Initialization after creation.\"\"\"\n    env_vars = self._get_env_all()\n    for key, value in env_vars.items():\n        attr_key = key[len(self.environ_prefix) :].lower()\n        if hasattr(self, attr_key):\n            attr_type = type(getattr(self, attr_key))\n            try:\n                if attr_type is bool:\n                    casted_value = value.lower() in (\"1\", \"true\", \"yes\", \"on\")\n                else:\n                    casted_value = attr_type(value)\n                setattr(self, attr_key, casted_value)\n            except (ValueError, TypeError):\n                pass\n</code></pre>"},{"location":"api/schemas/queueconfig/#qtasks.configs.config.QueueConfig.__setattr__","title":"<code>__setattr__(key, value)</code>","text":"<p>Setting the attribute.</p> Source code in <code>src/qtasks/configs/config.py</code> <pre><code>def __setattr__(self, key, value):\n    \"\"\"Setting the attribute.\"\"\"\n    # For dataclass fields\n    if key in self.__annotations__:\n        object.__setattr__(self, key, value)\n        if (\n            \"_callbacks\" in self.__dict__\n        ):  # Checking for presence to avoid recursion\n            self._notify(key, value)\n    # For internal attributes\n    elif key.startswith(\"_\"):\n        object.__setattr__(self, key, value)\n    # For dynamic fields\n    else:\n        dynamic_fields = object.__getattribute__(self, \"_dynamic_fields\")\n        dynamic_fields[key] = value\n        self._notify(key, value)\n</code></pre>"},{"location":"api/schemas/queueconfig/#qtasks.configs.config.QueueConfig.subscribe","title":"<code>subscribe(callback)</code>","text":"<p>Subscribe to change.</p> Source code in <code>src/qtasks/configs/config.py</code> <pre><code>def subscribe(self, callback: Callable[[\"QueueConfig\", str, Any], None]):\n    \"\"\"Subscribe to change.\"\"\"\n    self._callbacks.append(callback)\n</code></pre>"},{"location":"api/schemas/task_exec/","title":"TaskExec","text":"<p>TaskPriority and TaskExec Schema.</p>"},{"location":"api/schemas/task_exec/#qtasks.schemas.task_exec.TaskExecSchema","title":"<code>TaskExecSchema</code>  <code>dataclass</code>","text":"<p><code>TaskExecSchema</code> schema.</p> <p>Parameters:</p> Name Type Description Default <code>priority</code> <code>int</code> <p>Priority.</p> required <code>name</code> <code>str</code> <p>Name.</p> required <code>func</code> <code>FunctionType</code> <p>Task function.</p> required <code>awaiting</code> <code>bool</code> <p>Asynchronous task. Default: <code>False</code></p> <code>False</code> <code>generating</code> <code>str | Literal[False]</code> <p>Generating a task. Default: <code>False</code></p> <code>False</code> <code>echo</code> <code>bool</code> <p>Include the self parameter in the task. Default: <code>False</code></p> <code>False</code> <code>max_time</code> <code>float</code> <p>The maximum time the task will take to complete in seconds. Default: <code>None</code></p> <code>None</code> <code>retry</code> <code>int</code> <p>Number of attempts to retry the task. Default: <code>None</code></p> <code>None</code> <code>retry_on_exc</code> <code>List[Type[Exception]]</code> <p>Exceptions under which the task will be re-executed. Default: <code>None</code></p> <code>None</code> <code>decode</code> <code>Callable</code> <p>Decoder of the task result. Default: <code>None</code></p> <code>None</code> <code>tags</code> <code>List[str]</code> <p>Task tags. Default: <code>None</code></p> <code>None</code> <code>description</code> <code>str</code> <p>Description of the task. Default: <code>None</code>.</p> <code>None</code> <code>generate_handler</code> <code>Callable</code> <p>Handler generator. Default: <code>None</code></p> <code>None</code> <code>executor</code> <code>Type[BaseTaskExecutor]</code> <p>Class <code>BaseTaskExecutor</code>. Default: <code>SyncTaskExecutor</code>|<code>AsyncTaskExecutor</code>.</p> <code>None</code> <code>middlewares_before</code> <code>List[Type[TaskMiddleware]]</code> <p>Middleware before the task is executed. Default: <code>Empty array</code>.</p> <code>list()</code> <code>middlewares_after</code> <code>List[Type[TaskMiddleware]]</code> <p>Middleware after task execution. Default: <code>Empty array</code>.</p> <code>list()</code> <code>extra</code> <code>Dict[str, Any]</code> <p>Additional task parameters. Default: <code>Empty dictionary</code>.</p> <code>dict()</code> Source code in <code>src/qtasks/schemas/task_exec.py</code> <pre><code>@dataclass\nclass TaskExecSchema:\n    \"\"\"`TaskExecSchema` schema.\n\n    Args:\n        priority (int): Priority.\n        name (str): Name.\n\n        func (FunctionType): Task function.\n        awaiting (bool): Asynchronous task. Default: `False`\n        generating (str|Literal[False]): Generating a task. Default: `False`\n\n        echo (bool): Include the self parameter in the task. Default: `False`\n\n        max_time (float, optional): The maximum time the task will take to complete in seconds. Default: `None`\n\n        retry (int, optional): Number of attempts to retry the task. Default: `None`\n        retry_on_exc (List[Type[Exception]], optional): Exceptions under which the task will be re-executed. Default: `None`\n\n        decode (Callable, optional): Decoder of the task result. Default: `None`\n        tags (List[str], optional): Task tags. Default: `None`\n        description (str, optional): Description of the task. Default: `None`.\n\n        generate_handler (Callable, optional): Handler generator. Default: `None`\n\n        executor (Type[BaseTaskExecutor], optional): Class `BaseTaskExecutor`. Default: `SyncTaskExecutor`|`AsyncTaskExecutor`.\n        middlewares_before (List[Type[TaskMiddleware]]): Middleware before the task is executed. Default: `Empty array`.\n        middlewares_after (List[Type[TaskMiddleware]]): Middleware after task execution. Default: `Empty array`.\n\n        extra (Dict[str, Any]): Additional task parameters. Default: `Empty dictionary`.\n    \"\"\"\n\n    priority: int\n    name: str\n\n    func: FunctionType\n    awaiting: bool = False\n    generating: str | Literal[False] = False\n\n    echo: bool = False\n\n    max_time: float | None = None\n\n    retry: int | None = None\n    retry_on_exc: list[type[Exception]] | None = None\n\n    decode: Callable | None = None\n    tags: list[str] | None = None\n    description: str | None = None\n\n    generate_handler: Callable | None = None\n\n    executor: type[BaseTaskExecutor] | None = None\n    middlewares_before: list[type[TaskMiddleware]] = field(default_factory=list)\n    middlewares_after: list[type[TaskMiddleware]] = field(default_factory=list)\n\n    extra: dict = field(default_factory=dict)\n\n    def add_middlewares_before(self, middlewares: list[type[TaskMiddleware]]) -&gt; None:\n        \"\"\"Adds a middleware to a task.\n\n        Args:\n            middlewares (List[Type[TaskMiddleware]]): List of middlewares.\n        \"\"\"\n        self.middlewares_before.extend(middlewares)\n\n    def add_middlewares_after(self, middlewares: list[type[TaskMiddleware]]) -&gt; None:\n        \"\"\"Adds a middleware to a task.\n\n        Args:\n            middlewares (List[Type[TaskMiddleware]]): List of middlewares.\n        \"\"\"\n        self.middlewares_after.extend(middlewares)\n</code></pre>"},{"location":"api/schemas/task_exec/#qtasks.schemas.task_exec.TaskExecSchema.add_middlewares_after","title":"<code>add_middlewares_after(middlewares)</code>","text":"<p>Adds a middleware to a task.</p> <p>Parameters:</p> Name Type Description Default <code>middlewares</code> <code>List[Type[TaskMiddleware]]</code> <p>List of middlewares.</p> required Source code in <code>src/qtasks/schemas/task_exec.py</code> <pre><code>def add_middlewares_after(self, middlewares: list[type[TaskMiddleware]]) -&gt; None:\n    \"\"\"Adds a middleware to a task.\n\n    Args:\n        middlewares (List[Type[TaskMiddleware]]): List of middlewares.\n    \"\"\"\n    self.middlewares_after.extend(middlewares)\n</code></pre>"},{"location":"api/schemas/task_exec/#qtasks.schemas.task_exec.TaskExecSchema.add_middlewares_before","title":"<code>add_middlewares_before(middlewares)</code>","text":"<p>Adds a middleware to a task.</p> <p>Parameters:</p> Name Type Description Default <code>middlewares</code> <code>List[Type[TaskMiddleware]]</code> <p>List of middlewares.</p> required Source code in <code>src/qtasks/schemas/task_exec.py</code> <pre><code>def add_middlewares_before(self, middlewares: list[type[TaskMiddleware]]) -&gt; None:\n    \"\"\"Adds a middleware to a task.\n\n    Args:\n        middlewares (List[Type[TaskMiddleware]]): List of middlewares.\n    \"\"\"\n    self.middlewares_before.extend(middlewares)\n</code></pre>"},{"location":"api/schemas/task_exec/#qtasks.schemas.task_exec.TaskPrioritySchema","title":"<code>TaskPrioritySchema</code>  <code>dataclass</code>","text":"<p><code>TaskPrioritySchema</code> schema.</p> <p>Parameters:</p> Name Type Description Default <code>priority</code> <code>int</code> <p>Priority.</p> required <code>uuid</code> <code>UUID</code> <p>UUID.</p> required <code>name</code> <code>str</code> <p>Name.</p> required <code>args</code> <code>Tuple[str]</code> <p>Arguments of type args.</p> <code>list()</code> <code>kwargs</code> <code>Dict[str, str]</code> <p>Arguments of type kwargs.</p> <code>dict()</code> <code>created_at</code> <code>float</code> <p>Created date in <code>timestamp</code> format.</p> <code>0.0</code> <code>updated_at</code> <code>float</code> <p>Update date in <code>timestamp</code> format.</p> <code>0.0</code> Source code in <code>src/qtasks/schemas/task_exec.py</code> <pre><code>@dataclass(order=True)\nclass TaskPrioritySchema:\n    \"\"\"`TaskPrioritySchema` schema.\n\n    Args:\n        priority (int): Priority.\n        uuid (UUID): UUID.\n        name (str): Name.\n\n        args (Tuple[str]): Arguments of type args.\n        kwargs (Dict[str, str]): Arguments of type kwargs.\n\n        created_at (float): Created date in `timestamp` format.\n        updated_at (float): Update date in `timestamp` format.\n    \"\"\"\n\n    priority: int\n    uuid: UUID = field(compare=False)\n    name: str = field(compare=False)\n\n    args: list = field(default_factory=list, compare=False)\n    kwargs: dict = field(default_factory=dict, compare=False)\n\n    created_at: float = 0.0\n    updated_at: float = 0.0\n</code></pre>"},{"location":"api/schemas/task_status/","title":"TaskStatus","text":"<p>Task Status Schema.</p>"},{"location":"api/schemas/task_status/#qtasks.schemas.task_status.BaseTaskStatusSchema","title":"<code>BaseTaskStatusSchema</code>  <code>dataclass</code>","text":"<p><code>BaseTaskStatusSchema</code> schema.</p> <p>Parameters:</p> Name Type Description Default <code>status</code> <code>str</code> <p>Status.</p> required <code>task_name</code> <code>str</code> <p>Name.</p> <code>''</code> <code>priority</code> <code>int</code> <p>Priority.</p> <code>0</code> <code>args</code> <code>Tuple[str]</code> <p>Arguments of type args.</p> <code>'[]'</code> <code>kwargs</code> <code>Dict[str, str]</code> <p>Arguments of type kwargs.</p> <code>'{}'</code> <code>created_at</code> <code>float</code> <p>Created date in <code>timestamp</code> format.</p> <code>0.0</code> <code>updated_at</code> <code>float</code> <p>Update date in <code>timestamp</code> format.</p> <code>time()</code> <code>returning</code> <code>str | None</code> <p>Result. Default: <code>None</code>.</p> required <code>traceback</code> <code>str | None</code> <p>Trace errors. Default: <code>None</code>.</p> required Source code in <code>src/qtasks/schemas/task_status.py</code> <pre><code>@dataclass\nclass BaseTaskStatusSchema:\n    \"\"\"\n    `BaseTaskStatusSchema` schema.\n\n    Args:\n        status (str): Status.\n        task_name (str): Name.\n        priority (int): Priority.\n        args (Tuple[str]): Arguments of type args.\n        kwargs (Dict[str, str]): Arguments of type kwargs.\n\n        created_at (float): Created date in `timestamp` format.\n        updated_at (float): Update date in `timestamp` format.\n        returning (str | None): Result. Default: `None`.\n        traceback (str | None): Trace errors. Default: `None`.\n    \"\"\"\n\n    task_name: str = \"\"\n    priority: int = 0\n\n    args: str = field(default=\"[]\")\n    kwargs: str = field(default=\"{}\")\n\n    created_at: float = 0.0\n    updated_at: float = field(default_factory=time)\n\n    def __post_init__(self):\n        \"\"\"Convert arguments to JSON format.\"\"\"\n        if not isinstance(self.args, str):\n            self.args = json.dumps(self.args)\n        if not isinstance(self.kwargs, str):\n            self.kwargs = json.dumps(self.kwargs)\n</code></pre>"},{"location":"api/schemas/task_status/#qtasks.schemas.task_status.BaseTaskStatusSchema.__post_init__","title":"<code>__post_init__()</code>","text":"<p>Convert arguments to JSON format.</p> Source code in <code>src/qtasks/schemas/task_status.py</code> <pre><code>def __post_init__(self):\n    \"\"\"Convert arguments to JSON format.\"\"\"\n    if not isinstance(self.args, str):\n        self.args = json.dumps(self.args)\n    if not isinstance(self.kwargs, str):\n        self.kwargs = json.dumps(self.kwargs)\n</code></pre>"},{"location":"api/schemas/task_status/#qtasks.schemas.task_status.TaskStatusCancelSchema","title":"<code>TaskStatusCancelSchema</code>  <code>dataclass</code>","text":"<p>               Bases: <code>BaseTaskStatusSchema</code></p> <p><code>TaskStatusCancelSchema</code> schema.</p> <p>Parameters:</p> Name Type Description Default <code>status</code> <code>str</code> <p>Status.</p> <code>CANCEL.value</code> <code>cancel_reason</code> <code>str</code> <p>Reason for canceling the task.</p> <code>''</code> Source code in <code>src/qtasks/schemas/task_status.py</code> <pre><code>@dataclass\nclass TaskStatusCancelSchema(BaseTaskStatusSchema):\n    \"\"\"\n    `TaskStatusCancelSchema` schema.\n\n    Args:\n        status (str): Status.\n        cancel_reason (str): Reason for canceling the task.\n    \"\"\"\n\n    status: str = TaskStatusEnum.CANCEL.value\n    cancel_reason: str = \"\"\n</code></pre>"},{"location":"api/schemas/task_status/#qtasks.schemas.task_status.TaskStatusErrorSchema","title":"<code>TaskStatusErrorSchema</code>  <code>dataclass</code>","text":"<p>               Bases: <code>BaseTaskStatusSchema</code></p> <p><code>TaskStatusErrorSchema</code> schema.</p> <p>Parameters:</p> Name Type Description Default <code>status</code> <code>str</code> <p>Status.</p> <code>ERROR.value</code> <code>traceback</code> <code>str</code> <p>Error tracing.</p> <code>''</code> Source code in <code>src/qtasks/schemas/task_status.py</code> <pre><code>@dataclass\nclass TaskStatusErrorSchema(BaseTaskStatusSchema):\n    \"\"\"\n    `TaskStatusErrorSchema` schema.\n\n    Args:\n        status (str): Status.\n        traceback (str): Error tracing.\n    \"\"\"\n\n    status: str = TaskStatusEnum.ERROR.value\n    traceback: str = \"\"\n\n    # plugins\n    retry: ClassVar[int | None] = None\n    retry_child_uuid: ClassVar[str | None] = None\n    retry_parent_uuid: ClassVar[str | None] = None\n</code></pre>"},{"location":"api/schemas/task_status/#qtasks.schemas.task_status.TaskStatusNewSchema","title":"<code>TaskStatusNewSchema</code>  <code>dataclass</code>","text":"<p>               Bases: <code>BaseTaskStatusSchema</code></p> <p><code>TaskStatusNewSchema</code> schema.</p> <p>Parameters:</p> Name Type Description Default <code>status</code> <code>str</code> <p>Status.</p> <code>NEW.value</code> Source code in <code>src/qtasks/schemas/task_status.py</code> <pre><code>@dataclass\nclass TaskStatusNewSchema(BaseTaskStatusSchema):\n    \"\"\"\n    `TaskStatusNewSchema` schema.\n\n    Args:\n        status (str): Status.\n    \"\"\"\n\n    status: str = TaskStatusEnum.NEW.value\n</code></pre>"},{"location":"api/schemas/task_status/#qtasks.schemas.task_status.TaskStatusProcessSchema","title":"<code>TaskStatusProcessSchema</code>  <code>dataclass</code>","text":"<p>               Bases: <code>BaseTaskStatusSchema</code></p> <p><code>TaskStatusProcessSchema</code> schema.</p> <p>Parameters:</p> Name Type Description Default <code>status</code> <code>str</code> <p>Status.</p> <code>PROCESS.value</code> Source code in <code>src/qtasks/schemas/task_status.py</code> <pre><code>@dataclass\nclass TaskStatusProcessSchema(BaseTaskStatusSchema):\n    \"\"\"\n    `TaskStatusProcessSchema` schema.\n\n    Args:\n        status (str): Status.\n    \"\"\"\n\n    status: str = TaskStatusEnum.PROCESS.value\n</code></pre>"},{"location":"api/schemas/task_status/#qtasks.schemas.task_status.TaskStatusSuccessSchema","title":"<code>TaskStatusSuccessSchema</code>  <code>dataclass</code>","text":"<p>               Bases: <code>BaseTaskStatusSchema</code></p> <p><code>TaskStatusSuccessSchema</code> schema.</p> <p>Parameters:</p> Name Type Description Default <code>status</code> <code>str</code> <p>Status.</p> <code>SUCCESS.value</code> <code>returning</code> <code>str</code> <p>Result.</p> <code>''</code> Source code in <code>src/qtasks/schemas/task_status.py</code> <pre><code>@dataclass\nclass TaskStatusSuccessSchema(BaseTaskStatusSchema):\n    \"\"\"\n    `TaskStatusSuccessSchema` schema.\n\n    Args:\n        status (str): Status.\n        returning (str): Result.\n    \"\"\"\n\n    status: str = TaskStatusEnum.SUCCESS.value\n    returning: str = \"\"\n</code></pre>"},{"location":"api/schemas/task_status_enum/","title":"TaskStatusEnums","text":"<p>Task status enums.</p>"},{"location":"api/schemas/task_status_enum/#qtasks.enums.task_status.TaskStatusEnum","title":"<code>TaskStatusEnum</code>","text":"<p>               Bases: <code>Enum</code></p> <p><code>TaskStatusEnum</code> - Task statuses.</p> Source code in <code>src/qtasks/enums/task_status.py</code> <pre><code>class TaskStatusEnum(Enum):\n    \"\"\"`TaskStatusEnum` - Task statuses.\"\"\"\n\n    NEW = \"new\"\n    \"\"\"New task.\"\"\"\n    PROCESS = \"process\"\n    \"\"\"Task is being processed.\"\"\"\n    SUCCESS = \"success\"\n    \"\"\"Task successfully completed.\"\"\"\n    ERROR = \"error\"\n    \"\"\"Task completed with an error.\"\"\"\n    CANCEL = \"cancel\"\n    \"\"\"Task cancelled.\"\"\"\n</code></pre>"},{"location":"api/schemas/task_status_enum/#qtasks.enums.task_status.TaskStatusEnum.CANCEL","title":"<code>CANCEL = 'cancel'</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":"<p>Task cancelled.</p>"},{"location":"api/schemas/task_status_enum/#qtasks.enums.task_status.TaskStatusEnum.ERROR","title":"<code>ERROR = 'error'</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":"<p>Task completed with an error.</p>"},{"location":"api/schemas/task_status_enum/#qtasks.enums.task_status.TaskStatusEnum.NEW","title":"<code>NEW = 'new'</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":"<p>New task.</p>"},{"location":"api/schemas/task_status_enum/#qtasks.enums.task_status.TaskStatusEnum.PROCESS","title":"<code>PROCESS = 'process'</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":"<p>Task is being processed.</p>"},{"location":"api/schemas/task_status_enum/#qtasks.enums.task_status.TaskStatusEnum.SUCCESS","title":"<code>SUCCESS = 'success'</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":"<p>Task successfully completed.</p>"},{"location":"api/schemas/test_config/","title":"TestConfig","text":"<p>Test Schema.</p>"},{"location":"api/schemas/test_config/#qtasks.schemas.test.TestConfig","title":"<code>TestConfig</code>  <code>dataclass</code>","text":"<p>Configuration for testing task queues.</p> <p>Attributes:</p> Name Type Description <code>worker</code> <code>bool</code> <p>Worker.</p> <code>broker</code> <code>bool</code> <p>Broker.</p> <code>storage</code> <code>bool</code> <p>Storage.</p> <code>global_config</code> <code>bool</code> <p>Global config.</p> <code>plugins</code> <code>bool</code> <p>Plugins.</p> Source code in <code>src/qtasks/schemas/test.py</code> <pre><code>@dataclass\nclass TestConfig:\n    \"\"\"\n    Configuration for testing task queues.\n\n    Attributes:\n        worker (bool): Worker.\n        broker (bool): Broker.\n        storage (bool): Storage.\n        global_config (bool): Global config.\n        plugins (bool): Plugins.\n    \"\"\"\n\n    __test__ = False\n\n    worker: bool = False\n    broker: bool = False\n    storage: bool = False\n    global_config: bool = False\n    plugins: bool = False\n\n    @classmethod\n    def full(cls):\n        \"\"\"Create a complete testing configuration.\"\"\"\n        return cls(\n            worker=True, broker=True, storage=True, global_config=True, plugins=True\n        )\n\n    @classmethod\n    def only_worker(cls, plugins: bool = False):\n        \"\"\"Create a testing configuration for the worker only.\"\"\"\n        return cls(worker=True, plugins=plugins)\n\n    @classmethod\n    def only_broker(cls, plugins: bool = False):\n        \"\"\"Create a test configuration for the broker only.\"\"\"\n        return cls(broker=True, plugins=plugins)\n\n    @classmethod\n    def full_broker(cls):\n        \"\"\"Create a complete testing configuration for the broker.\"\"\"\n        return cls(broker=True, storage=True, global_config=True, plugins=True)\n</code></pre>"},{"location":"api/schemas/test_config/#qtasks.schemas.test.TestConfig.full","title":"<code>full()</code>  <code>classmethod</code>","text":"<p>Create a complete testing configuration.</p> Source code in <code>src/qtasks/schemas/test.py</code> <pre><code>@classmethod\ndef full(cls):\n    \"\"\"Create a complete testing configuration.\"\"\"\n    return cls(\n        worker=True, broker=True, storage=True, global_config=True, plugins=True\n    )\n</code></pre>"},{"location":"api/schemas/test_config/#qtasks.schemas.test.TestConfig.full_broker","title":"<code>full_broker()</code>  <code>classmethod</code>","text":"<p>Create a complete testing configuration for the broker.</p> Source code in <code>src/qtasks/schemas/test.py</code> <pre><code>@classmethod\ndef full_broker(cls):\n    \"\"\"Create a complete testing configuration for the broker.\"\"\"\n    return cls(broker=True, storage=True, global_config=True, plugins=True)\n</code></pre>"},{"location":"api/schemas/test_config/#qtasks.schemas.test.TestConfig.only_broker","title":"<code>only_broker(plugins=False)</code>  <code>classmethod</code>","text":"<p>Create a test configuration for the broker only.</p> Source code in <code>src/qtasks/schemas/test.py</code> <pre><code>@classmethod\ndef only_broker(cls, plugins: bool = False):\n    \"\"\"Create a test configuration for the broker only.\"\"\"\n    return cls(broker=True, plugins=plugins)\n</code></pre>"},{"location":"api/schemas/test_config/#qtasks.schemas.test.TestConfig.only_worker","title":"<code>only_worker(plugins=False)</code>  <code>classmethod</code>","text":"<p>Create a testing configuration for the worker only.</p> Source code in <code>src/qtasks/schemas/test.py</code> <pre><code>@classmethod\ndef only_worker(cls, plugins: bool = False):\n    \"\"\"Create a testing configuration for the worker only.\"\"\"\n    return cls(worker=True, plugins=plugins)\n</code></pre>"},{"location":"api/starters/async_starter/","title":"AsyncStarter","text":"<p>Async Starter.</p>"},{"location":"api/starters/async_starter/#qtasks.starters.async_starter.AsyncStarter","title":"<code>AsyncStarter</code>","text":"<p>               Bases: <code>BaseStarter[Literal[True]]</code>, <code>AsyncPluginMixin</code></p> <p>Starter that starts the Components.</p>"},{"location":"api/starters/async_starter/#qtasks.starters.async_starter.AsyncStarter--example","title":"Example","text":"<pre><code>from qtasks import QueueTasks\nfrom qtasks.brokers import AsyncRedisBroker\nfrom qtasks.workers import AsyncWorker\nfrom qtasks.starters import AsyncStarter\n\nbroker = AsyncRedisBroker(name=\"QueueTasks\", url=\"redis://localhost:6379/2\")\nworker = AsyncWorker(name=\"QueueTasks\", broker=broker)\n\napp = QueueTasks(worker=worker, broker=broker)\n\nstarter = AsyncStarter(name=\"QueueTasks\", worker=worker, broker=broker)\napp.run_forever(starter=starter)\n</code></pre> Source code in <code>src/qtasks/starters/async_starter.py</code> <pre><code>class AsyncStarter(BaseStarter[Literal[True]], AsyncPluginMixin):\n    \"\"\"\n    Starter that starts the Components.\n\n    ## Example\n\n    ```python\n    from qtasks import QueueTasks\n    from qtasks.brokers import AsyncRedisBroker\n    from qtasks.workers import AsyncWorker\n    from qtasks.starters import AsyncStarter\n\n    broker = AsyncRedisBroker(name=\"QueueTasks\", url=\"redis://localhost:6379/2\")\n    worker = AsyncWorker(name=\"QueueTasks\", broker=broker)\n\n    app = QueueTasks(worker=worker, broker=broker)\n\n    starter = AsyncStarter(name=\"QueueTasks\", worker=worker, broker=broker)\n    app.run_forever(starter=starter)\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        name: Annotated[\n            str | None,\n            Doc(\"\"\"\n                    Project name. This name can be used for tags for Starters.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        broker: Annotated[\n            Optional[BaseBroker],\n            Doc(\"\"\"\n                    Broker.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        worker: Annotated[\n            Optional[BaseWorker],\n            Doc(\"\"\"\n                    Worker.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        log: Annotated[\n            Logger | None,\n            Doc(\"\"\"\n                    Logger.\n\n                    Default: `qtasks.logs.Logger`.\n                    \"\"\"),\n        ] = None,\n        config: Annotated[\n            QueueConfig | None,\n            Doc(\"\"\"\n                    Config.\n\n                    Default: `qtasks.configs.config.QueueConfig`.\n                    \"\"\"),\n        ] = None,\n        events: Annotated[\n            Optional[BaseEvents],\n            Doc(\"\"\"\n                    Events.\n\n                    Default: `qtasks.events.AsyncEvents`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Initialization of an asynchronous starter.\n\n        Args:\n            name (str, optional): Project name. Default: None.\n            broker (BaseBroker, optional): Broker. Default: None.\n            worker (BaseWorker, optional): Worker. Default: None.\n            log (Logger, optional): Logger. Default: `qtasks.logs.Logger`.\n            config (QueueConfig, optional): Config. Default: `qtasks.configs.config.QueueConfig`.\n            events (BaseEvents, optional): Events. Default: `qtasks.events.AsyncEvents`.\n        \"\"\"\n        super().__init__(\n            name=name,\n            broker=broker,\n            worker=worker,\n            log=log,\n            config=config,\n            events=events,\n        )\n        self.events: BaseEvents[Literal[True]] = self.events or AsyncEvents()\n        self.worker: BaseWorker[Literal[True]]\n        self.broker: BaseBroker[Literal[True]]\n\n        self._global_loop: asyncio.AbstractEventLoop | None = None\n        self._started_plugins: set[BasePlugin] = set()\n\n    def start(\n        self,\n        loop: Annotated[\n            asyncio.AbstractEventLoop | None,\n            Doc(\"\"\"\n                    Asynchronous loop.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        num_workers: Annotated[\n            int,\n            Doc(\"\"\"\n                    Number of running workers.\n\n                    Default: `4`.\n                    \"\"\"),\n        ] = 4,\n        reset_config: Annotated[\n            bool,\n            Doc(\"\"\"\n                    Update the config of the worker and broker.\n\n                    Default: `True`.\n                    \"\"\"),\n        ] = True,\n        plugins: Annotated[\n            dict[str, list[BasePlugin]] | None,\n            Doc(\"\"\"\n                    Plugins for worker and broker.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n    ) -&gt; None:\n        \"\"\"\n        Starter launch. This function is enabled by the main `QueueTasks` instance via `run_forever`.\n\n        Args:\n            loop (asyncio.AbstractEventLoop, optional): Asynchronous loop. Default: None.\n            num_workers (int, optional): Number of workers. Default: 4.\n            reset_config (bool, optional): Update the config of the worker and broker. Default: True.\n            plugins (Dict[str, List[BasePlugin]] | None, optional): Plugins. Default: None.\n        \"\"\"\n        if self.log:\n            self.log.info(\"Starting QueueTasks...\")\n\n        if plugins:\n            self.plugins.update(plugins)\n\n        if reset_config:\n            self.update_configs(self.config)\n\n        if loop:\n            self._global_loop = loop\n        else:\n            try:\n                self._global_loop = asyncio.new_event_loop()\n                asyncio.set_event_loop(self._global_loop)\n            except RuntimeError:\n                self._global_loop = asyncio.get_event_loop()\n\n        try:\n            self._global_loop.run_until_complete(self._start(num_workers))\n        except KeyboardInterrupt:\n            with contextlib.suppress(RuntimeError, KeyboardInterrupt):\n                self._global_loop.run_until_complete(self.stop())\n\n    async def _start(self, num_workers=4):\n        \"\"\"\n        Launching the Starter asynchronously.\n\n        Args:\n            num_workers (int, optional): Number of workers. Default: 4.\n        \"\"\"\n        await self._plugin_trigger(\"starter_start\", starter=self)\n        for plugin in [i for y in self.plugins.values() for i in y]:\n            if plugin not in self._started_plugins:\n                plugin: BasePlugin[Literal[True]]\n                self._started_plugins.add(plugin)\n                await plugin.start()\n\n        await self.events.fire(\n            \"starting\", starter=self, worker=self.worker, broker=self.broker\n        )\n\n        worker_task = asyncio.create_task(self.worker.start(num_workers))\n        broker_task = asyncio.create_task(self.broker.start(self.worker))\n\n        with contextlib.suppress(asyncio.CancelledError):\n            await asyncio.gather(broker_task, worker_task)\n\n    async def stop(self):\n        \"\"\"Stops all components.\"\"\"\n        if self.log:\n            self.log.info(\"Stopping QueueTasks...\")\n        await self._plugin_trigger(\"starter_stop\", starter=self)\n\n        if self.broker:\n            await self.broker.stop()\n        if self.worker:\n            await self.worker.stop()\n        if self.broker.storage:\n            await self.broker.storage.stop()\n        if self.broker.storage.global_config:\n            await self.broker.storage.global_config.stop()\n\n        if self._global_loop and self._global_loop.is_running():\n            self._global_loop.stop()\n\n        await self.events.fire(\n            \"stopping\", starter=self, worker=self.worker, broker=self.broker\n        )\n\n        for model_plugin in [i for y in self.plugins.values() for i in y]:\n            model_plugin: BasePlugin[Literal[True]]\n            await model_plugin.stop()\n\n        for plugin in self._started_plugins:\n            plugin: BasePlugin[Literal[True]]\n            await plugin.stop()\n        self._started_plugins.clear()\n</code></pre>"},{"location":"api/starters/async_starter/#qtasks.starters.async_starter.AsyncStarter.__init__","title":"<code>__init__(name=None, broker=None, worker=None, log=None, config=None, events=None)</code>","text":"<p>Initialization of an asynchronous starter.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Project name. Default: None.</p> <code>None</code> <code>broker</code> <code>BaseBroker</code> <p>Broker. Default: None.</p> <code>None</code> <code>worker</code> <code>BaseWorker</code> <p>Worker. Default: None.</p> <code>None</code> <code>log</code> <code>Logger</code> <p>Logger. Default: <code>qtasks.logs.Logger</code>.</p> <code>None</code> <code>config</code> <code>QueueConfig</code> <p>Config. Default: <code>qtasks.configs.config.QueueConfig</code>.</p> <code>None</code> <code>events</code> <code>BaseEvents</code> <p>Events. Default: <code>qtasks.events.AsyncEvents</code>.</p> <code>None</code> Source code in <code>src/qtasks/starters/async_starter.py</code> <pre><code>def __init__(\n    self,\n    name: Annotated[\n        str | None,\n        Doc(\"\"\"\n                Project name. This name can be used for tags for Starters.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    broker: Annotated[\n        Optional[BaseBroker],\n        Doc(\"\"\"\n                Broker.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    worker: Annotated[\n        Optional[BaseWorker],\n        Doc(\"\"\"\n                Worker.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    log: Annotated[\n        Logger | None,\n        Doc(\"\"\"\n                Logger.\n\n                Default: `qtasks.logs.Logger`.\n                \"\"\"),\n    ] = None,\n    config: Annotated[\n        QueueConfig | None,\n        Doc(\"\"\"\n                Config.\n\n                Default: `qtasks.configs.config.QueueConfig`.\n                \"\"\"),\n    ] = None,\n    events: Annotated[\n        Optional[BaseEvents],\n        Doc(\"\"\"\n                Events.\n\n                Default: `qtasks.events.AsyncEvents`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    Initialization of an asynchronous starter.\n\n    Args:\n        name (str, optional): Project name. Default: None.\n        broker (BaseBroker, optional): Broker. Default: None.\n        worker (BaseWorker, optional): Worker. Default: None.\n        log (Logger, optional): Logger. Default: `qtasks.logs.Logger`.\n        config (QueueConfig, optional): Config. Default: `qtasks.configs.config.QueueConfig`.\n        events (BaseEvents, optional): Events. Default: `qtasks.events.AsyncEvents`.\n    \"\"\"\n    super().__init__(\n        name=name,\n        broker=broker,\n        worker=worker,\n        log=log,\n        config=config,\n        events=events,\n    )\n    self.events: BaseEvents[Literal[True]] = self.events or AsyncEvents()\n    self.worker: BaseWorker[Literal[True]]\n    self.broker: BaseBroker[Literal[True]]\n\n    self._global_loop: asyncio.AbstractEventLoop | None = None\n    self._started_plugins: set[BasePlugin] = set()\n</code></pre>"},{"location":"api/starters/async_starter/#qtasks.starters.async_starter.AsyncStarter.start","title":"<code>start(loop=None, num_workers=4, reset_config=True, plugins=None)</code>","text":"<p>Starter launch. This function is enabled by the main <code>QueueTasks</code> instance via <code>run_forever</code>.</p> <p>Parameters:</p> Name Type Description Default <code>loop</code> <code>AbstractEventLoop</code> <p>Asynchronous loop. Default: None.</p> <code>None</code> <code>num_workers</code> <code>int</code> <p>Number of workers. Default: 4.</p> <code>4</code> <code>reset_config</code> <code>bool</code> <p>Update the config of the worker and broker. Default: True.</p> <code>True</code> <code>plugins</code> <code>Dict[str, List[BasePlugin]] | None</code> <p>Plugins. Default: None.</p> <code>None</code> Source code in <code>src/qtasks/starters/async_starter.py</code> <pre><code>def start(\n    self,\n    loop: Annotated[\n        asyncio.AbstractEventLoop | None,\n        Doc(\"\"\"\n                Asynchronous loop.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    num_workers: Annotated[\n        int,\n        Doc(\"\"\"\n                Number of running workers.\n\n                Default: `4`.\n                \"\"\"),\n    ] = 4,\n    reset_config: Annotated[\n        bool,\n        Doc(\"\"\"\n                Update the config of the worker and broker.\n\n                Default: `True`.\n                \"\"\"),\n    ] = True,\n    plugins: Annotated[\n        dict[str, list[BasePlugin]] | None,\n        Doc(\"\"\"\n                Plugins for worker and broker.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n) -&gt; None:\n    \"\"\"\n    Starter launch. This function is enabled by the main `QueueTasks` instance via `run_forever`.\n\n    Args:\n        loop (asyncio.AbstractEventLoop, optional): Asynchronous loop. Default: None.\n        num_workers (int, optional): Number of workers. Default: 4.\n        reset_config (bool, optional): Update the config of the worker and broker. Default: True.\n        plugins (Dict[str, List[BasePlugin]] | None, optional): Plugins. Default: None.\n    \"\"\"\n    if self.log:\n        self.log.info(\"Starting QueueTasks...\")\n\n    if plugins:\n        self.plugins.update(plugins)\n\n    if reset_config:\n        self.update_configs(self.config)\n\n    if loop:\n        self._global_loop = loop\n    else:\n        try:\n            self._global_loop = asyncio.new_event_loop()\n            asyncio.set_event_loop(self._global_loop)\n        except RuntimeError:\n            self._global_loop = asyncio.get_event_loop()\n\n    try:\n        self._global_loop.run_until_complete(self._start(num_workers))\n    except KeyboardInterrupt:\n        with contextlib.suppress(RuntimeError, KeyboardInterrupt):\n            self._global_loop.run_until_complete(self.stop())\n</code></pre>"},{"location":"api/starters/async_starter/#qtasks.starters.async_starter.AsyncStarter.stop","title":"<code>stop()</code>  <code>async</code>","text":"<p>Stops all components.</p> Source code in <code>src/qtasks/starters/async_starter.py</code> <pre><code>async def stop(self):\n    \"\"\"Stops all components.\"\"\"\n    if self.log:\n        self.log.info(\"Stopping QueueTasks...\")\n    await self._plugin_trigger(\"starter_stop\", starter=self)\n\n    if self.broker:\n        await self.broker.stop()\n    if self.worker:\n        await self.worker.stop()\n    if self.broker.storage:\n        await self.broker.storage.stop()\n    if self.broker.storage.global_config:\n        await self.broker.storage.global_config.stop()\n\n    if self._global_loop and self._global_loop.is_running():\n        self._global_loop.stop()\n\n    await self.events.fire(\n        \"stopping\", starter=self, worker=self.worker, broker=self.broker\n    )\n\n    for model_plugin in [i for y in self.plugins.values() for i in y]:\n        model_plugin: BasePlugin[Literal[True]]\n        await model_plugin.stop()\n\n    for plugin in self._started_plugins:\n        plugin: BasePlugin[Literal[True]]\n        await plugin.stop()\n    self._started_plugins.clear()\n</code></pre>"},{"location":"api/starters/basestarter/","title":"BaseStarter - \u041f\u0438\u0448\u0435\u043c \u0441\u0432\u043e\u0439 \u0421\u0442\u0430\u0440\u0442\u0435\u0440","text":"<p>Base starter.</p>"},{"location":"api/starters/basestarter/#qtasks.starters.base.BaseStarter","title":"<code>BaseStarter</code>","text":"<p>               Bases: <code>Generic[TAsyncFlag]</code>, <code>ABC</code></p> <p><code>BaseStarter</code> - An abstract class that is the foundation for Starters.</p>"},{"location":"api/starters/basestarter/#qtasks.starters.base.BaseStarter--example","title":"Example","text":"<pre><code>from qtasks import QueueTasks\nfrom qtasks.starters.base import BaseStarter\n\nclass MyStarter(BaseStarter):\n    def __init__(self, name: str = None, broker = None, worker = None):\n        super().__init__(name=name, broker = None, worker = None)\n        pass\n</code></pre> Source code in <code>src/qtasks/starters/base.py</code> <pre><code>class BaseStarter(Generic[TAsyncFlag], ABC):\n    \"\"\"\n    `BaseStarter` - An abstract class that is the foundation for Starters.\n\n    ## Example\n\n    ```python\n    from qtasks import QueueTasks\n    from qtasks.starters.base import BaseStarter\n\n    class MyStarter(BaseStarter):\n        def __init__(self, name: str = None, broker = None, worker = None):\n            super().__init__(name=name, broker = None, worker = None)\n            pass\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        name: Annotated[\n            str | None,\n            Doc(\"\"\"\n                    Project name. This name can be used for tags for Starters.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        broker: Annotated[\n            Optional[BaseBroker],\n            Doc(\"\"\"\n                    Broker.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        worker: Annotated[\n            Optional[BaseWorker],\n            Doc(\"\"\"\n                    Worker.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        log: Annotated[\n            Logger | None,\n            Doc(\"\"\"\n                    Logger.\n\n                    Default: `qtasks.logs.Logger`.\n                    \"\"\"),\n        ] = None,\n        config: Annotated[\n            QueueConfig | None,\n            Doc(\"\"\"\n                    Config.\n\n                    Default: `qtasks.configs.config.QueueConfig`.\n                    \"\"\"),\n        ] = None,\n        events: Annotated[\n            Optional[BaseEvents],\n            Doc(\"\"\"\n                    Events.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Basic starter initialization.\n\n        Args:\n            name (str, optional): Project name. Default: None.\n            broker (BaseBroker, optional): Broker. Default: None.\n            worker (BaseWorker, optional): Worker. Default: None.\n            log (Logger, optional): Logger. Default: `qtasks.logs.Logger`.\n            config (QueueConfig, optional): Config. Default: `qtasks.configs.config.QueueConfig`.\n            events (BaseEvents, optional): Events. Default: `None`.\n        \"\"\"\n        self.name = name\n        self.config = config or QueueConfig()\n        self.log = (\n            log.with_subname(\"Starter\")\n            if log\n            else Logger(\n                name=self.name or \"QueueTasks\",\n                subname=\"Starter\",\n                default_level=self.config.logs_default_level_server,\n                format=self.config.logs_format,\n            )\n        )\n        self.events = events\n\n        self.broker = broker\n        self.worker = worker\n\n        self.plugins: dict[str, list[BasePlugin]] = {}\n\n        self.init_plugins()\n\n    @overload\n    def start(self: BaseStarter[Literal[False]], *args, **kwargs) -&gt; None: ...\n\n    @overload\n    def start(self: BaseStarter[Literal[True]], *args, **kwargs) -&gt; None: ...\n\n    @abstractmethod\n    def start(self, *args, **kwargs) -&gt; None:\n        \"\"\"Starter launch. This function is enabled by the main `QueueTasks` instance via `run_forever`.\"\"\"\n        pass\n\n    @overload\n    def stop(self: BaseStarter[Literal[False]]) -&gt; None: ...\n\n    @overload\n    async def stop(self: BaseStarter[Literal[True]]) -&gt; None: ...\n\n    @abstractmethod\n    def stop(self) -&gt; None | Awaitable[None]:\n        \"\"\"Stops the Starter. This function is invoked by the main `QueueTasks` instance after the `run_forever` function completes.\"\"\"\n        pass\n\n    def add_plugin(\n        self,\n        plugin: Annotated[\n            BasePlugin,\n            Doc(\"\"\"\n                    Plugin.\n                    \"\"\"),\n        ],\n        trigger_names: Annotated[\n            list[str] | None,\n            Doc(\"\"\"\n                    The name of the triggers for the plugin.\n\n                    Default: Default: will be added to `Globals`.\n                    \"\"\"),\n        ] = None,\n    ) -&gt; None:\n        \"\"\"\n        Add a plugin to the class.\n\n        Args:\n            plugin (BasePlugin): Plugin\n            trigger_names (List[str], optional): The name of the triggers for the plugin. Default: will be added to `Globals`.\n        \"\"\"\n        trigger_names = trigger_names or [\"Globals\"]\n\n        for name in trigger_names:\n            if name not in self.plugins:\n                self.plugins.update({name: [plugin]})\n            else:\n                self.plugins[name].append(plugin)\n        return\n\n    def update_configs(\n        self,\n        config: Annotated[\n            QueueConfig,\n            Doc(\"\"\"\n                    Config.\n                    \"\"\"),\n        ],\n    ):\n        \"\"\"\n        Update configs for all components.\n\n        Args:\n            config (QueueConfig): Config.\n        \"\"\"\n        self.log.debug(\"The config has been updated\")\n        if self.worker:\n            self.worker.update_config(config)\n        if self.broker:\n            self.broker.update_config(config)\n            if self.broker.storage:\n                self.broker.storage.update_config(config)\n                if self.broker.storage.global_config:\n                    self.broker.storage.global_config.update_config(config)\n\n    def init_plugins(self):\n        \"\"\"Initializing plugins.\"\"\"\n        pass\n</code></pre>"},{"location":"api/starters/basestarter/#qtasks.starters.base.BaseStarter.__init__","title":"<code>__init__(name=None, broker=None, worker=None, log=None, config=None, events=None)</code>","text":"<p>Basic starter initialization.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Project name. Default: None.</p> <code>None</code> <code>broker</code> <code>BaseBroker</code> <p>Broker. Default: None.</p> <code>None</code> <code>worker</code> <code>BaseWorker</code> <p>Worker. Default: None.</p> <code>None</code> <code>log</code> <code>Logger</code> <p>Logger. Default: <code>qtasks.logs.Logger</code>.</p> <code>None</code> <code>config</code> <code>QueueConfig</code> <p>Config. Default: <code>qtasks.configs.config.QueueConfig</code>.</p> <code>None</code> <code>events</code> <code>BaseEvents</code> <p>Events. Default: <code>None</code>.</p> <code>None</code> Source code in <code>src/qtasks/starters/base.py</code> <pre><code>def __init__(\n    self,\n    name: Annotated[\n        str | None,\n        Doc(\"\"\"\n                Project name. This name can be used for tags for Starters.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    broker: Annotated[\n        Optional[BaseBroker],\n        Doc(\"\"\"\n                Broker.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    worker: Annotated[\n        Optional[BaseWorker],\n        Doc(\"\"\"\n                Worker.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    log: Annotated[\n        Logger | None,\n        Doc(\"\"\"\n                Logger.\n\n                Default: `qtasks.logs.Logger`.\n                \"\"\"),\n    ] = None,\n    config: Annotated[\n        QueueConfig | None,\n        Doc(\"\"\"\n                Config.\n\n                Default: `qtasks.configs.config.QueueConfig`.\n                \"\"\"),\n    ] = None,\n    events: Annotated[\n        Optional[BaseEvents],\n        Doc(\"\"\"\n                Events.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    Basic starter initialization.\n\n    Args:\n        name (str, optional): Project name. Default: None.\n        broker (BaseBroker, optional): Broker. Default: None.\n        worker (BaseWorker, optional): Worker. Default: None.\n        log (Logger, optional): Logger. Default: `qtasks.logs.Logger`.\n        config (QueueConfig, optional): Config. Default: `qtasks.configs.config.QueueConfig`.\n        events (BaseEvents, optional): Events. Default: `None`.\n    \"\"\"\n    self.name = name\n    self.config = config or QueueConfig()\n    self.log = (\n        log.with_subname(\"Starter\")\n        if log\n        else Logger(\n            name=self.name or \"QueueTasks\",\n            subname=\"Starter\",\n            default_level=self.config.logs_default_level_server,\n            format=self.config.logs_format,\n        )\n    )\n    self.events = events\n\n    self.broker = broker\n    self.worker = worker\n\n    self.plugins: dict[str, list[BasePlugin]] = {}\n\n    self.init_plugins()\n</code></pre>"},{"location":"api/starters/basestarter/#qtasks.starters.base.BaseStarter.add_plugin","title":"<code>add_plugin(plugin, trigger_names=None)</code>","text":"<p>Add a plugin to the class.</p> <p>Parameters:</p> Name Type Description Default <code>plugin</code> <code>BasePlugin</code> <p>Plugin</p> required <code>trigger_names</code> <code>List[str]</code> <p>The name of the triggers for the plugin. Default: will be added to <code>Globals</code>.</p> <code>None</code> Source code in <code>src/qtasks/starters/base.py</code> <pre><code>def add_plugin(\n    self,\n    plugin: Annotated[\n        BasePlugin,\n        Doc(\"\"\"\n                Plugin.\n                \"\"\"),\n    ],\n    trigger_names: Annotated[\n        list[str] | None,\n        Doc(\"\"\"\n                The name of the triggers for the plugin.\n\n                Default: Default: will be added to `Globals`.\n                \"\"\"),\n    ] = None,\n) -&gt; None:\n    \"\"\"\n    Add a plugin to the class.\n\n    Args:\n        plugin (BasePlugin): Plugin\n        trigger_names (List[str], optional): The name of the triggers for the plugin. Default: will be added to `Globals`.\n    \"\"\"\n    trigger_names = trigger_names or [\"Globals\"]\n\n    for name in trigger_names:\n        if name not in self.plugins:\n            self.plugins.update({name: [plugin]})\n        else:\n            self.plugins[name].append(plugin)\n    return\n</code></pre>"},{"location":"api/starters/basestarter/#qtasks.starters.base.BaseStarter.init_plugins","title":"<code>init_plugins()</code>","text":"<p>Initializing plugins.</p> Source code in <code>src/qtasks/starters/base.py</code> <pre><code>def init_plugins(self):\n    \"\"\"Initializing plugins.\"\"\"\n    pass\n</code></pre>"},{"location":"api/starters/basestarter/#qtasks.starters.base.BaseStarter.start","title":"<code>start(*args, **kwargs)</code>  <code>abstractmethod</code>","text":"<pre><code>start(*args, **kwargs) -&gt; None\n</code></pre><pre><code>start(*args, **kwargs) -&gt; None\n</code></pre> <p>Starter launch. This function is enabled by the main <code>QueueTasks</code> instance via <code>run_forever</code>.</p> Source code in <code>src/qtasks/starters/base.py</code> <pre><code>@abstractmethod\ndef start(self, *args, **kwargs) -&gt; None:\n    \"\"\"Starter launch. This function is enabled by the main `QueueTasks` instance via `run_forever`.\"\"\"\n    pass\n</code></pre>"},{"location":"api/starters/basestarter/#qtasks.starters.base.BaseStarter.stop","title":"<code>stop()</code>  <code>abstractmethod</code>","text":"<pre><code>stop() -&gt; None\n</code></pre><pre><code>stop() -&gt; None\n</code></pre> <p>Stops the Starter. This function is invoked by the main <code>QueueTasks</code> instance after the <code>run_forever</code> function completes.</p> Source code in <code>src/qtasks/starters/base.py</code> <pre><code>@abstractmethod\ndef stop(self) -&gt; None | Awaitable[None]:\n    \"\"\"Stops the Starter. This function is invoked by the main `QueueTasks` instance after the `run_forever` function completes.\"\"\"\n    pass\n</code></pre>"},{"location":"api/starters/basestarter/#qtasks.starters.base.BaseStarter.update_configs","title":"<code>update_configs(config)</code>","text":"<p>Update configs for all components.</p> <p>Parameters:</p> Name Type Description Default <code>config</code> <code>QueueConfig</code> <p>Config.</p> required Source code in <code>src/qtasks/starters/base.py</code> <pre><code>def update_configs(\n    self,\n    config: Annotated[\n        QueueConfig,\n        Doc(\"\"\"\n                Config.\n                \"\"\"),\n    ],\n):\n    \"\"\"\n    Update configs for all components.\n\n    Args:\n        config (QueueConfig): Config.\n    \"\"\"\n    self.log.debug(\"The config has been updated\")\n    if self.worker:\n        self.worker.update_config(config)\n    if self.broker:\n        self.broker.update_config(config)\n        if self.broker.storage:\n            self.broker.storage.update_config(config)\n            if self.broker.storage.global_config:\n                self.broker.storage.global_config.update_config(config)\n</code></pre>"},{"location":"api/starters/sync_starter/","title":"SyncStarter","text":"<p>Sync Starter.</p>"},{"location":"api/starters/sync_starter/#qtasks.starters.sync_starter.SyncStarter","title":"<code>SyncStarter</code>","text":"<p>               Bases: <code>BaseStarter[Literal[False]]</code>, <code>SyncPluginMixin</code></p> <p>Starter that starts the Components.</p>"},{"location":"api/starters/sync_starter/#qtasks.starters.sync_starter.SyncStarter--example","title":"Example","text":"<pre><code>from qtasks import QueueTasks\nfrom qtasks.brokers import SyncRedisBroker\nfrom qtasks.workers import SyncWorker\nfrom qtasks.starters import SyncStarter\n\nbroker = SyncRedisBroker(name=\"QueueTasks\", url=\"redis://localhost:6379/2\")\nworker = SyncWorker(name=\"QueueTasks\", broker=broker)\n\napp = QueueTasks(worker=worker, broker=broker)\n\nstarter = SyncStarter(name=\"QueueTasks\", worker=worker, broker=broker)\napp.run_forever(starter=starter)\n</code></pre> Source code in <code>src/qtasks/starters/sync_starter.py</code> <pre><code>class SyncStarter(BaseStarter[Literal[False]], SyncPluginMixin):\n    \"\"\"\n    Starter that starts the Components.\n\n    ## Example\n\n    ```python\n    from qtasks import QueueTasks\n    from qtasks.brokers import SyncRedisBroker\n    from qtasks.workers import SyncWorker\n    from qtasks.starters import SyncStarter\n\n    broker = SyncRedisBroker(name=\"QueueTasks\", url=\"redis://localhost:6379/2\")\n    worker = SyncWorker(name=\"QueueTasks\", broker=broker)\n\n    app = QueueTasks(worker=worker, broker=broker)\n\n    starter = SyncStarter(name=\"QueueTasks\", worker=worker, broker=broker)\n    app.run_forever(starter=starter)\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        name: Annotated[\n            str | None,\n            Doc(\"\"\"\n                    Project name. This name can be used for tags for Starters.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        broker: Annotated[\n            Optional[BaseBroker],\n            Doc(\"\"\"\n                    Broker.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        worker: Annotated[\n            Optional[BaseWorker],\n            Doc(\"\"\"\n                    Worker.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        log: Annotated[\n            Logger | None,\n            Doc(\"\"\"\n                    Logger.\n\n                    Default: `qtasks.logs.Logger`.\n                    \"\"\"),\n        ] = None,\n        config: Annotated[\n            QueueConfig | None,\n            Doc(\"\"\"\n                    Config.\n\n                    Default: `qtasks.configs.config.QueueConfig`.\n                    \"\"\"),\n        ] = None,\n        events: Annotated[\n            Optional[BaseEvents],\n            Doc(\"\"\"\n                    Events.\n\n                    Default: `qtasks.events.SyncEvents`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Initialization of an synchronous starter.\n\n        Args:\n            name (str, optional): Project name. Default: None.\n            broker (BaseBroker, optional): Broker. Default: None.\n            worker (BaseWorker, optional): Worker. Default: None.\n            log (Logger, optional): Logger. Default: `qtasks.logs.Logger`.\n            config (QueueConfig, optional): Config. Default: `qtasks.configs.config.QueueConfig`.\n            events (BaseEvents, optional): Events. Default: `qtasks.events.SyncEvents`.\n        \"\"\"\n        super().__init__(\n            name=name,\n            broker=broker,\n            worker=worker,\n            log=log,\n            config=config,\n            events=events,\n        )\n        self.events: BaseEvents[Literal[False]] = self.events or SyncEvents()\n        self.worker: BaseWorker[Literal[False]]\n        self.broker: BaseBroker[Literal[False]]\n\n        self._started_plugins: set[BasePlugin] = set()\n\n    def start(\n        self,\n        num_workers: Annotated[\n            int,\n            Doc(\"\"\"\n                    Number of running workers.\n\n                    Default: `4`.\n                    \"\"\"),\n        ] = 4,\n        reset_config: Annotated[\n            bool,\n            Doc(\"\"\"\n                    Update the config of the worker and broker.\n\n                    Default: `True`.\n                    \"\"\"),\n        ] = True,\n        plugins: Annotated[\n            dict[str, list[BasePlugin]] | None,\n            Doc(\"\"\"\n                    Plugins for worker and broker.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n    ) -&gt; None:\n        \"\"\"Starter launch. This function is enabled by the main `QueueTasks` instance via `run_forever`.\n\n        Args:\n            num_workers (int, optional): Number of workers. Default: 4.\n            reset_config (bool, optional): Update the config of the worker and broker. Default: True.\n            plugins (Dict[str, BasePlugin] | None, optional): Plugins. Default: None.\n        \"\"\"\n        if self.log:\n            self.log.info(\"Starting QueueTasks...\")\n\n        if plugins:\n            self.plugins.update(plugins)\n\n        if reset_config:\n            self.update_configs(self.config)\n\n        try:\n            self._start(num_workers=num_workers)\n        except KeyboardInterrupt:\n            self.stop()\n\n    def _start(self, num_workers=4):\n        \"\"\"Starter starts synchronously.\n\n        Args:\n            num_workers (int, optional): Number of workers. Default: 4.\n        \"\"\"\n        self._plugin_trigger(\"starter_start\", starter=self)\n        for plugin in [i for y in self.plugins.values() for i in y]:\n            if plugin not in self._started_plugins:\n                self._started_plugins.add(plugin)\n                plugin.start()\n\n        self.events.fire(\n            \"starting\", starter=self, worker=self.worker, broker=self.broker\n        )\n\n        self.worker.start(num_workers)\n        self.broker.start(self.worker)\n\n        try:\n            while True:\n                pass\n        except KeyboardInterrupt:\n            self.stop()\n\n    def stop(self):\n        \"\"\"Stops all components.\"\"\"\n        if self.log:\n            self.log.info(\"Stopping QueueTasks...\")\n        self._plugin_trigger(\"starter_stop\", starter=self)\n\n        if self.broker:\n            self.broker.stop()\n        if self.worker:\n            self.worker.stop()\n        if self.broker.storage:\n            self.broker.storage.stop()\n        if self.broker.storage.global_config:\n            self.broker.storage.global_config.stop()\n\n        self.events.fire(\n            \"stopping\", starter=self, worker=self.worker, broker=self.broker\n        )\n\n        for model_plugin in [i for y in self.plugins.values() for i in y]:\n            model_plugin.stop()\n\n        for plugin in self._started_plugins:\n            plugin.stop()\n        self._started_plugins.clear()\n</code></pre>"},{"location":"api/starters/sync_starter/#qtasks.starters.sync_starter.SyncStarter.__init__","title":"<code>__init__(name=None, broker=None, worker=None, log=None, config=None, events=None)</code>","text":"<p>Initialization of an synchronous starter.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Project name. Default: None.</p> <code>None</code> <code>broker</code> <code>BaseBroker</code> <p>Broker. Default: None.</p> <code>None</code> <code>worker</code> <code>BaseWorker</code> <p>Worker. Default: None.</p> <code>None</code> <code>log</code> <code>Logger</code> <p>Logger. Default: <code>qtasks.logs.Logger</code>.</p> <code>None</code> <code>config</code> <code>QueueConfig</code> <p>Config. Default: <code>qtasks.configs.config.QueueConfig</code>.</p> <code>None</code> <code>events</code> <code>BaseEvents</code> <p>Events. Default: <code>qtasks.events.SyncEvents</code>.</p> <code>None</code> Source code in <code>src/qtasks/starters/sync_starter.py</code> <pre><code>def __init__(\n    self,\n    name: Annotated[\n        str | None,\n        Doc(\"\"\"\n                Project name. This name can be used for tags for Starters.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    broker: Annotated[\n        Optional[BaseBroker],\n        Doc(\"\"\"\n                Broker.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    worker: Annotated[\n        Optional[BaseWorker],\n        Doc(\"\"\"\n                Worker.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    log: Annotated[\n        Logger | None,\n        Doc(\"\"\"\n                Logger.\n\n                Default: `qtasks.logs.Logger`.\n                \"\"\"),\n    ] = None,\n    config: Annotated[\n        QueueConfig | None,\n        Doc(\"\"\"\n                Config.\n\n                Default: `qtasks.configs.config.QueueConfig`.\n                \"\"\"),\n    ] = None,\n    events: Annotated[\n        Optional[BaseEvents],\n        Doc(\"\"\"\n                Events.\n\n                Default: `qtasks.events.SyncEvents`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    Initialization of an synchronous starter.\n\n    Args:\n        name (str, optional): Project name. Default: None.\n        broker (BaseBroker, optional): Broker. Default: None.\n        worker (BaseWorker, optional): Worker. Default: None.\n        log (Logger, optional): Logger. Default: `qtasks.logs.Logger`.\n        config (QueueConfig, optional): Config. Default: `qtasks.configs.config.QueueConfig`.\n        events (BaseEvents, optional): Events. Default: `qtasks.events.SyncEvents`.\n    \"\"\"\n    super().__init__(\n        name=name,\n        broker=broker,\n        worker=worker,\n        log=log,\n        config=config,\n        events=events,\n    )\n    self.events: BaseEvents[Literal[False]] = self.events or SyncEvents()\n    self.worker: BaseWorker[Literal[False]]\n    self.broker: BaseBroker[Literal[False]]\n\n    self._started_plugins: set[BasePlugin] = set()\n</code></pre>"},{"location":"api/starters/sync_starter/#qtasks.starters.sync_starter.SyncStarter.start","title":"<code>start(num_workers=4, reset_config=True, plugins=None)</code>","text":"<p>Starter launch. This function is enabled by the main <code>QueueTasks</code> instance via <code>run_forever</code>.</p> <p>Parameters:</p> Name Type Description Default <code>num_workers</code> <code>int</code> <p>Number of workers. Default: 4.</p> <code>4</code> <code>reset_config</code> <code>bool</code> <p>Update the config of the worker and broker. Default: True.</p> <code>True</code> <code>plugins</code> <code>Dict[str, BasePlugin] | None</code> <p>Plugins. Default: None.</p> <code>None</code> Source code in <code>src/qtasks/starters/sync_starter.py</code> <pre><code>def start(\n    self,\n    num_workers: Annotated[\n        int,\n        Doc(\"\"\"\n                Number of running workers.\n\n                Default: `4`.\n                \"\"\"),\n    ] = 4,\n    reset_config: Annotated[\n        bool,\n        Doc(\"\"\"\n                Update the config of the worker and broker.\n\n                Default: `True`.\n                \"\"\"),\n    ] = True,\n    plugins: Annotated[\n        dict[str, list[BasePlugin]] | None,\n        Doc(\"\"\"\n                Plugins for worker and broker.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n) -&gt; None:\n    \"\"\"Starter launch. This function is enabled by the main `QueueTasks` instance via `run_forever`.\n\n    Args:\n        num_workers (int, optional): Number of workers. Default: 4.\n        reset_config (bool, optional): Update the config of the worker and broker. Default: True.\n        plugins (Dict[str, BasePlugin] | None, optional): Plugins. Default: None.\n    \"\"\"\n    if self.log:\n        self.log.info(\"Starting QueueTasks...\")\n\n    if plugins:\n        self.plugins.update(plugins)\n\n    if reset_config:\n        self.update_configs(self.config)\n\n    try:\n        self._start(num_workers=num_workers)\n    except KeyboardInterrupt:\n        self.stop()\n</code></pre>"},{"location":"api/starters/sync_starter/#qtasks.starters.sync_starter.SyncStarter.stop","title":"<code>stop()</code>","text":"<p>Stops all components.</p> Source code in <code>src/qtasks/starters/sync_starter.py</code> <pre><code>def stop(self):\n    \"\"\"Stops all components.\"\"\"\n    if self.log:\n        self.log.info(\"Stopping QueueTasks...\")\n    self._plugin_trigger(\"starter_stop\", starter=self)\n\n    if self.broker:\n        self.broker.stop()\n    if self.worker:\n        self.worker.stop()\n    if self.broker.storage:\n        self.broker.storage.stop()\n    if self.broker.storage.global_config:\n        self.broker.storage.global_config.stop()\n\n    self.events.fire(\n        \"stopping\", starter=self, worker=self.worker, broker=self.broker\n    )\n\n    for model_plugin in [i for y in self.plugins.values() for i in y]:\n        model_plugin.stop()\n\n    for plugin in self._started_plugins:\n        plugin.stop()\n    self._started_plugins.clear()\n</code></pre>"},{"location":"api/stats/async_stats/","title":"AsyncStats","text":"<p>Async Stats.</p>"},{"location":"api/stats/async_stats/#qtasks.stats.async_stats.AsyncStats","title":"<code>AsyncStats</code>","text":"<p>               Bases: <code>BaseStats</code>, <code>AsyncPluginMixin</code></p> <p>Class for asynchronous statistics.</p> Source code in <code>src/qtasks/stats/async_stats.py</code> <pre><code>class AsyncStats(BaseStats, AsyncPluginMixin):\n    \"\"\"Class for asynchronous statistics.\"\"\"\n\n    def __init__(self, app: QueueTasks, plugins: dict[str, list[BasePlugin]] | None = None):\n        \"\"\"\n        Initializing asynchronous statistics.\n\n        Args:\n            app (QueueTasks): Application instance. z\n            plugins (Optional[Dict[str, List[BasePlugin]]]): Plugins. Default: `None`.\n        \"\"\"\n        super().__init__(app=app, plugins=plugins)\n\n    async def inspect(self):\n        \"\"\"\n        Inspection of asynchronous statistics.\n\n        Returns:\n            InspectStats: Asynchronous statistics schema.\n        \"\"\"\n        await self._plugin_trigger(\n            \"stats_inspect\",\n            stats=self\n        )\n        return InspectStats(self.app)\n</code></pre>"},{"location":"api/stats/async_stats/#qtasks.stats.async_stats.AsyncStats.__init__","title":"<code>__init__(app, plugins=None)</code>","text":"<p>Initializing asynchronous statistics.</p> <p>Parameters:</p> Name Type Description Default <code>app</code> <code>QueueTasks</code> <p>Application instance. z</p> required <code>plugins</code> <code>Optional[Dict[str, List[BasePlugin]]]</code> <p>Plugins. Default: <code>None</code>.</p> <code>None</code> Source code in <code>src/qtasks/stats/async_stats.py</code> <pre><code>def __init__(self, app: QueueTasks, plugins: dict[str, list[BasePlugin]] | None = None):\n    \"\"\"\n    Initializing asynchronous statistics.\n\n    Args:\n        app (QueueTasks): Application instance. z\n        plugins (Optional[Dict[str, List[BasePlugin]]]): Plugins. Default: `None`.\n    \"\"\"\n    super().__init__(app=app, plugins=plugins)\n</code></pre>"},{"location":"api/stats/async_stats/#qtasks.stats.async_stats.AsyncStats.inspect","title":"<code>inspect()</code>  <code>async</code>","text":"<p>Inspection of asynchronous statistics.</p> <p>Returns:</p> Name Type Description <code>InspectStats</code> <p>Asynchronous statistics schema.</p> Source code in <code>src/qtasks/stats/async_stats.py</code> <pre><code>async def inspect(self):\n    \"\"\"\n    Inspection of asynchronous statistics.\n\n    Returns:\n        InspectStats: Asynchronous statistics schema.\n    \"\"\"\n    await self._plugin_trigger(\n        \"stats_inspect\",\n        stats=self\n    )\n    return InspectStats(self.app)\n</code></pre>"},{"location":"api/stats/basestats/","title":"BaseStats - \u041f\u0438\u0448\u0435\u043c \u0441\u0432\u043e\u044e \u0430\u043d\u0430\u043b\u0438\u0442\u0438\u043a\u0443","text":"<p>Base Stats.</p>"},{"location":"api/stats/basestats/#qtasks.stats.base.BaseStats","title":"<code>BaseStats</code>","text":"<p>               Bases: <code>ABC</code></p> <p>Base class for all statistics.</p> Source code in <code>src/qtasks/stats/base.py</code> <pre><code>class BaseStats(ABC): # noqa: B024\n    \"\"\"Base class for all statistics.\"\"\"\n\n    def __init__(\n            self,\n            app: Union[QueueTasks, aioQueueTasks],\n            plugins: dict[str, list[BasePlugin]] | None = None\n        ):\n        \"\"\"Initialize basic statistics.\"\"\"\n        self.app = app\n\n        self.plugins: dict[str, list[BasePlugin]] = plugins or {}\n</code></pre>"},{"location":"api/stats/basestats/#qtasks.stats.base.BaseStats.__init__","title":"<code>__init__(app, plugins=None)</code>","text":"<p>Initialize basic statistics.</p> Source code in <code>src/qtasks/stats/base.py</code> <pre><code>def __init__(\n        self,\n        app: Union[QueueTasks, aioQueueTasks],\n        plugins: dict[str, list[BasePlugin]] | None = None\n    ):\n    \"\"\"Initialize basic statistics.\"\"\"\n    self.app = app\n\n    self.plugins: dict[str, list[BasePlugin]] = plugins or {}\n</code></pre>"},{"location":"api/stats/sync_stats/","title":"SyncStats","text":"<p>Sync Stats.</p>"},{"location":"api/stats/sync_stats/#qtasks.stats.sync_stats.SyncStats","title":"<code>SyncStats</code>","text":"<p>               Bases: <code>BaseStats</code>, <code>SyncPluginMixin</code></p> <p>Class for synchronous statistics.</p> Source code in <code>src/qtasks/stats/sync_stats.py</code> <pre><code>class SyncStats(BaseStats, SyncPluginMixin):\n    \"\"\"Class for synchronous statistics.\"\"\"\n\n    def __init__(self, app: QueueTasks, plugins: dict[str, list[BasePlugin]] | None = None):\n        \"\"\"\n        Initializing asynchronous statistics.\n\n        Args:\n            app (QueueTasks): Application instance.\n            plugins (Optional[Dict[str, List[BasePlugin]]]): Plugins. Default: `None`.\n        \"\"\"\n        super().__init__(app=app, plugins=plugins)\n\n    def inspect(self):\n        \"\"\"\n        Inspection of asynchronous statistics.\n\n        Returns:\n            InspectStats: Synchronous statistics schema.\n        \"\"\"\n        self._plugin_trigger(\n            \"stats_inspect\",\n            stats=self\n        )\n        return InspectStats(self.app)\n</code></pre>"},{"location":"api/stats/sync_stats/#qtasks.stats.sync_stats.SyncStats.__init__","title":"<code>__init__(app, plugins=None)</code>","text":"<p>Initializing asynchronous statistics.</p> <p>Parameters:</p> Name Type Description Default <code>app</code> <code>QueueTasks</code> <p>Application instance.</p> required <code>plugins</code> <code>Optional[Dict[str, List[BasePlugin]]]</code> <p>Plugins. Default: <code>None</code>.</p> <code>None</code> Source code in <code>src/qtasks/stats/sync_stats.py</code> <pre><code>def __init__(self, app: QueueTasks, plugins: dict[str, list[BasePlugin]] | None = None):\n    \"\"\"\n    Initializing asynchronous statistics.\n\n    Args:\n        app (QueueTasks): Application instance.\n        plugins (Optional[Dict[str, List[BasePlugin]]]): Plugins. Default: `None`.\n    \"\"\"\n    super().__init__(app=app, plugins=plugins)\n</code></pre>"},{"location":"api/stats/sync_stats/#qtasks.stats.sync_stats.SyncStats.inspect","title":"<code>inspect()</code>","text":"<p>Inspection of asynchronous statistics.</p> <p>Returns:</p> Name Type Description <code>InspectStats</code> <p>Synchronous statistics schema.</p> Source code in <code>src/qtasks/stats/sync_stats.py</code> <pre><code>def inspect(self):\n    \"\"\"\n    Inspection of asynchronous statistics.\n\n    Returns:\n        InspectStats: Synchronous statistics schema.\n    \"\"\"\n    self._plugin_trigger(\n        \"stats_inspect\",\n        stats=self\n    )\n    return InspectStats(self.app)\n</code></pre>"},{"location":"api/stats/inspect/inspect_stats/","title":"InspectStats","text":"<p>InspectStats.</p>"},{"location":"api/stats/inspect/inspect_stats/#qtasks.stats.inspect.inspect.InspectStats","title":"<code>InspectStats</code>","text":"<p>               Bases: <code>UtilsInspectStats</code></p> <p>Class for inspection of statistics.</p> Source code in <code>src/qtasks/stats/inspect/inspect.py</code> <pre><code>class InspectStats(UtilsInspectStats):\n    \"\"\"Class for inspection of statistics.\"\"\"\n\n    def __init__(self, app: Union[\"QueueTasks\", \"aioQueueTasks\"]):\n        \"\"\"\n        Initializing the statistics inspection.\n\n        Args:\n            app (QueueTasks): Application instance.\n        \"\"\"\n        self._app = app\n\n    def app(self, json: bool = False):\n        \"\"\"\n        Getting information about the application.\n\n        Args:\n            json (bool, optional): Flag to return in JSON format. Default: `False`.\n\n        Returns:\n            str: Application information.\n        \"\"\"\n        return self._app_parser(self._app, json=json)\n\n    def task(self, task_name: str, json: bool = False):\n        \"\"\"\n        Obtaining information about a task.\n\n        Args:\n            task_name (str): The name of the task.\n            json (bool, optional): Flag to return in JSON format. Default: `False`.\n\n        Returns:\n            TaskExecSchema: Schema of the task function.\n        \"\"\"\n        if json:\n            return self._parser_json(self._app.tasks[task_name])\n        return self._tasks_parser((self._app.tasks[task_name],))\n\n    def tasks(self, *tasks: tuple[str], json: bool = False):\n        \"\"\"\n        Obtaining information about tasks.\n\n        Returns:\n            List[TaskExecSchema]: Task function schemas.\n            json (bool, optional): Flag to return in JSON format. Default: `False`.\n        \"\"\"\n        if not tasks:\n            result = self._app.tasks.values()\n        else:\n            result = [\n                self._app.tasks[task] for task in tasks if task in self._app.tasks\n            ]\n\n        if json:\n            return self._parser_json(result)\n\n        return self._tasks_parser(result)\n</code></pre>"},{"location":"api/stats/inspect/inspect_stats/#qtasks.stats.inspect.inspect.InspectStats.__init__","title":"<code>__init__(app)</code>","text":"<p>Initializing the statistics inspection.</p> <p>Parameters:</p> Name Type Description Default <code>app</code> <code>QueueTasks</code> <p>Application instance.</p> required Source code in <code>src/qtasks/stats/inspect/inspect.py</code> <pre><code>def __init__(self, app: Union[\"QueueTasks\", \"aioQueueTasks\"]):\n    \"\"\"\n    Initializing the statistics inspection.\n\n    Args:\n        app (QueueTasks): Application instance.\n    \"\"\"\n    self._app = app\n</code></pre>"},{"location":"api/stats/inspect/inspect_stats/#qtasks.stats.inspect.inspect.InspectStats.app","title":"<code>app(json=False)</code>","text":"<p>Getting information about the application.</p> <p>Parameters:</p> Name Type Description Default <code>json</code> <code>bool</code> <p>Flag to return in JSON format. Default: <code>False</code>.</p> <code>False</code> <p>Returns:</p> Name Type Description <code>str</code> <p>Application information.</p> Source code in <code>src/qtasks/stats/inspect/inspect.py</code> <pre><code>def app(self, json: bool = False):\n    \"\"\"\n    Getting information about the application.\n\n    Args:\n        json (bool, optional): Flag to return in JSON format. Default: `False`.\n\n    Returns:\n        str: Application information.\n    \"\"\"\n    return self._app_parser(self._app, json=json)\n</code></pre>"},{"location":"api/stats/inspect/inspect_stats/#qtasks.stats.inspect.inspect.InspectStats.task","title":"<code>task(task_name, json=False)</code>","text":"<p>Obtaining information about a task.</p> <p>Parameters:</p> Name Type Description Default <code>task_name</code> <code>str</code> <p>The name of the task.</p> required <code>json</code> <code>bool</code> <p>Flag to return in JSON format. Default: <code>False</code>.</p> <code>False</code> <p>Returns:</p> Name Type Description <code>TaskExecSchema</code> <p>Schema of the task function.</p> Source code in <code>src/qtasks/stats/inspect/inspect.py</code> <pre><code>def task(self, task_name: str, json: bool = False):\n    \"\"\"\n    Obtaining information about a task.\n\n    Args:\n        task_name (str): The name of the task.\n        json (bool, optional): Flag to return in JSON format. Default: `False`.\n\n    Returns:\n        TaskExecSchema: Schema of the task function.\n    \"\"\"\n    if json:\n        return self._parser_json(self._app.tasks[task_name])\n    return self._tasks_parser((self._app.tasks[task_name],))\n</code></pre>"},{"location":"api/stats/inspect/inspect_stats/#qtasks.stats.inspect.inspect.InspectStats.tasks","title":"<code>tasks(*tasks, json=False)</code>","text":"<p>Obtaining information about tasks.</p> <p>Returns:</p> Name Type Description <p>List[TaskExecSchema]: Task function schemas.</p> <code>json</code> <code>(bool, optional)</code> <p>Flag to return in JSON format. Default: <code>False</code>.</p> Source code in <code>src/qtasks/stats/inspect/inspect.py</code> <pre><code>def tasks(self, *tasks: tuple[str], json: bool = False):\n    \"\"\"\n    Obtaining information about tasks.\n\n    Returns:\n        List[TaskExecSchema]: Task function schemas.\n        json (bool, optional): Flag to return in JSON format. Default: `False`.\n    \"\"\"\n    if not tasks:\n        result = self._app.tasks.values()\n    else:\n        result = [\n            self._app.tasks[task] for task in tasks if task in self._app.tasks\n        ]\n\n    if json:\n        return self._parser_json(result)\n\n    return self._tasks_parser(result)\n</code></pre>"},{"location":"api/stats/inspect/utils_inspect_stats/","title":"UtilsInspectStats","text":"<p>BaseInspectStats.</p>"},{"location":"api/stats/inspect/utils_inspect_stats/#qtasks.stats.inspect.base.UtilsInspectStats","title":"<code>UtilsInspectStats</code>","text":"<p>Utilities for inspection of statistics.</p> Source code in <code>src/qtasks/stats/inspect/base.py</code> <pre><code>class UtilsInspectStats:\n    \"\"\"Utilities for inspection of statistics.\"\"\"\n\n    label_width = 26\n\n    def _app_parser(\n        self, app: Union[QueueTasks, aioQueueTasks], json: bool = False\n    ):\n        \"\"\"\n        Parser for application information.\n\n        Args:\n            app (QueueTasks): Application instance.\n\n        Returns:\n            str: Application information.\n        \"\"\"\n        lines = []\n        plugins_sum = (\n            len(app.plugins)\n            + len(app.broker.plugins)\n            + len(app.worker.plugins)\n            + (len(app.starter.plugins) if app.starter else 0)\n            + (len(app.broker.storage.plugins) if app.broker.storage else 0)\n            + (\n                len(app.broker.storage.global_config.plugins)\n                if app.broker.storage.global_config\n                else 0\n            )\n        )\n        task_info = {\n            \"Name\": app.name,\n            \"Method\": app._method,\n            \"Version\": app.version,\n            \"Config\": str(app.config),\n            \"Tasks Count\": len(app.tasks),\n            \"Routers Count\": len(app.routers),\n            \"Plugins Count\": plugins_sum,\n            \"Broker\": app.broker.__class__.__name__,\n            \"Worker\": app.worker.__class__.__name__,\n            \"Starter\": app.starter.__class__.__name__ if app.starter else \"\u2014\",\n            \"Storage\": app.broker.storage.__class__.__name__,\n            \"GlobalConfig\": (\n                app.broker.storage.global_config.__class__.__name__\n                if app.broker.storage.global_config\n                else \"\u2014\"\n            ),\n            \"Log\": app.log.__class__.__name__,\n        }\n        if app.events:\n            task_info.update(\n                {\n                    \"Init Count\": sum(\n                        len(inits) for inits in app.events.on._events.values()\n                    ),\n                }\n            )\n\n        if json:\n            return self._parser_json(task_info)\n\n        task_block = \"\\n\".join(\n            f\"{label:&lt;{self.label_width}}: {value}\"\n            for label, value in task_info.items()\n        )\n        lines.append(task_block)\n        lines.append(\"-\" * 50)\n        return \"\\n\".join(lines)\n\n    def _parser_json(self, data: Any | tuple[Any]) -&gt; str:\n        def formatter(d):\n            if is_dataclass(d) and not isinstance(d, type):\n                return asdict(d)\n            return d\n\n        data = (\n            [formatter(d) for d in data]\n            if isinstance(data, (tuple, list, ValuesView))\n            else formatter(data)\n        )\n        return json.dumps(data, ensure_ascii=False, indent=2, default=str)\n\n    def _tasks_parser(\n        self,\n        tasks: tuple[TaskExecSchema] | list[TaskExecSchema] | ValuesView[TaskExecSchema],\n    ) -&gt; str:\n        \"\"\"Formatted output of all registered tasks.\"\"\"\n        lines = []\n\n        for task in tasks:\n            args, kwargs = self._task_get_args_kwargs(task.func)\n\n            task_info = {\n                \"Task nane\": task.name,\n                \"Priority\": task.priority,\n                \"Description\": task.description or \"\u2014\",\n                \"Tags\": \", \".join(task.tags) if task.tags else \"\u2014\",\n                \"Awaiting\": task.awaiting,\n                \"Generating\": task.generating,\n                \"Task Self\": task.echo,\n                \"Args\": \", \".join(args) if args else \"\u2014\",\n                \"Kwargs\": (\n                    \", \".join(f\"{k}={v}\" for k, v in kwargs.items()) if kwargs else \"\u2014\"\n                ),\n            }\n\n            if task.retry is not None:\n                task_info[\"Retry Count\"] = task.retry\n            if task.retry_on_exc:\n                task_info[\"Retry on Exception\"] = pformat(task.retry_on_exc)\n            if task.decode:\n                task_info[\"Decode\"] = str(task.decode)\n            if task.generate_handler:\n                task_info[\"Generator\"] = str(task.generate_handler)\n            if task.executor:\n                task_info[\"Executor\"] = str(task.executor)\n            if task.middlewares_before:\n                task_info[\"Middlewares Before\"] = pformat(task.middlewares_before)\n            if task.middlewares_after:\n                task_info[\"Middlewares After\"] = pformat(task.middlewares_after)\n            if task.extra:\n                extra_lines = \"\\n\" + \"\\n\".join(\n                    f\" * {k}: {v}\" for k, v in task.extra.items()\n                )\n                task_info[\"Extra\"] = extra_lines\n\n            task_block = \"\\n\".join(\n                f\"{label:&lt;{self.label_width}}: {value}\"\n                for label, value in task_info.items()\n            )\n\n            lines.append(task_block)\n            lines.append(\"-\" * 50)\n\n        return \"\\n\".join(lines) or \"No registered tasks.\"\n\n    def _task_get_args_kwargs(self, func):\n        \"\"\"\n        Retrieving positional and key arguments of a task function.\n\n        Args:\n            func (Callable): Task function.\n\n        Returns:\n            tuple: Positional and key arguments.\n        \"\"\"\n        sig = signature(func)\n        positional_args = []\n        keyword_args = {}\n\n        for name, param in sig.parameters.items():\n            annotation = param.annotation if param.annotation is not _empty else None\n\n            type_str = (\n                f\": {annotation.__name__}\"\n                if isinstance(annotation, type)\n                else f\": {annotation}\" if annotation else \"\"\n            )\n\n            if param.kind in (param.POSITIONAL_ONLY, param.POSITIONAL_OR_KEYWORD):\n                if param.default is param.empty:\n                    positional_args.append(f\"{name}{type_str}\")\n                else:\n                    keyword_args[f\"{name}{type_str}\"] = param.default\n            elif param.kind == param.KEYWORD_ONLY:\n                type_str = type_str or \"\"\n                keyword_args[f\"{name}{type_str}\"] = (\n                    param.default if param.default is not param.empty else \"required\"\n                )\n            elif param.kind == param.VAR_POSITIONAL:\n                positional_args.append(f\"*{name}\")\n            elif param.kind == param.VAR_KEYWORD:\n                keyword_args[f\"**{name}\"] = \"...\"\n\n        return positional_args, keyword_args\n</code></pre>"},{"location":"api/storages/async_redisstorage/","title":"AsyncRedisStorage","text":"<p>Async Redis storage.</p>"},{"location":"api/storages/async_redisstorage/#qtasks.storages.async_redis.AsyncRedisStorage","title":"<code>AsyncRedisStorage</code>","text":"<p>               Bases: <code>BaseStorage</code>, <code>AsyncPluginMixin</code></p> <p>A repository that works with Redis, storing information about tasks.</p>"},{"location":"api/storages/async_redisstorage/#qtasks.storages.async_redis.AsyncRedisStorage--example","title":"Example","text":"<pre><code>from qtasks import QueueTasks\nfrom qtasks.brokers import AsyncRedisBroker\nfrom qtasks.storages import AsyncRedisStorage\n\nstorage = AsyncRedisStorage(name=\"QueueTasks\")\nbroker = AsyncRedisBroker(name=\"QueueTasks\", storage=storage)\n\napp = QueueTasks(broker=broker)\n</code></pre> Source code in <code>src/qtasks/storages/async_redis.py</code> <pre><code>class AsyncRedisStorage(BaseStorage, AsyncPluginMixin):\n    \"\"\"\n    A repository that works with Redis, storing information about tasks.\n\n    ## Example\n\n    ```python\n    from qtasks import QueueTasks\n    from qtasks.brokers import AsyncRedisBroker\n    from qtasks.storages import AsyncRedisStorage\n\n    storage = AsyncRedisStorage(name=\"QueueTasks\")\n    broker = AsyncRedisBroker(name=\"QueueTasks\", storage=storage)\n\n    app = QueueTasks(broker=broker)\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Project name. This name is also used by the Repository.\n\n                    Default: `QueueTasks`.\n                    \"\"\"),\n        ] = \"QueueTasks\",\n        url: Annotated[\n            str,\n            Doc(\"\"\"\n                    URL to connect to Redis.\n\n                    Default: `redis://localhost:6379/0`.\n                    \"\"\"),\n        ] = \"redis://localhost:6379/0\",\n        queue_process: Annotated[\n            str,\n            Doc(\"\"\"\n                    The name of the channel for tasks in the process.\n\n                    Default: `task_process`.\n                    \"\"\"),\n        ] = \"task_process\",\n        redis_connect: Annotated[\n            aioredis.Redis | None,\n            Doc(\"\"\"\n                    External connection class to Redis.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        global_config: Annotated[\n            Optional[BaseGlobalConfig],\n            Doc(\"\"\"\n                    Global config.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        log: Annotated[\n            Logger | None,\n            Doc(\"\"\"\n                    Logger.\n\n                    Default: `qtasks.logs.Logger`.\n                    \"\"\"),\n        ] = None,\n        config: Annotated[\n            QueueConfig | None,\n            Doc(\"\"\"\n                    Config.\n\n                    Default: `qtasks.configs.config.QueueConfig`.\n                    \"\"\"),\n        ] = None,\n        events: Annotated[\n            Optional[BaseEvents],\n            Doc(\"\"\"\n                    Events.\n\n                    Default: `qtasks.events.AsyncEvents`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Initializing an asynchronous Redis storage.\n\n        Args:\n            name (str, optional): Project name. Default: \"QueueTasks\".\n            url (str, optional): URL to connect to Redis. Default: \"redis://localhost:6379/0\".\n            queue_process (str, optional): Channel name for tasks in the process. Default: \"task_process\".\n            redis_connect (aioredis.Redis, optional): External Redis connection class. Default: None.\n            global_config (BaseGlobalConfig, optional): Global config. Default: None.\n            log (Logger, optional): Logger. Default: `qtasks.logs.Logger`.\n            config (QueueConfig, optional): Config. Default: `qtasks.configs.config.QueueConfig`.\n            events (BaseEvents, optional): Events. Default: `qtasks.events.AsyncEvents`.\n        \"\"\"\n        self.url = url\n        super().__init__(name, log=log, config=config, events=events)\n        self._queue_process = queue_process\n        self.queue_process = f\"{self.name}:{queue_process}\"\n        self.events = self.events or AsyncEvents()\n\n        self.client = redis_connect or aioredis.from_url(\n            self.url, decode_responses=True, encoding=\"utf-8\"\n        )\n        self.redis_contrib = AsyncRedisCommandQueue(redis=self.client, log=self.log)\n\n        self.global_config: BaseGlobalConfig[Literal[True]] = (\n            global_config\n            or AsyncRedisGlobalConfig(\n                name=self.name,\n                redis_connect=self.client,\n                log=self.log,\n                config=self.config,\n            )\n        )\n\n    async def add(\n        self,\n        uuid: Annotated[\n            UUID | str,\n            Doc(\"\"\"\n                    UUID of the task.\n                    \"\"\"),\n        ],\n        task_status: Annotated[\n            TaskStatusNewSchema,\n            Doc(\"\"\"\n                    New task status diagram.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Adding a task to the repository.\n\n        Args:\n            uuid (UUID | str): UUID of the task.\n            task_status (TaskStatusNewSchema): The new task's status schema.\n        \"\"\"\n        uuid = str(uuid)\n\n        new_data = await self._plugin_trigger(\n            \"storage_add\",\n            storage=self,\n            uuid=uuid,\n            task_status=task_status,\n            return_last=True,\n        )\n        if new_data:\n            uuid = new_data.get(\"uuid\", uuid)\n            task_status = new_data.get(\"task_status\", task_status)\n\n        raw = self.client.hset(f\"{self.name}:{uuid}\", mapping=task_status.__dict__)\n        await cast(Awaitable[int], raw)\n        return\n\n    async def get(self, uuid: UUID | str) -&gt; Union[Task, None]:\n        \"\"\"\n        Obtaining information about a task.\n\n        Args:\n            uuid (UUID|str): UUID of the task.\n\n        Returns:\n            Task|None: If there is task information, returns `schemas.task.Task`, otherwise `None`.\n        \"\"\"\n        loop = asyncio.get_running_loop()\n        asyncio_atexit.register(self.stop, loop=loop)\n\n        key = f\"{self.name}:{uuid}\"\n        raw = self.client.hgetall(key)\n        result = await cast(Awaitable[dict], raw)\n        if not result:\n            return None\n\n        result = self._build_task(uuid=uuid, result=result)\n        new_result = await self._plugin_trigger(\n            \"storage_get\", storage=self, result=result, return_last=True\n        )\n        if new_result:\n            result = new_result.get(\"result\", result)\n        return result\n\n    async def get_all(self) -&gt; list[Task]:\n        \"\"\"\n        Get all tasks.\n\n        Returns:\n            List[Task]: Array of tasks.\n        \"\"\"\n        pattern = f\"{self.name}:*\"\n\n        results: list[Task] = []\n        async for key in self.client.scan_iter(pattern):\n            name, uuid, *_ = key.split(\":\")\n            if uuid in [self._queue_process, \"task_queue\"]:\n                continue\n            if (\n                self.global_config\n                and self.global_config.config_name is not None\n                and f\"{name}:{uuid}\".find(self.global_config.config_name) != -1\n            ):\n                continue\n\n            task = await self.get(uuid=uuid)\n            if not task:\n                continue\n\n            results.append(task)\n\n        new_results = await self._plugin_trigger(\n            \"storage_get_all\", storage=self, results=results, return_last=True\n        )\n        if new_results:\n            results = new_results.get(\"results\", results)\n\n        return results\n\n    async def update(\n        self,\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    Update arguments of type kwargs.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Updates task information.\n\n        Args:\n            kwargs (dict, optional): task data of type kwargs.\n        \"\"\"\n        new_kw = await self._plugin_trigger(\n            \"storage_update\", storage=self, kw=kwargs, return_last=True\n        )\n        if new_kw:\n            kwargs = new_kw.get(\"kw\", kwargs)\n        return await self.redis_contrib.execute(\n            \"hset\", kwargs[\"name\"], mapping=kwargs[\"mapping\"]\n        )\n\n    async def remove_finished_task(\n        self,\n        task_broker: Annotated[\n            TaskPrioritySchema,\n            Doc(\"\"\"\n                    Priority task diagram.\n                    \"\"\"),\n        ],\n        model: Annotated[\n            TaskStatusSuccessSchema | TaskStatusErrorSchema | TaskStatusCancelSchema,\n            Doc(\"\"\"\n                    Model of the task result.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Updates data for a completed task.\n\n        Args:\n            task_broker (TaskPrioritySchema): The priority task schema.\n            model (TaskStatusSuccessSchema | TaskStatusErrorSchema | TaskStatusCancelSchema): Model of the task result.\n        \"\"\"\n        if isinstance(model, TaskStatusSuccessSchema) and not isinstance(\n            model.returning, (bytes, str, int, float)\n        ):\n            trace = \"Invalid input of type: 'NoneType'. Convert to a bytes, string, int or float first.\"\n            model = TaskStatusErrorSchema(\n                task_name=task_broker.name,\n                priority=task_broker.priority,\n                traceback=trace,\n                created_at=task_broker.created_at,\n                updated_at=time.time(),\n            )\n            if self.log:\n                self.log.error(\n                    f\"Task {task_broker.uuid} finished with an error:\\n{trace}\"\n                )\n        await self.redis_contrib.execute(\n            \"hset\", f\"{self.name}:{task_broker.uuid}\", mapping=model.__dict__\n        )\n        await self.redis_contrib.execute(\n            \"zrem\",\n            self.queue_process,\n            f\"{task_broker.name}:{task_broker.uuid}:{task_broker.priority}\",\n        )\n\n        await self._plugin_trigger(\n            \"storage_remove_finished_task\",\n            storage=self,\n            task_broker=task_broker,\n            model=model,\n        )\n        return\n\n    async def start(self):\n        \"\"\"Starts the repository.\"\"\"\n        await self._plugin_trigger(\"storage_start\", storage=self)\n        if self.global_config:\n            await self.global_config.start()\n\n    async def stop(self):\n        \"\"\"Stops storage.\"\"\"\n        await self._plugin_trigger(\"storage_stop\", storage=self)\n        return await self.client.aclose()\n\n    async def add_process(\n        self,\n        task_data: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task data from the broker.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int,\n            Doc(\"\"\"\n                    Task priority.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Adds a task to the list of tasks in a process.\n\n        Args:\n            task_data (str): Task data from the broker.\n            priority (int): Task priority.\n        \"\"\"\n        new_data = await self._plugin_trigger(\n            \"storage_add_process\", storage=self, return_last=True\n        )\n        if new_data:\n            task_data = new_data.get(\"task_data\", task_data)\n            priority = new_data.get(\"priority\", priority)\n        await self.client.zadd(self.queue_process, {task_data: priority})\n        return\n\n    async def _running_older_tasks(self, worker: BaseWorker[Literal[True]]):\n        tasks = await self.client.zrange(self.queue_process, 0, -1)\n        for task_data in tasks:\n            task_name, uuid, priority = task_data.split(\":\")\n            name_ = f\"{self.name}:{uuid}\"\n            raw = self.client.hmget(name_, [\"args\", \"kwargs\", \"created_at\"])\n            args, kwargs, created_at = await cast(Awaitable[list], raw)\n            args, kwargs, created_at = (\n                json.loads(args) or (),\n                json.loads(kwargs) or {},\n                float(created_at),\n            )\n            new_data = await self._plugin_trigger(\n                \"storage_running_older_tasks\",\n                storage=self,\n                worker=worker,\n                return_last=True,\n            )\n            if new_data:\n                task_name = new_data.get(\"task_name\", task_name)\n                uuid = new_data.get(\"uuid\", uuid)\n                priority = new_data.get(\"priority\", priority)\n                created_at = new_data.get(\"created_at\", created_at)\n                args = new_data.get(\"args\", args)\n                kwargs = new_data.get(\"kw\", kwargs)\n            await worker.add(\n                name=task_name,\n                uuid=uuid,\n                priority=int(priority),\n                created_at=created_at,\n                args=args,\n                kwargs=kwargs,\n            )\n        return\n\n    async def _delete_finished_tasks(self):\n        await self._plugin_trigger(\"storage_delete_finished_tasks\", storage=self)\n        pattern = f\"{self.name}:\"\n        try:\n            tasks: list[Task] = list(\n                filter(\n                    lambda task: task.status != TaskStatusEnum.NEW.value,\n                    await self.get_all(),\n                )\n            )\n\n            tasks_hash = [pattern + str(task.uuid) for task in tasks]\n            tasks_queue = [\n                f\"{task.task_name}:{task.uuid}:{task.priority}\" for task in tasks\n            ]\n\n            if tasks_queue:\n                await self.client.zrem(self.queue_process, *tasks_queue)\n            if tasks_hash:\n                await self.client.delete(*tasks_hash)\n        except BaseException:\n            pass\n        return\n\n    async def flush_all(self) -&gt; None:\n        \"\"\"Delete all data.\"\"\"\n        loop = asyncio.get_running_loop()\n        asyncio_atexit.register(self.stop, loop=loop)\n\n        await self._plugin_trigger(\"storage_flush_all\", storage=self)\n\n        pipe = self.client.pipeline()\n\n        pattern = f\"{self.name}:*\"\n        async for key in self.client.scan_iter(pattern):\n            await self.client.delete(key)\n        await pipe.execute()\n        return\n</code></pre>"},{"location":"api/storages/async_redisstorage/#qtasks.storages.async_redis.AsyncRedisStorage.__init__","title":"<code>__init__(name='QueueTasks', url='redis://localhost:6379/0', queue_process='task_process', redis_connect=None, global_config=None, log=None, config=None, events=None)</code>","text":"<p>Initializing an asynchronous Redis storage.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Project name. Default: \"QueueTasks\".</p> <code>'QueueTasks'</code> <code>url</code> <code>str</code> <p>URL to connect to Redis. Default: \"redis://localhost:6379/0\".</p> <code>'redis://localhost:6379/0'</code> <code>queue_process</code> <code>str</code> <p>Channel name for tasks in the process. Default: \"task_process\".</p> <code>'task_process'</code> <code>redis_connect</code> <code>Redis</code> <p>External Redis connection class. Default: None.</p> <code>None</code> <code>global_config</code> <code>BaseGlobalConfig</code> <p>Global config. Default: None.</p> <code>None</code> <code>log</code> <code>Logger</code> <p>Logger. Default: <code>qtasks.logs.Logger</code>.</p> <code>None</code> <code>config</code> <code>QueueConfig</code> <p>Config. Default: <code>qtasks.configs.config.QueueConfig</code>.</p> <code>None</code> <code>events</code> <code>BaseEvents</code> <p>Events. Default: <code>qtasks.events.AsyncEvents</code>.</p> <code>None</code> Source code in <code>src/qtasks/storages/async_redis.py</code> <pre><code>def __init__(\n    self,\n    name: Annotated[\n        str,\n        Doc(\"\"\"\n                Project name. This name is also used by the Repository.\n\n                Default: `QueueTasks`.\n                \"\"\"),\n    ] = \"QueueTasks\",\n    url: Annotated[\n        str,\n        Doc(\"\"\"\n                URL to connect to Redis.\n\n                Default: `redis://localhost:6379/0`.\n                \"\"\"),\n    ] = \"redis://localhost:6379/0\",\n    queue_process: Annotated[\n        str,\n        Doc(\"\"\"\n                The name of the channel for tasks in the process.\n\n                Default: `task_process`.\n                \"\"\"),\n    ] = \"task_process\",\n    redis_connect: Annotated[\n        aioredis.Redis | None,\n        Doc(\"\"\"\n                External connection class to Redis.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    global_config: Annotated[\n        Optional[BaseGlobalConfig],\n        Doc(\"\"\"\n                Global config.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    log: Annotated[\n        Logger | None,\n        Doc(\"\"\"\n                Logger.\n\n                Default: `qtasks.logs.Logger`.\n                \"\"\"),\n    ] = None,\n    config: Annotated[\n        QueueConfig | None,\n        Doc(\"\"\"\n                Config.\n\n                Default: `qtasks.configs.config.QueueConfig`.\n                \"\"\"),\n    ] = None,\n    events: Annotated[\n        Optional[BaseEvents],\n        Doc(\"\"\"\n                Events.\n\n                Default: `qtasks.events.AsyncEvents`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    Initializing an asynchronous Redis storage.\n\n    Args:\n        name (str, optional): Project name. Default: \"QueueTasks\".\n        url (str, optional): URL to connect to Redis. Default: \"redis://localhost:6379/0\".\n        queue_process (str, optional): Channel name for tasks in the process. Default: \"task_process\".\n        redis_connect (aioredis.Redis, optional): External Redis connection class. Default: None.\n        global_config (BaseGlobalConfig, optional): Global config. Default: None.\n        log (Logger, optional): Logger. Default: `qtasks.logs.Logger`.\n        config (QueueConfig, optional): Config. Default: `qtasks.configs.config.QueueConfig`.\n        events (BaseEvents, optional): Events. Default: `qtasks.events.AsyncEvents`.\n    \"\"\"\n    self.url = url\n    super().__init__(name, log=log, config=config, events=events)\n    self._queue_process = queue_process\n    self.queue_process = f\"{self.name}:{queue_process}\"\n    self.events = self.events or AsyncEvents()\n\n    self.client = redis_connect or aioredis.from_url(\n        self.url, decode_responses=True, encoding=\"utf-8\"\n    )\n    self.redis_contrib = AsyncRedisCommandQueue(redis=self.client, log=self.log)\n\n    self.global_config: BaseGlobalConfig[Literal[True]] = (\n        global_config\n        or AsyncRedisGlobalConfig(\n            name=self.name,\n            redis_connect=self.client,\n            log=self.log,\n            config=self.config,\n        )\n    )\n</code></pre>"},{"location":"api/storages/async_redisstorage/#qtasks.storages.async_redis.AsyncRedisStorage.add","title":"<code>add(uuid, task_status)</code>  <code>async</code>","text":"<p>Adding a task to the repository.</p> <p>Parameters:</p> Name Type Description Default <code>uuid</code> <code>UUID | str</code> <p>UUID of the task.</p> required <code>task_status</code> <code>TaskStatusNewSchema</code> <p>The new task's status schema.</p> required Source code in <code>src/qtasks/storages/async_redis.py</code> <pre><code>async def add(\n    self,\n    uuid: Annotated[\n        UUID | str,\n        Doc(\"\"\"\n                UUID of the task.\n                \"\"\"),\n    ],\n    task_status: Annotated[\n        TaskStatusNewSchema,\n        Doc(\"\"\"\n                New task status diagram.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Adding a task to the repository.\n\n    Args:\n        uuid (UUID | str): UUID of the task.\n        task_status (TaskStatusNewSchema): The new task's status schema.\n    \"\"\"\n    uuid = str(uuid)\n\n    new_data = await self._plugin_trigger(\n        \"storage_add\",\n        storage=self,\n        uuid=uuid,\n        task_status=task_status,\n        return_last=True,\n    )\n    if new_data:\n        uuid = new_data.get(\"uuid\", uuid)\n        task_status = new_data.get(\"task_status\", task_status)\n\n    raw = self.client.hset(f\"{self.name}:{uuid}\", mapping=task_status.__dict__)\n    await cast(Awaitable[int], raw)\n    return\n</code></pre>"},{"location":"api/storages/async_redisstorage/#qtasks.storages.async_redis.AsyncRedisStorage.add_process","title":"<code>add_process(task_data, priority)</code>  <code>async</code>","text":"<p>Adds a task to the list of tasks in a process.</p> <p>Parameters:</p> Name Type Description Default <code>task_data</code> <code>str</code> <p>Task data from the broker.</p> required <code>priority</code> <code>int</code> <p>Task priority.</p> required Source code in <code>src/qtasks/storages/async_redis.py</code> <pre><code>async def add_process(\n    self,\n    task_data: Annotated[\n        str,\n        Doc(\"\"\"\n                Task data from the broker.\n                \"\"\"),\n    ],\n    priority: Annotated[\n        int,\n        Doc(\"\"\"\n                Task priority.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Adds a task to the list of tasks in a process.\n\n    Args:\n        task_data (str): Task data from the broker.\n        priority (int): Task priority.\n    \"\"\"\n    new_data = await self._plugin_trigger(\n        \"storage_add_process\", storage=self, return_last=True\n    )\n    if new_data:\n        task_data = new_data.get(\"task_data\", task_data)\n        priority = new_data.get(\"priority\", priority)\n    await self.client.zadd(self.queue_process, {task_data: priority})\n    return\n</code></pre>"},{"location":"api/storages/async_redisstorage/#qtasks.storages.async_redis.AsyncRedisStorage.flush_all","title":"<code>flush_all()</code>  <code>async</code>","text":"<p>Delete all data.</p> Source code in <code>src/qtasks/storages/async_redis.py</code> <pre><code>async def flush_all(self) -&gt; None:\n    \"\"\"Delete all data.\"\"\"\n    loop = asyncio.get_running_loop()\n    asyncio_atexit.register(self.stop, loop=loop)\n\n    await self._plugin_trigger(\"storage_flush_all\", storage=self)\n\n    pipe = self.client.pipeline()\n\n    pattern = f\"{self.name}:*\"\n    async for key in self.client.scan_iter(pattern):\n        await self.client.delete(key)\n    await pipe.execute()\n    return\n</code></pre>"},{"location":"api/storages/async_redisstorage/#qtasks.storages.async_redis.AsyncRedisStorage.get","title":"<code>get(uuid)</code>  <code>async</code>","text":"<p>Obtaining information about a task.</p> <p>Parameters:</p> Name Type Description Default <code>uuid</code> <code>UUID | str</code> <p>UUID of the task.</p> required <p>Returns:</p> Type Description <code>Union[Task, None]</code> <p>Task|None: If there is task information, returns <code>schemas.task.Task</code>, otherwise <code>None</code>.</p> Source code in <code>src/qtasks/storages/async_redis.py</code> <pre><code>async def get(self, uuid: UUID | str) -&gt; Union[Task, None]:\n    \"\"\"\n    Obtaining information about a task.\n\n    Args:\n        uuid (UUID|str): UUID of the task.\n\n    Returns:\n        Task|None: If there is task information, returns `schemas.task.Task`, otherwise `None`.\n    \"\"\"\n    loop = asyncio.get_running_loop()\n    asyncio_atexit.register(self.stop, loop=loop)\n\n    key = f\"{self.name}:{uuid}\"\n    raw = self.client.hgetall(key)\n    result = await cast(Awaitable[dict], raw)\n    if not result:\n        return None\n\n    result = self._build_task(uuid=uuid, result=result)\n    new_result = await self._plugin_trigger(\n        \"storage_get\", storage=self, result=result, return_last=True\n    )\n    if new_result:\n        result = new_result.get(\"result\", result)\n    return result\n</code></pre>"},{"location":"api/storages/async_redisstorage/#qtasks.storages.async_redis.AsyncRedisStorage.get_all","title":"<code>get_all()</code>  <code>async</code>","text":"<p>Get all tasks.</p> <p>Returns:</p> Type Description <code>list[Task]</code> <p>List[Task]: Array of tasks.</p> Source code in <code>src/qtasks/storages/async_redis.py</code> <pre><code>async def get_all(self) -&gt; list[Task]:\n    \"\"\"\n    Get all tasks.\n\n    Returns:\n        List[Task]: Array of tasks.\n    \"\"\"\n    pattern = f\"{self.name}:*\"\n\n    results: list[Task] = []\n    async for key in self.client.scan_iter(pattern):\n        name, uuid, *_ = key.split(\":\")\n        if uuid in [self._queue_process, \"task_queue\"]:\n            continue\n        if (\n            self.global_config\n            and self.global_config.config_name is not None\n            and f\"{name}:{uuid}\".find(self.global_config.config_name) != -1\n        ):\n            continue\n\n        task = await self.get(uuid=uuid)\n        if not task:\n            continue\n\n        results.append(task)\n\n    new_results = await self._plugin_trigger(\n        \"storage_get_all\", storage=self, results=results, return_last=True\n    )\n    if new_results:\n        results = new_results.get(\"results\", results)\n\n    return results\n</code></pre>"},{"location":"api/storages/async_redisstorage/#qtasks.storages.async_redis.AsyncRedisStorage.remove_finished_task","title":"<code>remove_finished_task(task_broker, model)</code>  <code>async</code>","text":"<p>Updates data for a completed task.</p> <p>Parameters:</p> Name Type Description Default <code>task_broker</code> <code>TaskPrioritySchema</code> <p>The priority task schema.</p> required <code>model</code> <code>TaskStatusSuccessSchema | TaskStatusErrorSchema | TaskStatusCancelSchema</code> <p>Model of the task result.</p> required Source code in <code>src/qtasks/storages/async_redis.py</code> <pre><code>async def remove_finished_task(\n    self,\n    task_broker: Annotated[\n        TaskPrioritySchema,\n        Doc(\"\"\"\n                Priority task diagram.\n                \"\"\"),\n    ],\n    model: Annotated[\n        TaskStatusSuccessSchema | TaskStatusErrorSchema | TaskStatusCancelSchema,\n        Doc(\"\"\"\n                Model of the task result.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Updates data for a completed task.\n\n    Args:\n        task_broker (TaskPrioritySchema): The priority task schema.\n        model (TaskStatusSuccessSchema | TaskStatusErrorSchema | TaskStatusCancelSchema): Model of the task result.\n    \"\"\"\n    if isinstance(model, TaskStatusSuccessSchema) and not isinstance(\n        model.returning, (bytes, str, int, float)\n    ):\n        trace = \"Invalid input of type: 'NoneType'. Convert to a bytes, string, int or float first.\"\n        model = TaskStatusErrorSchema(\n            task_name=task_broker.name,\n            priority=task_broker.priority,\n            traceback=trace,\n            created_at=task_broker.created_at,\n            updated_at=time.time(),\n        )\n        if self.log:\n            self.log.error(\n                f\"Task {task_broker.uuid} finished with an error:\\n{trace}\"\n            )\n    await self.redis_contrib.execute(\n        \"hset\", f\"{self.name}:{task_broker.uuid}\", mapping=model.__dict__\n    )\n    await self.redis_contrib.execute(\n        \"zrem\",\n        self.queue_process,\n        f\"{task_broker.name}:{task_broker.uuid}:{task_broker.priority}\",\n    )\n\n    await self._plugin_trigger(\n        \"storage_remove_finished_task\",\n        storage=self,\n        task_broker=task_broker,\n        model=model,\n    )\n    return\n</code></pre>"},{"location":"api/storages/async_redisstorage/#qtasks.storages.async_redis.AsyncRedisStorage.start","title":"<code>start()</code>  <code>async</code>","text":"<p>Starts the repository.</p> Source code in <code>src/qtasks/storages/async_redis.py</code> <pre><code>async def start(self):\n    \"\"\"Starts the repository.\"\"\"\n    await self._plugin_trigger(\"storage_start\", storage=self)\n    if self.global_config:\n        await self.global_config.start()\n</code></pre>"},{"location":"api/storages/async_redisstorage/#qtasks.storages.async_redis.AsyncRedisStorage.stop","title":"<code>stop()</code>  <code>async</code>","text":"<p>Stops storage.</p> Source code in <code>src/qtasks/storages/async_redis.py</code> <pre><code>async def stop(self):\n    \"\"\"Stops storage.\"\"\"\n    await self._plugin_trigger(\"storage_stop\", storage=self)\n    return await self.client.aclose()\n</code></pre>"},{"location":"api/storages/async_redisstorage/#qtasks.storages.async_redis.AsyncRedisStorage.update","title":"<code>update(**kwargs)</code>  <code>async</code>","text":"<p>Updates task information.</p> <p>Parameters:</p> Name Type Description Default <code>kwargs</code> <code>dict</code> <p>task data of type kwargs.</p> <code>{}</code> Source code in <code>src/qtasks/storages/async_redis.py</code> <pre><code>async def update(\n    self,\n    **kwargs: Annotated[\n        Any,\n        Doc(\"\"\"\n                Update arguments of type kwargs.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Updates task information.\n\n    Args:\n        kwargs (dict, optional): task data of type kwargs.\n    \"\"\"\n    new_kw = await self._plugin_trigger(\n        \"storage_update\", storage=self, kw=kwargs, return_last=True\n    )\n    if new_kw:\n        kwargs = new_kw.get(\"kw\", kwargs)\n    return await self.redis_contrib.execute(\n        \"hset\", kwargs[\"name\"], mapping=kwargs[\"mapping\"]\n    )\n</code></pre>"},{"location":"api/storages/basestorage/","title":"BaseStorage - \u041f\u0438\u0448\u0435\u043c \u0441\u0432\u043e\u0435 \u0425\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435","text":"<p>Base storage class.</p>"},{"location":"api/storages/basestorage/#qtasks.storages.base.BaseStorage","title":"<code>BaseStorage</code>","text":"<p>               Bases: <code>Generic[TAsyncFlag]</code>, <code>ABC</code></p> <p><code>BaseStorage</code> - An abstract class that is the foundation for Storage.</p>"},{"location":"api/storages/basestorage/#qtasks.storages.base.BaseStorage--example","title":"Example","text":"<pre><code>from qtasks.storages.base import BaseStorage\n\nclass MyStorage(BaseStorage):\n    def __init__(self, name: str = None):\n        super().__init__(name=name)\n        pass\n</code></pre> Source code in <code>src/qtasks/storages/base.py</code> <pre><code>class BaseStorage(Generic[TAsyncFlag], ABC):\n    \"\"\"\n    `BaseStorage` - An abstract class that is the foundation for Storage.\n\n    ## Example\n\n    ```python\n    from qtasks.storages.base import BaseStorage\n\n    class MyStorage(BaseStorage):\n        def __init__(self, name: str = None):\n            super().__init__(name=name)\n            pass\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Project name. This name can be used for tags for Storage.\n\n                    Default: `QueueTasks`.\n                    \"\"\"),\n        ] = \"QueueTasks\",\n        global_config: Annotated[\n            Optional[BaseGlobalConfig[TAsyncFlag]],\n            Doc(\"\"\"\n                    Global config.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        log: Annotated[\n            Logger | None,\n            Doc(\"\"\"\n                    Logger.\n\n                    Default: `qtasks.logs.Logger`.\n                    \"\"\"),\n        ] = None,\n        config: Annotated[\n            QueueConfig | None,\n            Doc(\"\"\"\n                    Config.\n\n                    Default: `qtasks.configs.config.QueueConfig`.\n                    \"\"\"),\n        ] = None,\n        events: Annotated[\n            Optional[BaseEvents],\n            Doc(\"\"\"\n                    Events.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Initializing the underlying storage.\n\n        Args:\n            name (str, optional): Project name. Default: `QueueTasks`.\n            global_config (BaseGlobalConfig, optional): Global config. Default: `None`.\n            log (Logger, optional): Logger. Default: `qtasks.logs.Logger`.\n            config (QueueConfig, optional): Config. Default: `qtasks.configs.config.QueueConfig`.\n            events (BaseEvents, optional): Events. Default: `None`.\n        \"\"\"\n        self.name = name\n        self.global_config: BaseGlobalConfig[TAsyncFlag] | None = global_config\n\n        self.config = config or QueueConfig()\n        self.log = (\n            log.with_subname(\"Storage\")\n            if log\n            else Logger(\n                name=self.name or \"QueueTasks\",\n                subname=\"Storage\",\n                default_level=self.config.logs_default_level_server,\n                format=self.config.logs_format,\n            )\n        )\n        self.events = events\n\n        self.client = None\n        self.plugins: dict[str, list[BasePlugin]] = {}\n\n        self.init_plugins()\n\n    @overload\n    def add(\n        self: BaseStorage[Literal[False]],\n        uuid: Annotated[\n            UUID | str,\n            Doc(\"\"\"\n                    UUID of the task.\n                    \"\"\"),\n        ],\n        task_status: Annotated[\n            TaskStatusNewSchema,\n            Doc(\"\"\"\n                    New task status diagram.\n                    \"\"\"),\n        ],\n    ) -&gt; None: ...\n\n    @overload\n    async def add(\n        self: BaseStorage[Literal[True]],\n        uuid: Annotated[\n            UUID | str,\n            Doc(\"\"\"\n                    UUID of the task.\n                    \"\"\"),\n        ],\n        task_status: Annotated[\n            TaskStatusNewSchema,\n            Doc(\"\"\"\n                    New task status diagram.\n                    \"\"\"),\n        ],\n    ) -&gt; None: ...\n\n    @abstractmethod\n    def add(\n        self,\n        uuid: Annotated[\n            UUID | str,\n            Doc(\"\"\"\n                    UUID of the task.\n                    \"\"\"),\n        ],\n        task_status: Annotated[\n            TaskStatusNewSchema,\n            Doc(\"\"\"\n                    New task status diagram.\n                    \"\"\"),\n        ],\n    ) -&gt; None | Awaitable[None]:\n        \"\"\"\n        Adding a task to the repository.\n\n        Args:\n            uuid (UUID | str): UUID of the task.\n            task_status (TaskStatusNewSchema): The new task's status schema.\n        \"\"\"\n        pass\n\n    @overload\n    def get(\n        self: BaseStorage[Literal[False]],\n        uuid: Annotated[\n            UUID | str,\n            Doc(\"\"\"\n                    UUID of the task.\n                    \"\"\"),\n        ],\n    ) -&gt; Task | None: ...\n\n    @overload\n    async def get(\n        self: BaseStorage[Literal[True]],\n        uuid: Annotated[\n            UUID | str,\n            Doc(\"\"\"\n                    UUID of the task.\n                    \"\"\"),\n        ],\n    ) -&gt; Task | None: ...\n\n    @abstractmethod\n    def get(\n        self,\n        uuid: Annotated[\n            UUID | str,\n            Doc(\"\"\"\n                    UUID of the task.\n                    \"\"\"),\n        ],\n    ) -&gt; Task | None | Awaitable[Task | None]:\n        \"\"\"\n        Obtaining information about a task.\n\n        Args:\n            uuid (UUID|str): UUID of the task.\n\n        Returns:\n            Task|None: If there is task information, returns `schemas.task.Task`, otherwise `None`.\n        \"\"\"\n        pass\n\n    @overload\n    def get_all(self: BaseStorage[Literal[False]]) -&gt; list[Task]: ...\n\n    @overload\n    async def get_all(self: BaseStorage[Literal[True]]) -&gt; list[Task]: ...\n\n    @abstractmethod\n    def get_all(self) -&gt; list[Task] | Awaitable[list[Task]]:\n        \"\"\"\n        Get all tasks.\n\n        Returns:\n            List[Task]: Array of tasks.\n        \"\"\"\n        pass\n\n    @overload\n    def update(\n        self: BaseStorage[Literal[False]],\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    Update arguments of type kwargs.\n                    \"\"\"),\n        ],\n    ) -&gt; None: ...\n\n    @overload\n    async def update(\n        self: BaseStorage[Literal[True]],\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    Update arguments of type kwargs.\n                    \"\"\"),\n        ],\n    ) -&gt; None: ...\n\n    @abstractmethod\n    def update(\n        self,\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    Update arguments of type kwargs.\n                    \"\"\"),\n        ],\n    ) -&gt; None | Awaitable[None]:\n        \"\"\"\n        Updates task information.\n\n        Args:\n            kwargs (dict, optional): task data of type kwargs.\n        \"\"\"\n        pass\n\n    @overload\n    def start(self: BaseStorage[Literal[False]]) -&gt; None: ...\n\n    @overload\n    async def start(self: BaseStorage[Literal[True]]) -&gt; None: ...\n\n    @abstractmethod\n    def start(self) -&gt; None | Awaitable[None]:\n        \"\"\"Starts the repository. This function is invoked by the main `QueueTasks` instance after the `run_forever` function is run.\"\"\"\n        pass\n\n    @overload\n    def stop(self: BaseStorage[Literal[False]]) -&gt; None: ...\n\n    @overload\n    async def stop(self: BaseStorage[Literal[True]]) -&gt; None: ...\n\n    @abstractmethod\n    def stop(self) -&gt; None | Awaitable[None]:\n        \"\"\"Stops storage. This function is invoked by the main `QueueTasks` instance after the `run_forever` function completes.\"\"\"\n        pass\n\n    @overload\n    def add_process(\n        self: BaseStorage[Literal[False]],\n        task_data: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task data from the broker.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int,\n            Doc(\"\"\"\n                    Task priority.\n                    \"\"\"),\n        ],\n    ) -&gt; None: ...\n\n    @overload\n    async def add_process(\n        self: BaseStorage[Literal[True]],\n        task_data: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task data from the broker.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int,\n            Doc(\"\"\"\n                    Task priority.\n                    \"\"\"),\n        ],\n    ) -&gt; None: ...\n\n    @abstractmethod\n    def add_process(\n        self,\n        task_data: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task data from the broker.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int,\n            Doc(\"\"\"\n                    Task priority.\n                    \"\"\"),\n        ],\n    ) -&gt; None | Awaitable[None]:\n        \"\"\"\n        Adds a task to the list of tasks in a process.\n\n        Args:\n            task_data (str): Task data from the broker.\n            priority (int): Task priority.\n        \"\"\"\n        pass\n\n    def add_plugin(\n        self,\n        plugin: Annotated[\n            BasePlugin,\n            Doc(\"\"\"\n                    Plugin.\n                    \"\"\"),\n        ],\n        trigger_names: Annotated[\n            list[str] | None,\n            Doc(\"\"\"\n                    The name of the triggers for the plugin.\n\n                    Default: Default: will be added to `Globals`.\n                    \"\"\"),\n        ] = None,\n    ) -&gt; None:\n        \"\"\"\n        Add a plugin to the class.\n\n        Args:\n            plugin (BasePlugin): Plugin\n            trigger_names (List[str], optional): The name of the triggers for the plugin. Default: will be added to `Globals`.\n        \"\"\"\n        trigger_names = trigger_names or [\"Globals\"]\n\n        for name in trigger_names:\n            if name not in self.plugins:\n                self.plugins.update({name: [plugin]})\n            else:\n                self.plugins[name].append(plugin)\n        return\n\n    @overload\n    def remove_finished_task(\n        self: BaseStorage[Literal[False]],\n        task_broker: Annotated[\n            TaskPrioritySchema,\n            Doc(\"\"\"\n                    Priority task diagram.\n                    \"\"\"),\n        ],\n        model: Annotated[\n            TaskStatusSuccessSchema | TaskStatusErrorSchema,\n            Doc(\"\"\"\n                    Model of the task result.\n                    \"\"\"),\n        ],\n    ) -&gt; None: ...\n\n    @overload\n    async def remove_finished_task(\n        self: BaseStorage[Literal[True]],\n        task_broker: Annotated[\n            TaskPrioritySchema,\n            Doc(\"\"\"\n                    Priority task diagram.\n                    \"\"\"),\n        ],\n        model: Annotated[\n            TaskStatusSuccessSchema | TaskStatusErrorSchema,\n            Doc(\"\"\"\n                    Model of the task result.\n                    \"\"\"),\n        ],\n    ) -&gt; None: ...\n\n    def remove_finished_task(\n        self,\n        task_broker: Annotated[\n            TaskPrioritySchema,\n            Doc(\"\"\"\n                    Priority task diagram.\n                    \"\"\"),\n        ],\n        model: Annotated[\n            TaskStatusSuccessSchema | TaskStatusErrorSchema,\n            Doc(\"\"\"\n                    Model of the task result.\n                    \"\"\"),\n        ],\n    ) -&gt; None | Awaitable[None]:\n        \"\"\"\n        Updates storage data via the `self.storage.remove_finished_task` function.\n\n        Args:\n            task_broker (TaskPrioritySchema): The priority task schema.\n            model (TaskStatusNewSchema | TaskStatusErrorSchema): Model of the task result.\n        \"\"\"\n        pass\n\n    @overload\n    def _delete_finished_tasks(self: BaseStorage[Literal[False]]) -&gt; None: ...\n\n    @overload\n    async def _delete_finished_tasks(self: BaseStorage[Literal[True]]) -&gt; None: ...\n\n    def _delete_finished_tasks(self) -&gt; None | Awaitable[None]:\n        \"\"\"Deletes all completed tasks.\"\"\"\n        pass\n\n    @overload\n    def _running_older_tasks(\n        self: BaseStorage[Literal[False]], worker: BaseWorker\n    ) -&gt; None: ...\n\n    @overload\n    async def _running_older_tasks(\n        self: BaseStorage[Literal[True]], worker: BaseWorker\n    ) -&gt; None: ...\n\n    def _running_older_tasks(\n        self, worker: BaseWorker\n    ) -&gt; None | Awaitable[None]:\n        \"\"\"\n        Deletes all old tasks.\n\n        Args:\n            worker (BaseWorker): Worker component.\n        \"\"\"\n        pass\n\n    def update_config(\n        self,\n        config: Annotated[\n            QueueConfig,\n            Doc(\"\"\"\n                    Config.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Updates the broker config.\n\n        Args:\n            config (QueueConfig): Config.\n        \"\"\"\n        self.config = config\n        return\n\n    @overload\n    def flush_all(self: BaseStorage[Literal[False]]) -&gt; None: ...\n\n    @overload\n    async def flush_all(self: BaseStorage[Literal[True]]) -&gt; None: ...\n\n    def flush_all(self) -&gt; None | Awaitable[None]:\n        \"\"\"Delete all data.\"\"\"\n        pass\n\n    def _build_task(self, uuid, result: dict) -&gt; Task:\n        base_kwargs = dict(\n            status=result[\"status\"],\n            uuid=uuid,\n            priority=int(result[\"priority\"]),\n            task_name=result[\"task_name\"],\n            args=json.loads(result[\"args\"]),\n            kwargs=json.loads(result[\"kwargs\"]),\n            created_at=datetime.datetime.fromtimestamp(float(result[\"created_at\"])),\n            updated_at=datetime.datetime.fromtimestamp(float(result[\"updated_at\"])),\n        )\n        if \"returning\" in result:\n            base_kwargs[\"returning\"] = json.loads(result[\"returning\"])\n        if \"traceback\" in result:\n            base_kwargs[\"traceback\"] = result[\"traceback\"]\n        if \"retry\" in result:\n            base_kwargs[\"retry\"] = int(result[\"retry\"])\n        if \"retry_parent_uuid\" in result:\n            base_kwargs[\"retry_parent_uuid\"] = result[\"retry_parent_uuid\"]\n        if \"retry_child_uuid\" in result:\n            base_kwargs[\"retry_child_uuid\"] = result[\"retry_child_uuid\"]\n\n        # Get the names of standard fields\n        task_field_names = {f.name for f in fields(Task)}\n\n        # Get extra fields and their types\n        extra_fields = []\n        extra_values = {}\n\n        for key, value in result.items():\n            if key not in task_field_names:\n                field_type = self._infer_type(value)\n                extra_fields.append((key, field_type, field(default=None)))\n\n                if field_type is bool:\n                    extra_values[key] = value.lower() == \"true\"\n                elif field_type is int:\n                    extra_values[key] = int(value)\n                elif field_type is float:\n                    extra_values[key] = float(value)\n                else:\n                    extra_values[key] = value\n\n        if extra_fields:\n            NewTask = make_dataclass(\"Task\", extra_fields, bases=(Task,))\n        else:\n            NewTask = Task\n\n        task = NewTask(**base_kwargs, **extra_values)\n        return task\n\n    def _infer_type(self, value: str):\n        \"\"\"Tries to determine the real type from a string.\"\"\"\n        if value.lower() in {\"true\", \"false\"}:\n            return bool\n        try:\n            int(value)\n            return int\n        except ValueError:\n            pass\n        try:\n            float(value)\n            return float\n        except ValueError:\n            pass\n        return str\n\n    def init_plugins(self):\n        \"\"\"Initializing plugins.\"\"\"\n        pass\n</code></pre>"},{"location":"api/storages/basestorage/#qtasks.storages.base.BaseStorage.__init__","title":"<code>__init__(name='QueueTasks', global_config=None, log=None, config=None, events=None)</code>","text":"<p>Initializing the underlying storage.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Project name. Default: <code>QueueTasks</code>.</p> <code>'QueueTasks'</code> <code>global_config</code> <code>BaseGlobalConfig</code> <p>Global config. Default: <code>None</code>.</p> <code>None</code> <code>log</code> <code>Logger</code> <p>Logger. Default: <code>qtasks.logs.Logger</code>.</p> <code>None</code> <code>config</code> <code>QueueConfig</code> <p>Config. Default: <code>qtasks.configs.config.QueueConfig</code>.</p> <code>None</code> <code>events</code> <code>BaseEvents</code> <p>Events. Default: <code>None</code>.</p> <code>None</code> Source code in <code>src/qtasks/storages/base.py</code> <pre><code>def __init__(\n    self,\n    name: Annotated[\n        str,\n        Doc(\"\"\"\n                Project name. This name can be used for tags for Storage.\n\n                Default: `QueueTasks`.\n                \"\"\"),\n    ] = \"QueueTasks\",\n    global_config: Annotated[\n        Optional[BaseGlobalConfig[TAsyncFlag]],\n        Doc(\"\"\"\n                Global config.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    log: Annotated[\n        Logger | None,\n        Doc(\"\"\"\n                Logger.\n\n                Default: `qtasks.logs.Logger`.\n                \"\"\"),\n    ] = None,\n    config: Annotated[\n        QueueConfig | None,\n        Doc(\"\"\"\n                Config.\n\n                Default: `qtasks.configs.config.QueueConfig`.\n                \"\"\"),\n    ] = None,\n    events: Annotated[\n        Optional[BaseEvents],\n        Doc(\"\"\"\n                Events.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    Initializing the underlying storage.\n\n    Args:\n        name (str, optional): Project name. Default: `QueueTasks`.\n        global_config (BaseGlobalConfig, optional): Global config. Default: `None`.\n        log (Logger, optional): Logger. Default: `qtasks.logs.Logger`.\n        config (QueueConfig, optional): Config. Default: `qtasks.configs.config.QueueConfig`.\n        events (BaseEvents, optional): Events. Default: `None`.\n    \"\"\"\n    self.name = name\n    self.global_config: BaseGlobalConfig[TAsyncFlag] | None = global_config\n\n    self.config = config or QueueConfig()\n    self.log = (\n        log.with_subname(\"Storage\")\n        if log\n        else Logger(\n            name=self.name or \"QueueTasks\",\n            subname=\"Storage\",\n            default_level=self.config.logs_default_level_server,\n            format=self.config.logs_format,\n        )\n    )\n    self.events = events\n\n    self.client = None\n    self.plugins: dict[str, list[BasePlugin]] = {}\n\n    self.init_plugins()\n</code></pre>"},{"location":"api/storages/basestorage/#qtasks.storages.base.BaseStorage.add","title":"<code>add(uuid, task_status)</code>  <code>abstractmethod</code>","text":"<pre><code>add(uuid: Annotated[UUID | str, Doc('\\n                    UUID of the task.\\n                    ')], task_status: Annotated[TaskStatusNewSchema, Doc('\\n                    New task status diagram.\\n                    ')]) -&gt; None\n</code></pre><pre><code>add(uuid: Annotated[UUID | str, Doc('\\n                    UUID of the task.\\n                    ')], task_status: Annotated[TaskStatusNewSchema, Doc('\\n                    New task status diagram.\\n                    ')]) -&gt; None\n</code></pre> <p>Adding a task to the repository.</p> <p>Parameters:</p> Name Type Description Default <code>uuid</code> <code>UUID | str</code> <p>UUID of the task.</p> required <code>task_status</code> <code>TaskStatusNewSchema</code> <p>The new task's status schema.</p> required Source code in <code>src/qtasks/storages/base.py</code> <pre><code>@abstractmethod\ndef add(\n    self,\n    uuid: Annotated[\n        UUID | str,\n        Doc(\"\"\"\n                UUID of the task.\n                \"\"\"),\n    ],\n    task_status: Annotated[\n        TaskStatusNewSchema,\n        Doc(\"\"\"\n                New task status diagram.\n                \"\"\"),\n    ],\n) -&gt; None | Awaitable[None]:\n    \"\"\"\n    Adding a task to the repository.\n\n    Args:\n        uuid (UUID | str): UUID of the task.\n        task_status (TaskStatusNewSchema): The new task's status schema.\n    \"\"\"\n    pass\n</code></pre>"},{"location":"api/storages/basestorage/#qtasks.storages.base.BaseStorage.add_plugin","title":"<code>add_plugin(plugin, trigger_names=None)</code>","text":"<p>Add a plugin to the class.</p> <p>Parameters:</p> Name Type Description Default <code>plugin</code> <code>BasePlugin</code> <p>Plugin</p> required <code>trigger_names</code> <code>List[str]</code> <p>The name of the triggers for the plugin. Default: will be added to <code>Globals</code>.</p> <code>None</code> Source code in <code>src/qtasks/storages/base.py</code> <pre><code>def add_plugin(\n    self,\n    plugin: Annotated[\n        BasePlugin,\n        Doc(\"\"\"\n                Plugin.\n                \"\"\"),\n    ],\n    trigger_names: Annotated[\n        list[str] | None,\n        Doc(\"\"\"\n                The name of the triggers for the plugin.\n\n                Default: Default: will be added to `Globals`.\n                \"\"\"),\n    ] = None,\n) -&gt; None:\n    \"\"\"\n    Add a plugin to the class.\n\n    Args:\n        plugin (BasePlugin): Plugin\n        trigger_names (List[str], optional): The name of the triggers for the plugin. Default: will be added to `Globals`.\n    \"\"\"\n    trigger_names = trigger_names or [\"Globals\"]\n\n    for name in trigger_names:\n        if name not in self.plugins:\n            self.plugins.update({name: [plugin]})\n        else:\n            self.plugins[name].append(plugin)\n    return\n</code></pre>"},{"location":"api/storages/basestorage/#qtasks.storages.base.BaseStorage.add_process","title":"<code>add_process(task_data, priority)</code>  <code>abstractmethod</code>","text":"<pre><code>add_process(task_data: Annotated[str, Doc('\\n                    Task data from the broker.\\n                    ')], priority: Annotated[int, Doc('\\n                    Task priority.\\n                    ')]) -&gt; None\n</code></pre><pre><code>add_process(task_data: Annotated[str, Doc('\\n                    Task data from the broker.\\n                    ')], priority: Annotated[int, Doc('\\n                    Task priority.\\n                    ')]) -&gt; None\n</code></pre> <p>Adds a task to the list of tasks in a process.</p> <p>Parameters:</p> Name Type Description Default <code>task_data</code> <code>str</code> <p>Task data from the broker.</p> required <code>priority</code> <code>int</code> <p>Task priority.</p> required Source code in <code>src/qtasks/storages/base.py</code> <pre><code>@abstractmethod\ndef add_process(\n    self,\n    task_data: Annotated[\n        str,\n        Doc(\"\"\"\n                Task data from the broker.\n                \"\"\"),\n    ],\n    priority: Annotated[\n        int,\n        Doc(\"\"\"\n                Task priority.\n                \"\"\"),\n    ],\n) -&gt; None | Awaitable[None]:\n    \"\"\"\n    Adds a task to the list of tasks in a process.\n\n    Args:\n        task_data (str): Task data from the broker.\n        priority (int): Task priority.\n    \"\"\"\n    pass\n</code></pre>"},{"location":"api/storages/basestorage/#qtasks.storages.base.BaseStorage.flush_all","title":"<code>flush_all()</code>","text":"<pre><code>flush_all() -&gt; None\n</code></pre><pre><code>flush_all() -&gt; None\n</code></pre> <p>Delete all data.</p> Source code in <code>src/qtasks/storages/base.py</code> <pre><code>def flush_all(self) -&gt; None | Awaitable[None]:\n    \"\"\"Delete all data.\"\"\"\n    pass\n</code></pre>"},{"location":"api/storages/basestorage/#qtasks.storages.base.BaseStorage.get","title":"<code>get(uuid)</code>  <code>abstractmethod</code>","text":"<pre><code>get(uuid: Annotated[UUID | str, Doc('\\n                    UUID of the task.\\n                    ')]) -&gt; Task | None\n</code></pre><pre><code>get(uuid: Annotated[UUID | str, Doc('\\n                    UUID of the task.\\n                    ')]) -&gt; Task | None\n</code></pre> <p>Obtaining information about a task.</p> <p>Parameters:</p> Name Type Description Default <code>uuid</code> <code>UUID | str</code> <p>UUID of the task.</p> required <p>Returns:</p> Type Description <code>Task | None | Awaitable[Task | None]</code> <p>Task|None: If there is task information, returns <code>schemas.task.Task</code>, otherwise <code>None</code>.</p> Source code in <code>src/qtasks/storages/base.py</code> <pre><code>@abstractmethod\ndef get(\n    self,\n    uuid: Annotated[\n        UUID | str,\n        Doc(\"\"\"\n                UUID of the task.\n                \"\"\"),\n    ],\n) -&gt; Task | None | Awaitable[Task | None]:\n    \"\"\"\n    Obtaining information about a task.\n\n    Args:\n        uuid (UUID|str): UUID of the task.\n\n    Returns:\n        Task|None: If there is task information, returns `schemas.task.Task`, otherwise `None`.\n    \"\"\"\n    pass\n</code></pre>"},{"location":"api/storages/basestorage/#qtasks.storages.base.BaseStorage.get_all","title":"<code>get_all()</code>  <code>abstractmethod</code>","text":"<pre><code>get_all() -&gt; list[Task]\n</code></pre><pre><code>get_all() -&gt; list[Task]\n</code></pre> <p>Get all tasks.</p> <p>Returns:</p> Type Description <code>list[Task] | Awaitable[list[Task]]</code> <p>List[Task]: Array of tasks.</p> Source code in <code>src/qtasks/storages/base.py</code> <pre><code>@abstractmethod\ndef get_all(self) -&gt; list[Task] | Awaitable[list[Task]]:\n    \"\"\"\n    Get all tasks.\n\n    Returns:\n        List[Task]: Array of tasks.\n    \"\"\"\n    pass\n</code></pre>"},{"location":"api/storages/basestorage/#qtasks.storages.base.BaseStorage.init_plugins","title":"<code>init_plugins()</code>","text":"<p>Initializing plugins.</p> Source code in <code>src/qtasks/storages/base.py</code> <pre><code>def init_plugins(self):\n    \"\"\"Initializing plugins.\"\"\"\n    pass\n</code></pre>"},{"location":"api/storages/basestorage/#qtasks.storages.base.BaseStorage.remove_finished_task","title":"<code>remove_finished_task(task_broker, model)</code>","text":"<pre><code>remove_finished_task(task_broker: Annotated[TaskPrioritySchema, Doc('\\n                    Priority task diagram.\\n                    ')], model: Annotated[TaskStatusSuccessSchema | TaskStatusErrorSchema, Doc('\\n                    Model of the task result.\\n                    ')]) -&gt; None\n</code></pre><pre><code>remove_finished_task(task_broker: Annotated[TaskPrioritySchema, Doc('\\n                    Priority task diagram.\\n                    ')], model: Annotated[TaskStatusSuccessSchema | TaskStatusErrorSchema, Doc('\\n                    Model of the task result.\\n                    ')]) -&gt; None\n</code></pre> <p>Updates storage data via the <code>self.storage.remove_finished_task</code> function.</p> <p>Parameters:</p> Name Type Description Default <code>task_broker</code> <code>TaskPrioritySchema</code> <p>The priority task schema.</p> required <code>model</code> <code>TaskStatusNewSchema | TaskStatusErrorSchema</code> <p>Model of the task result.</p> required Source code in <code>src/qtasks/storages/base.py</code> <pre><code>def remove_finished_task(\n    self,\n    task_broker: Annotated[\n        TaskPrioritySchema,\n        Doc(\"\"\"\n                Priority task diagram.\n                \"\"\"),\n    ],\n    model: Annotated[\n        TaskStatusSuccessSchema | TaskStatusErrorSchema,\n        Doc(\"\"\"\n                Model of the task result.\n                \"\"\"),\n    ],\n) -&gt; None | Awaitable[None]:\n    \"\"\"\n    Updates storage data via the `self.storage.remove_finished_task` function.\n\n    Args:\n        task_broker (TaskPrioritySchema): The priority task schema.\n        model (TaskStatusNewSchema | TaskStatusErrorSchema): Model of the task result.\n    \"\"\"\n    pass\n</code></pre>"},{"location":"api/storages/basestorage/#qtasks.storages.base.BaseStorage.start","title":"<code>start()</code>  <code>abstractmethod</code>","text":"<pre><code>start() -&gt; None\n</code></pre><pre><code>start() -&gt; None\n</code></pre> <p>Starts the repository. This function is invoked by the main <code>QueueTasks</code> instance after the <code>run_forever</code> function is run.</p> Source code in <code>src/qtasks/storages/base.py</code> <pre><code>@abstractmethod\ndef start(self) -&gt; None | Awaitable[None]:\n    \"\"\"Starts the repository. This function is invoked by the main `QueueTasks` instance after the `run_forever` function is run.\"\"\"\n    pass\n</code></pre>"},{"location":"api/storages/basestorage/#qtasks.storages.base.BaseStorage.stop","title":"<code>stop()</code>  <code>abstractmethod</code>","text":"<pre><code>stop() -&gt; None\n</code></pre><pre><code>stop() -&gt; None\n</code></pre> <p>Stops storage. This function is invoked by the main <code>QueueTasks</code> instance after the <code>run_forever</code> function completes.</p> Source code in <code>src/qtasks/storages/base.py</code> <pre><code>@abstractmethod\ndef stop(self) -&gt; None | Awaitable[None]:\n    \"\"\"Stops storage. This function is invoked by the main `QueueTasks` instance after the `run_forever` function completes.\"\"\"\n    pass\n</code></pre>"},{"location":"api/storages/basestorage/#qtasks.storages.base.BaseStorage.update","title":"<code>update(**kwargs)</code>  <code>abstractmethod</code>","text":"<pre><code>update(**kwargs: Annotated[Any, Doc('\\n                    Update arguments of type kwargs.\\n                    ')]) -&gt; None\n</code></pre><pre><code>update(**kwargs: Annotated[Any, Doc('\\n                    Update arguments of type kwargs.\\n                    ')]) -&gt; None\n</code></pre> <p>Updates task information.</p> <p>Parameters:</p> Name Type Description Default <code>kwargs</code> <code>dict</code> <p>task data of type kwargs.</p> <code>{}</code> Source code in <code>src/qtasks/storages/base.py</code> <pre><code>@abstractmethod\ndef update(\n    self,\n    **kwargs: Annotated[\n        Any,\n        Doc(\"\"\"\n                Update arguments of type kwargs.\n                \"\"\"),\n    ],\n) -&gt; None | Awaitable[None]:\n    \"\"\"\n    Updates task information.\n\n    Args:\n        kwargs (dict, optional): task data of type kwargs.\n    \"\"\"\n    pass\n</code></pre>"},{"location":"api/storages/basestorage/#qtasks.storages.base.BaseStorage.update_config","title":"<code>update_config(config)</code>","text":"<p>Updates the broker config.</p> <p>Parameters:</p> Name Type Description Default <code>config</code> <code>QueueConfig</code> <p>Config.</p> required Source code in <code>src/qtasks/storages/base.py</code> <pre><code>def update_config(\n    self,\n    config: Annotated[\n        QueueConfig,\n        Doc(\"\"\"\n                Config.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Updates the broker config.\n\n    Args:\n        config (QueueConfig): Config.\n    \"\"\"\n    self.config = config\n    return\n</code></pre>"},{"location":"api/storages/sync_redisstorage/","title":"SyncRedisStorage","text":"<p>Sync Redis storage.</p>"},{"location":"api/storages/sync_redisstorage/#qtasks.storages.sync_redis.SyncRedisStorage","title":"<code>SyncRedisStorage</code>","text":"<p>               Bases: <code>BaseStorage</code>, <code>SyncPluginMixin</code></p> <p>A repository that works with Redis, storing information about tasks.</p>"},{"location":"api/storages/sync_redisstorage/#qtasks.storages.sync_redis.SyncRedisStorage--example","title":"Example","text":"<pre><code>from qtasks import QueueTasks\nfrom qtasks.brokers import SyncRedisBroker\nfrom qtasks.storages import SyncRedisStorage\n\nstorage = SyncRedisStorage(name=\"QueueTasks\")\nbroker = SyncRedisBroker(name=\"QueueTasks\", storage=storage)\n\napp = QueueTasks(broker=broker)\n</code></pre> Source code in <code>src/qtasks/storages/sync_redis.py</code> <pre><code>class SyncRedisStorage(BaseStorage, SyncPluginMixin):\n    \"\"\"\n    A repository that works with Redis, storing information about tasks.\n\n    ## Example\n\n    ```python\n    from qtasks import QueueTasks\n    from qtasks.brokers import SyncRedisBroker\n    from qtasks.storages import SyncRedisStorage\n\n    storage = SyncRedisStorage(name=\"QueueTasks\")\n    broker = SyncRedisBroker(name=\"QueueTasks\", storage=storage)\n\n    app = QueueTasks(broker=broker)\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Project name. This name is also used by the broker.\n\n                    Default: `QueueTasks`.\n                    \"\"\"),\n        ] = \"QueueTasks\",\n        url: Annotated[\n            str,\n            Doc(\"\"\"\n                    URL to connect to Redis.\n\n                    Default: `redis://localhost:6379/0`.\n                    \"\"\"),\n        ] = \"redis://localhost:6379/0\",\n        queue_process: Annotated[\n            str,\n            Doc(\"\"\"\n                    The name of the channel for tasks in the process.\n\n                    Default: `task_process`.\n                    \"\"\"),\n        ] = \"task_process\",\n        redis_connect: Annotated[\n            redis.Redis | None,\n            Doc(\"\"\"\n                    External connection class to Redis.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        global_config: Annotated[\n            Optional[BaseGlobalConfig],\n            Doc(\"\"\"\n                    Global config.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        log: Annotated[\n            Logger | None,\n            Doc(\"\"\"\n                    Logger.\n\n                    Default: `qtasks.logs.Logger`.\n                    \"\"\"),\n        ] = None,\n        config: Annotated[\n            QueueConfig | None,\n            Doc(\"\"\"\n                    Config.\n\n                    Default: `qtasks.configs.config.QueueConfig`.\n                    \"\"\"),\n        ] = None,\n        events: Annotated[\n            Optional[BaseEvents],\n            Doc(\"\"\"\n                    Events.\n\n                    Default: `qtasks.events.SyncEvents`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Initializing the storage.\n\n        Args:\n            name (str, optional): Project name. Default: \"QueueTasks\".\n            url (str, optional): URL to connect to Redis. Default: \"redis://localhost:6379/0\".\n            queue_process (str, optional): Channel name for tasks in the process. Default: \"task_process\".\n            redis_connect (redis.Redis, optional): External Redis connection class. Default: None.\n            global_config (BaseGlobalConfig, optional): Global config. Default: None.\n            log (Logger, optional): Logger. Default: `qtasks.logs.Logger`.\n            config (QueueConfig, optional): Config. Default: `qtasks.configs.config.QueueConfig`.\n            events (BaseEvents, optional): Events. Default: `qtasks.events.SyncEvents`.\n        \"\"\"\n        self.url = url\n        super().__init__(name=name, log=log, config=config, events=events)\n        self._queue_process = queue_process\n        self.queue_process = f\"{self.name}:{queue_process}\"\n        self.events = self.events or SyncEvents()\n        self.client = redis_connect or redis.Redis.from_url(\n            self.url, decode_responses=True, encoding=\"utf-8\"\n        )\n        self.redis_contrib = SyncRedisCommandQueue(redis=self.client, log=self.log)\n\n        self.global_config: BaseGlobalConfig[Literal[False]] = (\n            global_config\n            or SyncRedisGlobalConfig(\n                name=self.name,\n                redis_connect=self.client,\n                log=self.log,\n                config=self.config,\n            )\n        )\n\n    def add(\n        self,\n        uuid: Annotated[\n            UUID | str,\n            Doc(\"\"\"\n                    UUID of the task.\n                    \"\"\"),\n        ],\n        task_status: Annotated[\n            TaskStatusNewSchema,\n            Doc(\"\"\"\n                    New task status diagram.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Adding a task to the repository.\n\n        Args:\n            uuid (UUID | str): UUID of the task.\n            task_status (TaskStatusNewSchema): The new task's status schema.\n        \"\"\"\n        uuid = str(uuid)\n\n        new_data = self._plugin_trigger(\n            \"storage_add\",\n            storage=self,\n            uuid=uuid,\n            task_status=task_status,\n            return_last=True,\n        )\n        if new_data:\n            uuid = new_data.get(\"uuid\", uuid)\n            task_status = new_data.get(\"task_status\", task_status)\n\n        self.client.hset(f\"{self.name}:{uuid}\", mapping=task_status.__dict__)\n        return\n\n    def get(self, uuid: UUID | str) -&gt; Union[Task, None]:\n        \"\"\"\n        Obtaining information about a task.\n\n        Args:\n            uuid (UUID|str): UUID of the task.\n\n        Returns:\n            Task|None: If there is task information, returns `schemas.task.Task`, otherwise `None`.\n        \"\"\"\n        key = f\"{self.name}:{uuid}\"\n        result = cast(dict, self.client.hgetall(key))\n        if not result:\n            return None\n\n        result = self._build_task(uuid=str(uuid), result=result)\n        new_result = self._plugin_trigger(\n            \"storage_get\", storage=self, result=result, return_last=True\n        )\n        if new_result:\n            result = new_result.get(\"result\", result)\n        return result\n\n    def get_all(self) -&gt; list[Task]:\n        \"\"\"\n        Get all tasks.\n\n        Returns:\n            List[Task]: Array of tasks.\n        \"\"\"\n        pattern = f\"{self.name}:*\"\n\n        results: list[Task] = []\n        for key in self.client.scan_iter(pattern):\n            name, uuid, *_ = key.split(\":\")\n            if uuid in [self._queue_process, \"task_queue\"]:\n                continue\n            if (\n                self.global_config\n                and self.global_config.config_name is not None\n                and f\"{name}:{uuid}\".find(self.global_config.config_name) != -1\n            ):\n                continue\n\n            task = self.get(uuid=uuid)\n            if not task:\n                continue\n\n            results.append(task)\n\n        new_results = self._plugin_trigger(\n            \"storage_get_all\", storage=self, results=results, return_last=True\n        )\n        if new_results:\n            results = new_results.get(\"results\", results)\n\n        return results\n\n    def update(\n        self,\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    Update arguments of type kwargs.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Updates task information.\n\n        Args:\n            kwargs (dict, optional): task data of type kwargs.\n        \"\"\"\n        new_kw = self._plugin_trigger(\n            \"storage_update\", storage=self, kw=kwargs, return_last=True\n        )\n        if new_kw:\n            kwargs = new_kw.get(\"kw\", kwargs)\n\n        return self.redis_contrib.execute(\n            \"hset\", kwargs[\"name\"], mapping=kwargs[\"mapping\"]\n        )\n\n    def remove_finished_task(\n        self,\n        task_broker: Annotated[\n            TaskPrioritySchema,\n            Doc(\"\"\"\n                    Priority task diagram.\n                    \"\"\"),\n        ],\n        model: Annotated[\n            TaskStatusSuccessSchema | TaskStatusErrorSchema,\n            Doc(\"\"\"\n                    Model of the task result.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Updates data for a completed task.\n\n        Args:\n            task_broker (TaskPrioritySchema): The priority task schema.\n            model (TaskStatusSuccessSchema | TaskStatusErrorSchema): Model of the task result.\n        \"\"\"\n        if isinstance(model, TaskStatusSuccessSchema) and not isinstance(\n            model.returning, (bytes, str, int, float)\n        ):\n            trace = \"Invalid input of type: 'NoneType'. Convert to a bytes, string, int or float first.\"\n            model = TaskStatusErrorSchema(\n                task_name=task_broker.name,\n                priority=task_broker.priority,\n                traceback=trace,\n                created_at=task_broker.created_at,\n                updated_at=time.time(),\n            )\n            if self.log:\n                self.log.error(\n                    f\"Task {task_broker.uuid} finished with an error:\\n{trace}\"\n                )\n\n        self.redis_contrib.execute(\n            \"hset\", f\"{self.name}:{task_broker.uuid}\", mapping=model.__dict__\n        )\n        self.redis_contrib.execute(\n            \"zrem\",\n            self.queue_process,\n            f\"{task_broker.name}:{task_broker.uuid}:{task_broker.priority}\",\n        )\n\n        self._plugin_trigger(\n            \"storage_remove_finished_task\",\n            storage=self,\n            task_broker=task_broker,\n            model=model,\n        )\n        return\n\n    def start(self):\n        \"\"\"Starts the repository.\"\"\"\n        self._plugin_trigger(\"storage_start\", storage=self)\n        if self.global_config:\n            self.global_config.start()\n\n    def stop(self) -&gt; None:\n        \"\"\"Stops storage.\"\"\"\n        self._plugin_trigger(\"storage_stop\", storage=self)\n        self.client.close()\n\n    def add_process(\n        self,\n        task_data: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task data from the broker.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int,\n            Doc(\"\"\"\n                    Task priority.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Adds a task to the list of tasks in a process.\n\n        Args:\n            task_data (str): Task data from the broker.\n            priority (int): Task priority.\n        \"\"\"\n        new_data = self._plugin_trigger(\n            \"storage_add_process\", storage=self, return_last=True\n        )\n        if new_data:\n            task_data = new_data.get(\"task_data\", task_data)\n            priority = new_data.get(\"priority\", priority)\n\n        self.client.zadd(self.queue_process, {task_data: priority})\n        return\n\n    def _running_older_tasks(self, worker: BaseWorker[Literal[False]]) -&gt; None:\n        tasks = cast(Any, self.client.zrange(self.queue_process, 0, -1))\n        for task_data in tasks:\n            task_name, uuid, priority = task_data.split(\":\")\n            name_ = f\"{self.name}:{uuid}\"\n            raw = self.client.hmget(name_, [\"args\", \"kwargs\", \"created_at\"])\n            args, kwargs, created_at = cast(list, raw)\n            args, kwargs, created_at = (\n                json.loads(args) or (),\n                json.loads(kwargs) or {},\n                float(created_at),\n            )\n            new_data = self._plugin_trigger(\n                \"storage_running_older_tasks\",\n                storage=self,\n                worker=worker,\n                return_last=True,\n            )\n            if new_data:\n                task_name = new_data.get(\"task_name\", task_name)\n                uuid = new_data.get(\"uuid\", uuid)\n                priority = new_data.get(\"priority\", priority)\n                created_at = new_data.get(\"created_at\", created_at)\n                args = new_data.get(\"args\", args)\n                kwargs = new_data.get(\"kw\", kwargs)\n\n            worker.add(\n                name=task_name,\n                uuid=uuid,\n                priority=int(priority),\n                created_at=created_at,\n                args=args,\n                kwargs=kwargs,\n            )\n\n    def _delete_finished_tasks(self):\n        self._plugin_trigger(\"storage_delete_finished_tasks\", storage=self)\n        pattern = f\"{self.name}:\"\n        try:\n            tasks: list[Task] = list(\n                filter(\n                    lambda task: task.status != TaskStatusEnum.NEW.value, self.get_all()\n                )\n            )\n\n            tasks_hash = [pattern + str(task.uuid) for task in tasks]\n            tasks_queue = [\n                f\"{task.task_name}:{task.uuid}:{task.priority}\" for task in tasks\n            ]\n\n            if tasks_queue:\n                self.client.zrem(self.queue_process, *tasks_queue)\n            if tasks_hash:\n                self.client.delete(*tasks_hash)\n        except BaseException:\n            pass\n        return\n\n    def flush_all(self) -&gt; None:\n        \"\"\"Delete all data.\"\"\"\n        self._plugin_trigger(\"storage_flush_all\", storage=self)\n\n        pipe = self.client.pipeline()\n\n        pattern = f\"{self.name}:*\"\n        for key in self.client.scan_iter(pattern):\n            self.client.delete(key)\n        pipe.execute()\n        return\n</code></pre>"},{"location":"api/storages/sync_redisstorage/#qtasks.storages.sync_redis.SyncRedisStorage.__init__","title":"<code>__init__(name='QueueTasks', url='redis://localhost:6379/0', queue_process='task_process', redis_connect=None, global_config=None, log=None, config=None, events=None)</code>","text":"<p>Initializing the storage.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Project name. Default: \"QueueTasks\".</p> <code>'QueueTasks'</code> <code>url</code> <code>str</code> <p>URL to connect to Redis. Default: \"redis://localhost:6379/0\".</p> <code>'redis://localhost:6379/0'</code> <code>queue_process</code> <code>str</code> <p>Channel name for tasks in the process. Default: \"task_process\".</p> <code>'task_process'</code> <code>redis_connect</code> <code>Redis</code> <p>External Redis connection class. Default: None.</p> <code>None</code> <code>global_config</code> <code>BaseGlobalConfig</code> <p>Global config. Default: None.</p> <code>None</code> <code>log</code> <code>Logger</code> <p>Logger. Default: <code>qtasks.logs.Logger</code>.</p> <code>None</code> <code>config</code> <code>QueueConfig</code> <p>Config. Default: <code>qtasks.configs.config.QueueConfig</code>.</p> <code>None</code> <code>events</code> <code>BaseEvents</code> <p>Events. Default: <code>qtasks.events.SyncEvents</code>.</p> <code>None</code> Source code in <code>src/qtasks/storages/sync_redis.py</code> <pre><code>def __init__(\n    self,\n    name: Annotated[\n        str,\n        Doc(\"\"\"\n                Project name. This name is also used by the broker.\n\n                Default: `QueueTasks`.\n                \"\"\"),\n    ] = \"QueueTasks\",\n    url: Annotated[\n        str,\n        Doc(\"\"\"\n                URL to connect to Redis.\n\n                Default: `redis://localhost:6379/0`.\n                \"\"\"),\n    ] = \"redis://localhost:6379/0\",\n    queue_process: Annotated[\n        str,\n        Doc(\"\"\"\n                The name of the channel for tasks in the process.\n\n                Default: `task_process`.\n                \"\"\"),\n    ] = \"task_process\",\n    redis_connect: Annotated[\n        redis.Redis | None,\n        Doc(\"\"\"\n                External connection class to Redis.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    global_config: Annotated[\n        Optional[BaseGlobalConfig],\n        Doc(\"\"\"\n                Global config.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    log: Annotated[\n        Logger | None,\n        Doc(\"\"\"\n                Logger.\n\n                Default: `qtasks.logs.Logger`.\n                \"\"\"),\n    ] = None,\n    config: Annotated[\n        QueueConfig | None,\n        Doc(\"\"\"\n                Config.\n\n                Default: `qtasks.configs.config.QueueConfig`.\n                \"\"\"),\n    ] = None,\n    events: Annotated[\n        Optional[BaseEvents],\n        Doc(\"\"\"\n                Events.\n\n                Default: `qtasks.events.SyncEvents`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    Initializing the storage.\n\n    Args:\n        name (str, optional): Project name. Default: \"QueueTasks\".\n        url (str, optional): URL to connect to Redis. Default: \"redis://localhost:6379/0\".\n        queue_process (str, optional): Channel name for tasks in the process. Default: \"task_process\".\n        redis_connect (redis.Redis, optional): External Redis connection class. Default: None.\n        global_config (BaseGlobalConfig, optional): Global config. Default: None.\n        log (Logger, optional): Logger. Default: `qtasks.logs.Logger`.\n        config (QueueConfig, optional): Config. Default: `qtasks.configs.config.QueueConfig`.\n        events (BaseEvents, optional): Events. Default: `qtasks.events.SyncEvents`.\n    \"\"\"\n    self.url = url\n    super().__init__(name=name, log=log, config=config, events=events)\n    self._queue_process = queue_process\n    self.queue_process = f\"{self.name}:{queue_process}\"\n    self.events = self.events or SyncEvents()\n    self.client = redis_connect or redis.Redis.from_url(\n        self.url, decode_responses=True, encoding=\"utf-8\"\n    )\n    self.redis_contrib = SyncRedisCommandQueue(redis=self.client, log=self.log)\n\n    self.global_config: BaseGlobalConfig[Literal[False]] = (\n        global_config\n        or SyncRedisGlobalConfig(\n            name=self.name,\n            redis_connect=self.client,\n            log=self.log,\n            config=self.config,\n        )\n    )\n</code></pre>"},{"location":"api/storages/sync_redisstorage/#qtasks.storages.sync_redis.SyncRedisStorage.add","title":"<code>add(uuid, task_status)</code>","text":"<p>Adding a task to the repository.</p> <p>Parameters:</p> Name Type Description Default <code>uuid</code> <code>UUID | str</code> <p>UUID of the task.</p> required <code>task_status</code> <code>TaskStatusNewSchema</code> <p>The new task's status schema.</p> required Source code in <code>src/qtasks/storages/sync_redis.py</code> <pre><code>def add(\n    self,\n    uuid: Annotated[\n        UUID | str,\n        Doc(\"\"\"\n                UUID of the task.\n                \"\"\"),\n    ],\n    task_status: Annotated[\n        TaskStatusNewSchema,\n        Doc(\"\"\"\n                New task status diagram.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Adding a task to the repository.\n\n    Args:\n        uuid (UUID | str): UUID of the task.\n        task_status (TaskStatusNewSchema): The new task's status schema.\n    \"\"\"\n    uuid = str(uuid)\n\n    new_data = self._plugin_trigger(\n        \"storage_add\",\n        storage=self,\n        uuid=uuid,\n        task_status=task_status,\n        return_last=True,\n    )\n    if new_data:\n        uuid = new_data.get(\"uuid\", uuid)\n        task_status = new_data.get(\"task_status\", task_status)\n\n    self.client.hset(f\"{self.name}:{uuid}\", mapping=task_status.__dict__)\n    return\n</code></pre>"},{"location":"api/storages/sync_redisstorage/#qtasks.storages.sync_redis.SyncRedisStorage.add_process","title":"<code>add_process(task_data, priority)</code>","text":"<p>Adds a task to the list of tasks in a process.</p> <p>Parameters:</p> Name Type Description Default <code>task_data</code> <code>str</code> <p>Task data from the broker.</p> required <code>priority</code> <code>int</code> <p>Task priority.</p> required Source code in <code>src/qtasks/storages/sync_redis.py</code> <pre><code>def add_process(\n    self,\n    task_data: Annotated[\n        str,\n        Doc(\"\"\"\n                Task data from the broker.\n                \"\"\"),\n    ],\n    priority: Annotated[\n        int,\n        Doc(\"\"\"\n                Task priority.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Adds a task to the list of tasks in a process.\n\n    Args:\n        task_data (str): Task data from the broker.\n        priority (int): Task priority.\n    \"\"\"\n    new_data = self._plugin_trigger(\n        \"storage_add_process\", storage=self, return_last=True\n    )\n    if new_data:\n        task_data = new_data.get(\"task_data\", task_data)\n        priority = new_data.get(\"priority\", priority)\n\n    self.client.zadd(self.queue_process, {task_data: priority})\n    return\n</code></pre>"},{"location":"api/storages/sync_redisstorage/#qtasks.storages.sync_redis.SyncRedisStorage.flush_all","title":"<code>flush_all()</code>","text":"<p>Delete all data.</p> Source code in <code>src/qtasks/storages/sync_redis.py</code> <pre><code>def flush_all(self) -&gt; None:\n    \"\"\"Delete all data.\"\"\"\n    self._plugin_trigger(\"storage_flush_all\", storage=self)\n\n    pipe = self.client.pipeline()\n\n    pattern = f\"{self.name}:*\"\n    for key in self.client.scan_iter(pattern):\n        self.client.delete(key)\n    pipe.execute()\n    return\n</code></pre>"},{"location":"api/storages/sync_redisstorage/#qtasks.storages.sync_redis.SyncRedisStorage.get","title":"<code>get(uuid)</code>","text":"<p>Obtaining information about a task.</p> <p>Parameters:</p> Name Type Description Default <code>uuid</code> <code>UUID | str</code> <p>UUID of the task.</p> required <p>Returns:</p> Type Description <code>Union[Task, None]</code> <p>Task|None: If there is task information, returns <code>schemas.task.Task</code>, otherwise <code>None</code>.</p> Source code in <code>src/qtasks/storages/sync_redis.py</code> <pre><code>def get(self, uuid: UUID | str) -&gt; Union[Task, None]:\n    \"\"\"\n    Obtaining information about a task.\n\n    Args:\n        uuid (UUID|str): UUID of the task.\n\n    Returns:\n        Task|None: If there is task information, returns `schemas.task.Task`, otherwise `None`.\n    \"\"\"\n    key = f\"{self.name}:{uuid}\"\n    result = cast(dict, self.client.hgetall(key))\n    if not result:\n        return None\n\n    result = self._build_task(uuid=str(uuid), result=result)\n    new_result = self._plugin_trigger(\n        \"storage_get\", storage=self, result=result, return_last=True\n    )\n    if new_result:\n        result = new_result.get(\"result\", result)\n    return result\n</code></pre>"},{"location":"api/storages/sync_redisstorage/#qtasks.storages.sync_redis.SyncRedisStorage.get_all","title":"<code>get_all()</code>","text":"<p>Get all tasks.</p> <p>Returns:</p> Type Description <code>list[Task]</code> <p>List[Task]: Array of tasks.</p> Source code in <code>src/qtasks/storages/sync_redis.py</code> <pre><code>def get_all(self) -&gt; list[Task]:\n    \"\"\"\n    Get all tasks.\n\n    Returns:\n        List[Task]: Array of tasks.\n    \"\"\"\n    pattern = f\"{self.name}:*\"\n\n    results: list[Task] = []\n    for key in self.client.scan_iter(pattern):\n        name, uuid, *_ = key.split(\":\")\n        if uuid in [self._queue_process, \"task_queue\"]:\n            continue\n        if (\n            self.global_config\n            and self.global_config.config_name is not None\n            and f\"{name}:{uuid}\".find(self.global_config.config_name) != -1\n        ):\n            continue\n\n        task = self.get(uuid=uuid)\n        if not task:\n            continue\n\n        results.append(task)\n\n    new_results = self._plugin_trigger(\n        \"storage_get_all\", storage=self, results=results, return_last=True\n    )\n    if new_results:\n        results = new_results.get(\"results\", results)\n\n    return results\n</code></pre>"},{"location":"api/storages/sync_redisstorage/#qtasks.storages.sync_redis.SyncRedisStorage.remove_finished_task","title":"<code>remove_finished_task(task_broker, model)</code>","text":"<p>Updates data for a completed task.</p> <p>Parameters:</p> Name Type Description Default <code>task_broker</code> <code>TaskPrioritySchema</code> <p>The priority task schema.</p> required <code>model</code> <code>TaskStatusSuccessSchema | TaskStatusErrorSchema</code> <p>Model of the task result.</p> required Source code in <code>src/qtasks/storages/sync_redis.py</code> <pre><code>def remove_finished_task(\n    self,\n    task_broker: Annotated[\n        TaskPrioritySchema,\n        Doc(\"\"\"\n                Priority task diagram.\n                \"\"\"),\n    ],\n    model: Annotated[\n        TaskStatusSuccessSchema | TaskStatusErrorSchema,\n        Doc(\"\"\"\n                Model of the task result.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Updates data for a completed task.\n\n    Args:\n        task_broker (TaskPrioritySchema): The priority task schema.\n        model (TaskStatusSuccessSchema | TaskStatusErrorSchema): Model of the task result.\n    \"\"\"\n    if isinstance(model, TaskStatusSuccessSchema) and not isinstance(\n        model.returning, (bytes, str, int, float)\n    ):\n        trace = \"Invalid input of type: 'NoneType'. Convert to a bytes, string, int or float first.\"\n        model = TaskStatusErrorSchema(\n            task_name=task_broker.name,\n            priority=task_broker.priority,\n            traceback=trace,\n            created_at=task_broker.created_at,\n            updated_at=time.time(),\n        )\n        if self.log:\n            self.log.error(\n                f\"Task {task_broker.uuid} finished with an error:\\n{trace}\"\n            )\n\n    self.redis_contrib.execute(\n        \"hset\", f\"{self.name}:{task_broker.uuid}\", mapping=model.__dict__\n    )\n    self.redis_contrib.execute(\n        \"zrem\",\n        self.queue_process,\n        f\"{task_broker.name}:{task_broker.uuid}:{task_broker.priority}\",\n    )\n\n    self._plugin_trigger(\n        \"storage_remove_finished_task\",\n        storage=self,\n        task_broker=task_broker,\n        model=model,\n    )\n    return\n</code></pre>"},{"location":"api/storages/sync_redisstorage/#qtasks.storages.sync_redis.SyncRedisStorage.start","title":"<code>start()</code>","text":"<p>Starts the repository.</p> Source code in <code>src/qtasks/storages/sync_redis.py</code> <pre><code>def start(self):\n    \"\"\"Starts the repository.\"\"\"\n    self._plugin_trigger(\"storage_start\", storage=self)\n    if self.global_config:\n        self.global_config.start()\n</code></pre>"},{"location":"api/storages/sync_redisstorage/#qtasks.storages.sync_redis.SyncRedisStorage.stop","title":"<code>stop()</code>","text":"<p>Stops storage.</p> Source code in <code>src/qtasks/storages/sync_redis.py</code> <pre><code>def stop(self) -&gt; None:\n    \"\"\"Stops storage.\"\"\"\n    self._plugin_trigger(\"storage_stop\", storage=self)\n    self.client.close()\n</code></pre>"},{"location":"api/storages/sync_redisstorage/#qtasks.storages.sync_redis.SyncRedisStorage.update","title":"<code>update(**kwargs)</code>","text":"<p>Updates task information.</p> <p>Parameters:</p> Name Type Description Default <code>kwargs</code> <code>dict</code> <p>task data of type kwargs.</p> <code>{}</code> Source code in <code>src/qtasks/storages/sync_redis.py</code> <pre><code>def update(\n    self,\n    **kwargs: Annotated[\n        Any,\n        Doc(\"\"\"\n                Update arguments of type kwargs.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Updates task information.\n\n    Args:\n        kwargs (dict, optional): task data of type kwargs.\n    \"\"\"\n    new_kw = self._plugin_trigger(\n        \"storage_update\", storage=self, kw=kwargs, return_last=True\n    )\n    if new_kw:\n        kwargs = new_kw.get(\"kw\", kwargs)\n\n    return self.redis_contrib.execute(\n        \"hset\", kwargs[\"name\"], mapping=kwargs[\"mapping\"]\n    )\n</code></pre>"},{"location":"api/tests/async_testcase/","title":"AsyncTestCase","text":"<p>Async test classes.</p>"},{"location":"api/tests/async_testcase/#qtasks.tests.async_testcase.AsyncTestCase","title":"<code>AsyncTestCase</code>","text":"<p>               Bases: <code>BaseTestCase[Literal[True]]</code></p> <p>Asynchronous testing case.</p>"},{"location":"api/tests/async_testcase/#qtasks.tests.async_testcase.AsyncTestCase--example","title":"Example","text":"<pre><code>from qtasks import QueueTasks\nfrom qtasks.tests import AsyncTestCase\n\napp = QueueTasks()\n\ntest_case = AsyncTestCase(app=app)\n</code></pre> Source code in <code>src/qtasks/tests/async_testcase.py</code> <pre><code>class AsyncTestCase(BaseTestCase[Literal[True]]):\n    \"\"\"\n    Asynchronous testing case.\n\n    ## Example\n\n    ```python\n    from qtasks import QueueTasks\n    from qtasks.tests import AsyncTestCase\n\n    app = QueueTasks()\n\n    test_case = AsyncTestCase(app=app)\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        app: Annotated[\n            \"QueueTasks\",\n            Doc(\"\"\"\n                    Main copy.\n                    \"\"\"),\n        ],\n        name: Annotated[\n            str | None,\n            Doc(\"\"\"\n                    Project name. This name can be used for test components.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Asynchronous test case.\n\n        Args:\n            app(QueueTasks, Doc): Main instance.\n            name (str, optional): Project name. This name can be used for test components. Default: `None`.\n        \"\"\"\n        super().__init__(app=app, name=name)\n        self.app: QueueTasks\n\n        self._global_loop: asyncio.AbstractEventLoop | None = None\n\n    def start_in_background(\n        self,\n        starter: Annotated[\n            Optional[\"BaseStarter\"],\n            Doc(\"\"\"\n                    Starter. Stores methods for launching components.\n\n                    Default: `qtasks.starters.AsyncStarter`.\n                    \"\"\"),\n        ] = None,\n        num_workers: Annotated[\n            int,\n            Doc(\"\"\"\n                    Number of running workers.\n\n                    Default: `4`.\n                    \"\"\"),\n        ] = 4,\n        reset_config: Annotated[\n            bool,\n            Doc(\"\"\"\n                    Update the config of the worker and broker.\n\n                    Default: `True`.\n                    \"\"\"),\n        ] = True,\n    ):  # TODO: fix!\n        \"\"\"\n        Run `app.run_forever()` in the background.\n\n        Args:\n            starter (BaseStarter, optional): Starter. Default: `qtasks.starters.AsyncStarter`.\n            num_workers (int, optional): Number of workers running. Default: 4.\n            reset_config (bool, optional): Update the config of the worker and broker. Default: True.\n        \"\"\"\n\n        def run_loop():\n            loop = asyncio.new_event_loop()\n            asyncio.set_event_loop(loop)\n            try:\n                loop.run_until_complete(self.start(loop=loop, num_workers=num_workers))\n            finally:\n                loop.close()\n\n        thread = threading.Thread(target=run_loop, daemon=True)\n        thread.start()\n\n    async def start(\n        self,\n        loop: Annotated[\n            asyncio.AbstractEventLoop | None,\n            Doc(\"\"\"\n                    Asynchronous loop.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        starter: Annotated[\n            Optional[\"BaseStarter\"],\n            Doc(\"\"\"\n                    Starter. Stores methods for launching components.\n\n                    Default: `qtasks.starters.AsyncStarter`.\n                    \"\"\"),\n        ] = None,\n        num_workers: Annotated[\n            int,\n            Doc(\"\"\"\n                    Number of running workers.\n\n                    Default: `4`.\n                    \"\"\"),\n        ] = 4,\n        reset_config: Annotated[\n            bool,\n            Doc(\"\"\"\n                    Update the config of the worker and broker.\n\n                    Default: `True`.\n                    \"\"\"),\n        ] = True,\n    ) -&gt; None:\n        \"\"\"\n        Runs `app.run_forever()`.\n\n        Args:\n            loop (asyncio.AbstractEventLoop, optional): async loop. Default: None.\n            starter (BaseStarter, optional): Starter. Default: `qtasks.starters.AsyncStarter`.\n            num_workers (int, optional): Number of workers running. Default: 4.\n            reset_config (bool, optional): Update the config of the worker and broker. Default: True.\n        \"\"\"\n        self.app.run_forever(\n            loop=loop,\n            starter=starter,\n            num_workers=num_workers,\n            reset_config=reset_config,\n        )\n\n    async def stop(self):\n        \"\"\"Stops the test case.\"\"\"\n        if self.test_config.global_config and self.app.broker.storage.global_config:\n            await self.app.broker.storage.global_config.stop()\n\n        if self.test_config.storage:\n            await self.app.broker.storage.stop()\n\n        if self.test_config.broker:\n            await self.app.broker.stop()\n\n        if self.test_config.worker:\n            await self.app.worker.stop()\n        return\n\n    async def add_task(\n        self,\n        task_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        *args: Annotated[\n            Any,\n            Doc(\"\"\"\n                    args of the task.\n\n                    Default: `()`.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int,\n            Doc(\"\"\"\n                    The task has priority.\n\n                    Default: `0`.\n                    \"\"\"),\n        ] = 0,\n        timeout: Annotated[\n            float | None,\n            Doc(\"\"\"\n                    Task timeout.\n\n                    If specified, the task is returned via `qtasks.results.AsyncTask`.\n                    \"\"\"),\n        ] = None,\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    kwargs tasks.\n\n                    Default: `{}`.\n                    \"\"\"),\n        ],\n    ) -&gt; Union[\"Task\", None]:\n        \"\"\"\n        Add a task.\n\n        Args:\n            task_name (str): The name of the task.\n            priority (int, optional): Task priority. Default: `0`.\n            args (tuple, optional): task args. Default: `()`.\n            kwargs (dict, optional): kwargs of tasks. Default: `{}`\n\n            timeout (float, optional): Task timeout. If specified, the task is called via `qtasks.results.AsyncResult`.\n\n        Returns:\n            Task|None: Task data or None.\n        \"\"\"\n        if self.test_config.broker:\n            return await self.app.add_task(\n                task_name, *args, priority=priority, timeout=timeout, **kwargs\n            )\n        elif self.test_config.worker:\n            return await self.app.worker.add(\n                name=task_name,\n                uuid=uuid4(),\n                priority=priority,\n                created_at=time(),\n                args=args or (),\n                kwargs=kwargs or {},\n            )\n        else:\n            print(\n                f\"[AsyncTestCase: {self.name}] Be sure to enable Worker or Broker!\"\n            )\n            return\n\n    async def get(\n        self,\n        uuid: Annotated[\n            UUID | str,\n            Doc(\"\"\"\n                    UUID of the task.\n                    \"\"\"),\n        ],\n    ) -&gt; Union[\"Task\", None]:\n        \"\"\"\n        Get a task.\n\n        Args:\n            uuid (UUID|str): UUID of the Task.\n\n        Returns:\n            Task|None: Task data or None.\n        \"\"\"\n        if isinstance(uuid, str):\n            uuid = UUID(uuid)\n        if not self.test_config.broker:\n            print(f\"[AsyncTestCase: {self.name}] Broker is not started!\")\n            return\n        return await self.app.broker.get(uuid=uuid)\n</code></pre>"},{"location":"api/tests/async_testcase/#qtasks.tests.async_testcase.AsyncTestCase.__init__","title":"<code>__init__(app, name=None)</code>","text":"<p>Asynchronous test case.</p> <p>Parameters:</p> Name Type Description Default <code>app</code> <code>(QueueTasks, Doc)</code> <p>Main instance.</p> required <code>name</code> <code>str</code> <p>Project name. This name can be used for test components. Default: <code>None</code>.</p> <code>None</code> Source code in <code>src/qtasks/tests/async_testcase.py</code> <pre><code>def __init__(\n    self,\n    app: Annotated[\n        \"QueueTasks\",\n        Doc(\"\"\"\n                Main copy.\n                \"\"\"),\n    ],\n    name: Annotated[\n        str | None,\n        Doc(\"\"\"\n                Project name. This name can be used for test components.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    Asynchronous test case.\n\n    Args:\n        app(QueueTasks, Doc): Main instance.\n        name (str, optional): Project name. This name can be used for test components. Default: `None`.\n    \"\"\"\n    super().__init__(app=app, name=name)\n    self.app: QueueTasks\n\n    self._global_loop: asyncio.AbstractEventLoop | None = None\n</code></pre>"},{"location":"api/tests/async_testcase/#qtasks.tests.async_testcase.AsyncTestCase.add_task","title":"<code>add_task(task_name, *args, priority=0, timeout=None, **kwargs)</code>  <code>async</code>","text":"<p>Add a task.</p> <p>Parameters:</p> Name Type Description Default <code>task_name</code> <code>str</code> <p>The name of the task.</p> required <code>priority</code> <code>int</code> <p>Task priority. Default: <code>0</code>.</p> <code>0</code> <code>args</code> <code>tuple</code> <p>task args. Default: <code>()</code>.</p> <code>()</code> <code>kwargs</code> <code>dict</code> <p>kwargs of tasks. Default: <code>{}</code></p> <code>{}</code> <code>timeout</code> <code>float</code> <p>Task timeout. If specified, the task is called via <code>qtasks.results.AsyncResult</code>.</p> <code>None</code> <p>Returns:</p> Type Description <code>Union[Task, None]</code> <p>Task|None: Task data or None.</p> Source code in <code>src/qtasks/tests/async_testcase.py</code> <pre><code>async def add_task(\n    self,\n    task_name: Annotated[\n        str,\n        Doc(\"\"\"\n                Task name.\n                \"\"\"),\n    ],\n    *args: Annotated[\n        Any,\n        Doc(\"\"\"\n                args of the task.\n\n                Default: `()`.\n                \"\"\"),\n    ],\n    priority: Annotated[\n        int,\n        Doc(\"\"\"\n                The task has priority.\n\n                Default: `0`.\n                \"\"\"),\n    ] = 0,\n    timeout: Annotated[\n        float | None,\n        Doc(\"\"\"\n                Task timeout.\n\n                If specified, the task is returned via `qtasks.results.AsyncTask`.\n                \"\"\"),\n    ] = None,\n    **kwargs: Annotated[\n        Any,\n        Doc(\"\"\"\n                kwargs tasks.\n\n                Default: `{}`.\n                \"\"\"),\n    ],\n) -&gt; Union[\"Task\", None]:\n    \"\"\"\n    Add a task.\n\n    Args:\n        task_name (str): The name of the task.\n        priority (int, optional): Task priority. Default: `0`.\n        args (tuple, optional): task args. Default: `()`.\n        kwargs (dict, optional): kwargs of tasks. Default: `{}`\n\n        timeout (float, optional): Task timeout. If specified, the task is called via `qtasks.results.AsyncResult`.\n\n    Returns:\n        Task|None: Task data or None.\n    \"\"\"\n    if self.test_config.broker:\n        return await self.app.add_task(\n            task_name, *args, priority=priority, timeout=timeout, **kwargs\n        )\n    elif self.test_config.worker:\n        return await self.app.worker.add(\n            name=task_name,\n            uuid=uuid4(),\n            priority=priority,\n            created_at=time(),\n            args=args or (),\n            kwargs=kwargs or {},\n        )\n    else:\n        print(\n            f\"[AsyncTestCase: {self.name}] Be sure to enable Worker or Broker!\"\n        )\n        return\n</code></pre>"},{"location":"api/tests/async_testcase/#qtasks.tests.async_testcase.AsyncTestCase.get","title":"<code>get(uuid)</code>  <code>async</code>","text":"<p>Get a task.</p> <p>Parameters:</p> Name Type Description Default <code>uuid</code> <code>UUID | str</code> <p>UUID of the Task.</p> required <p>Returns:</p> Type Description <code>Union[Task, None]</code> <p>Task|None: Task data or None.</p> Source code in <code>src/qtasks/tests/async_testcase.py</code> <pre><code>async def get(\n    self,\n    uuid: Annotated[\n        UUID | str,\n        Doc(\"\"\"\n                UUID of the task.\n                \"\"\"),\n    ],\n) -&gt; Union[\"Task\", None]:\n    \"\"\"\n    Get a task.\n\n    Args:\n        uuid (UUID|str): UUID of the Task.\n\n    Returns:\n        Task|None: Task data or None.\n    \"\"\"\n    if isinstance(uuid, str):\n        uuid = UUID(uuid)\n    if not self.test_config.broker:\n        print(f\"[AsyncTestCase: {self.name}] Broker is not started!\")\n        return\n    return await self.app.broker.get(uuid=uuid)\n</code></pre>"},{"location":"api/tests/async_testcase/#qtasks.tests.async_testcase.AsyncTestCase.start","title":"<code>start(loop=None, starter=None, num_workers=4, reset_config=True)</code>  <code>async</code>","text":"<p>Runs <code>app.run_forever()</code>.</p> <p>Parameters:</p> Name Type Description Default <code>loop</code> <code>AbstractEventLoop</code> <p>async loop. Default: None.</p> <code>None</code> <code>starter</code> <code>BaseStarter</code> <p>Starter. Default: <code>qtasks.starters.AsyncStarter</code>.</p> <code>None</code> <code>num_workers</code> <code>int</code> <p>Number of workers running. Default: 4.</p> <code>4</code> <code>reset_config</code> <code>bool</code> <p>Update the config of the worker and broker. Default: True.</p> <code>True</code> Source code in <code>src/qtasks/tests/async_testcase.py</code> <pre><code>async def start(\n    self,\n    loop: Annotated[\n        asyncio.AbstractEventLoop | None,\n        Doc(\"\"\"\n                Asynchronous loop.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    starter: Annotated[\n        Optional[\"BaseStarter\"],\n        Doc(\"\"\"\n                Starter. Stores methods for launching components.\n\n                Default: `qtasks.starters.AsyncStarter`.\n                \"\"\"),\n    ] = None,\n    num_workers: Annotated[\n        int,\n        Doc(\"\"\"\n                Number of running workers.\n\n                Default: `4`.\n                \"\"\"),\n    ] = 4,\n    reset_config: Annotated[\n        bool,\n        Doc(\"\"\"\n                Update the config of the worker and broker.\n\n                Default: `True`.\n                \"\"\"),\n    ] = True,\n) -&gt; None:\n    \"\"\"\n    Runs `app.run_forever()`.\n\n    Args:\n        loop (asyncio.AbstractEventLoop, optional): async loop. Default: None.\n        starter (BaseStarter, optional): Starter. Default: `qtasks.starters.AsyncStarter`.\n        num_workers (int, optional): Number of workers running. Default: 4.\n        reset_config (bool, optional): Update the config of the worker and broker. Default: True.\n    \"\"\"\n    self.app.run_forever(\n        loop=loop,\n        starter=starter,\n        num_workers=num_workers,\n        reset_config=reset_config,\n    )\n</code></pre>"},{"location":"api/tests/async_testcase/#qtasks.tests.async_testcase.AsyncTestCase.start_in_background","title":"<code>start_in_background(starter=None, num_workers=4, reset_config=True)</code>","text":"<p>Run <code>app.run_forever()</code> in the background.</p> <p>Parameters:</p> Name Type Description Default <code>starter</code> <code>BaseStarter</code> <p>Starter. Default: <code>qtasks.starters.AsyncStarter</code>.</p> <code>None</code> <code>num_workers</code> <code>int</code> <p>Number of workers running. Default: 4.</p> <code>4</code> <code>reset_config</code> <code>bool</code> <p>Update the config of the worker and broker. Default: True.</p> <code>True</code> Source code in <code>src/qtasks/tests/async_testcase.py</code> <pre><code>def start_in_background(\n    self,\n    starter: Annotated[\n        Optional[\"BaseStarter\"],\n        Doc(\"\"\"\n                Starter. Stores methods for launching components.\n\n                Default: `qtasks.starters.AsyncStarter`.\n                \"\"\"),\n    ] = None,\n    num_workers: Annotated[\n        int,\n        Doc(\"\"\"\n                Number of running workers.\n\n                Default: `4`.\n                \"\"\"),\n    ] = 4,\n    reset_config: Annotated[\n        bool,\n        Doc(\"\"\"\n                Update the config of the worker and broker.\n\n                Default: `True`.\n                \"\"\"),\n    ] = True,\n):  # TODO: fix!\n    \"\"\"\n    Run `app.run_forever()` in the background.\n\n    Args:\n        starter (BaseStarter, optional): Starter. Default: `qtasks.starters.AsyncStarter`.\n        num_workers (int, optional): Number of workers running. Default: 4.\n        reset_config (bool, optional): Update the config of the worker and broker. Default: True.\n    \"\"\"\n\n    def run_loop():\n        loop = asyncio.new_event_loop()\n        asyncio.set_event_loop(loop)\n        try:\n            loop.run_until_complete(self.start(loop=loop, num_workers=num_workers))\n        finally:\n            loop.close()\n\n    thread = threading.Thread(target=run_loop, daemon=True)\n    thread.start()\n</code></pre>"},{"location":"api/tests/async_testcase/#qtasks.tests.async_testcase.AsyncTestCase.stop","title":"<code>stop()</code>  <code>async</code>","text":"<p>Stops the test case.</p> Source code in <code>src/qtasks/tests/async_testcase.py</code> <pre><code>async def stop(self):\n    \"\"\"Stops the test case.\"\"\"\n    if self.test_config.global_config and self.app.broker.storage.global_config:\n        await self.app.broker.storage.global_config.stop()\n\n    if self.test_config.storage:\n        await self.app.broker.storage.stop()\n\n    if self.test_config.broker:\n        await self.app.broker.stop()\n\n    if self.test_config.worker:\n        await self.app.worker.stop()\n    return\n</code></pre>"},{"location":"api/tests/basetests/","title":"BaseTestCase - \u041f\u0438\u0448\u0435\u043c \u0441\u0432\u043e\u0439 \u041a\u0435\u0439\u0441 \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f","text":"<p>Base test case.</p>"},{"location":"api/tests/basetests/#qtasks.tests.base.BaseTestCase","title":"<code>BaseTestCase</code>","text":"<p>               Bases: <code>Generic[TAsyncFlag]</code>, <code>ABC</code></p> <p><code>BaseTestCase</code> - An abstract class that is the foundation for TestCase.</p>"},{"location":"api/tests/basetests/#qtasks.tests.base.BaseTestCase--example","title":"Example","text":"<pre><code>from qtasks import QueueTasks\nfrom qtasks.tests.base import BaseTestCase\n\nclass MyTestCase(BaseTestCase):\n    def __init__(self, app: QueueTasks, name: str|None = None):\n        super().__init__(app=app, name=name)\n        pass\n</code></pre> Source code in <code>src/qtasks/tests/base.py</code> <pre><code>class BaseTestCase(Generic[TAsyncFlag], ABC):\n    \"\"\"\n    `BaseTestCase` - An abstract class that is the foundation for TestCase.\n\n    ## Example\n\n    ```python\n    from qtasks import QueueTasks\n    from qtasks.tests.base import BaseTestCase\n\n    class MyTestCase(BaseTestCase):\n        def __init__(self, app: QueueTasks, name: str|None = None):\n            super().__init__(app=app, name=name)\n            pass\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        app: Annotated[\n            Union[\"QueueTasks\", \"aioQueueTasks\"],\n            Doc(\"\"\"\n                    Main copy.\n                    \"\"\"),\n        ],\n        name: Annotated[\n            str | None,\n            Doc(\"\"\"\n                    Project name. This name can be used for test components.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"Test case initialization.\"\"\"\n        self.app = app\n\n        self.name = name\n        self.config = QueueConfig()\n        self.test_config = TestConfig()\n\n    @overload\n    def start(self: \"BaseTestCase[Literal[False]]\", **kwargs) -&gt; None:\n        \"\"\"Launches a test case.\"\"\"\n        pass\n\n    @overload\n    async def start(self: \"BaseTestCase[Literal[True]]\", **kwargs) -&gt; None:\n        \"\"\"Launches a test case.\"\"\"\n        pass\n\n    @abstractmethod\n    def start(self, **kwargs) -&gt; None | Awaitable[None]:\n        \"\"\"Launches a test case.\"\"\"\n        pass\n\n    @overload\n    def stop(self: \"BaseTestCase[Literal[False]]\", **kwargs) -&gt; None:\n        \"\"\"Launches a test case.\"\"\"\n        pass\n\n    @overload\n    async def stop(self: \"BaseTestCase[Literal[True]]\", **kwargs) -&gt; None:\n        \"\"\"Launches a test case.\"\"\"\n        pass\n\n    @abstractmethod\n    def stop(self, **kwargs) -&gt; None | Awaitable[None]:\n        \"\"\"Stops the test case.\"\"\"\n        pass\n\n    def update_config(\n        self,\n        config: Annotated[\n            QueueConfig,\n            Doc(\"\"\"\n                    Config.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Updates the broker config.\n\n        Args:\n            config (QueueConfig): Config.\n        \"\"\"\n        self.config = config\n        return\n\n    def settings(\n        self, test_config: TestConfig | None = None, awaiting: bool | None = False\n    ) -&gt; None:\n        \"\"\"\n        Test settings.\n\n        Args:\n            test_config (TestConfig, optional): Test config. Default: `TestConfig()`.\n            awaiting (bool, optional): Use Async components. Default: `False`.\n        \"\"\"\n        if test_config:\n            self.test_config = test_config\n        else:\n            test_config = self.test_config\n\n        global_config = None\n        storage = None\n\n        if not test_config.global_config:\n            global_config = (\n                AsyncTestGlobalConfig(name=self.name)\n                if awaiting\n                else SyncTestGlobalConfig(name=self.name)\n            )\n\n        if not test_config.storage:\n            storage = (\n                AsyncTestStorage(name=self.name, global_config=global_config)\n                if awaiting\n                else SyncTestStorage(name=self.name, global_config=global_config)\n            )\n\n        if not test_config.broker:\n            self.app.broker = (\n                AsyncTestBroker(name=self.name, storage=storage)\n                if awaiting\n                else SyncTestBroker(name=self.name, storage=storage)\n            )\n\n        if not test_config.worker:\n            self.app.worker = AsyncTestWorker(name=self.name, broker=self.app.broker) if awaiting else SyncTestWorker(name=self.name, broker=self.app.broker)  # type: ignore\n\n        if not test_config.plugins:\n            self.app.plugins.clear()\n            self.app.broker.plugins.clear()\n            self.app.broker.storage.plugins.clear()\n            if self.app.broker.storage.global_config:\n                self.app.broker.storage.global_config.plugins.clear()\n            self.app.worker.plugins.clear()\n            if self.app.starter:\n                self.app.starter.plugins.clear()\n\n        return\n</code></pre>"},{"location":"api/tests/basetests/#qtasks.tests.base.BaseTestCase.__init__","title":"<code>__init__(app, name=None)</code>","text":"<p>Test case initialization.</p> Source code in <code>src/qtasks/tests/base.py</code> <pre><code>def __init__(\n    self,\n    app: Annotated[\n        Union[\"QueueTasks\", \"aioQueueTasks\"],\n        Doc(\"\"\"\n                Main copy.\n                \"\"\"),\n    ],\n    name: Annotated[\n        str | None,\n        Doc(\"\"\"\n                Project name. This name can be used for test components.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"Test case initialization.\"\"\"\n    self.app = app\n\n    self.name = name\n    self.config = QueueConfig()\n    self.test_config = TestConfig()\n</code></pre>"},{"location":"api/tests/basetests/#qtasks.tests.base.BaseTestCase.settings","title":"<code>settings(test_config=None, awaiting=False)</code>","text":"<p>Test settings.</p> <p>Parameters:</p> Name Type Description Default <code>test_config</code> <code>TestConfig</code> <p>Test config. Default: <code>TestConfig()</code>.</p> <code>None</code> <code>awaiting</code> <code>bool</code> <p>Use Async components. Default: <code>False</code>.</p> <code>False</code> Source code in <code>src/qtasks/tests/base.py</code> <pre><code>def settings(\n    self, test_config: TestConfig | None = None, awaiting: bool | None = False\n) -&gt; None:\n    \"\"\"\n    Test settings.\n\n    Args:\n        test_config (TestConfig, optional): Test config. Default: `TestConfig()`.\n        awaiting (bool, optional): Use Async components. Default: `False`.\n    \"\"\"\n    if test_config:\n        self.test_config = test_config\n    else:\n        test_config = self.test_config\n\n    global_config = None\n    storage = None\n\n    if not test_config.global_config:\n        global_config = (\n            AsyncTestGlobalConfig(name=self.name)\n            if awaiting\n            else SyncTestGlobalConfig(name=self.name)\n        )\n\n    if not test_config.storage:\n        storage = (\n            AsyncTestStorage(name=self.name, global_config=global_config)\n            if awaiting\n            else SyncTestStorage(name=self.name, global_config=global_config)\n        )\n\n    if not test_config.broker:\n        self.app.broker = (\n            AsyncTestBroker(name=self.name, storage=storage)\n            if awaiting\n            else SyncTestBroker(name=self.name, storage=storage)\n        )\n\n    if not test_config.worker:\n        self.app.worker = AsyncTestWorker(name=self.name, broker=self.app.broker) if awaiting else SyncTestWorker(name=self.name, broker=self.app.broker)  # type: ignore\n\n    if not test_config.plugins:\n        self.app.plugins.clear()\n        self.app.broker.plugins.clear()\n        self.app.broker.storage.plugins.clear()\n        if self.app.broker.storage.global_config:\n            self.app.broker.storage.global_config.plugins.clear()\n        self.app.worker.plugins.clear()\n        if self.app.starter:\n            self.app.starter.plugins.clear()\n\n    return\n</code></pre>"},{"location":"api/tests/basetests/#qtasks.tests.base.BaseTestCase.start","title":"<code>start(**kwargs)</code>  <code>abstractmethod</code>","text":"<pre><code>start(**kwargs) -&gt; None\n</code></pre><pre><code>start(**kwargs) -&gt; None\n</code></pre> <p>Launches a test case.</p> Source code in <code>src/qtasks/tests/base.py</code> <pre><code>@abstractmethod\ndef start(self, **kwargs) -&gt; None | Awaitable[None]:\n    \"\"\"Launches a test case.\"\"\"\n    pass\n</code></pre>"},{"location":"api/tests/basetests/#qtasks.tests.base.BaseTestCase.stop","title":"<code>stop(**kwargs)</code>  <code>abstractmethod</code>","text":"<pre><code>stop(**kwargs) -&gt; None\n</code></pre><pre><code>stop(**kwargs) -&gt; None\n</code></pre> <p>Stops the test case.</p> Source code in <code>src/qtasks/tests/base.py</code> <pre><code>@abstractmethod\ndef stop(self, **kwargs) -&gt; None | Awaitable[None]:\n    \"\"\"Stops the test case.\"\"\"\n    pass\n</code></pre>"},{"location":"api/tests/basetests/#qtasks.tests.base.BaseTestCase.update_config","title":"<code>update_config(config)</code>","text":"<p>Updates the broker config.</p> <p>Parameters:</p> Name Type Description Default <code>config</code> <code>QueueConfig</code> <p>Config.</p> required Source code in <code>src/qtasks/tests/base.py</code> <pre><code>def update_config(\n    self,\n    config: Annotated[\n        QueueConfig,\n        Doc(\"\"\"\n                Config.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Updates the broker config.\n\n    Args:\n        config (QueueConfig): Config.\n    \"\"\"\n    self.config = config\n    return\n</code></pre>"},{"location":"api/tests/sync_testcase/","title":"SyncTestCase","text":"<p>Sync test classes.</p>"},{"location":"api/tests/sync_testcase/#qtasks.tests.sync_testcase.SyncTestCase","title":"<code>SyncTestCase</code>","text":"<p>               Bases: <code>BaseTestCase[Literal[False]]</code></p> <p>Synchronous testing case.</p>"},{"location":"api/tests/sync_testcase/#qtasks.tests.sync_testcase.SyncTestCase--example","title":"Example","text":"<pre><code>from qtasks import QueueTasks\nfrom qtasks.tests import SyncTestCase\n\napp = QueueTasks()\n\ntest_case = SyncTestCase(app=app)\n</code></pre> Source code in <code>src/qtasks/tests/sync_testcase.py</code> <pre><code>class SyncTestCase(BaseTestCase[Literal[False]]):\n    \"\"\"\n    Synchronous testing case.\n\n    ## Example\n\n    ```python\n    from qtasks import QueueTasks\n    from qtasks.tests import SyncTestCase\n\n    app = QueueTasks()\n\n    test_case = SyncTestCase(app=app)\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        app: Annotated[\n            \"QueueTasks\",\n            Doc(\"\"\"\n                    Main copy.\n                    \"\"\"),\n        ],\n        name: Annotated[\n            str | None,\n            Doc(\"\"\"\n                    Project name. This name can be used for test components.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Synchronous test case.\n\n        Args:\n            app(QueueTasks): Main instance.\n            name (str, optional): Project name. This name can be used for test components. Default: `None`.\n        \"\"\"\n        super().__init__(app=app, name=name)\n        self.app: QueueTasks\n\n    def start_in_background(\n        self,\n        starter: Annotated[\n            Optional[\"BaseStarter\"],\n            Doc(\"\"\"\n                    Starter. Stores methods for launching components.\n\n                    Default: `qtasks.starters.AsyncStarter`.\n                    \"\"\"),\n        ] = None,\n        num_workers: Annotated[\n            int,\n            Doc(\"\"\"\n                    Number of running workers.\n\n                    Default: `4`.\n                    \"\"\"),\n        ] = 4,\n        reset_config: Annotated[\n            bool,\n            Doc(\"\"\"\n                    Update the config of the worker and broker.\n\n                    Default: `True`.\n                    \"\"\"),\n        ] = True,\n    ):\n        \"\"\"\n        Run `app.run_forever()` in the background.\n\n        Args:\n            starter (BaseStarter, optional): Starter. Default: `qtasks.starters.AsyncStarter`.\n            num_workers (int, optional): Number of workers running. Default: 4.\n            reset_config (bool, optional): Update the config of the worker and broker. Default: True.\n        \"\"\"\n\n        def run():\n            self.start(\n                starter=starter, num_workers=num_workers, reset_config=reset_config\n            )\n\n        thread = threading.Thread(target=run, daemon=True)\n        thread.start()\n\n    def start(\n        self,\n        starter: Annotated[\n            Optional[\"BaseStarter\"],\n            Doc(\"\"\"\n                    Starter. Stores methods for launching components.\n\n                    Default: `qtasks.starters.AsyncStarter`.\n                    \"\"\"),\n        ] = None,\n        num_workers: Annotated[\n            int,\n            Doc(\"\"\"\n                    Number of running workers.\n\n                    Default: `4`.\n                    \"\"\"),\n        ] = 4,\n        reset_config: Annotated[\n            bool,\n            Doc(\"\"\"\n                    Update the config of the worker and broker.\n\n                    Default: `True`.\n                    \"\"\"),\n        ] = True,\n    ) -&gt; None:\n        \"\"\"\n        Runs `app.run_forever()`.\n\n        Args:\n            starter (BaseStarter, optional): Starter. Default: `qtasks.starters.AsyncStarter`.\n            num_workers (int, optional): Number of workers running. Default: 4.\n            reset_config (bool, optional): Update the config of the worker and broker. Default: True.\n        \"\"\"\n        self.app.run_forever(\n            starter=starter, num_workers=num_workers, reset_config=reset_config\n        )\n\n    def stop(self):\n        \"\"\"Stops the test case.\"\"\"\n        if self.test_config.global_config and self.app.broker.storage.global_config:\n            self.app.broker.storage.global_config.stop()\n\n        if self.test_config.storage:\n            self.app.broker.storage.stop()\n\n        if self.test_config.broker:\n            self.app.broker.stop()\n\n        if self.test_config.worker:\n            self.app.worker.stop()\n\n    def add_task(\n        self,\n        task_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        *args: Annotated[\n            Any,\n            Doc(\"\"\"\n                    args of the task.\n\n                    Default: `()`.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int,\n            Doc(\"\"\"\n                    The task has priority.\n\n                    Default: `0`.\n                    \"\"\"),\n        ] = 0,\n        timeout: Annotated[\n            float | None,\n            Doc(\"\"\"\n                    Task timeout.\n\n                    If specified, the task is returned via `qtasks.results.AsyncTask`.\n                    \"\"\"),\n        ] = None,\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    kwargs tasks.\n\n                    Default: `{}`.\n                    \"\"\"),\n        ],\n    ) -&gt; Union[\"Task\", None]:\n        \"\"\"\n        Add a task.\n\n        Args:\n            task_name (str): The name of the task.\n            priority (int, optional): Task priority. Default: `0`.\n            args (tuple, optional): task args. Default: `()`.\n            kwargs (dict, optional): kwargs of tasks. Default: `{}`\n            timeout (float, optional): Task timeout. If specified, the task is called via `qtasks.results.SyncResult`.\n\n        Returns:\n            Task|None: Task data or None.\n        \"\"\"\n        if self.test_config.broker:\n            return self.app.add_task(\n                task_name, *args, priority=priority, timeout=timeout, **kwargs\n            )\n        elif self.test_config.worker:\n            return self.app.worker.add(\n                name=task_name,\n                uuid=uuid4(),\n                priority=priority,\n                created_at=time(),\n                args=args,\n                kwargs=kwargs,\n            )\n        else:\n            print(\n                f\"[SyncTestCase: {self.name}] Be sure to enable Worker or Broker!\"\n            )\n            return\n\n    def get(\n        self,\n        uuid: Annotated[\n            UUID | str,\n            Doc(\"\"\"\n                    UUID of the task.\n                    \"\"\"),\n        ],\n    ) -&gt; Union[\"Task\", None]:\n        \"\"\"\n        Get a task.\n\n        Args:\n            uuid (UUID|str): UUID of the Task.\n\n        Returns:\n            Task|None: Task data or None.\n        \"\"\"\n        if isinstance(uuid, str):\n            uuid = UUID(uuid)\n        if not self.test_config.broker:\n            print(f\"[SyncTestCase: {self.name}] Broker is not started!\")\n            return\n        return self.app.broker.get(uuid=uuid)\n</code></pre>"},{"location":"api/tests/sync_testcase/#qtasks.tests.sync_testcase.SyncTestCase.__init__","title":"<code>__init__(app, name=None)</code>","text":"<p>Synchronous test case.</p> <p>Parameters:</p> Name Type Description Default <code>app</code> <code>QueueTasks</code> <p>Main instance.</p> required <code>name</code> <code>str</code> <p>Project name. This name can be used for test components. Default: <code>None</code>.</p> <code>None</code> Source code in <code>src/qtasks/tests/sync_testcase.py</code> <pre><code>def __init__(\n    self,\n    app: Annotated[\n        \"QueueTasks\",\n        Doc(\"\"\"\n                Main copy.\n                \"\"\"),\n    ],\n    name: Annotated[\n        str | None,\n        Doc(\"\"\"\n                Project name. This name can be used for test components.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    Synchronous test case.\n\n    Args:\n        app(QueueTasks): Main instance.\n        name (str, optional): Project name. This name can be used for test components. Default: `None`.\n    \"\"\"\n    super().__init__(app=app, name=name)\n    self.app: QueueTasks\n</code></pre>"},{"location":"api/tests/sync_testcase/#qtasks.tests.sync_testcase.SyncTestCase.add_task","title":"<code>add_task(task_name, *args, priority=0, timeout=None, **kwargs)</code>","text":"<p>Add a task.</p> <p>Parameters:</p> Name Type Description Default <code>task_name</code> <code>str</code> <p>The name of the task.</p> required <code>priority</code> <code>int</code> <p>Task priority. Default: <code>0</code>.</p> <code>0</code> <code>args</code> <code>tuple</code> <p>task args. Default: <code>()</code>.</p> <code>()</code> <code>kwargs</code> <code>dict</code> <p>kwargs of tasks. Default: <code>{}</code></p> <code>{}</code> <code>timeout</code> <code>float</code> <p>Task timeout. If specified, the task is called via <code>qtasks.results.SyncResult</code>.</p> <code>None</code> <p>Returns:</p> Type Description <code>Union[Task, None]</code> <p>Task|None: Task data or None.</p> Source code in <code>src/qtasks/tests/sync_testcase.py</code> <pre><code>def add_task(\n    self,\n    task_name: Annotated[\n        str,\n        Doc(\"\"\"\n                Task name.\n                \"\"\"),\n    ],\n    *args: Annotated[\n        Any,\n        Doc(\"\"\"\n                args of the task.\n\n                Default: `()`.\n                \"\"\"),\n    ],\n    priority: Annotated[\n        int,\n        Doc(\"\"\"\n                The task has priority.\n\n                Default: `0`.\n                \"\"\"),\n    ] = 0,\n    timeout: Annotated[\n        float | None,\n        Doc(\"\"\"\n                Task timeout.\n\n                If specified, the task is returned via `qtasks.results.AsyncTask`.\n                \"\"\"),\n    ] = None,\n    **kwargs: Annotated[\n        Any,\n        Doc(\"\"\"\n                kwargs tasks.\n\n                Default: `{}`.\n                \"\"\"),\n    ],\n) -&gt; Union[\"Task\", None]:\n    \"\"\"\n    Add a task.\n\n    Args:\n        task_name (str): The name of the task.\n        priority (int, optional): Task priority. Default: `0`.\n        args (tuple, optional): task args. Default: `()`.\n        kwargs (dict, optional): kwargs of tasks. Default: `{}`\n        timeout (float, optional): Task timeout. If specified, the task is called via `qtasks.results.SyncResult`.\n\n    Returns:\n        Task|None: Task data or None.\n    \"\"\"\n    if self.test_config.broker:\n        return self.app.add_task(\n            task_name, *args, priority=priority, timeout=timeout, **kwargs\n        )\n    elif self.test_config.worker:\n        return self.app.worker.add(\n            name=task_name,\n            uuid=uuid4(),\n            priority=priority,\n            created_at=time(),\n            args=args,\n            kwargs=kwargs,\n        )\n    else:\n        print(\n            f\"[SyncTestCase: {self.name}] Be sure to enable Worker or Broker!\"\n        )\n        return\n</code></pre>"},{"location":"api/tests/sync_testcase/#qtasks.tests.sync_testcase.SyncTestCase.get","title":"<code>get(uuid)</code>","text":"<p>Get a task.</p> <p>Parameters:</p> Name Type Description Default <code>uuid</code> <code>UUID | str</code> <p>UUID of the Task.</p> required <p>Returns:</p> Type Description <code>Union[Task, None]</code> <p>Task|None: Task data or None.</p> Source code in <code>src/qtasks/tests/sync_testcase.py</code> <pre><code>def get(\n    self,\n    uuid: Annotated[\n        UUID | str,\n        Doc(\"\"\"\n                UUID of the task.\n                \"\"\"),\n    ],\n) -&gt; Union[\"Task\", None]:\n    \"\"\"\n    Get a task.\n\n    Args:\n        uuid (UUID|str): UUID of the Task.\n\n    Returns:\n        Task|None: Task data or None.\n    \"\"\"\n    if isinstance(uuid, str):\n        uuid = UUID(uuid)\n    if not self.test_config.broker:\n        print(f\"[SyncTestCase: {self.name}] Broker is not started!\")\n        return\n    return self.app.broker.get(uuid=uuid)\n</code></pre>"},{"location":"api/tests/sync_testcase/#qtasks.tests.sync_testcase.SyncTestCase.start","title":"<code>start(starter=None, num_workers=4, reset_config=True)</code>","text":"<p>Runs <code>app.run_forever()</code>.</p> <p>Parameters:</p> Name Type Description Default <code>starter</code> <code>BaseStarter</code> <p>Starter. Default: <code>qtasks.starters.AsyncStarter</code>.</p> <code>None</code> <code>num_workers</code> <code>int</code> <p>Number of workers running. Default: 4.</p> <code>4</code> <code>reset_config</code> <code>bool</code> <p>Update the config of the worker and broker. Default: True.</p> <code>True</code> Source code in <code>src/qtasks/tests/sync_testcase.py</code> <pre><code>def start(\n    self,\n    starter: Annotated[\n        Optional[\"BaseStarter\"],\n        Doc(\"\"\"\n                Starter. Stores methods for launching components.\n\n                Default: `qtasks.starters.AsyncStarter`.\n                \"\"\"),\n    ] = None,\n    num_workers: Annotated[\n        int,\n        Doc(\"\"\"\n                Number of running workers.\n\n                Default: `4`.\n                \"\"\"),\n    ] = 4,\n    reset_config: Annotated[\n        bool,\n        Doc(\"\"\"\n                Update the config of the worker and broker.\n\n                Default: `True`.\n                \"\"\"),\n    ] = True,\n) -&gt; None:\n    \"\"\"\n    Runs `app.run_forever()`.\n\n    Args:\n        starter (BaseStarter, optional): Starter. Default: `qtasks.starters.AsyncStarter`.\n        num_workers (int, optional): Number of workers running. Default: 4.\n        reset_config (bool, optional): Update the config of the worker and broker. Default: True.\n    \"\"\"\n    self.app.run_forever(\n        starter=starter, num_workers=num_workers, reset_config=reset_config\n    )\n</code></pre>"},{"location":"api/tests/sync_testcase/#qtasks.tests.sync_testcase.SyncTestCase.start_in_background","title":"<code>start_in_background(starter=None, num_workers=4, reset_config=True)</code>","text":"<p>Run <code>app.run_forever()</code> in the background.</p> <p>Parameters:</p> Name Type Description Default <code>starter</code> <code>BaseStarter</code> <p>Starter. Default: <code>qtasks.starters.AsyncStarter</code>.</p> <code>None</code> <code>num_workers</code> <code>int</code> <p>Number of workers running. Default: 4.</p> <code>4</code> <code>reset_config</code> <code>bool</code> <p>Update the config of the worker and broker. Default: True.</p> <code>True</code> Source code in <code>src/qtasks/tests/sync_testcase.py</code> <pre><code>def start_in_background(\n    self,\n    starter: Annotated[\n        Optional[\"BaseStarter\"],\n        Doc(\"\"\"\n                Starter. Stores methods for launching components.\n\n                Default: `qtasks.starters.AsyncStarter`.\n                \"\"\"),\n    ] = None,\n    num_workers: Annotated[\n        int,\n        Doc(\"\"\"\n                Number of running workers.\n\n                Default: `4`.\n                \"\"\"),\n    ] = 4,\n    reset_config: Annotated[\n        bool,\n        Doc(\"\"\"\n                Update the config of the worker and broker.\n\n                Default: `True`.\n                \"\"\"),\n    ] = True,\n):\n    \"\"\"\n    Run `app.run_forever()` in the background.\n\n    Args:\n        starter (BaseStarter, optional): Starter. Default: `qtasks.starters.AsyncStarter`.\n        num_workers (int, optional): Number of workers running. Default: 4.\n        reset_config (bool, optional): Update the config of the worker and broker. Default: True.\n    \"\"\"\n\n    def run():\n        self.start(\n            starter=starter, num_workers=num_workers, reset_config=reset_config\n        )\n\n    thread = threading.Thread(target=run, daemon=True)\n    thread.start()\n</code></pre>"},{"location":"api/tests/sync_testcase/#qtasks.tests.sync_testcase.SyncTestCase.stop","title":"<code>stop()</code>","text":"<p>Stops the test case.</p> Source code in <code>src/qtasks/tests/sync_testcase.py</code> <pre><code>def stop(self):\n    \"\"\"Stops the test case.\"\"\"\n    if self.test_config.global_config and self.app.broker.storage.global_config:\n        self.app.broker.storage.global_config.stop()\n\n    if self.test_config.storage:\n        self.app.broker.storage.stop()\n\n    if self.test_config.broker:\n        self.app.broker.stop()\n\n    if self.test_config.worker:\n        self.app.worker.stop()\n</code></pre>"},{"location":"api/timers/async_timer/","title":"AsyncTimer","text":"<p>Async timer for scheduling tasks.</p>"},{"location":"api/timers/async_timer/#qtasks.timers.async_timer.AsyncTimer","title":"<code>AsyncTimer</code>","text":"<p>               Bases: <code>BaseTimer[Literal[True]]</code></p> <p>A timer running through apscheduler that starts tasks.</p>"},{"location":"api/timers/async_timer/#qtasks.timers.async_timer.AsyncTimer--example","title":"Example","text":"<pre><code>from qtasks import QueueTasks\nfrom qtasks.timers import AsyncTimer\n\napp = QueueTasks()\ntimer = AsyncTimer(app=app)\n\ntrigger = CronTrigger(second=\"*/10\") # Trigger every 10 seconds\ntimer.add_task(task_name=\"test\", trigger=trigger)\n\ntimer.run_forever()\n</code></pre> Source code in <code>src/qtasks/timers/async_timer.py</code> <pre><code>class AsyncTimer(BaseTimer[Literal[True]]):\n    \"\"\"\n    A timer running through apscheduler that starts tasks.\n\n    ## Example\n\n    ```python\n    from qtasks import QueueTasks\n    from qtasks.timers import AsyncTimer\n\n    app = QueueTasks()\n    timer = AsyncTimer(app=app)\n\n    trigger = CronTrigger(second=\"*/10\") # Trigger every 10 seconds\n    timer.add_task(task_name=\"test\", trigger=trigger)\n\n    timer.run_forever()\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        app: Annotated[\n            QueueTasks,\n            Doc(\"\"\"\n                    Application.\n                    \"\"\"),\n        ],\n        log: Annotated[\n            Logger | None,\n            Doc(\"\"\"\n                    Logger.\n\n                    Default: `qtasks.logs.Logger`.\n                    \"\"\"),\n        ] = None,\n        config: Annotated[\n            QueueConfig | None,\n            Doc(\"\"\"\n                    Config.\n\n                    Default: `qtasks.configs.config.QueueConfig`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Timer initialization.\n\n        Args:\n            app (QueueTasks): Application.\n            log (Logger, optional): Logger. Default: `qtasks.logs.Logger`.\n            config (QueueConfig, optional): Config. Default: `qtasks.configs.config.QueueConfig`.\n        \"\"\"\n        super().__init__(app=app, log=log, config=config)\n        self.app: QueueTasks\n\n        self.scheduler = AsyncIOScheduler()\n        self.tasks = {}\n\n    def add_task(\n        self,\n        *args: Annotated[\n            Any,\n            Doc(\"\"\"\n                    args of the task.\n\n                    Default: `()`.\n                    \"\"\"),\n        ],\n        task_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int | None,\n            Doc(\"\"\"\n                    The task has priority.\n\n                    Default: Task priority value.\n                    \"\"\"),\n        ] = None,\n        timeout: Annotated[\n            float | None,\n            Doc(\"\"\"\n                    Task timeout.\n\n                    If specified, the task is returned via `qtasks.results.AsyncTask`.\n                    \"\"\"),\n        ] = None,\n        trigger: Annotated[\n            Any,\n            Doc(\"\"\"\n                    Task trigger.\n                    \"\"\"),\n        ],\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    kwargs tasks.\n\n                    Default: `{}`.\n                    \"\"\"),\n        ],\n    ) -&gt; Job:\n        \"\"\"\n        Adding a task.\n\n        Args:\n            task_name (str): The name of the task.\n            priority (int, optional): Task priority. Default is `0`.\n            args (tuple, optional): task args. Defaults to `()`.\n            kwargs (dict, optional): kwags tasks. Defaults to `{}`.\n\n        Returns:\n            Any|None: Task.\n        \"\"\"\n        self.tasks[task_name] = trigger\n\n        return self.scheduler.add_job(\n            self._add_task_async,\n            trigger=trigger,\n            args=(task_name, priority, args, kwargs),\n        )\n\n    async def _add_task_async(\n        self,\n        task_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int,\n            Doc(\"\"\"\n                    Task priority.\n\n                    Default: `0`.\n                    \"\"\"),\n        ] = 0,\n        args: Annotated[\n            tuple | None,\n            Doc(\"\"\"\n                    args of the task.\n\n                    Default: `()`.\n                    \"\"\"),\n        ] = None,\n        kwargs: Annotated[\n            dict | None,\n            Doc(\"\"\"\n                    kwargs tasks.\n\n                    Default: `{}`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Run the added task asynchronously.\n\n        Args:\n            task_name (str): The name of the task.\n            priority (int, optional): Task priority. Default is `0`.\n            args (tuple, optional): task args. Defaults to `()`.\n            kwargs (dict, optional): kwags tasks. Defaults to `{}`.\n        \"\"\"\n        args, kwargs = args or (), kwargs or {}\n        task = await self.app.add_task(\n            task_name, *args, priority=priority, timeout=None, **kwargs\n        )\n        self.log.info(f\"Task '{task_name}' sent with UUID: {task.uuid}\")\n\n    def run_forever(self):\n        \"\"\"Start Timer.\"\"\"\n        self.log.info(\"Starting...\")\n        try:\n            asyncio.run(\n                self._start_scheduler()\n            )\n        except KeyboardInterrupt:\n            self.log.info(\"Stopping...\")\n\n    async def _start_scheduler(self):\n        \"\"\"Start Timer asynchronously.\"\"\"\n        self.scheduler.start()\n        while True:\n            await asyncio.sleep(1)\n</code></pre>"},{"location":"api/timers/async_timer/#qtasks.timers.async_timer.AsyncTimer.__init__","title":"<code>__init__(app, log=None, config=None)</code>","text":"<p>Timer initialization.</p> <p>Parameters:</p> Name Type Description Default <code>app</code> <code>QueueTasks</code> <p>Application.</p> required <code>log</code> <code>Logger</code> <p>Logger. Default: <code>qtasks.logs.Logger</code>.</p> <code>None</code> <code>config</code> <code>QueueConfig</code> <p>Config. Default: <code>qtasks.configs.config.QueueConfig</code>.</p> <code>None</code> Source code in <code>src/qtasks/timers/async_timer.py</code> <pre><code>def __init__(\n    self,\n    app: Annotated[\n        QueueTasks,\n        Doc(\"\"\"\n                Application.\n                \"\"\"),\n    ],\n    log: Annotated[\n        Logger | None,\n        Doc(\"\"\"\n                Logger.\n\n                Default: `qtasks.logs.Logger`.\n                \"\"\"),\n    ] = None,\n    config: Annotated[\n        QueueConfig | None,\n        Doc(\"\"\"\n                Config.\n\n                Default: `qtasks.configs.config.QueueConfig`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    Timer initialization.\n\n    Args:\n        app (QueueTasks): Application.\n        log (Logger, optional): Logger. Default: `qtasks.logs.Logger`.\n        config (QueueConfig, optional): Config. Default: `qtasks.configs.config.QueueConfig`.\n    \"\"\"\n    super().__init__(app=app, log=log, config=config)\n    self.app: QueueTasks\n\n    self.scheduler = AsyncIOScheduler()\n    self.tasks = {}\n</code></pre>"},{"location":"api/timers/async_timer/#qtasks.timers.async_timer.AsyncTimer.add_task","title":"<code>add_task(*args, task_name, priority=None, timeout=None, trigger, **kwargs)</code>","text":"<p>Adding a task.</p> <p>Parameters:</p> Name Type Description Default <code>task_name</code> <code>str</code> <p>The name of the task.</p> required <code>priority</code> <code>int</code> <p>Task priority. Default is <code>0</code>.</p> <code>None</code> <code>args</code> <code>tuple</code> <p>task args. Defaults to <code>()</code>.</p> <code>()</code> <code>kwargs</code> <code>dict</code> <p>kwags tasks. Defaults to <code>{}</code>.</p> <code>{}</code> <p>Returns:</p> Type Description <code>Job</code> <p>Any|None: Task.</p> Source code in <code>src/qtasks/timers/async_timer.py</code> <pre><code>def add_task(\n    self,\n    *args: Annotated[\n        Any,\n        Doc(\"\"\"\n                args of the task.\n\n                Default: `()`.\n                \"\"\"),\n    ],\n    task_name: Annotated[\n        str,\n        Doc(\"\"\"\n                Task name.\n                \"\"\"),\n    ],\n    priority: Annotated[\n        int | None,\n        Doc(\"\"\"\n                The task has priority.\n\n                Default: Task priority value.\n                \"\"\"),\n    ] = None,\n    timeout: Annotated[\n        float | None,\n        Doc(\"\"\"\n                Task timeout.\n\n                If specified, the task is returned via `qtasks.results.AsyncTask`.\n                \"\"\"),\n    ] = None,\n    trigger: Annotated[\n        Any,\n        Doc(\"\"\"\n                Task trigger.\n                \"\"\"),\n    ],\n    **kwargs: Annotated[\n        Any,\n        Doc(\"\"\"\n                kwargs tasks.\n\n                Default: `{}`.\n                \"\"\"),\n    ],\n) -&gt; Job:\n    \"\"\"\n    Adding a task.\n\n    Args:\n        task_name (str): The name of the task.\n        priority (int, optional): Task priority. Default is `0`.\n        args (tuple, optional): task args. Defaults to `()`.\n        kwargs (dict, optional): kwags tasks. Defaults to `{}`.\n\n    Returns:\n        Any|None: Task.\n    \"\"\"\n    self.tasks[task_name] = trigger\n\n    return self.scheduler.add_job(\n        self._add_task_async,\n        trigger=trigger,\n        args=(task_name, priority, args, kwargs),\n    )\n</code></pre>"},{"location":"api/timers/async_timer/#qtasks.timers.async_timer.AsyncTimer.run_forever","title":"<code>run_forever()</code>","text":"<p>Start Timer.</p> Source code in <code>src/qtasks/timers/async_timer.py</code> <pre><code>def run_forever(self):\n    \"\"\"Start Timer.\"\"\"\n    self.log.info(\"Starting...\")\n    try:\n        asyncio.run(\n            self._start_scheduler()\n        )\n    except KeyboardInterrupt:\n        self.log.info(\"Stopping...\")\n</code></pre>"},{"location":"api/timers/basetimer/","title":"BaseTimer - \u041f\u0438\u0448\u0435\u043c \u0441\u0432\u043e\u0439 \u0422\u0430\u0439\u043c\u0435\u0440","text":"<p>Base timer class.</p>"},{"location":"api/timers/basetimer/#qtasks.timers.base.BaseTimer","title":"<code>BaseTimer</code>","text":"<p>               Bases: <code>Generic[TAsyncFlag]</code>, <code>ABC</code></p> <p><code>BaseTimer</code> - An abstract class that is the basis for Timers.</p>"},{"location":"api/timers/basetimer/#qtasks.timers.base.BaseTimer--example","title":"Example","text":"<pre><code>from qtasks import QueueTasks\nfrom qtasks.timers.base import BaseTimer\n\nclass MyTimer(BaseTimer):\n    def __init__(self, app: QueueTasks):\n        super().__init__(app=app)\n        pass\n</code></pre> Source code in <code>src/qtasks/timers/base.py</code> <pre><code>class BaseTimer(Generic[TAsyncFlag], ABC):\n    \"\"\"\n    `BaseTimer` - An abstract class that is the basis for Timers.\n\n    ## Example\n\n    ```python\n    from qtasks import QueueTasks\n    from qtasks.timers.base import BaseTimer\n\n    class MyTimer(BaseTimer):\n        def __init__(self, app: QueueTasks):\n            super().__init__(app=app)\n            pass\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        app: Annotated[\n            Union[QueueTasks, aioQueueTasks],\n            Doc(\"\"\"\n                    Task.\n\n                    Default: `{qtasks.QueueTasks}` or `{qtasks.asyncio.QueueTasks}`.\n                    \"\"\"),\n        ],\n        log: Annotated[\n            Logger | None,\n            Doc(\"\"\"\n                    Logger.\n\n                    Default: `qtasks.logs.Logger`.\n                    \"\"\"),\n        ] = None,\n        config: Annotated[\n            QueueConfig | None,\n            Doc(\"\"\"\n                    Config.\n\n                    Default: `qtasks.configs.config.QueueConfig`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Timer initialization.\n\n        Args:\n            app (QueueTasks): Application.\n            log (Logger, optional): Logger. Default: `qtasks.logs.Logger`.\n            config (QueueConfig, optional): Config. Default: `qtasks.configs.config.QueueConfig`.\n        \"\"\"\n        self.app = app\n        self.config = config or self.app.config\n        self.log = (\n            log.with_subname(\"Timer\")\n            if log\n            else Logger(\n                name=self.app.name,\n                subname=\"Timer\",\n                default_level=self.config.logs_default_level_server,\n                format=self.config.logs_format,\n            )\n        )\n\n    @overload\n    def add_task(\n        self: BaseTimer[Literal[False]],\n        *args: Annotated[\n            Any,\n            Doc(\"\"\"\n                    args of the task.\n\n                    Default: `()`.\n                    \"\"\"),\n        ],\n        task_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int | None,\n            Doc(\"\"\"\n                    The task has priority.\n\n                    Default: Task priority value.\n                    \"\"\"),\n        ] = None,\n        timeout: Annotated[\n            float | None,\n            Doc(\"\"\"\n                    Task timeout.\n\n                    If specified, the task is returned via `qtasks.results.AsyncTask`.\n                    \"\"\"),\n        ] = None,\n        trigger: Annotated[\n            Any,\n            Doc(\"\"\"\n                    Task trigger.\n                    \"\"\"),\n        ],\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    kwargs tasks.\n\n                    Default: `{}`.\n                    \"\"\"),\n        ],\n    ) -&gt; Any | None: ...\n\n    @overload\n    async def add_task(\n        self: BaseTimer[Literal[True]],\n        *args: Annotated[\n            Any,\n            Doc(\"\"\"\n                    args of the task.\n\n                    Default: `()`.\n                    \"\"\"),\n        ],\n        task_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int | None,\n            Doc(\"\"\"\n                    The task has priority.\n\n                    Default: Task priority value.\n                    \"\"\"),\n        ] = None,\n        timeout: Annotated[\n            float | None,\n            Doc(\"\"\"\n                    Task timeout.\n\n                    If specified, the task is returned via `qtasks.results.AsyncTask`.\n                    \"\"\"),\n        ] = None,\n        trigger: Annotated[\n            Any,\n            Doc(\"\"\"\n                    Task trigger.\n                    \"\"\"),\n        ],\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    kwargs tasks.\n\n                    Default: `{}`.\n                    \"\"\"),\n        ],\n    ) -&gt; Any | None: ...\n\n    @abstractmethod\n    def add_task(\n        self,\n        *args: Annotated[\n            Any,\n            Doc(\"\"\"\n                    args of the task.\n\n                    Default: `()`.\n                    \"\"\"),\n        ],\n        task_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int | None,\n            Doc(\"\"\"\n                    The task has priority.\n\n                    Default: Task priority value.\n                    \"\"\"),\n        ] = None,\n        timeout: Annotated[\n            float | None,\n            Doc(\"\"\"\n                    Task timeout.\n\n                    If specified, the task is returned via `qtasks.results.AsyncTask`.\n                    \"\"\"),\n        ] = None,\n        trigger: Annotated[\n            Any,\n            Doc(\"\"\"\n                    Task trigger.\n                    \"\"\"),\n        ],\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    kwargs tasks.\n\n                    Default: `{}`.\n                    \"\"\"),\n        ],\n    ) -&gt; Any | None | Awaitable[Any | None]:\n        \"\"\"\n        Adding a task.\n\n        Args:\n            task_name (str): The name of the task.\n            trigger (Any, optional): Trigger values.\n            priority (int, optional): Task priority. Default is `0`.\n            args (tuple, optional): task args. Defaults to `()`.\n            kwargs (dict, optional): kwags tasks. Defaults to `{}`.\n\n        Returns:\n            Any|None: Task.\n        \"\"\"\n        pass\n\n    def run_forever(self):\n        \"\"\"Start Timer.\"\"\"\n        pass\n</code></pre>"},{"location":"api/timers/basetimer/#qtasks.timers.base.BaseTimer.__init__","title":"<code>__init__(app, log=None, config=None)</code>","text":"<p>Timer initialization.</p> <p>Parameters:</p> Name Type Description Default <code>app</code> <code>QueueTasks</code> <p>Application.</p> required <code>log</code> <code>Logger</code> <p>Logger. Default: <code>qtasks.logs.Logger</code>.</p> <code>None</code> <code>config</code> <code>QueueConfig</code> <p>Config. Default: <code>qtasks.configs.config.QueueConfig</code>.</p> <code>None</code> Source code in <code>src/qtasks/timers/base.py</code> <pre><code>def __init__(\n    self,\n    app: Annotated[\n        Union[QueueTasks, aioQueueTasks],\n        Doc(\"\"\"\n                Task.\n\n                Default: `{qtasks.QueueTasks}` or `{qtasks.asyncio.QueueTasks}`.\n                \"\"\"),\n    ],\n    log: Annotated[\n        Logger | None,\n        Doc(\"\"\"\n                Logger.\n\n                Default: `qtasks.logs.Logger`.\n                \"\"\"),\n    ] = None,\n    config: Annotated[\n        QueueConfig | None,\n        Doc(\"\"\"\n                Config.\n\n                Default: `qtasks.configs.config.QueueConfig`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    Timer initialization.\n\n    Args:\n        app (QueueTasks): Application.\n        log (Logger, optional): Logger. Default: `qtasks.logs.Logger`.\n        config (QueueConfig, optional): Config. Default: `qtasks.configs.config.QueueConfig`.\n    \"\"\"\n    self.app = app\n    self.config = config or self.app.config\n    self.log = (\n        log.with_subname(\"Timer\")\n        if log\n        else Logger(\n            name=self.app.name,\n            subname=\"Timer\",\n            default_level=self.config.logs_default_level_server,\n            format=self.config.logs_format,\n        )\n    )\n</code></pre>"},{"location":"api/timers/basetimer/#qtasks.timers.base.BaseTimer.add_task","title":"<code>add_task(*args, task_name, priority=None, timeout=None, trigger, **kwargs)</code>  <code>abstractmethod</code>","text":"<pre><code>add_task(*args: Annotated[Any, Doc('\\n                    args of the task.\\n\\n                    Default: `()`.\\n                    ')], task_name: Annotated[str, Doc('\\n                    Task name.\\n                    ')], priority: Annotated[int | None, Doc('\\n                    The task has priority.\\n\\n                    Default: Task priority value.\\n                    ')] = None, timeout: Annotated[float | None, Doc('\\n                    Task timeout.\\n\\n                    If specified, the task is returned via `qtasks.results.AsyncTask`.\\n                    ')] = None, trigger: Annotated[Any, Doc('\\n                    Task trigger.\\n                    ')], **kwargs: Annotated[Any, Doc('\\n                    kwargs tasks.\\n\\n                    Default: `{}`.\\n                    ')]) -&gt; Any | None\n</code></pre><pre><code>add_task(*args: Annotated[Any, Doc('\\n                    args of the task.\\n\\n                    Default: `()`.\\n                    ')], task_name: Annotated[str, Doc('\\n                    Task name.\\n                    ')], priority: Annotated[int | None, Doc('\\n                    The task has priority.\\n\\n                    Default: Task priority value.\\n                    ')] = None, timeout: Annotated[float | None, Doc('\\n                    Task timeout.\\n\\n                    If specified, the task is returned via `qtasks.results.AsyncTask`.\\n                    ')] = None, trigger: Annotated[Any, Doc('\\n                    Task trigger.\\n                    ')], **kwargs: Annotated[Any, Doc('\\n                    kwargs tasks.\\n\\n                    Default: `{}`.\\n                    ')]) -&gt; Any | None\n</code></pre> <p>Adding a task.</p> <p>Parameters:</p> Name Type Description Default <code>task_name</code> <code>str</code> <p>The name of the task.</p> required <code>trigger</code> <code>Any</code> <p>Trigger values.</p> required <code>priority</code> <code>int</code> <p>Task priority. Default is <code>0</code>.</p> <code>None</code> <code>args</code> <code>tuple</code> <p>task args. Defaults to <code>()</code>.</p> <code>()</code> <code>kwargs</code> <code>dict</code> <p>kwags tasks. Defaults to <code>{}</code>.</p> <code>{}</code> <p>Returns:</p> Type Description <code>Any | None | Awaitable[Any | None]</code> <p>Any|None: Task.</p> Source code in <code>src/qtasks/timers/base.py</code> <pre><code>@abstractmethod\ndef add_task(\n    self,\n    *args: Annotated[\n        Any,\n        Doc(\"\"\"\n                args of the task.\n\n                Default: `()`.\n                \"\"\"),\n    ],\n    task_name: Annotated[\n        str,\n        Doc(\"\"\"\n                Task name.\n                \"\"\"),\n    ],\n    priority: Annotated[\n        int | None,\n        Doc(\"\"\"\n                The task has priority.\n\n                Default: Task priority value.\n                \"\"\"),\n    ] = None,\n    timeout: Annotated[\n        float | None,\n        Doc(\"\"\"\n                Task timeout.\n\n                If specified, the task is returned via `qtasks.results.AsyncTask`.\n                \"\"\"),\n    ] = None,\n    trigger: Annotated[\n        Any,\n        Doc(\"\"\"\n                Task trigger.\n                \"\"\"),\n    ],\n    **kwargs: Annotated[\n        Any,\n        Doc(\"\"\"\n                kwargs tasks.\n\n                Default: `{}`.\n                \"\"\"),\n    ],\n) -&gt; Any | None | Awaitable[Any | None]:\n    \"\"\"\n    Adding a task.\n\n    Args:\n        task_name (str): The name of the task.\n        trigger (Any, optional): Trigger values.\n        priority (int, optional): Task priority. Default is `0`.\n        args (tuple, optional): task args. Defaults to `()`.\n        kwargs (dict, optional): kwags tasks. Defaults to `{}`.\n\n    Returns:\n        Any|None: Task.\n    \"\"\"\n    pass\n</code></pre>"},{"location":"api/timers/basetimer/#qtasks.timers.base.BaseTimer.run_forever","title":"<code>run_forever()</code>","text":"<p>Start Timer.</p> Source code in <code>src/qtasks/timers/base.py</code> <pre><code>def run_forever(self):\n    \"\"\"Start Timer.\"\"\"\n    pass\n</code></pre>"},{"location":"api/timers/sync_timer/","title":"SyncTimer","text":"<p>Sync timer for scheduling tasks.</p>"},{"location":"api/timers/sync_timer/#qtasks.timers.sync_timer.SyncTimer","title":"<code>SyncTimer</code>","text":"<p>               Bases: <code>BaseTimer[Literal[False]]</code></p> <p>A timer running through apscheduler that starts tasks.</p>"},{"location":"api/timers/sync_timer/#qtasks.timers.sync_timer.SyncTimer--example","title":"Example","text":"<pre><code>from qtasks import QueueTasks\nfrom qtasks.timers import SyncTimer\n\napp = QueueTasks()\ntimer = SyncTimer(app=app)\n\ntrigger = CronTrigger(second=\"*/10\") # Trigger every 10 seconds\ntimer.add_task(task_name=\"test\", trigger=trigger)\n\ntimer.run_forever()\n</code></pre> Source code in <code>src/qtasks/timers/sync_timer.py</code> <pre><code>class SyncTimer(BaseTimer[Literal[False]]):\n    \"\"\"\n    A timer running through apscheduler that starts tasks.\n\n    ## Example\n\n    ```python\n    from qtasks import QueueTasks\n    from qtasks.timers import SyncTimer\n\n    app = QueueTasks()\n    timer = SyncTimer(app=app)\n\n    trigger = CronTrigger(second=\"*/10\") # Trigger every 10 seconds\n    timer.add_task(task_name=\"test\", trigger=trigger)\n\n    timer.run_forever()\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        app: Annotated[\n            QueueTasks,\n            Doc(\"\"\"\n                    Application.\n                    \"\"\"),\n        ],\n        log: Annotated[\n            Logger | None,\n            Doc(\"\"\"\n                    Logger.\n\n                    Default: `qtasks.logs.Logger`.\n                    \"\"\"),\n        ] = None,\n        config: Annotated[\n            QueueConfig | None,\n            Doc(\"\"\"\n                    Config.\n\n                    Default: `qtasks.configs.config.QueueConfig`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Timer initialization.\n\n        Args:\n            app (QueueTasks): Application.\n            log (Logger, optional): Logger. Default: `qtasks.logs.Logger`.\n            config (QueueConfig, optional): Config. Default: `qtasks.configs.config.QueueConfig`.\n        \"\"\"\n        super().__init__(app=app, log=log, config=config)\n        self.app: QueueTasks\n        self.scheduler = BackgroundScheduler()\n        self.tasks = {}\n\n    def add_task(\n        self,\n        *args: Annotated[\n            Any,\n            Doc(\"\"\"\n                    args of the task.\n\n                    Default: `()`.\n                    \"\"\"),\n        ],\n        task_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int | None,\n            Doc(\"\"\"\n                    The task has priority.\n\n                    Default: Task priority value.\n                    \"\"\"),\n        ] = None,\n        timeout: Annotated[\n            float | None,\n            Doc(\"\"\"\n                    Task timeout.\n\n                    If specified, the task is returned via `qtasks.results.AsyncTask`.\n                    \"\"\"),\n        ] = None,\n        trigger: Annotated[\n            Any,\n            Doc(\"\"\"\n                    Task trigger.\n                    \"\"\"),\n        ],\n        **kwargs: Annotated[\n            Any,\n            Doc(\"\"\"\n                    kwargs tasks.\n\n                    Default: `{}`.\n                    \"\"\"),\n        ],\n    ) -&gt; Job:\n        \"\"\"\n        Adding a task.\n\n        Args:\n            task_name (str): The name of the task.\n            priority (int, optional): Task priority. Default is `0`.\n            args (tuple, optional): task args. Defaults to `()`.\n            kwargs (dict, optional): kwags tasks. Defaults to `{}`.\n\n        Returns:\n            Any|None: Task.\n        \"\"\"\n        self.tasks[task_name] = trigger\n\n        return self.scheduler.add_job(\n            self._add_task_sync,\n            trigger=trigger,\n            args=(task_name, priority, args, kwargs),\n        )\n\n    def _add_task_sync(\n        self,\n        task_name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int,\n            Doc(\"\"\"\n                    Task priority.\n\n                    Default: `0`.\n                    \"\"\"),\n        ] = 0,\n        args: Annotated[\n            tuple | None,\n            Doc(\"\"\"\n                    args of the task.\n\n                    Default: `()`.\n                    \"\"\"),\n        ] = None,\n        kwargs: Annotated[\n            dict | None,\n            Doc(\"\"\"\n                    kwargs tasks.\n\n                    Default: `{}`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Run the added task synchronously.\n\n        Args:\n            task_name (str): The name of the task.\n            priority (int, optional): Task priority. Default is `0`.\n            args (tuple, optional): task args. Defaults to `()`.\n            kwargs (dict, optional): kwags tasks. Defaults to `{}`.\n        \"\"\"\n        args, kwargs = args or (), kwargs or {}\n        task = self.app.add_task(\n            task_name, *args, priority=priority, timeout=None, **kwargs\n        )\n        self.log.info(f\"Task '{task_name}' sent with UUID: {task.uuid}\")\n\n    def run_forever(self):\n        \"\"\"Start Timer.\"\"\"\n        self.log.info(\"Starting...\")\n        try:\n            self.scheduler.start()\n            while True:\n                sleep(1)\n                pass\n        except KeyboardInterrupt:\n            self.log.info(\"Stopping...\")\n            self.scheduler.shutdown()\n</code></pre>"},{"location":"api/timers/sync_timer/#qtasks.timers.sync_timer.SyncTimer.__init__","title":"<code>__init__(app, log=None, config=None)</code>","text":"<p>Timer initialization.</p> <p>Parameters:</p> Name Type Description Default <code>app</code> <code>QueueTasks</code> <p>Application.</p> required <code>log</code> <code>Logger</code> <p>Logger. Default: <code>qtasks.logs.Logger</code>.</p> <code>None</code> <code>config</code> <code>QueueConfig</code> <p>Config. Default: <code>qtasks.configs.config.QueueConfig</code>.</p> <code>None</code> Source code in <code>src/qtasks/timers/sync_timer.py</code> <pre><code>def __init__(\n    self,\n    app: Annotated[\n        QueueTasks,\n        Doc(\"\"\"\n                Application.\n                \"\"\"),\n    ],\n    log: Annotated[\n        Logger | None,\n        Doc(\"\"\"\n                Logger.\n\n                Default: `qtasks.logs.Logger`.\n                \"\"\"),\n    ] = None,\n    config: Annotated[\n        QueueConfig | None,\n        Doc(\"\"\"\n                Config.\n\n                Default: `qtasks.configs.config.QueueConfig`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    Timer initialization.\n\n    Args:\n        app (QueueTasks): Application.\n        log (Logger, optional): Logger. Default: `qtasks.logs.Logger`.\n        config (QueueConfig, optional): Config. Default: `qtasks.configs.config.QueueConfig`.\n    \"\"\"\n    super().__init__(app=app, log=log, config=config)\n    self.app: QueueTasks\n    self.scheduler = BackgroundScheduler()\n    self.tasks = {}\n</code></pre>"},{"location":"api/timers/sync_timer/#qtasks.timers.sync_timer.SyncTimer.add_task","title":"<code>add_task(*args, task_name, priority=None, timeout=None, trigger, **kwargs)</code>","text":"<p>Adding a task.</p> <p>Parameters:</p> Name Type Description Default <code>task_name</code> <code>str</code> <p>The name of the task.</p> required <code>priority</code> <code>int</code> <p>Task priority. Default is <code>0</code>.</p> <code>None</code> <code>args</code> <code>tuple</code> <p>task args. Defaults to <code>()</code>.</p> <code>()</code> <code>kwargs</code> <code>dict</code> <p>kwags tasks. Defaults to <code>{}</code>.</p> <code>{}</code> <p>Returns:</p> Type Description <code>Job</code> <p>Any|None: Task.</p> Source code in <code>src/qtasks/timers/sync_timer.py</code> <pre><code>def add_task(\n    self,\n    *args: Annotated[\n        Any,\n        Doc(\"\"\"\n                args of the task.\n\n                Default: `()`.\n                \"\"\"),\n    ],\n    task_name: Annotated[\n        str,\n        Doc(\"\"\"\n                Task name.\n                \"\"\"),\n    ],\n    priority: Annotated[\n        int | None,\n        Doc(\"\"\"\n                The task has priority.\n\n                Default: Task priority value.\n                \"\"\"),\n    ] = None,\n    timeout: Annotated[\n        float | None,\n        Doc(\"\"\"\n                Task timeout.\n\n                If specified, the task is returned via `qtasks.results.AsyncTask`.\n                \"\"\"),\n    ] = None,\n    trigger: Annotated[\n        Any,\n        Doc(\"\"\"\n                Task trigger.\n                \"\"\"),\n    ],\n    **kwargs: Annotated[\n        Any,\n        Doc(\"\"\"\n                kwargs tasks.\n\n                Default: `{}`.\n                \"\"\"),\n    ],\n) -&gt; Job:\n    \"\"\"\n    Adding a task.\n\n    Args:\n        task_name (str): The name of the task.\n        priority (int, optional): Task priority. Default is `0`.\n        args (tuple, optional): task args. Defaults to `()`.\n        kwargs (dict, optional): kwags tasks. Defaults to `{}`.\n\n    Returns:\n        Any|None: Task.\n    \"\"\"\n    self.tasks[task_name] = trigger\n\n    return self.scheduler.add_job(\n        self._add_task_sync,\n        trigger=trigger,\n        args=(task_name, priority, args, kwargs),\n    )\n</code></pre>"},{"location":"api/timers/sync_timer/#qtasks.timers.sync_timer.SyncTimer.run_forever","title":"<code>run_forever()</code>","text":"<p>Start Timer.</p> Source code in <code>src/qtasks/timers/sync_timer.py</code> <pre><code>def run_forever(self):\n    \"\"\"Start Timer.\"\"\"\n    self.log.info(\"Starting...\")\n    try:\n        self.scheduler.start()\n        while True:\n            sleep(1)\n            pass\n    except KeyboardInterrupt:\n        self.log.info(\"Stopping...\")\n        self.scheduler.shutdown()\n</code></pre>"},{"location":"api/workers/async_worker/","title":"AsyncWorker","text":"<p>Init module for async worker.</p>"},{"location":"api/workers/async_worker/#qtasks.workers.async_worker.AsyncWorker","title":"<code>AsyncWorker</code>","text":"<p>               Bases: <code>BaseWorker</code>, <code>AsyncPluginMixin</code></p> <p>Worker, Receiving tasks from the Broker and processing them.</p>"},{"location":"api/workers/async_worker/#qtasks.workers.async_worker.AsyncWorker--example","title":"Example","text":"<pre><code>from qtasks import QueueTasks\nfrom qtasks.workers import AsyncWorker\n\nworker = AsyncWorker()\napp = QueueTasks(worker=worker)\n</code></pre> Source code in <code>src/qtasks/workers/async_worker.py</code> <pre><code>class AsyncWorker(BaseWorker, AsyncPluginMixin):\n    \"\"\"\n    Worker, Receiving tasks from the Broker and processing them.\n\n    ## Example\n\n    ```python\n    from qtasks import QueueTasks\n    from qtasks.workers import AsyncWorker\n\n    worker = AsyncWorker()\n    app = QueueTasks(worker=worker)\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Project name. This name is also used by the worker.\n\n                    Default: `QueueTasks`.\n                    \"\"\"),\n        ] = \"QueueTasks\",\n        broker: Annotated[\n            Optional[BaseBroker],\n            Doc(\"\"\"\n                    Broker.\n\n                    Default: `qtasks.brokers.AsyncRedisBroker`.\n                    \"\"\"),\n        ] = None,\n        log: Annotated[\n            Logger | None,\n            Doc(\"\"\"\n                    Logger.\n\n                    Default: `qtasks.logs.Logger`.\n                    \"\"\"),\n        ] = None,\n        config: Annotated[\n            QueueConfig | None,\n            Doc(\"\"\"\n                    Config.\n\n                    Default: `qtasks.configs.config.QueueConfig`.\n                    \"\"\"),\n        ] = None,\n        events: Annotated[\n            Optional[BaseEvents],\n            Doc(\"\"\"\n                    Events.\n\n                    Default: `qtasks.events.AsyncEvents`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Initializing an asynchronous worker.\n\n        Args:\n            name (str, optional): Project name. Default: \"QueueTasks\".\n            broker (BaseBroker, optional): Broker. Default: `None`.\n            log (Logger, optional): Logger. Default: `None`.\n            config (QueueConfig, optional): Config. Default: `None`.\n            events (BaseEvents, optional): Events. Default: `qtasks.events.AsyncEvents`.\n        \"\"\"\n        super().__init__(\n            name=name, broker=broker, log=log, config=config, events=events\n        )\n\n        self.events = self.events or AsyncEvents()\n        self.events: BaseEvents[Literal[True]]\n\n        self.broker = broker or AsyncRedisBroker(\n            name=self.name, log=self.log, config=self.config\n        )\n        self.broker: BaseBroker[Literal[True]]\n\n        self.queue = asyncio.PriorityQueue()\n\n        self._tasks: dict[str, TaskExecSchema] = {}\n        self._stop_event: asyncio.Event | None = None\n        self.semaphore = asyncio.Semaphore(self.config.max_tasks_process)\n        self.condition: asyncio.Condition | None = None\n\n        self.task_executor = AsyncTaskExecutor\n\n    async def worker(\n        self,\n        number: Annotated[\n            int,\n            Doc(\"\"\"\n                    Worker number.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Task processor.\n\n        Args:\n            number (int): Worker number.\n\n        Raises:\n            RuntimeError: Worker is not running.\n        \"\"\"\n        if not self._stop_event or not self.condition:\n            raise RuntimeError(\"Worker is not running\")\n\n        await self.events.fire(\"worker_running\", worker=self, number=number)\n\n        try:\n            while not self._stop_event.is_set():\n                async with self.condition:\n                    while self.queue.empty():\n                        await self.condition.wait()\n\n                task_broker: TaskPrioritySchema | None = await self.queue.get()\n                if task_broker is None:\n                    break\n                asyncio.create_task(self._execute_task(task_broker))\n        finally:\n            await self.events.fire(\"worker_stopping\", worker=self, number=number)\n\n    async def _execute_task(\n        self,\n        task_broker: Annotated[\n            TaskPrioritySchema,\n            Doc(\"\"\"\n                    Priority task diagram.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Performs task independently.\n\n        Args:\n            task_broker (TaskPrioritySchema): The priority task schema.\n        \"\"\"\n        async with self.semaphore:\n            model = TaskStatusProcessSchema(\n                task_name=task_broker.name,\n                priority=task_broker.priority,\n                created_at=task_broker.created_at,\n                updated_at=time(),\n                args=json.dumps(task_broker.args),\n                kwargs=json.dumps(task_broker.kwargs),\n            )\n\n            task_func = await self._task_exists(task_broker=task_broker)\n            if not task_func:\n                self.queue.task_done()\n                return\n\n            new_model = await self._plugin_trigger(\n                \"worker_execute_before\",\n                worker=self,\n                task_broker=task_broker,\n                task_func=task_func,\n                model=model,\n                return_last=True,\n            )\n            if new_model:\n                model = new_model.get(\"model\", model)\n\n            await self.broker.update(\n                name=f\"{self.name}:{task_broker.uuid}\", mapping=asdict(model)\n            )\n\n            await self.events.fire(\n                \"task_running\",\n                worker=self,\n                task_func=task_func,\n                task_broker=task_broker,\n            )\n            model = await self._run_task(task_func, task_broker)\n            await self.events.fire(\n                \"task_stopping\",\n                worker=self,\n                task_func=task_func,\n                task_broker=task_broker,\n                model=model,\n            )\n\n            await self.remove_finished_task(\n                task_func=task_func, task_broker=task_broker, model=model\n            )\n\n            await self._plugin_trigger(\n                \"worker_execute_after\",\n                task_func=task_func,\n                task_broker=task_broker,\n                model=model,\n            )\n\n            self.queue.task_done()\n\n    async def add(\n        self,\n        name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        uuid: Annotated[\n            UUID,\n            Doc(\"\"\"\n                    UUID of the task.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int,\n            Doc(\"\"\"\n                    Task priority.\n                    \"\"\"),\n        ],\n        created_at: Annotated[\n            float,\n            Doc(\"\"\"\n                    Creating a task in timestamp format.\n                    \"\"\"),\n        ],\n        args: Annotated[\n            tuple,\n            Doc(\"\"\"\n                    Task arguments of type args.\n                    \"\"\"),\n        ],\n        kwargs: Annotated[\n            dict,\n            Doc(\"\"\"\n                    Task arguments of type kwargs.\n                    \"\"\"),\n        ],\n    ) -&gt; Task:\n        \"\"\"\n        Adding a task to the queue.\n\n        Args:\n            name (str): Name of the task.\n            uuid (UUID): UUID of the task.\n            priority (int): Task priority.\n            created_at (float): Create a task in timestamp format.\n            args (tuple): Task arguments of type args.\n            kwargs (dict): Task arguments of type kwargs.\n\n            Raises:\n                RuntimeError: Worker is not running.\n        \"\"\"\n        if not self.condition:\n            raise RuntimeError(\"Worker is not running.\")\n\n        new_data = await self._plugin_trigger(\n            \"worker_add\",\n            worker=self,\n            task_name=name,\n            uuid=uuid,\n            priority=priority,\n            args=args,\n            kw=kwargs,\n            created_at=created_at,\n            return_last=True,\n        )\n        if new_data:\n            name = new_data.get(\"name\", name)\n            uuid = new_data.get(\"uuid\", uuid)\n            priority = new_data.get(\"priority\", priority)\n            args = new_data.get(\"args\", args)\n            kwargs = new_data.get(\"kw\", kwargs)\n            created_at = new_data.get(\"created_at\", created_at)\n\n        model = TaskPrioritySchema(\n            priority=priority,\n            uuid=uuid,\n            name=name,\n            args=list(args),\n            kwargs=kwargs,\n            created_at=created_at,\n            updated_at=created_at,\n        )\n        async with self.condition:\n            await self.queue.put(model)\n            self.condition.notify_all()\n        return Task(\n            status=TaskStatusEnum.NEW.value,\n            task_name=name,\n            uuid=uuid,\n            priority=priority,\n            args=args,\n            kwargs=kwargs,\n            created_at=datetime.fromtimestamp(created_at),\n            updated_at=datetime.fromtimestamp(created_at),\n        )\n\n    async def start(\n        self,\n        num_workers: Annotated[\n            int,\n            Doc(\"\"\"\n                    Number of workers.\n\n                    Default: `4`.\n                    \"\"\"),\n        ] = 4,\n    ) -&gt; None:\n        \"\"\"\n        Runs multiple task handlers.\n\n        Args:\n            num_workers (int, optional): Number of workers. Default: 4.\n        \"\"\"\n        self.num_workers = num_workers\n\n        if self.condition is None:\n            self.condition = asyncio.Condition()\n        if self._stop_event is None:\n            self._stop_event = asyncio.Event()\n        await self._plugin_trigger(\"worker_start\", worker=self)\n\n        loop = asyncio.get_event_loop()\n        workers = [\n            loop.create_task(self.worker(number)) for number in range(self.num_workers)\n        ]\n        await self._stop_event.wait()\n\n        for worker_task in workers:\n            worker_task.cancel()\n        await asyncio.gather(*workers, return_exceptions=True)\n\n    async def stop(self):\n        \"\"\"Stops workers.\"\"\"\n        await self._plugin_trigger(\"worker_stop\", worker=self)\n        if self._stop_event:\n            self._stop_event.set()\n\n    def update_config(\n        self,\n        config: Annotated[\n            QueueConfig,\n            Doc(\"\"\"\n                    Config.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Updates the broker config and semaphore.\n\n        Args:\n            config (QueueConfig): Config.\n        \"\"\"\n        self.config = config\n        self.semaphore = Semaphore(config.max_tasks_process)\n\n    async def _run_task(\n        self, task_func: TaskExecSchema, task_broker: TaskPrioritySchema\n    ) -&gt; TaskStatusSuccessSchema | TaskStatusErrorSchema | TaskStatusCancelSchema:\n        \"\"\"\n        Run the task function.\n\n        Args:\n            task_func (TaskExecSchema): Schema `qtasks.schemas.TaskExecSchema`.\n            task_broker(TaskPrioritySchema): Schema `qtasks.schemas.TaskPrioritySchema`.\n\n        Returns:\n            Any: The result of the task function.\n\n        Raises:\n            RuntimeError: task_executor is not defined.\n        \"\"\"\n        if not self.task_executor:\n            raise RuntimeError(\"task_executor is not defined.\")\n\n        if self.log:\n            self.log.info(\n                f\"Task {task_broker.uuid} ({task_broker.name}) is running, priority: {task_broker.priority}.\\n\"\n                f\"Arguments of the task: {task_broker.args}, {task_broker.kwargs}\"\n            )\n\n        new_data = await self._plugin_trigger(\n            \"worker_run_task_before\",\n            worker=self,\n            task_func=task_func,\n            task_broker=task_broker,\n            return_last=True,\n        )\n        if new_data:\n            task_func = new_data.get(\"task_func\", task_func)\n            task_broker = new_data.get(\"task_broker\", task_broker)\n\n        if self.task_middlewares_before:\n            task_func.add_middlewares_before(self.task_middlewares_before)\n        if self.task_middlewares_after:\n            task_func.add_middlewares_after(self.task_middlewares_after)\n\n        executor = (\n            task_func.executor if task_func.executor is not None else self.task_executor\n        )\n        task_executor: BaseTaskExecutor[Literal[True]] = executor(\n            task_func=task_func,\n            task_broker=task_broker,\n            log=self.log,\n            plugins=self.plugins,\n        )\n\n        try:\n            result = await task_executor.execute()\n            return await self._task_success(result, task_func, task_broker)\n        except TaskCancelError as e:\n            return await self._task_cancel(e, task_func, task_broker)\n        except BaseException as e:\n            return await self._task_error(e, task_func, task_broker)\n\n    async def _task_success(\n        self, result: Any, task_func: TaskExecSchema, task_broker: TaskPrioritySchema\n    ) -&gt; TaskStatusSuccessSchema:\n        \"\"\"Event of successful completion of a task.\"\"\"\n        model = TaskStatusSuccessSchema(\n            task_name=task_func.name,\n            priority=task_func.priority,\n            returning=result,\n            created_at=task_broker.created_at,\n            updated_at=time(),\n            args=json.dumps(task_broker.args),\n            kwargs=json.dumps(task_broker.kwargs),\n        )\n        if self.log:\n            self.log.info(\n                f\"Task {task_broker.uuid} successfully completed, result: {result}\"\n            )\n        return model\n\n    async def _task_error(\n        self, e, task_func: TaskExecSchema, task_broker: TaskPrioritySchema\n    ) -&gt; TaskStatusErrorSchema:\n        \"\"\"Event of task completion with an error.\"\"\"\n        trace = traceback.format_exc()\n\n        # plugin: retry\n        plugin_result = None\n\n        should_retry = task_func.retry and (\n            not task_func.retry_on_exc or type(e) in task_func.retry_on_exc\n        )\n        if should_retry and task_func.retry:\n            plugin_result = await self._plugin_trigger(\n                \"worker_task_error_retry\",\n                broker=self.broker,\n                task_func=task_func,\n                task_broker=task_broker,\n                trace=trace,\n                return_last=True,\n            )\n\n        model = TaskStatusErrorSchema(\n            task_name=task_func.name,\n            priority=task_func.priority,\n            traceback=trace,\n            created_at=task_broker.created_at,\n            updated_at=time(),\n            args=json.dumps(task_broker.args),\n            kwargs=json.dumps(task_broker.kwargs),\n        )\n        if plugin_result:\n            model: TaskStatusErrorSchema = plugin_result.get(\"model\", model)\n        #\n\n        if plugin_result and model.retry != 0:\n            if self.log:\n                self.log.error(\n                    f\"Task {task_broker.uuid} completed with an error and will be retried.\"\n                )\n        else:\n            if self.log:\n                self.log.error(f\"Task {task_broker.uuid} completed with an error:\\n{trace}\")\n        return model\n\n    async def _task_cancel(\n        self, e, task_func: TaskExecSchema, task_broker: TaskPrioritySchema\n    ) -&gt; TaskStatusCancelSchema:\n        \"\"\"Task cancellation event.\"\"\"\n        model = TaskStatusCancelSchema(\n            task_name=task_func.name,\n            priority=task_func.priority,\n            cancel_reason=str(e),\n            created_at=task_broker.created_at,\n            updated_at=time(),\n        )\n        if self.log:\n            self.log.error(f\"Task {task_broker.uuid} was cancelled because: {e}\")\n        return model\n\n    async def _task_exists(\n        self, task_broker: TaskPrioritySchema\n    ) -&gt; TaskExecSchema | None:\n        \"\"\"\n        Checking the existence of a task.\n\n        Args:\n            task_broker(TaskPrioritySchema): Schema `TaskPrioritySchema`.\n\n        Returns:\n            TaskExecSchema|None: Schema `TaskExecSchema` or `None`.\n        \"\"\"\n        try:\n            return self._tasks[task_broker.name]\n        except KeyError as e:\n            if self.log:\n                self.log.warning(f\"Task {e.args[0]} does not exist!\")\n            trace = traceback.format_exc()\n            model = TaskStatusErrorSchema(\n                task_name=task_broker.name,\n                priority=task_broker.priority,\n                traceback=trace,\n                created_at=task_broker.created_at,\n                updated_at=time(),\n            )\n            await self.remove_finished_task(\n                task_func=None, task_broker=task_broker, model=model\n            )\n            if self.log:\n                self.log.error(f\"Task {task_broker.name} completed with an error:\\n{trace}\")\n            return None\n\n    async def remove_finished_task(\n        self,\n        task_func: Annotated[\n            TaskExecSchema | None,\n            Doc(\"\"\"\n                    Diagram of the task function.\n                    \"\"\"),\n        ],\n        task_broker: Annotated[\n            TaskPrioritySchema,\n            Doc(\"\"\"\n                    Priority task diagram.\n                    \"\"\"),\n        ],\n        model: Annotated[\n            TaskStatusSuccessSchema | TaskStatusProcessSchema | TaskStatusErrorSchema | TaskStatusCancelSchema,\n            Doc(\"\"\"\n                    Model of the task result.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Updates storage data via the `self.storage.remove_finished_task` function.\n\n        Args:\n            task_func (TaskExecSchema, optional): Task function schema. Default: `None`.\n            task_broker (TaskPrioritySchema): The priority task schema.\n            model (TaskStatusSuccessSchema | TaskStatusProcessSchema | TaskStatusErrorSchema | TaskStatusCancelSchema): Model of the task result.\n        \"\"\"\n        new_data = await self._plugin_trigger(\n            \"worker_remove_finished_task\",\n            worker=self,\n            broker=self.broker,\n            task_func=task_func,\n            task_broker=task_broker,\n            model=model,\n            return_last=True,\n        )\n        if new_data:\n            task_broker, model = new_data.get(\"task_broker\", task_broker), new_data.get(\n                \"model\", model\n            )\n        await self.broker.remove_finished_task(task_broker, model)\n\n    def init_plugins(self):\n        \"\"\"Initializing plugins.\"\"\"\n        self.add_plugin(AsyncRetryPlugin(), trigger_names=[\"worker_task_error_retry\"])\n        self.add_plugin(\n            AsyncPydanticWrapperPlugin(),\n            trigger_names=[\n                \"task_executor_args_replace\",\n                \"task_executor_after_execute_result_replace\",\n            ],\n        )\n        self.add_plugin(\n            AsyncDependsPlugin(), trigger_names=[\n                \"task_executor_args_replace\",\n                \"task_executor_task_close\",\n                \"worker_stop\",\n                \"broker_stop\",\n                \"storage_stop\",\n                \"global_config_stop\"\n            ]\n        )\n        self.add_plugin(\n            AsyncStatePlugin(), trigger_names=[\"task_executor_args_replace\"]\n        )\n</code></pre>"},{"location":"api/workers/async_worker/#qtasks.workers.async_worker.AsyncWorker.__init__","title":"<code>__init__(name='QueueTasks', broker=None, log=None, config=None, events=None)</code>","text":"<p>Initializing an asynchronous worker.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Project name. Default: \"QueueTasks\".</p> <code>'QueueTasks'</code> <code>broker</code> <code>BaseBroker</code> <p>Broker. Default: <code>None</code>.</p> <code>None</code> <code>log</code> <code>Logger</code> <p>Logger. Default: <code>None</code>.</p> <code>None</code> <code>config</code> <code>QueueConfig</code> <p>Config. Default: <code>None</code>.</p> <code>None</code> <code>events</code> <code>BaseEvents</code> <p>Events. Default: <code>qtasks.events.AsyncEvents</code>.</p> <code>None</code> Source code in <code>src/qtasks/workers/async_worker.py</code> <pre><code>def __init__(\n    self,\n    name: Annotated[\n        str,\n        Doc(\"\"\"\n                Project name. This name is also used by the worker.\n\n                Default: `QueueTasks`.\n                \"\"\"),\n    ] = \"QueueTasks\",\n    broker: Annotated[\n        Optional[BaseBroker],\n        Doc(\"\"\"\n                Broker.\n\n                Default: `qtasks.brokers.AsyncRedisBroker`.\n                \"\"\"),\n    ] = None,\n    log: Annotated[\n        Logger | None,\n        Doc(\"\"\"\n                Logger.\n\n                Default: `qtasks.logs.Logger`.\n                \"\"\"),\n    ] = None,\n    config: Annotated[\n        QueueConfig | None,\n        Doc(\"\"\"\n                Config.\n\n                Default: `qtasks.configs.config.QueueConfig`.\n                \"\"\"),\n    ] = None,\n    events: Annotated[\n        Optional[BaseEvents],\n        Doc(\"\"\"\n                Events.\n\n                Default: `qtasks.events.AsyncEvents`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    Initializing an asynchronous worker.\n\n    Args:\n        name (str, optional): Project name. Default: \"QueueTasks\".\n        broker (BaseBroker, optional): Broker. Default: `None`.\n        log (Logger, optional): Logger. Default: `None`.\n        config (QueueConfig, optional): Config. Default: `None`.\n        events (BaseEvents, optional): Events. Default: `qtasks.events.AsyncEvents`.\n    \"\"\"\n    super().__init__(\n        name=name, broker=broker, log=log, config=config, events=events\n    )\n\n    self.events = self.events or AsyncEvents()\n    self.events: BaseEvents[Literal[True]]\n\n    self.broker = broker or AsyncRedisBroker(\n        name=self.name, log=self.log, config=self.config\n    )\n    self.broker: BaseBroker[Literal[True]]\n\n    self.queue = asyncio.PriorityQueue()\n\n    self._tasks: dict[str, TaskExecSchema] = {}\n    self._stop_event: asyncio.Event | None = None\n    self.semaphore = asyncio.Semaphore(self.config.max_tasks_process)\n    self.condition: asyncio.Condition | None = None\n\n    self.task_executor = AsyncTaskExecutor\n</code></pre>"},{"location":"api/workers/async_worker/#qtasks.workers.async_worker.AsyncWorker.add","title":"<code>add(name, uuid, priority, created_at, args, kwargs)</code>  <code>async</code>","text":"<p>Adding a task to the queue.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Name of the task.</p> required <code>uuid</code> <code>UUID</code> <p>UUID of the task.</p> required <code>priority</code> <code>int</code> <p>Task priority.</p> required <code>created_at</code> <code>float</code> <p>Create a task in timestamp format.</p> required <code>args</code> <code>tuple</code> <p>Task arguments of type args.</p> required <code>kwargs</code> <code>dict</code> <p>Task arguments of type kwargs.</p> required <code>Raises</code> <p>RuntimeError: Worker is not running.</p> required Source code in <code>src/qtasks/workers/async_worker.py</code> <pre><code>async def add(\n    self,\n    name: Annotated[\n        str,\n        Doc(\"\"\"\n                Task name.\n                \"\"\"),\n    ],\n    uuid: Annotated[\n        UUID,\n        Doc(\"\"\"\n                UUID of the task.\n                \"\"\"),\n    ],\n    priority: Annotated[\n        int,\n        Doc(\"\"\"\n                Task priority.\n                \"\"\"),\n    ],\n    created_at: Annotated[\n        float,\n        Doc(\"\"\"\n                Creating a task in timestamp format.\n                \"\"\"),\n    ],\n    args: Annotated[\n        tuple,\n        Doc(\"\"\"\n                Task arguments of type args.\n                \"\"\"),\n    ],\n    kwargs: Annotated[\n        dict,\n        Doc(\"\"\"\n                Task arguments of type kwargs.\n                \"\"\"),\n    ],\n) -&gt; Task:\n    \"\"\"\n    Adding a task to the queue.\n\n    Args:\n        name (str): Name of the task.\n        uuid (UUID): UUID of the task.\n        priority (int): Task priority.\n        created_at (float): Create a task in timestamp format.\n        args (tuple): Task arguments of type args.\n        kwargs (dict): Task arguments of type kwargs.\n\n        Raises:\n            RuntimeError: Worker is not running.\n    \"\"\"\n    if not self.condition:\n        raise RuntimeError(\"Worker is not running.\")\n\n    new_data = await self._plugin_trigger(\n        \"worker_add\",\n        worker=self,\n        task_name=name,\n        uuid=uuid,\n        priority=priority,\n        args=args,\n        kw=kwargs,\n        created_at=created_at,\n        return_last=True,\n    )\n    if new_data:\n        name = new_data.get(\"name\", name)\n        uuid = new_data.get(\"uuid\", uuid)\n        priority = new_data.get(\"priority\", priority)\n        args = new_data.get(\"args\", args)\n        kwargs = new_data.get(\"kw\", kwargs)\n        created_at = new_data.get(\"created_at\", created_at)\n\n    model = TaskPrioritySchema(\n        priority=priority,\n        uuid=uuid,\n        name=name,\n        args=list(args),\n        kwargs=kwargs,\n        created_at=created_at,\n        updated_at=created_at,\n    )\n    async with self.condition:\n        await self.queue.put(model)\n        self.condition.notify_all()\n    return Task(\n        status=TaskStatusEnum.NEW.value,\n        task_name=name,\n        uuid=uuid,\n        priority=priority,\n        args=args,\n        kwargs=kwargs,\n        created_at=datetime.fromtimestamp(created_at),\n        updated_at=datetime.fromtimestamp(created_at),\n    )\n</code></pre>"},{"location":"api/workers/async_worker/#qtasks.workers.async_worker.AsyncWorker.init_plugins","title":"<code>init_plugins()</code>","text":"<p>Initializing plugins.</p> Source code in <code>src/qtasks/workers/async_worker.py</code> <pre><code>def init_plugins(self):\n    \"\"\"Initializing plugins.\"\"\"\n    self.add_plugin(AsyncRetryPlugin(), trigger_names=[\"worker_task_error_retry\"])\n    self.add_plugin(\n        AsyncPydanticWrapperPlugin(),\n        trigger_names=[\n            \"task_executor_args_replace\",\n            \"task_executor_after_execute_result_replace\",\n        ],\n    )\n    self.add_plugin(\n        AsyncDependsPlugin(), trigger_names=[\n            \"task_executor_args_replace\",\n            \"task_executor_task_close\",\n            \"worker_stop\",\n            \"broker_stop\",\n            \"storage_stop\",\n            \"global_config_stop\"\n        ]\n    )\n    self.add_plugin(\n        AsyncStatePlugin(), trigger_names=[\"task_executor_args_replace\"]\n    )\n</code></pre>"},{"location":"api/workers/async_worker/#qtasks.workers.async_worker.AsyncWorker.remove_finished_task","title":"<code>remove_finished_task(task_func, task_broker, model)</code>  <code>async</code>","text":"<p>Updates storage data via the <code>self.storage.remove_finished_task</code> function.</p> <p>Parameters:</p> Name Type Description Default <code>task_func</code> <code>TaskExecSchema</code> <p>Task function schema. Default: <code>None</code>.</p> required <code>task_broker</code> <code>TaskPrioritySchema</code> <p>The priority task schema.</p> required <code>model</code> <code>TaskStatusSuccessSchema | TaskStatusProcessSchema | TaskStatusErrorSchema | TaskStatusCancelSchema</code> <p>Model of the task result.</p> required Source code in <code>src/qtasks/workers/async_worker.py</code> <pre><code>async def remove_finished_task(\n    self,\n    task_func: Annotated[\n        TaskExecSchema | None,\n        Doc(\"\"\"\n                Diagram of the task function.\n                \"\"\"),\n    ],\n    task_broker: Annotated[\n        TaskPrioritySchema,\n        Doc(\"\"\"\n                Priority task diagram.\n                \"\"\"),\n    ],\n    model: Annotated[\n        TaskStatusSuccessSchema | TaskStatusProcessSchema | TaskStatusErrorSchema | TaskStatusCancelSchema,\n        Doc(\"\"\"\n                Model of the task result.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Updates storage data via the `self.storage.remove_finished_task` function.\n\n    Args:\n        task_func (TaskExecSchema, optional): Task function schema. Default: `None`.\n        task_broker (TaskPrioritySchema): The priority task schema.\n        model (TaskStatusSuccessSchema | TaskStatusProcessSchema | TaskStatusErrorSchema | TaskStatusCancelSchema): Model of the task result.\n    \"\"\"\n    new_data = await self._plugin_trigger(\n        \"worker_remove_finished_task\",\n        worker=self,\n        broker=self.broker,\n        task_func=task_func,\n        task_broker=task_broker,\n        model=model,\n        return_last=True,\n    )\n    if new_data:\n        task_broker, model = new_data.get(\"task_broker\", task_broker), new_data.get(\n            \"model\", model\n        )\n    await self.broker.remove_finished_task(task_broker, model)\n</code></pre>"},{"location":"api/workers/async_worker/#qtasks.workers.async_worker.AsyncWorker.start","title":"<code>start(num_workers=4)</code>  <code>async</code>","text":"<p>Runs multiple task handlers.</p> <p>Parameters:</p> Name Type Description Default <code>num_workers</code> <code>int</code> <p>Number of workers. Default: 4.</p> <code>4</code> Source code in <code>src/qtasks/workers/async_worker.py</code> <pre><code>async def start(\n    self,\n    num_workers: Annotated[\n        int,\n        Doc(\"\"\"\n                Number of workers.\n\n                Default: `4`.\n                \"\"\"),\n    ] = 4,\n) -&gt; None:\n    \"\"\"\n    Runs multiple task handlers.\n\n    Args:\n        num_workers (int, optional): Number of workers. Default: 4.\n    \"\"\"\n    self.num_workers = num_workers\n\n    if self.condition is None:\n        self.condition = asyncio.Condition()\n    if self._stop_event is None:\n        self._stop_event = asyncio.Event()\n    await self._plugin_trigger(\"worker_start\", worker=self)\n\n    loop = asyncio.get_event_loop()\n    workers = [\n        loop.create_task(self.worker(number)) for number in range(self.num_workers)\n    ]\n    await self._stop_event.wait()\n\n    for worker_task in workers:\n        worker_task.cancel()\n    await asyncio.gather(*workers, return_exceptions=True)\n</code></pre>"},{"location":"api/workers/async_worker/#qtasks.workers.async_worker.AsyncWorker.stop","title":"<code>stop()</code>  <code>async</code>","text":"<p>Stops workers.</p> Source code in <code>src/qtasks/workers/async_worker.py</code> <pre><code>async def stop(self):\n    \"\"\"Stops workers.\"\"\"\n    await self._plugin_trigger(\"worker_stop\", worker=self)\n    if self._stop_event:\n        self._stop_event.set()\n</code></pre>"},{"location":"api/workers/async_worker/#qtasks.workers.async_worker.AsyncWorker.update_config","title":"<code>update_config(config)</code>","text":"<p>Updates the broker config and semaphore.</p> <p>Parameters:</p> Name Type Description Default <code>config</code> <code>QueueConfig</code> <p>Config.</p> required Source code in <code>src/qtasks/workers/async_worker.py</code> <pre><code>def update_config(\n    self,\n    config: Annotated[\n        QueueConfig,\n        Doc(\"\"\"\n                Config.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Updates the broker config and semaphore.\n\n    Args:\n        config (QueueConfig): Config.\n    \"\"\"\n    self.config = config\n    self.semaphore = Semaphore(config.max_tasks_process)\n</code></pre>"},{"location":"api/workers/async_worker/#qtasks.workers.async_worker.AsyncWorker.worker","title":"<code>worker(number)</code>  <code>async</code>","text":"<p>Task processor.</p> <p>Parameters:</p> Name Type Description Default <code>number</code> <code>int</code> <p>Worker number.</p> required <p>Raises:</p> Type Description <code>RuntimeError</code> <p>Worker is not running.</p> Source code in <code>src/qtasks/workers/async_worker.py</code> <pre><code>async def worker(\n    self,\n    number: Annotated[\n        int,\n        Doc(\"\"\"\n                Worker number.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Task processor.\n\n    Args:\n        number (int): Worker number.\n\n    Raises:\n        RuntimeError: Worker is not running.\n    \"\"\"\n    if not self._stop_event or not self.condition:\n        raise RuntimeError(\"Worker is not running\")\n\n    await self.events.fire(\"worker_running\", worker=self, number=number)\n\n    try:\n        while not self._stop_event.is_set():\n            async with self.condition:\n                while self.queue.empty():\n                    await self.condition.wait()\n\n            task_broker: TaskPrioritySchema | None = await self.queue.get()\n            if task_broker is None:\n                break\n            asyncio.create_task(self._execute_task(task_broker))\n    finally:\n        await self.events.fire(\"worker_stopping\", worker=self, number=number)\n</code></pre>"},{"location":"api/workers/baseworker/","title":"BaseWorker - \u041f\u0438\u0448\u0435\u043c \u0441\u0432\u043e\u0439 \u0412\u043e\u0440\u043a\u0435\u0440","text":"<p>Base worker class.</p>"},{"location":"api/workers/baseworker/#qtasks.workers.base.BaseWorker","title":"<code>BaseWorker</code>","text":"<p>               Bases: <code>Generic[TAsyncFlag]</code>, <code>ABC</code></p> <p><code>BaseWorker</code> - An abstract class that is the foundation for Workers.</p>"},{"location":"api/workers/baseworker/#qtasks.workers.base.BaseWorker--example","title":"Example","text":"<pre><code>from qtasks import QueueTasks\nfrom qtasks.workers.base import BaseWorker\n\nclass MyWorker(BaseWorker):\n    def __init__(self, name: str = None, broker: BaseBroker = None):\n        super().__init__(name=name, broker=broker)\n        pass\n</code></pre> Source code in <code>src/qtasks/workers/base.py</code> <pre><code>class BaseWorker(Generic[TAsyncFlag], ABC):\n    \"\"\"\n    `BaseWorker` - An abstract class that is the foundation for Workers.\n\n    ## Example\n\n    ```python\n    from qtasks import QueueTasks\n    from qtasks.workers.base import BaseWorker\n\n    class MyWorker(BaseWorker):\n        def __init__(self, name: str = None, broker: BaseBroker = None):\n            super().__init__(name=name, broker=broker)\n            pass\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Project name. This name can be used by Worker.\n\n                    Default: `QueueTasks`.\n                    \"\"\"),\n        ] = \"QueueTasks\",\n        broker: Annotated[\n            Optional[BaseBroker],\n            Doc(\"\"\"\n                    Broker `qtasks.brokers.base.BaseBroker`.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n        log: Annotated[\n            Logger | None,\n            Doc(\"\"\"\n                    Logger.\n\n                    Default: `qtasks.logs.Logger`.\n                    \"\"\"),\n        ] = None,\n        config: Annotated[\n            QueueConfig | None,\n            Doc(\"\"\"\n                    Config.\n\n                    Default: `qtasks.configs.config.QueueConfig`.\n                    \"\"\"),\n        ] = None,\n        events: Annotated[\n            Optional[BaseEvents],\n            Doc(\"\"\"\n                    Events.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Initializing the base worker.\n\n        Args:\n            name (str, optional): Project name. Default: None.\n            broker (BaseBroker, optional): Broker. Default: None.\n            log (Logger, optional): Logger. Default: None.\n            config (QueueConfig, optional): Config. Default: None.\n        \"\"\"\n        self.name = name\n        self.broker = broker\n        self.config = config or QueueConfig()\n\n        self.log = (\n            log.with_subname(\"Worker\")\n            if log\n            else Logger(\n                name=self.name or \"QueueTasks\",\n                subname=\"Worker\",\n                default_level=self.config.logs_default_level_server,\n                format=self.config.logs_format,\n            )\n        )\n\n        self._tasks: dict[str, TaskExecSchema] = {}\n        self.events: BaseEvents | None = events\n        self.task_middlewares_before: list[type[TaskMiddleware]] = []\n        self.task_middlewares_after: list[type[TaskMiddleware]] = []\n\n        self.task_executor: type[BaseTaskExecutor] | None = None\n\n        self.plugins: dict[str, list[BasePlugin]] = {}\n\n        self.num_workers = 0\n\n        self.init_plugins()\n\n    @overload\n    def add(\n        self: BaseWorker[Literal[False]],\n        name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        uuid: Annotated[\n            UUID,\n            Doc(\"\"\"\n                    UUID of the task.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int,\n            Doc(\"\"\"\n                    Task priority.\n                    \"\"\"),\n        ],\n        created_at: Annotated[\n            float,\n            Doc(\"\"\"\n                    Creating a task in timestamp format.\n                    \"\"\"),\n        ],\n        args: Annotated[\n            tuple,\n            Doc(\"\"\"\n                    Task arguments of type args.\n                    \"\"\"),\n        ],\n        kwargs: Annotated[\n            dict,\n            Doc(\"\"\"\n                    Task arguments of type kwargs.\n                    \"\"\"),\n        ],\n    ) -&gt; None: ...\n\n    @overload\n    async def add(\n        self: BaseWorker[Literal[True]],\n        name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        uuid: Annotated[\n            UUID,\n            Doc(\"\"\"\n                    UUID of the task.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int,\n            Doc(\"\"\"\n                    Task priority.\n                    \"\"\"),\n        ],\n        created_at: Annotated[\n            float,\n            Doc(\"\"\"\n                    Creating a task in timestamp format.\n                    \"\"\"),\n        ],\n        args: Annotated[\n            tuple,\n            Doc(\"\"\"\n                    Task arguments of type args.\n                    \"\"\"),\n        ],\n        kwargs: Annotated[\n            dict,\n            Doc(\"\"\"\n                    Task arguments of type kwargs.\n                    \"\"\"),\n        ],\n    ) -&gt; None: ...\n\n    @abstractmethod\n    def add(\n        self,\n        name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        uuid: Annotated[\n            UUID,\n            Doc(\"\"\"\n                    UUID of the task.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int,\n            Doc(\"\"\"\n                    Task priority.\n                    \"\"\"),\n        ],\n        created_at: Annotated[\n            float,\n            Doc(\"\"\"\n                    Creating a task in timestamp format.\n                    \"\"\"),\n        ],\n        args: Annotated[\n            tuple,\n            Doc(\"\"\"\n                    Task arguments of type args.\n                    \"\"\"),\n        ],\n        kwargs: Annotated[\n            dict,\n            Doc(\"\"\"\n                    Task arguments of type kwargs.\n                    \"\"\"),\n        ],\n    ) -&gt; None | Awaitable[None]:\n        \"\"\"\n        Adding a task to the queue.\n\n        Args:\n            name (str): Name of the task.\n            uuid (UUID): UUID of the task.\n            priority (int): Task priority.\n            created_at (float): Create a task in timestamp format.\n            args (tuple): Task arguments of type args.\n            kwargs (dict): Task arguments of type kwargs.\n        \"\"\"\n        pass\n\n    @overload\n    def start(\n        self: BaseWorker[Literal[False]],\n        num_workers: Annotated[\n            int | None,\n            Doc(\"\"\"\n                    Number of workers.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n    ) -&gt; None: ...\n\n    @overload\n    async def start(\n        self: BaseWorker[Literal[True]],\n        num_workers: Annotated[\n            int | None,\n            Doc(\"\"\"\n                    Number of workers.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n    ) -&gt; None: ...\n\n    @abstractmethod\n    def start(\n        self,\n        num_workers: Annotated[\n            int | None,\n            Doc(\"\"\"\n                    Number of workers.\n\n                    Default: `None`.\n                    \"\"\"),\n        ] = None,\n    ) -&gt; None | Awaitable[None]:\n        \"\"\"\n        Runs multiple task handlers. This function is enabled by the main `QueueTasks` instance via `run_forever`.\n\n        Args:\n            num_workers (int, optional): Number of workers. Default: 4.\n        \"\"\"\n        pass\n\n    @overload\n    def stop(self: BaseWorker[Literal[False]]) -&gt; None: ...\n\n    @overload\n    async def stop(self: BaseWorker[Literal[True]]) -&gt; None: ...\n\n    @abstractmethod\n    def stop(self) -&gt; None | Awaitable[None]:\n        \"\"\"Stops workers. This function is invoked by the main `QueueTasks` instance after the `run_forever` function completes.\"\"\"\n        pass\n\n    def update_config(\n        self,\n        config: Annotated[\n            QueueConfig,\n            Doc(\"\"\"\n                    Config.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Updates the broker config.\n\n        Args:\n            config (QueueConfig): Config.\n        \"\"\"\n        self.config = config\n        return\n\n    def add_plugin(\n        self,\n        plugin: Annotated[\n            BasePlugin,\n            Doc(\"\"\"\n                    Plugin.\n                    \"\"\"),\n        ],\n        trigger_names: Annotated[\n            list[str] | None,\n            Doc(\"\"\"\n                    The name of the triggers for the plugin.\n\n                    Default: Default: will be added to `Globals`.\n                    \"\"\"),\n        ] = None,\n    ) -&gt; None:\n        \"\"\"\n        Add a plugin to the class.\n\n        Args:\n            plugin (BasePlugin): Plugin\n            trigger_names (List[str], optional): The name of the triggers for the plugin. Default: will be added to `Globals`.\n        \"\"\"\n        trigger_names = trigger_names or [\"Globals\"]\n\n        for name in trigger_names:\n            if name not in self.plugins:\n                self.plugins.update({name: [plugin]})\n            else:\n                self.plugins[name].append(plugin)\n        return\n\n    def init_plugins(self):\n        \"\"\"Initializing plugins.\"\"\"\n        pass\n</code></pre>"},{"location":"api/workers/baseworker/#qtasks.workers.base.BaseWorker.__init__","title":"<code>__init__(name='QueueTasks', broker=None, log=None, config=None, events=None)</code>","text":"<p>Initializing the base worker.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Project name. Default: None.</p> <code>'QueueTasks'</code> <code>broker</code> <code>BaseBroker</code> <p>Broker. Default: None.</p> <code>None</code> <code>log</code> <code>Logger</code> <p>Logger. Default: None.</p> <code>None</code> <code>config</code> <code>QueueConfig</code> <p>Config. Default: None.</p> <code>None</code> Source code in <code>src/qtasks/workers/base.py</code> <pre><code>def __init__(\n    self,\n    name: Annotated[\n        str,\n        Doc(\"\"\"\n                Project name. This name can be used by Worker.\n\n                Default: `QueueTasks`.\n                \"\"\"),\n    ] = \"QueueTasks\",\n    broker: Annotated[\n        Optional[BaseBroker],\n        Doc(\"\"\"\n                Broker `qtasks.brokers.base.BaseBroker`.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n    log: Annotated[\n        Logger | None,\n        Doc(\"\"\"\n                Logger.\n\n                Default: `qtasks.logs.Logger`.\n                \"\"\"),\n    ] = None,\n    config: Annotated[\n        QueueConfig | None,\n        Doc(\"\"\"\n                Config.\n\n                Default: `qtasks.configs.config.QueueConfig`.\n                \"\"\"),\n    ] = None,\n    events: Annotated[\n        Optional[BaseEvents],\n        Doc(\"\"\"\n                Events.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    Initializing the base worker.\n\n    Args:\n        name (str, optional): Project name. Default: None.\n        broker (BaseBroker, optional): Broker. Default: None.\n        log (Logger, optional): Logger. Default: None.\n        config (QueueConfig, optional): Config. Default: None.\n    \"\"\"\n    self.name = name\n    self.broker = broker\n    self.config = config or QueueConfig()\n\n    self.log = (\n        log.with_subname(\"Worker\")\n        if log\n        else Logger(\n            name=self.name or \"QueueTasks\",\n            subname=\"Worker\",\n            default_level=self.config.logs_default_level_server,\n            format=self.config.logs_format,\n        )\n    )\n\n    self._tasks: dict[str, TaskExecSchema] = {}\n    self.events: BaseEvents | None = events\n    self.task_middlewares_before: list[type[TaskMiddleware]] = []\n    self.task_middlewares_after: list[type[TaskMiddleware]] = []\n\n    self.task_executor: type[BaseTaskExecutor] | None = None\n\n    self.plugins: dict[str, list[BasePlugin]] = {}\n\n    self.num_workers = 0\n\n    self.init_plugins()\n</code></pre>"},{"location":"api/workers/baseworker/#qtasks.workers.base.BaseWorker.add","title":"<code>add(name, uuid, priority, created_at, args, kwargs)</code>  <code>abstractmethod</code>","text":"<pre><code>add(name: Annotated[str, Doc('\\n                    Task name.\\n                    ')], uuid: Annotated[UUID, Doc('\\n                    UUID of the task.\\n                    ')], priority: Annotated[int, Doc('\\n                    Task priority.\\n                    ')], created_at: Annotated[float, Doc('\\n                    Creating a task in timestamp format.\\n                    ')], args: Annotated[tuple, Doc('\\n                    Task arguments of type args.\\n                    ')], kwargs: Annotated[dict, Doc('\\n                    Task arguments of type kwargs.\\n                    ')]) -&gt; None\n</code></pre><pre><code>add(name: Annotated[str, Doc('\\n                    Task name.\\n                    ')], uuid: Annotated[UUID, Doc('\\n                    UUID of the task.\\n                    ')], priority: Annotated[int, Doc('\\n                    Task priority.\\n                    ')], created_at: Annotated[float, Doc('\\n                    Creating a task in timestamp format.\\n                    ')], args: Annotated[tuple, Doc('\\n                    Task arguments of type args.\\n                    ')], kwargs: Annotated[dict, Doc('\\n                    Task arguments of type kwargs.\\n                    ')]) -&gt; None\n</code></pre> <p>Adding a task to the queue.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Name of the task.</p> required <code>uuid</code> <code>UUID</code> <p>UUID of the task.</p> required <code>priority</code> <code>int</code> <p>Task priority.</p> required <code>created_at</code> <code>float</code> <p>Create a task in timestamp format.</p> required <code>args</code> <code>tuple</code> <p>Task arguments of type args.</p> required <code>kwargs</code> <code>dict</code> <p>Task arguments of type kwargs.</p> required Source code in <code>src/qtasks/workers/base.py</code> <pre><code>@abstractmethod\ndef add(\n    self,\n    name: Annotated[\n        str,\n        Doc(\"\"\"\n                Task name.\n                \"\"\"),\n    ],\n    uuid: Annotated[\n        UUID,\n        Doc(\"\"\"\n                UUID of the task.\n                \"\"\"),\n    ],\n    priority: Annotated[\n        int,\n        Doc(\"\"\"\n                Task priority.\n                \"\"\"),\n    ],\n    created_at: Annotated[\n        float,\n        Doc(\"\"\"\n                Creating a task in timestamp format.\n                \"\"\"),\n    ],\n    args: Annotated[\n        tuple,\n        Doc(\"\"\"\n                Task arguments of type args.\n                \"\"\"),\n    ],\n    kwargs: Annotated[\n        dict,\n        Doc(\"\"\"\n                Task arguments of type kwargs.\n                \"\"\"),\n    ],\n) -&gt; None | Awaitable[None]:\n    \"\"\"\n    Adding a task to the queue.\n\n    Args:\n        name (str): Name of the task.\n        uuid (UUID): UUID of the task.\n        priority (int): Task priority.\n        created_at (float): Create a task in timestamp format.\n        args (tuple): Task arguments of type args.\n        kwargs (dict): Task arguments of type kwargs.\n    \"\"\"\n    pass\n</code></pre>"},{"location":"api/workers/baseworker/#qtasks.workers.base.BaseWorker.add_plugin","title":"<code>add_plugin(plugin, trigger_names=None)</code>","text":"<p>Add a plugin to the class.</p> <p>Parameters:</p> Name Type Description Default <code>plugin</code> <code>BasePlugin</code> <p>Plugin</p> required <code>trigger_names</code> <code>List[str]</code> <p>The name of the triggers for the plugin. Default: will be added to <code>Globals</code>.</p> <code>None</code> Source code in <code>src/qtasks/workers/base.py</code> <pre><code>def add_plugin(\n    self,\n    plugin: Annotated[\n        BasePlugin,\n        Doc(\"\"\"\n                Plugin.\n                \"\"\"),\n    ],\n    trigger_names: Annotated[\n        list[str] | None,\n        Doc(\"\"\"\n                The name of the triggers for the plugin.\n\n                Default: Default: will be added to `Globals`.\n                \"\"\"),\n    ] = None,\n) -&gt; None:\n    \"\"\"\n    Add a plugin to the class.\n\n    Args:\n        plugin (BasePlugin): Plugin\n        trigger_names (List[str], optional): The name of the triggers for the plugin. Default: will be added to `Globals`.\n    \"\"\"\n    trigger_names = trigger_names or [\"Globals\"]\n\n    for name in trigger_names:\n        if name not in self.plugins:\n            self.plugins.update({name: [plugin]})\n        else:\n            self.plugins[name].append(plugin)\n    return\n</code></pre>"},{"location":"api/workers/baseworker/#qtasks.workers.base.BaseWorker.init_plugins","title":"<code>init_plugins()</code>","text":"<p>Initializing plugins.</p> Source code in <code>src/qtasks/workers/base.py</code> <pre><code>def init_plugins(self):\n    \"\"\"Initializing plugins.\"\"\"\n    pass\n</code></pre>"},{"location":"api/workers/baseworker/#qtasks.workers.base.BaseWorker.start","title":"<code>start(num_workers=None)</code>  <code>abstractmethod</code>","text":"<pre><code>start(num_workers: Annotated[int | None, Doc('\\n                    Number of workers.\\n\\n                    Default: `None`.\\n                    ')] = None) -&gt; None\n</code></pre><pre><code>start(num_workers: Annotated[int | None, Doc('\\n                    Number of workers.\\n\\n                    Default: `None`.\\n                    ')] = None) -&gt; None\n</code></pre> <p>Runs multiple task handlers. This function is enabled by the main <code>QueueTasks</code> instance via <code>run_forever</code>.</p> <p>Parameters:</p> Name Type Description Default <code>num_workers</code> <code>int</code> <p>Number of workers. Default: 4.</p> <code>None</code> Source code in <code>src/qtasks/workers/base.py</code> <pre><code>@abstractmethod\ndef start(\n    self,\n    num_workers: Annotated[\n        int | None,\n        Doc(\"\"\"\n                Number of workers.\n\n                Default: `None`.\n                \"\"\"),\n    ] = None,\n) -&gt; None | Awaitable[None]:\n    \"\"\"\n    Runs multiple task handlers. This function is enabled by the main `QueueTasks` instance via `run_forever`.\n\n    Args:\n        num_workers (int, optional): Number of workers. Default: 4.\n    \"\"\"\n    pass\n</code></pre>"},{"location":"api/workers/baseworker/#qtasks.workers.base.BaseWorker.stop","title":"<code>stop()</code>  <code>abstractmethod</code>","text":"<pre><code>stop() -&gt; None\n</code></pre><pre><code>stop() -&gt; None\n</code></pre> <p>Stops workers. This function is invoked by the main <code>QueueTasks</code> instance after the <code>run_forever</code> function completes.</p> Source code in <code>src/qtasks/workers/base.py</code> <pre><code>@abstractmethod\ndef stop(self) -&gt; None | Awaitable[None]:\n    \"\"\"Stops workers. This function is invoked by the main `QueueTasks` instance after the `run_forever` function completes.\"\"\"\n    pass\n</code></pre>"},{"location":"api/workers/baseworker/#qtasks.workers.base.BaseWorker.update_config","title":"<code>update_config(config)</code>","text":"<p>Updates the broker config.</p> <p>Parameters:</p> Name Type Description Default <code>config</code> <code>QueueConfig</code> <p>Config.</p> required Source code in <code>src/qtasks/workers/base.py</code> <pre><code>def update_config(\n    self,\n    config: Annotated[\n        QueueConfig,\n        Doc(\"\"\"\n                Config.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Updates the broker config.\n\n    Args:\n        config (QueueConfig): Config.\n    \"\"\"\n    self.config = config\n    return\n</code></pre>"},{"location":"api/workers/sync_threadworker/","title":"SyncThreadWorker","text":"<p>Init module for sync worker.</p>"},{"location":"api/workers/sync_threadworker/#qtasks.workers.sync_worker.SyncThreadWorker","title":"<code>SyncThreadWorker</code>","text":"<p>               Bases: <code>BaseWorker</code>, <code>SyncPluginMixin</code></p> <p>Worker, Receiving tasks from the Broker and processing them.</p>"},{"location":"api/workers/sync_threadworker/#qtasks.workers.sync_worker.SyncThreadWorker--example","title":"Example","text":"<pre><code>from qtasks import QueueTasks\nfrom qtasks.workers import SyncThreadWorker\n\nworker = SyncThreadWorker()\napp = QueueTasks(worker=worker)\n</code></pre> Source code in <code>src/qtasks/workers/sync_worker.py</code> <pre><code>class SyncThreadWorker(BaseWorker, SyncPluginMixin):\n    \"\"\"\n    Worker, Receiving tasks from the Broker and processing them.\n\n    ## Example\n\n    ```python\n    from qtasks import QueueTasks\n    from qtasks.workers import SyncThreadWorker\n\n    worker = SyncThreadWorker()\n    app = QueueTasks(worker=worker)\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Project name. This name is also used by the worker.\n\n                    Default: `QueueTasks`.\n                    \"\"\"),\n        ] = \"QueueTasks\",\n        broker: Annotated[\n            Optional[BaseBroker],\n            Doc(\"\"\"\n                    Broker.\n\n                    Default: `qtasks.brokers.SyncRedisBroker`.\n                    \"\"\"),\n        ] = None,\n        log: Annotated[\n            Logger | None,\n            Doc(\"\"\"\n                    Logger.\n\n                    Default: `qtasks.logs.Logger`.\n                    \"\"\"),\n        ] = None,\n        config: Annotated[\n            QueueConfig | None,\n            Doc(\"\"\"\n                    Config.\n\n                    Default: `qtasks.configs.config.QueueConfig`.\n                    \"\"\"),\n        ] = None,\n        events: Annotated[\n            Optional[BaseEvents],\n            Doc(\"\"\"\n                    Events.\n\n                    Default: `qtasks.events.SyncEvents`.\n                    \"\"\"),\n        ] = None,\n    ):\n        \"\"\"\n        Initializing a synchronous worker.\n\n        Args:\n            name (str, optional): Project name. Default: \"QueueTasks\".\n            broker (BaseBroker, optional): Broker. Default: `None`.\n            log (Logger, optional): Logger. Default: `None`.\n            config (QueueConfig, optional): Config. Default: `None`.\n            events (BaseEvents, optional): Events. Default: `qtasks.events.SyncEvents`.\n        \"\"\"\n        super().__init__(\n            name=name, broker=broker, log=log, config=config, events=events\n        )\n\n        self.events = self.events or SyncEvents()\n        self.events: BaseEvents[Literal[False]]\n\n        self.broker = broker or SyncRedisBroker(\n            name=self.name, log=self.log, config=self.config\n        )\n        self.broker: BaseBroker[Literal[False]]\n\n        self.queue = PriorityQueue()\n        self._tasks: dict[str, TaskExecSchema] = {}\n        self._stop_event = Event()\n        self.lock = Lock()\n        self.threads: list[Thread] = []\n        self.semaphore = Semaphore(self.config.max_tasks_process)\n\n        self.task_executor = SyncTaskExecutor\n\n    def worker(\n        self,\n        number: Annotated[\n            int,\n            Doc(\"\"\"\n                    Worker number.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Task processor.\n\n        Args:\n            number (int): Worker number.\n\n        Raises:\n            RuntimeError: Worker is not running.\n        \"\"\"\n        if not self._stop_event:\n            raise RuntimeError(\"Worker is not running\")\n\n        self.events.fire(\"worker_running\", worker=self, number=number)\n\n        try:\n            while not self._stop_event.is_set():\n                with self.lock:\n                    if self.queue.empty():\n                        sleep(0.1)\n                        continue\n                    task_broker: TaskPrioritySchema = self.queue.get()\n\n                if task_broker is None:\n                    break\n                Thread(\n                    target=self._execute_task, args=(task_broker,), daemon=True\n                ).start()\n\n        finally:\n            self.events.fire(\"worker_stopping\", worker=self, number=number)\n\n    def _execute_task(\n        self,\n        task_broker: Annotated[\n            TaskPrioritySchema,\n            Doc(\"\"\"\n                    Priority task diagram.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Performs task independently.\n\n        Args:\n            task_broker (TaskPrioritySchema): The priority task schema.\n        \"\"\"\n        with self.semaphore:\n            model = TaskStatusProcessSchema(\n                task_name=task_broker.name,\n                priority=task_broker.priority,\n                created_at=task_broker.created_at,\n                updated_at=time(),\n                args=json.dumps(task_broker.args),\n                kwargs=json.dumps(task_broker.kwargs),\n            )\n\n            task_func = self._task_exists(task_broker=task_broker)\n            if not task_func:\n                self.queue.task_done()\n                return\n\n            new_model = self._plugin_trigger(\n                \"worker_execute_before\",\n                worker=self,\n                task_broker=task_broker,\n                task_func=task_func,\n                model=model,\n                return_last=True,\n            )\n            if new_model:\n                model = new_model.get(\"model\", model)\n\n            self.broker.update(\n                name=f\"{self.name}:{task_broker.uuid}\", mapping=asdict(model)\n            )\n\n            self.events.fire(\n                \"task_running\",\n                worker=self,\n                task_func=task_func,\n                task_broker=task_broker,\n            )\n            model = self._run_task(task_func=task_func, task_broker=task_broker)\n            self.events.fire(\n                \"task_stopping\",\n                worker=self,\n                task_func=task_func,\n                task_broker=task_broker,\n                model=model,\n            )\n\n            self.remove_finished_task(\n                task_func=task_func, task_broker=task_broker, model=model\n            )\n\n            self._plugin_trigger(\n                \"worker_execute_after\",\n                task_func=task_func,\n                task_broker=task_broker,\n                model=model,\n            )\n\n            self.queue.task_done()\n\n    def add(\n        self,\n        name: Annotated[\n            str,\n            Doc(\"\"\"\n                    Task name.\n                    \"\"\"),\n        ],\n        uuid: Annotated[\n            UUID,\n            Doc(\"\"\"\n                    UUID of the task.\n                    \"\"\"),\n        ],\n        priority: Annotated[\n            int,\n            Doc(\"\"\"\n                    Task priority.\n                    \"\"\"),\n        ],\n        created_at: Annotated[\n            float,\n            Doc(\"\"\"\n                    Creating a task in timestamp format.\n                    \"\"\"),\n        ],\n        args: Annotated[\n            tuple,\n            Doc(\"\"\"\n                    Task arguments of type args.\n                    \"\"\"),\n        ],\n        kwargs: Annotated[\n            dict,\n            Doc(\"\"\"\n                    Task arguments of type kwargs.\n                    \"\"\"),\n        ],\n    ) -&gt; Task:\n        \"\"\"\n        Adding a task to the queue.\n\n        Args:\n            name (str): Name of the task.\n            uuid (UUID): UUID of the task.\n            priority (int): Task priority.\n            created_at (float): Create a task in timestamp format.\n            args (tuple): Task arguments of type args.\n            kwargs (dict): Task arguments of type kwargs.\n        \"\"\"\n        new_data = self._plugin_trigger(\n            \"worker_add\",\n            worker=self,\n            task_name=name,\n            uuid=uuid,\n            priority=priority,\n            args=args,\n            kw=kwargs,\n            created_at=created_at,\n            return_last=True,\n        )\n        if new_data:\n            name = new_data.get(\"name\", name)\n            uuid = new_data.get(\"uuid\", uuid)\n            priority = new_data.get(\"priority\", priority)\n            args = new_data.get(\"args\", args)\n            kwargs = new_data.get(\"kw\", kwargs)\n            created_at = new_data.get(\"created_at\", created_at)\n\n        model = TaskPrioritySchema(\n            priority=priority,\n            uuid=uuid,\n            name=name,\n            args=list(args),\n            kwargs=kwargs,\n            created_at=created_at,\n            updated_at=created_at,\n        )\n        with self.lock:\n            self.queue.put(model)\n\n        return Task(\n            status=TaskStatusEnum.NEW.value,\n            task_name=name,\n            uuid=uuid,\n            priority=priority,\n            args=args,\n            kwargs=kwargs,\n            created_at=datetime.fromtimestamp(created_at),\n            updated_at=datetime.fromtimestamp(created_at),\n        )\n\n    def start(\n        self,\n        num_workers: Annotated[\n            int,\n            Doc(\"\"\"\n                    Number of workers.\n\n                    Default: `4`.\n                    \"\"\"),\n        ] = 4,\n    ) -&gt; None:\n        \"\"\"\n        Runs multiple task handlers.\n\n        Args:\n            num_workers (int, optional): Number of workers. Default: `4`.\n        \"\"\"\n        self.num_workers = num_workers\n        self._plugin_trigger(\"worker_start\", worker=self)\n\n        for number in range(self.num_workers):\n            thread = Thread(target=self.worker, args=(number,), daemon=True)\n            thread.start()\n            self.threads.append(thread)\n\n    def stop(self):\n        \"\"\"Stops workers.\"\"\"\n        self._plugin_trigger(\"worker_stop\", worker=self)\n        self._stop_event.set()\n        for thread in self.threads:\n            thread.join()\n\n    def update_config(self, config: QueueConfig):\n        \"\"\"Updates the config.\"\"\"\n        self.config = config\n        self.semaphore = Semaphore(config.max_tasks_process)\n\n    def _run_task(\n        self, task_func: TaskExecSchema, task_broker: TaskPrioritySchema\n    ) -&gt; TaskStatusSuccessSchema | TaskStatusErrorSchema | TaskStatusCancelSchema:\n        \"\"\"\n        Run the task function.\n\n        Args:\n            task_func (TaskExecSchema): Schema `qtasks.schemas.TaskExecSchema`.\n            task_broker(TaskPrioritySchema): Schema `qtasks.schemas.TaskPrioritySchema`.\n\n        Returns:\n            TaskStatusSuccessSchema|TaskStatusErrorSchema: The result of the task function.\n\n        Raises:\n            RuntimeError: task_executor is not defined.\n        \"\"\"\n        if not self.task_executor:\n            raise RuntimeError(\"task_executor is not defined.\")\n\n        if self.log:\n            self.log.info(\n                f\"Task {task_broker.uuid} ({task_broker.name}) is running, priority: {task_broker.priority}.\\n\"\n                f\"Arguments of the task: {task_broker.args}, {task_broker.kwargs}\"\n            )\n\n        new_data = self._plugin_trigger(\n            \"worker_run_task_before\",\n            worker=self,\n            task_func=task_func,\n            task_broker=task_broker,\n            return_last=True,\n        )\n        if new_data:\n            task_func = new_data.get(\"task_func\", task_func)\n            task_broker = new_data.get(\"task_broker\", task_broker)\n\n        if self.task_middlewares_before:\n            task_func.add_middlewares_before(self.task_middlewares_before)\n        if self.task_middlewares_after:\n            task_func.add_middlewares_after(self.task_middlewares_after)\n\n        executor = (\n            task_func.executor if task_func.executor is not None else self.task_executor\n        )\n        executor = executor(\n            task_func=task_func,\n            task_broker=task_broker,\n            log=self.log,\n            plugins=self.plugins,\n        )\n\n        try:\n            result = executor.execute()\n            return self._task_success(result, task_func, task_broker)\n        except TaskCancelError as e:\n            return self._task_cancel(e, task_func, task_broker)\n        except BaseException as e:\n            return self._task_error(e, task_func, task_broker)\n\n    def _task_success(\n        self, result: Any, task_func: TaskExecSchema, task_broker: TaskPrioritySchema\n    ) -&gt; TaskStatusSuccessSchema:\n        \"\"\"Event of successful completion of a task.\"\"\"\n        model = TaskStatusSuccessSchema(\n            task_name=task_func.name,\n            priority=task_func.priority,\n            returning=result,\n            created_at=task_broker.created_at,\n            updated_at=time(),\n            args=json.dumps(task_broker.args),\n            kwargs=json.dumps(task_broker.kwargs),\n        )\n        if self.log:\n            self.log.info(\n                f\"Task {task_broker.uuid} successfully completed, result: {result}\"\n            )\n        return model\n\n    def _task_error(\n        self, e, task_func: TaskExecSchema, task_broker: TaskPrioritySchema\n    ) -&gt; TaskStatusErrorSchema:\n        \"\"\"Event of task completion with an error.\"\"\"\n        trace = traceback.format_exc()\n\n        # plugin: retry\n        plugin_result = None\n\n        should_retry = task_func.retry and (\n            not task_func.retry_on_exc or type(e) in task_func.retry_on_exc\n        )\n        if should_retry and task_func.retry:\n            plugin_result = self._plugin_trigger(\n                \"worker_task_error_retry\",\n                broker=self.broker,\n                task_func=task_func,\n                task_broker=task_broker,\n                trace=trace,\n                return_last=True,\n            )\n\n        model = TaskStatusErrorSchema(\n            task_name=task_func.name,\n            priority=task_func.priority,\n            traceback=trace,\n            created_at=task_broker.created_at,\n            updated_at=time(),\n            args=json.dumps(task_broker.args),\n            kwargs=json.dumps(task_broker.kwargs),\n        )\n        if plugin_result:\n            model: TaskStatusErrorSchema = plugin_result.get(\"model\", model)\n        #\n\n        if plugin_result and model.retry != 0:\n            if self.log:\n                self.log.error(\n                    f\"Task {task_broker.uuid} completed with an error and will be retried.\"\n                )\n        else:\n            if self.log:\n                self.log.error(f\"Task {task_broker.uuid} completed with an error:\\n{trace}\")\n        return model\n\n    def _task_cancel(\n        self, e, task_func: TaskExecSchema, task_broker: TaskPrioritySchema\n    ) -&gt; TaskStatusCancelSchema:\n        \"\"\"Task cancellation event.\"\"\"\n        model = TaskStatusCancelSchema(\n            task_name=task_func.name,\n            priority=task_func.priority,\n            cancel_reason=str(e),\n            created_at=task_broker.created_at,\n            updated_at=time(),\n        )\n        if self.log:\n            self.log.error(f\"Task {task_broker.uuid} was cancelled because: {e}\")\n        return model\n\n    def _task_exists(\n        self, task_broker: TaskPrioritySchema\n    ) -&gt; TaskExecSchema | None:\n        \"\"\"\n        Checking the existence of a task.\n\n        Args:\n            task_broker(TaskPrioritySchema): Schema `TaskPrioritySchema`.\n\n        Returns:\n            TaskExecSchema|None: Schema `TaskExecSchema` or `None`.\n        \"\"\"\n        try:\n            return self._tasks[task_broker.name]\n        except KeyError as e:\n            if self.log:\n                self.log.warning(f\"Task {e.args[0]} does not exist!\")\n            trace = traceback.format_exc()\n            model = TaskStatusErrorSchema(\n                task_name=task_broker.name,\n                priority=task_broker.priority,\n                traceback=trace,\n                created_at=task_broker.created_at,\n                updated_at=time(),\n            )\n            self.remove_finished_task(\n                task_func=None, task_broker=task_broker, model=model\n            )\n            if self.log:\n                self.log.error(f\"Task {task_broker.name} completed with an error:\\n{trace}\")\n            return None\n\n    def remove_finished_task(\n        self,\n        task_func: Annotated[\n            TaskExecSchema | None,\n            Doc(\"\"\"\n                    Diagram of the task function.\n                    \"\"\"),\n        ],\n        task_broker: Annotated[\n            TaskPrioritySchema,\n            Doc(\"\"\"\n                    Priority task diagram.\n                    \"\"\"),\n        ],\n        model: Annotated[\n            TaskStatusSuccessSchema | TaskStatusProcessSchema | TaskStatusErrorSchema | TaskStatusCancelSchema,\n            Doc(\"\"\"\n                    Model of the task result.\n                    \"\"\"),\n        ],\n    ) -&gt; None:\n        \"\"\"\n        Updates storage data via the `self.storage.remove_finished_task` function.\n\n        Args:\n            task_func (TaskExecSchema, optional): Task function schema. Default: `None`.\n            task_broker (TaskPrioritySchema): The priority task schema.\n            model (TaskStatusSuccessSchema | TaskStatusProcessSchema | TaskStatusErrorSchema | TaskStatusCancelSchema): Model of the task result.\n        \"\"\"\n        new_data = self._plugin_trigger(\n            \"worker_remove_finished_task\",\n            worker=self,\n            broker=self.broker,\n            task_func=task_func,\n            task_broker=task_broker,\n            model=model,\n            return_last=True,\n        )\n        if new_data:\n            task_broker, model = new_data.get(\"task_broker\", task_broker), new_data.get(\n                \"model\", model\n            )\n        self.broker.remove_finished_task(task_broker, model)\n\n    def init_plugins(self):\n        \"\"\"Initializing plugins.\"\"\"\n        self.add_plugin(SyncRetryPlugin(), trigger_names=[\"worker_task_error_retry\"])\n        self.add_plugin(\n            SyncPydanticWrapperPlugin(),\n            trigger_names=[\n                \"task_executor_args_replace\",\n                \"task_executor_after_execute_result_replace\",\n            ],\n        )\n        self.add_plugin(\n            SyncDependsPlugin(), trigger_names=[\n                \"task_executor_args_replace\",\n                \"task_executor_task_close\",\n                \"worker_stop\",\n                \"broker_stop\",\n                \"storage_stop\",\n                \"global_config_stop\"\n            ]\n        )\n        self.add_plugin(\n            SyncStatePlugin(), trigger_names=[\"task_executor_args_replace\"]\n        )\n</code></pre>"},{"location":"api/workers/sync_threadworker/#qtasks.workers.sync_worker.SyncThreadWorker.__init__","title":"<code>__init__(name='QueueTasks', broker=None, log=None, config=None, events=None)</code>","text":"<p>Initializing a synchronous worker.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Project name. Default: \"QueueTasks\".</p> <code>'QueueTasks'</code> <code>broker</code> <code>BaseBroker</code> <p>Broker. Default: <code>None</code>.</p> <code>None</code> <code>log</code> <code>Logger</code> <p>Logger. Default: <code>None</code>.</p> <code>None</code> <code>config</code> <code>QueueConfig</code> <p>Config. Default: <code>None</code>.</p> <code>None</code> <code>events</code> <code>BaseEvents</code> <p>Events. Default: <code>qtasks.events.SyncEvents</code>.</p> <code>None</code> Source code in <code>src/qtasks/workers/sync_worker.py</code> <pre><code>def __init__(\n    self,\n    name: Annotated[\n        str,\n        Doc(\"\"\"\n                Project name. This name is also used by the worker.\n\n                Default: `QueueTasks`.\n                \"\"\"),\n    ] = \"QueueTasks\",\n    broker: Annotated[\n        Optional[BaseBroker],\n        Doc(\"\"\"\n                Broker.\n\n                Default: `qtasks.brokers.SyncRedisBroker`.\n                \"\"\"),\n    ] = None,\n    log: Annotated[\n        Logger | None,\n        Doc(\"\"\"\n                Logger.\n\n                Default: `qtasks.logs.Logger`.\n                \"\"\"),\n    ] = None,\n    config: Annotated[\n        QueueConfig | None,\n        Doc(\"\"\"\n                Config.\n\n                Default: `qtasks.configs.config.QueueConfig`.\n                \"\"\"),\n    ] = None,\n    events: Annotated[\n        Optional[BaseEvents],\n        Doc(\"\"\"\n                Events.\n\n                Default: `qtasks.events.SyncEvents`.\n                \"\"\"),\n    ] = None,\n):\n    \"\"\"\n    Initializing a synchronous worker.\n\n    Args:\n        name (str, optional): Project name. Default: \"QueueTasks\".\n        broker (BaseBroker, optional): Broker. Default: `None`.\n        log (Logger, optional): Logger. Default: `None`.\n        config (QueueConfig, optional): Config. Default: `None`.\n        events (BaseEvents, optional): Events. Default: `qtasks.events.SyncEvents`.\n    \"\"\"\n    super().__init__(\n        name=name, broker=broker, log=log, config=config, events=events\n    )\n\n    self.events = self.events or SyncEvents()\n    self.events: BaseEvents[Literal[False]]\n\n    self.broker = broker or SyncRedisBroker(\n        name=self.name, log=self.log, config=self.config\n    )\n    self.broker: BaseBroker[Literal[False]]\n\n    self.queue = PriorityQueue()\n    self._tasks: dict[str, TaskExecSchema] = {}\n    self._stop_event = Event()\n    self.lock = Lock()\n    self.threads: list[Thread] = []\n    self.semaphore = Semaphore(self.config.max_tasks_process)\n\n    self.task_executor = SyncTaskExecutor\n</code></pre>"},{"location":"api/workers/sync_threadworker/#qtasks.workers.sync_worker.SyncThreadWorker.add","title":"<code>add(name, uuid, priority, created_at, args, kwargs)</code>","text":"<p>Adding a task to the queue.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Name of the task.</p> required <code>uuid</code> <code>UUID</code> <p>UUID of the task.</p> required <code>priority</code> <code>int</code> <p>Task priority.</p> required <code>created_at</code> <code>float</code> <p>Create a task in timestamp format.</p> required <code>args</code> <code>tuple</code> <p>Task arguments of type args.</p> required <code>kwargs</code> <code>dict</code> <p>Task arguments of type kwargs.</p> required Source code in <code>src/qtasks/workers/sync_worker.py</code> <pre><code>def add(\n    self,\n    name: Annotated[\n        str,\n        Doc(\"\"\"\n                Task name.\n                \"\"\"),\n    ],\n    uuid: Annotated[\n        UUID,\n        Doc(\"\"\"\n                UUID of the task.\n                \"\"\"),\n    ],\n    priority: Annotated[\n        int,\n        Doc(\"\"\"\n                Task priority.\n                \"\"\"),\n    ],\n    created_at: Annotated[\n        float,\n        Doc(\"\"\"\n                Creating a task in timestamp format.\n                \"\"\"),\n    ],\n    args: Annotated[\n        tuple,\n        Doc(\"\"\"\n                Task arguments of type args.\n                \"\"\"),\n    ],\n    kwargs: Annotated[\n        dict,\n        Doc(\"\"\"\n                Task arguments of type kwargs.\n                \"\"\"),\n    ],\n) -&gt; Task:\n    \"\"\"\n    Adding a task to the queue.\n\n    Args:\n        name (str): Name of the task.\n        uuid (UUID): UUID of the task.\n        priority (int): Task priority.\n        created_at (float): Create a task in timestamp format.\n        args (tuple): Task arguments of type args.\n        kwargs (dict): Task arguments of type kwargs.\n    \"\"\"\n    new_data = self._plugin_trigger(\n        \"worker_add\",\n        worker=self,\n        task_name=name,\n        uuid=uuid,\n        priority=priority,\n        args=args,\n        kw=kwargs,\n        created_at=created_at,\n        return_last=True,\n    )\n    if new_data:\n        name = new_data.get(\"name\", name)\n        uuid = new_data.get(\"uuid\", uuid)\n        priority = new_data.get(\"priority\", priority)\n        args = new_data.get(\"args\", args)\n        kwargs = new_data.get(\"kw\", kwargs)\n        created_at = new_data.get(\"created_at\", created_at)\n\n    model = TaskPrioritySchema(\n        priority=priority,\n        uuid=uuid,\n        name=name,\n        args=list(args),\n        kwargs=kwargs,\n        created_at=created_at,\n        updated_at=created_at,\n    )\n    with self.lock:\n        self.queue.put(model)\n\n    return Task(\n        status=TaskStatusEnum.NEW.value,\n        task_name=name,\n        uuid=uuid,\n        priority=priority,\n        args=args,\n        kwargs=kwargs,\n        created_at=datetime.fromtimestamp(created_at),\n        updated_at=datetime.fromtimestamp(created_at),\n    )\n</code></pre>"},{"location":"api/workers/sync_threadworker/#qtasks.workers.sync_worker.SyncThreadWorker.init_plugins","title":"<code>init_plugins()</code>","text":"<p>Initializing plugins.</p> Source code in <code>src/qtasks/workers/sync_worker.py</code> <pre><code>def init_plugins(self):\n    \"\"\"Initializing plugins.\"\"\"\n    self.add_plugin(SyncRetryPlugin(), trigger_names=[\"worker_task_error_retry\"])\n    self.add_plugin(\n        SyncPydanticWrapperPlugin(),\n        trigger_names=[\n            \"task_executor_args_replace\",\n            \"task_executor_after_execute_result_replace\",\n        ],\n    )\n    self.add_plugin(\n        SyncDependsPlugin(), trigger_names=[\n            \"task_executor_args_replace\",\n            \"task_executor_task_close\",\n            \"worker_stop\",\n            \"broker_stop\",\n            \"storage_stop\",\n            \"global_config_stop\"\n        ]\n    )\n    self.add_plugin(\n        SyncStatePlugin(), trigger_names=[\"task_executor_args_replace\"]\n    )\n</code></pre>"},{"location":"api/workers/sync_threadworker/#qtasks.workers.sync_worker.SyncThreadWorker.remove_finished_task","title":"<code>remove_finished_task(task_func, task_broker, model)</code>","text":"<p>Updates storage data via the <code>self.storage.remove_finished_task</code> function.</p> <p>Parameters:</p> Name Type Description Default <code>task_func</code> <code>TaskExecSchema</code> <p>Task function schema. Default: <code>None</code>.</p> required <code>task_broker</code> <code>TaskPrioritySchema</code> <p>The priority task schema.</p> required <code>model</code> <code>TaskStatusSuccessSchema | TaskStatusProcessSchema | TaskStatusErrorSchema | TaskStatusCancelSchema</code> <p>Model of the task result.</p> required Source code in <code>src/qtasks/workers/sync_worker.py</code> <pre><code>def remove_finished_task(\n    self,\n    task_func: Annotated[\n        TaskExecSchema | None,\n        Doc(\"\"\"\n                Diagram of the task function.\n                \"\"\"),\n    ],\n    task_broker: Annotated[\n        TaskPrioritySchema,\n        Doc(\"\"\"\n                Priority task diagram.\n                \"\"\"),\n    ],\n    model: Annotated[\n        TaskStatusSuccessSchema | TaskStatusProcessSchema | TaskStatusErrorSchema | TaskStatusCancelSchema,\n        Doc(\"\"\"\n                Model of the task result.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Updates storage data via the `self.storage.remove_finished_task` function.\n\n    Args:\n        task_func (TaskExecSchema, optional): Task function schema. Default: `None`.\n        task_broker (TaskPrioritySchema): The priority task schema.\n        model (TaskStatusSuccessSchema | TaskStatusProcessSchema | TaskStatusErrorSchema | TaskStatusCancelSchema): Model of the task result.\n    \"\"\"\n    new_data = self._plugin_trigger(\n        \"worker_remove_finished_task\",\n        worker=self,\n        broker=self.broker,\n        task_func=task_func,\n        task_broker=task_broker,\n        model=model,\n        return_last=True,\n    )\n    if new_data:\n        task_broker, model = new_data.get(\"task_broker\", task_broker), new_data.get(\n            \"model\", model\n        )\n    self.broker.remove_finished_task(task_broker, model)\n</code></pre>"},{"location":"api/workers/sync_threadworker/#qtasks.workers.sync_worker.SyncThreadWorker.start","title":"<code>start(num_workers=4)</code>","text":"<p>Runs multiple task handlers.</p> <p>Parameters:</p> Name Type Description Default <code>num_workers</code> <code>int</code> <p>Number of workers. Default: <code>4</code>.</p> <code>4</code> Source code in <code>src/qtasks/workers/sync_worker.py</code> <pre><code>def start(\n    self,\n    num_workers: Annotated[\n        int,\n        Doc(\"\"\"\n                Number of workers.\n\n                Default: `4`.\n                \"\"\"),\n    ] = 4,\n) -&gt; None:\n    \"\"\"\n    Runs multiple task handlers.\n\n    Args:\n        num_workers (int, optional): Number of workers. Default: `4`.\n    \"\"\"\n    self.num_workers = num_workers\n    self._plugin_trigger(\"worker_start\", worker=self)\n\n    for number in range(self.num_workers):\n        thread = Thread(target=self.worker, args=(number,), daemon=True)\n        thread.start()\n        self.threads.append(thread)\n</code></pre>"},{"location":"api/workers/sync_threadworker/#qtasks.workers.sync_worker.SyncThreadWorker.stop","title":"<code>stop()</code>","text":"<p>Stops workers.</p> Source code in <code>src/qtasks/workers/sync_worker.py</code> <pre><code>def stop(self):\n    \"\"\"Stops workers.\"\"\"\n    self._plugin_trigger(\"worker_stop\", worker=self)\n    self._stop_event.set()\n    for thread in self.threads:\n        thread.join()\n</code></pre>"},{"location":"api/workers/sync_threadworker/#qtasks.workers.sync_worker.SyncThreadWorker.update_config","title":"<code>update_config(config)</code>","text":"<p>Updates the config.</p> Source code in <code>src/qtasks/workers/sync_worker.py</code> <pre><code>def update_config(self, config: QueueConfig):\n    \"\"\"Updates the config.\"\"\"\n    self.config = config\n    self.semaphore = Semaphore(config.max_tasks_process)\n</code></pre>"},{"location":"api/workers/sync_threadworker/#qtasks.workers.sync_worker.SyncThreadWorker.worker","title":"<code>worker(number)</code>","text":"<p>Task processor.</p> <p>Parameters:</p> Name Type Description Default <code>number</code> <code>int</code> <p>Worker number.</p> required <p>Raises:</p> Type Description <code>RuntimeError</code> <p>Worker is not running.</p> Source code in <code>src/qtasks/workers/sync_worker.py</code> <pre><code>def worker(\n    self,\n    number: Annotated[\n        int,\n        Doc(\"\"\"\n                Worker number.\n                \"\"\"),\n    ],\n) -&gt; None:\n    \"\"\"\n    Task processor.\n\n    Args:\n        number (int): Worker number.\n\n    Raises:\n        RuntimeError: Worker is not running.\n    \"\"\"\n    if not self._stop_event:\n        raise RuntimeError(\"Worker is not running\")\n\n    self.events.fire(\"worker_running\", worker=self, number=number)\n\n    try:\n        while not self._stop_event.is_set():\n            with self.lock:\n                if self.queue.empty():\n                    sleep(0.1)\n                    continue\n                task_broker: TaskPrioritySchema = self.queue.get()\n\n            if task_broker is None:\n                break\n            Thread(\n                target=self._execute_task, args=(task_broker,), daemon=True\n            ).start()\n\n    finally:\n        self.events.fire(\"worker_stopping\", worker=self, number=number)\n</code></pre>"},{"location":"architecture/","title":"QTasks Architecture","text":"<p>This section describes the architectural principles of QTasks: how the framework is structured at the level of components, execution threads, and data transfer. It does not cover user capabilities, APIs, or usage examples\u2014the focus is exclusively on internal structure and engineering solutions.</p> <p>QTasks is designed as a component task framework in which each element performs a strictly limited role and interacts with other elements through formalized contracts.</p> <p>QTasks is designed as a component-based task framework in which each element performs a strictly limited role and interacts with other elements through formalized data contracts. The architecture is focused on extensibility, predictable behavior, and the ability to replace any component without rewriting the entire system.</p>"},{"location":"architecture/#who-is-this-section-for","title":"Who is this section for?","text":"<p>The \"Architecture\" section is aimed at developers who:</p> <ul> <li>integrate QTasks into complex projects;</li> <li>develop their own components or plugins;</li> <li>analyze performance and execution flows;</li> <li>make architectural decisions at the system level.</li> </ul> <p>Understanding this section is not essential for everyday use of QTasks, but it becomes critical when deeply integrating and extending the framework.</p>"},{"location":"architecture/#basic-architecture-philosophy","title":"Basic architecture philosophy","text":"<p>QTasks is based on the principle of component minimalism. A component implements only its own responsibility and does not contain logic related to other levels of the system. This achieves:</p> <ul> <li>loose coupling between parts of the system;</li> <li>the ability to independently replace the broker, worker, storage, and auxiliary components;</li> <li>predictable task lifecycle;</li> <li>simplified testing and debugging.</li> </ul> <p>The architecture is not built around a specific transport, storage, or execution method. These details are moved outside the core and connected through the implementation of abstract interfaces.</p>"},{"location":"architecture/#component-model","title":"Component Model","text":"<p>QTasks consists of a set of logically independent components that form a task processing pipeline. The components do not call each other directly and do not exchange business objects. All interactions occur through data schemas and clearly defined entry points.</p> <p>This approach allows the system to be viewed as a set of isolated nodes connected by data flows, rather than as a monolithic process with shared state.</p> <p>This approach allows the system to be viewed as a set of isolated nodes connected by data flows, rather than as a monolithic process with a shared state.</p>"},{"location":"architecture/#control-and-data-flows","title":"Control and data flows","text":"<p>The QTasks architecture distinguishes between two types of flows:</p> <ul> <li>control flow \u2014 determines the order in which task processing stages are executed;</li> <li>data flow \u2014 describes what data structures are transferred between components and in what form.</li> </ul> <p>The task at each stage is represented not by a Python function or object, but by a data schema suitable for serialization, logging, storage, and transfer between processes or nodes.</p> <p>Asynchrony and parallelism are considered properties of specific components and their environment, rather than the global state of the entire system.</p>"},{"location":"architecture/#boundaries-of-responsibility","title":"Boundaries of responsibility","text":"<p>Each QTasks component has a clearly defined area of responsibility. Components are unaware of each other's internal implementation details and rely only on public contracts.</p> <p>This rule deliberately limits the \"intelligence\" of components, but makes the system resilient to increasing complexity and the emergence of new usage scenarios.</p>"},{"location":"architecture/#extension-without-changing-contracts","title":"Extension without changing contracts","text":"<p>QTasks does not have a \"core\" as a separate monolith that needs to be extended. The system consists of components linked by contracts \u2014 abstract classes and data schemas.</p> <p>Extension is achieved in two basic ways:</p> <ul> <li>replacing the implementation of a component while preserving its contract (e.g., different transport, different storage model, different executor);</li> <li>adding new components or extension mechanisms that connect to existing flows without breaking existing contracts.</li> </ul> <p>The key principle here is system evolution through contracts: as long as the contract is stable, the internals of the component can be changed freely, and the ecosystem around it remains compatible.</p>"},{"location":"architecture/configuration/","title":"Configuration","text":"<p>This page describes the architectural model of configuration in QTasks: how it is structured, how it is distributed among components, and how parameter changes are automatically reflected throughout the system.</p> <p>Unlike configurations distributed across components or tied to global variables, QTasks uses a single, typed configuration source.</p>"},{"location":"architecture/configuration/#unified-configuration-scheme","title":"Unified configuration scheme","text":"<p>All QTasks configuration is stored in a single dataclass scheme \u2014 <code>QueueConfig</code>.</p> <p>A configuration instance:</p> <ul> <li>is created by default when <code>QueueTasks</code> is initialized;</li> <li>is available as <code>app.config</code>;</li> <li>is passed to all components when they are created as a parameter <code>config=config</code>;</li> <li>is saved by components as <code>self.config</code>.</li> </ul> <p>If a component does not receive a configuration explicitly, it must create its own instance of <code>QueueConfig</code>. This allows components to be used in isolation, without depending on the global state of the application.</p>"},{"location":"architecture/configuration/#configuration-as-an-architectural-contract","title":"Configuration as an architectural contract","text":"<p><code>QueueConfig</code> is not just a set of parameters, but part of the architectural contract between components.</p> <p>Through configuration:</p> <ul> <li>component behavior parameters are set;</li> <li>consistency of settings between them is ensured;</li> <li>centralized updating of critical parameters is implemented.</li> </ul> <p>Components do not synchronize their settings directly with each other \u2014 they rely exclusively on the configuration.</p>"},{"location":"architecture/configuration/#change-subscription-mechanism","title":"Change subscription mechanism","text":"<p>One of the key features of <code>QueueConfig</code> is support for subscribing to parameter changes.</p> <p>Two mechanisms are used for this:</p> <ul> <li><code>subscribe</code> \u2014 registration of change handlers;</li> <li><code>_notify</code> \u2014 notification of subscribers when a value changes.</li> </ul> <p>Notification occurs automatically when the attribute is changed via <code>setattr</code>.</p>"},{"location":"architecture/configuration/#subscribe-function","title":"Subscribe function","text":"<p><code>subscribe</code> allows you to subscribe to changes in both existing and dynamically added configuration parameters.</p> <p>The subscriber receives the following arguments:</p> <ul> <li><code>config: QueueConfig</code> \u2014 configuration instance;</li> <li><code>key</code> \u2014 name of the changed parameter;</li> <li><code>value</code> \u2014 new parameter value.</li> </ul> <p>This allows a component or subsystem to respond to configuration changes without polling the state.</p>"},{"location":"architecture/configuration/#automatic-propagation-of-changes","title":"Automatic propagation of changes","text":"<p>By default, the subscription to configuration changes is registered in <code>QueueTasks.__init__</code>.</p> <p>It is linked to an internal method:</p> <pre><code>self._update_configs()\n</code></pre> <p>This method is responsible for synchronizing critical parameters between components.</p> <p>At the time of writing, it is used, in particular, to update component loggers:</p> <pre><code>component.log.update_logger(**kwargs)\n</code></pre> <p>Thus, a configuration change leads to an immediate update of the state of components without restarting them.</p>"},{"location":"architecture/configuration/#dynamic-configuration-parameters","title":"Dynamic configuration parameters","text":"<p>The <code>QueueConfig</code> architecture allows parameters to be added during execution.</p> <p>Such parameters:</p> <ul> <li>become part of the overall configuration;</li> <li>participate in the subscription mechanism;</li> <li>can be used by both components and plugins.</li> </ul> <p>This allows you to extend the configuration without changing the basic schema and without breaking component compatibility.</p>"},{"location":"architecture/configuration/#boundaries-of-responsibility","title":"Boundaries of responsibility","text":"<ul> <li><code>QueueConfig</code> is responsible for storing and distributing parameters;</li> <li>Components are responsible for responding to changes, not coordinating them.</li> <li>The configuration does not contain task execution logic.</li> </ul> <p>This separation makes the configuration system predictable, extensible, and safe for complex scenarios.</p>"},{"location":"architecture/configuration/#architectural-invariants","title":"Architectural Invariants","text":"<ul> <li>There is a single source of configuration in the system.</li> <li>Configuration is typed and serializable.</li> <li>Parameter changes are propagated automatically.</li> <li>Components are independent of global state.</li> </ul> <p>This configuration model allows QTasks to remain consistent even with dynamic changes during runtime.</p>"},{"location":"architecture/extensibility/","title":"Extensibility","text":"<p>This page describes QTasks' architectural approach to extensibility: the mechanisms by which the system adapts to new scenarios, scales, and integrates with external libraries and frameworks.</p> <p>Extensibility in QTasks is determined not by the number of settings, but by the structure of the architecture: a set of components, their contracts, and the ability to implement additional behavior.</p> <p>Extensibility in QTasks is determined not by the number of settings, but by the structure of the architecture: a set of components, their contracts, and the ability to implement additional behavior through plugins.</p>"},{"location":"architecture/extensibility/#basic-principle-of-extensibility","title":"Basic principle of extensibility","text":"<p>QTasks was originally designed so that extension occurs through composition, rather than through modification.</p> <p>The main factors of extensibility are:</p> <ul> <li>replacing or adding components;</li> <li>using plugins;</li> <li>complying with abstract class contracts;</li> <li>transferring data through schemas.</li> </ul> <p>Settings play a secondary role and are not the primary mechanism for scaling or integration.</p>"},{"location":"architecture/extensibility/#scaling-through-components","title":"Scaling through components","text":"<p>QTasks components are oriented towards horizontal scaling by default.</p> <p>This means that the system assumes:</p> <ul> <li>duplication of server instances of the application;</li> <li>collaboration between multiple workers;</li> <li>use of a common broker and storage.</li> </ul> <p>Changing the scaling model is achieved not through configuration flags, but through:</p> <ul> <li>replacing specific component implementations;</li> <li>changing their behavior using plugins;</li> <li>implementing custom load balancing strategies.</li> </ul> <p>Thus, scaling becomes an architectural decision rather than a configuration setting.</p>"},{"location":"architecture/extensibility/#plugins-as-an-extension-mechanism","title":"Plugins as an extension mechanism","text":"<p>Plugins in QTasks are used to introduce additional behavior into existing execution flows.</p> <p>Plugins can be used to:</p> <ul> <li>modify the task lifecycle;</li> <li>implement logging, metrics, and tracing;</li> <li>change the execution strategy without changing components;</li> <li>add integration layers.</li> </ul> <p>Plugins do not violate architectural invariants and do not require changes to component contracts.</p>"},{"location":"architecture/extensibility/#integration-with-external-libraries","title":"Integration with external libraries","text":"<p>QTasks allows integration with external libraries and frameworks with minimal restrictions.</p> <p>This is achieved by:</p> <ul> <li>the absence of signals and global dispatchers;</li> <li>minimal use of global variables;</li> <li>strict separation of responsibilities between components;</li> <li>transparent execution threads;</li> <li>explicit lifecycle management.</li> </ul> <p>As a result, QTasks can be used as a background task execution system within other applications without imposing its own management model on them.</p>"},{"location":"architecture/extensibility/#example-of-integration-with-fastapi","title":"Example of integration with FastAPI","text":"<p>Below is an architectural example of using QTasks together with FastAPI.</p>"},{"location":"architecture/extensibility/#defining-tasks","title":"Defining tasks","text":"<pre><code># tasks.py\nfrom qtasks import AsyncRouter\n\nrouter = AsyncRouter()\n\n@router.task()\nasync def example_task(x: int, y: int) -&gt; int:\n    return x + y\n</code></pre>"},{"location":"architecture/extensibility/#using-a-task-in-the-api","title":"Using a task in the API","text":"<pre><code># api.py\nfrom fastapi import FastAPI\nfrom .tasks import example_task\n\napp = FastAPI()\n\n@app.get(\"/\")\nasync def read_root():\n    task = await example_task.add_task(1, 2, timeout=50)\n    return {\"result\": task.returning}\n</code></pre>"},{"location":"architecture/extensibility/#qtasks-server","title":"QTasks server","text":"<pre><code># qtasks_app.py\nfrom qtasks.asyncio import QueueTasks\nfrom .tasks import router as tasks_router\n\napp = QueueTasks()\napp.include_router(tasks_router)\n\nif __name__ == \"__main__\":\n    app.run_forever()\n</code></pre>"},{"location":"architecture/extensibility/#architectural-analysis-of-the-example","title":"Architectural analysis of the example","text":"<p>In this scenario:</p> <ul> <li>The API calls the task directly through the task object received from the router;</li> <li>The call is made through a broker (e.g., Redis), without a direct connection to the QTasks server;</li> <li>The API waits for the result via <code>AsyncResult</code>, since <code>timeout</code> is specified;</li> <li>The QTasks server can run in another process or on another node;</li> <li>The server knows about the task thanks to <code>include_router</code>, rather than through a hard link to the API.</li> </ul> <p>The client only needs to pass the task to the broker\u2014the rest of the processing happens independently.</p>"},{"location":"architecture/extensibility/#about-context-management-and-global-variables","title":"About context management and global variables","text":"<p>The example above uses direct access to the task through the router.</p> <p>If you want to avoid global variables, the task can be declared via <code>@app.task</code>. In this case:</p> <ul> <li>the reference to <code>app</code> is stored inside <code>AsyncTask</code>;</li> <li><code>AsyncResult</code> is automatically linked to the required application instance;</li> <li>the task call remains transparent to the client. This emphasizes that the choice of integration model is an architectural decision made by the user, This emphasizes that the choice of integration model is an architectural decision made by the user, not a limitation of QTasks.</li> </ul>"},{"location":"architecture/extensibility/#architectural-invariants","title":"Architectural invariants","text":"<ul> <li>Extensibility is achieved through components and plugins.</li> <li>Scalability is a consequence of architecture, not configuration.</li> <li>QTasks does not impose its control model on external applications;</li> <li>integrations do not require intervention in the system core.</li> </ul> <p>This model allows QTasks to be used as a basis for complex and non-standard scenarios without losing controllability.</p>"},{"location":"architecture/task_flow/","title":"Task Execution","text":"<p>This page describes the complete lifecycle of a task in QTasks: from the moment it is sent by the client to the completion of execution on the server side and the receipt of the result. The description focuses on data flows, component contracts, and the order of interaction, rather than on the user API.</p> <p>The reference example uses a configuration with Redis as the broker and storage.</p>"},{"location":"architecture/task_flow/#general-component-interaction-diagram","title":"General Component Interaction Diagram","text":"<pre><code>sequenceDiagram\n    participant Client\n    participant Broker\n    participant Storage\n    participant Worker\n    participant TaskExecutor\n\n    Client-&gt;&gt;Broker: add_task()\n    Broker-&gt;&gt;Storage: add()\n    Broker--&gt;&gt;Client: Task(status=\"new\")\n\n    Broker-&gt;&gt;Broker: lpop(queue)\n    Broker-&gt;&gt;Storage: add_process()\n    Broker-&gt;&gt;Storage: get()\n    Broker-&gt;&gt;Worker: add()\n\nWorker-&gt;&gt;TaskExecutor: execute()\nTaskExecutor--&gt;&gt;Worker: result\n\nWorker-&gt;&gt;Broker: remove_finished_task()\nBroker-&gt;&gt;Storage: remove_finished_task()</code></pre> <p>The diagram reflects only the high-level order of interactions. The details of each stage are disclosed below.</p>"},{"location":"architecture/task_flow/#task-submission-by-the-client","title":"Task submission by the client","text":"<p>On the client side, the task exists exclusively as a data schema and is not linked to a specific method of execution.</p> <ol> <li>The client sends the task to the Broker via the <code>add_task</code> contract, which is internally translated into the <code>add</code> contract.</li> <li>The Broker passes the task data to the Storage via the <code>add</code> contract.</li> <li>The Storage serializes the task status and saves it, for example, for Redis:</li> </ol> <pre><code>hset(\"{storage_name}:{uuid}\", mapping=task_status.__dict__)\n</code></pre> <ol> <li>The broker adds a reference to the task to its own queue:</li> </ol> <pre><code>rpush(queue_name, \"{task_name}:{uuid}:{priority}\")\n</code></pre> <ol> <li>The broker immediately returns the <code>Task</code> schema with the status <code>new</code> to the client.</li> </ol> <p>At this stage, the task is considered registered but not yet processed.</p>"},{"location":"architecture/task_flow/#receiving-a-task-by-the-server","title":"Receiving a task by the server","text":"<p>A broker operating in server mode constantly polls the task queue.</p> <ol> <li>The broker executes <code>lpop(queue_name)</code>. 1.1. If the queue is empty, the broker suspends execution for <code>default_sleep</code> seconds (default <code>0.01</code>).</li> <li>Upon receiving a task, the broker notifies the storage about the start of processing according to the contract <code>add_process</code>.</li> <li>The Storage adds the task to the queue of tasks to be executed, for example:</li> </ol> <pre><code>zadd(queue_process, {task_data: priority})\n</code></pre> <ol> <li>The Broker requests the complete task data from the Storage using the <code>get</code> contract.</li> <li>The received data is transferred to the Worker via the <code>add</code> contract.</li> </ol>"},{"location":"architecture/task_flow/#execution-queue-in-worker","title":"Execution queue in Worker","text":"<ol> <li>The Worker converts the received data into <code>TaskPrioritySchema</code>.</li> <li>The schema is added to the internal execution queue <code>self.queue</code>.</li> <li>The <code>new</code> task status is immediately generated and returned.</li> <li>Subworkers running inside the Worker listen to one common queue.</li> <li>Tasks are captured on a first-come, first-served basis using <code>Condition</code> and <code>Semaphore(max_tasks_process)</code>.</li> </ol> <p>Thus, parallelism and asynchrony are limited and controlled at the Worker level.</p>"},{"location":"architecture/task_flow/#task-transition-to-execution-state","title":"Task transition to execution state","text":"<ol> <li>Before the actual launch, Worker forms <code>TaskStatusProcessSchema</code>.</li> <li>The status is transferred to the Broker via the <code>update</code> contract.</li> <li>The Broker transmits the update to the Storage:</li> </ol> <pre><code>   hset(\"{storage_name}:{uuid}\", mapping=asdict(model))\n</code></pre> <p>At this stage, the task is officially considered to be in progress.</p>"},{"location":"architecture/task_flow/#task-function-execution","title":"Task function execution","text":"<ol> <li>The worker retrieves the task description from <code>app._tasks</code> in the form of <code>TaskExecSchema</code>.</li> <li>This schema is attached to the task data.</li> <li>The worker passes the task to <code>TaskExecutor</code> via the <code>execute()</code> contract.</li> </ol> <p>Sequence inside <code>TaskExecutor</code>:</p> <ul> <li>call <code>execute_middlewares_before()</code>;</li> <li>call <code>before_execute()</code>;</li> <li>execute <code>run_task()</code>;</li> <li>for a generator task, delegate to <code>run_task_gen()</code>;</li> <li>call <code>after_execute()</code>;</li> <li>call <code>execute_middlewares_after()</code>;</li> <li>application of <code>decode()</code> (if enabled, default is yes).</li> </ul> <p><code>TaskExecutor</code> returns either the result or an exception to the Worker.</p>"},{"location":"architecture/task_flow/#task-completion","title":"Task completion","text":"<p>Depending on the result, the Worker forms one of the final schemas:</p> <ul> <li><code>TaskStatusSuccessSchema</code>;</li> <li><code>TaskStatusErrorSchema</code>;</li> <li> <p><code>TaskStatusCancelSchema</code>.</p> </li> <li> <p>The result is passed to <code>remove_finished_task()</code>.</p> </li> <li>The Worker sends the data to the Broker according to the <code>remove_finished_task()</code> contract.</li> <li>The Broker transfers it to the Storage.</li> </ul> <p>The Storage performs two actions:</p> <pre><code>hset(\"{storage_name}:{uuid}\", mapping=model.__dict__)\nzrem(queue_process, \"{task_name}:{uuid}:{priority}\")\n</code></pre>"},{"location":"architecture/task_flow/#redis-command-queue","title":"Redis command queue","text":"<p>When using Redis, write operations are performed via <code>(A)syncRedisCommandQueue</code>.</p> <ol> <li>Commands are added to the internal execution queue.</li> <li>If the queue does not exist, it is created automatically.</li> <li>The queue is executed sequentially.</li> <li>After the last command is executed, the queue is automatically closed.</li> </ol> <p>This mechanism reduces overhead and organizes write operations.</p>"},{"location":"architecture/task_flow/#getting-the-task-result","title":"Getting the task result","text":"<p>The task status is obtained through the Storage.</p> <ol> <li>According to the <code>get()</code> contract, data is retrieved and converted to <code>Task</code>.</li> <li>If <code>timeout</code> is specified in <code>add_task()</code>, <code>(A)syncResult</code> is used.</li> <li><code>(A)syncResult</code> periodically queries the Storage at intervals of <code>result_time_interval</code>.</li> <li>Waiting is implemented via:</li> <li><code>ThreadPoolExecutor(max_workers=1)</code> for sync mode;</li> <li><code>asyncio.wait_for()</code> for async mode.</li> <li>If the task status is not included in <code>result_statuses_end</code> (default: <code>SUCCESS</code>, <code>ERROR</code>, <code>CANCEL</code>), the wait continues.</li> </ol> <p>After reaching the final status, the result is returned to the client.</p>"},{"location":"architecture/task_flow/#architectural-invariants","title":"Architectural invariants","text":"<ul> <li>The task is represented by data schemas at all stages, not by executable objects.</li> <li>Components interact exclusively through contracts.</li> <li>The broker does not execute tasks and does not know their internal logic.</li> <li>The worker does not manage data storage.</li> <li>The storage does not contain execution logic.</li> </ul> <p>These invariants ensure predictable behavior and the ability to replace any component without changing the others.</p>"},{"location":"architecture/components/","title":"Components: General Information","text":"<p>This section describes the QTasks component model as the basis for the entire framework architecture. It provides a general understanding of what a component is in QTasks, what principles underlie their interaction, and how they form a coherent system.</p> <p>All subsequent pages in the \"Components\" tab expand and detail the provisions described here, focusing on specific aspects: abstract classes, classes that implement the QTask interface, and classes that implement the QTaskManager interface.</p> <p>All subsequent pages of the \"Components\" tab expand on and detail the concepts described here, focusing on specific aspects: abstract classes, data schemas, execution threads, asynchrony, and the plugin system.</p>"},{"location":"architecture/components/#what-is-a-component-in-qtasks","title":"What is a component in QTasks?","text":"<p>A component in QTasks is an isolated architectural element that implements a strictly defined responsibility and interacts with the rest of the system exclusively through contracts.</p> <p>A component:</p> <ul> <li>is unaware of the specific implementations of other components;</li> <li>does not store references to their internal state;</li> <li>does not contain business logic that goes beyond its area of responsibility.</li> </ul> <p>This separation allows QTasks to be viewed not as a single process, but as a system of interchangeable nodes connected by data flows.</p>"},{"location":"architecture/components/#main-and-additional-components","title":"Main and additional components","text":"<p>In the QTasks architecture, components are conditionally divided into two groups:</p> <ul> <li> <p>core components \u2014 form the mandatory minimum task processing pipeline;</p> </li> <li> <p>additional components \u2014 extend the behavior of the system without being critical for basic task execution.</p> </li> </ul> <p>The boundary between these groups is not based on importance, but on architectural necessity: core components define system invariants, while additional components use these invariants to extend functionality.</p> <p>Contracts and abstractions</p> <p>Component interaction is based on contracts expressed through abstract classes and data schemas.</p>"},{"location":"architecture/components/#contracts-and-abstractions","title":"Contracts and abstractions","text":"<p>Component interaction is based on contracts expressed through abstract classes and data schemas.</p> <p>A contract defines:</p> <ul> <li>what data the component accepts;</li> <li>what data it returns;</li> <li>at which points behavior extension is allowed.</li> </ul> <p>A component's implementation can be replaced entirely if it remains compatible with the contract. This is a key mechanism for the evolution of the QTasks architecture.</p>"},{"location":"architecture/components/#data-transfer-between-components","title":"Data Transfer Between Components","text":"<p>QTasks components do not exchange execution objects or Python process state. All data is transferred in the form of schemas \u2014 structured, serializable representations of the task state and its processing context.</p> <p>This approach provides:</p> <ul> <li>transparency of data flows;</li> <li>the ability to store and restore state;</li> <li>independence from the execution environment;</li> <li>simplified debugging and testing.</li> </ul>"},{"location":"architecture/components/#execution-flows-and-asynchrony","title":"Execution flows and asynchrony","text":"<p>Asynchrony and parallelism in QTasks are not global properties of the system. They are localized within specific components and managed independently by them.</p> <p>Each component:</p> <ul> <li>determines its own execution model (sync/async);</li> <li>controls its own queues, locks, and semaphores;</li> <li>does not impose its model on other components.</li> </ul> <p>This allows different execution models to be combined within a single system.</p>"},{"location":"architecture/components/#plugins-and-extension-points","title":"Plugins and extension points","text":"<p>Components provide predefined extension points where additional behavior can be implemented.</p> <p>Plugins:</p> <ul> <li>do not change component contracts;</li> <li>do not interfere with their internal state directly;</li> <li>are integrated into existing execution flows.</li> </ul> <p>Thus, extensibility is achieved without violating architectural invariants.</p>"},{"location":"architecture/components/#changing-and-replacing-components","title":"Changing and replacing components","text":"<p>The QTasks architecture allows for the following scenarios when working with components:</p> <ul> <li>creating your own component from scratch;</li> <li>replacing the standard implementation with a custom one;</li> <li>completely disabling an unnecessary component;</li> <li>using different implementations of the same component in different environments.</li> </ul> <p>The only mandatory condition is compliance with the contract expected by the rest of the system.</p>"},{"location":"architecture/components/#the-role-of-this-section","title":"The role of this section","text":"<p>The \"Components\" section is designed to develop architectural thinking when working with QTasks. It explains not only how components are structured, but also why the architecture looks the way it does.</p> <p>Understanding this section is critical when:</p> <p>Understanding this section is critical when:</p> <ul> <li>developing your own components;</li> <li>deeply integrating QTasks into your infrastructure;</li> <li>analyzing execution flows and performance;</li> <li>designing non-standard usage scenarios.</li> </ul>"},{"location":"architecture/components/abstract_classes/","title":"Components: abstract classes","text":"<p>This page describes the role and structure of abstract classes in the QTasks architecture. Abstract classes form component contracts and are a key mechanism for system-wide consistency.</p> <p>In QTasks, abstract classes are not an auxiliary element, but the foundation of the architecture: they define the permissible behavior of components, their interfaces, and extension points.</p>"},{"location":"architecture/components/abstract_classes/#role-of-abstract-classes","title":"Role of abstract classes","text":"<p>Each main and additional QTasks component must inherit from the corresponding abstract class. These classes:</p> <ul> <li>define the contract for the component's interaction with the system;</li> <li>fix the mandatory methods and their signatures;</li> <li>define the model of synchronous and asynchronous execution;</li> <li>serve as a single source of documentation and typing.</li> </ul> <p>If a component does not implement a mandatory method declared via <code>@abstractmethod</code>, its creation will result in a Python-level error before the system even starts.</p>"},{"location":"architecture/components/abstract_classes/#basic-naming","title":"Basic naming","text":"<p>All abstract component classes follow a single naming pattern:</p> <ul> <li><code>Base&lt;Component&gt;</code> \u2014 abstract class;</li> <li><code>(A)sync&lt;WorkingMethod&gt;&lt;Component&gt;</code> \u2014 concrete implementation.</li> </ul> <p>Example:</p> <ul> <li><code>BaseStorage</code> \u2014 storage component contract;</li> <li><code>AsyncRedisStorage</code> \u2014 asynchronous implementation of Redis-based storage.</li> </ul> <p>This naming convention makes the architecture self-documenting and allows you to immediately determine the role and execution model of the component.</p>"},{"location":"architecture/components/abstract_classes/#separation-into-async-and-sync","title":"Separation into Async and Sync","text":"<p>Abstract classes use parameterization via Generic[TAsyncFlag] for strict separation of synchronous and asynchronous components.</p> <ul> <li><code>TAsyncFlag = True</code> \u2014 asynchronous component;</li> <li><code>TAsyncFlag = False</code> \u2014 synchronous component.</li> </ul> <p>This separation is reflected in method types through <code>@overload</code>, for example:</p> <ul> <li><code>self: BaseBroker[Literal[True]]</code> \u2014 asynchronous context;</li> <li><code>self: BaseBroker[Literal[False]]</code> \u2014 synchronous context.</li> </ul> <p>Architectural rule:</p> <ul> <li>asynchronous components can work with synchronous functions;</li> <li>synchronous components do not allow asynchronous functions to be called.</li> </ul> <p>This restriction is intentionally strict and prevents implicit runtime errors.</p>"},{"location":"architecture/components/abstract_classes/#component-constructor","title":"Component constructor","text":"<p>Each abstract class defines its own <code>__init__</code>, through which the component initialization passes.</p> <p>Through the constructor:</p> <p>The constructor:</p> <ul> <li>passes mandatory dependencies;</li> <li>sets configuration parameters;</li> <li>fixes component invariants.</li> </ul> <p>The set of parameters varies between base classes, but the idea of centralized initialization is common to all components.</p>"},{"location":"architecture/components/abstract_classes/#required-methods-and-default-behavior","title":"Required methods and default behavior","text":"<p>Abstract classes in QTasks can contain:</p> <ul> <li>methods marked with <code>@abstractmethod</code>, which must be implemented;</li> <li>methods with default implementation;</li> <li>helper methods used within the component.</li> </ul> <p>Thus, the contract includes not only signatures, but also basic behavior, which is considered correct for a given component type.</p>"},{"location":"architecture/components/abstract_classes/#documentation-and-typing","title":"Documentation and typing","text":"<p>Each method in abstract classes is accompanied by documentation in the Google docstring format.</p> <p>This ensures:</p> <ul> <li>a consistent documentation style throughout QTasks;</li> <li>synchronization of the architectural description and the code;</li> <li>correct operation of the IDE, static analysis, and autocompletion.</li> </ul> <p>An abstract class is the canonical source of information about how a component should behave.</p>"},{"location":"architecture/components/abstract_classes/#abstract-plugin-classes","title":"Abstract plugin classes","text":"<p>The same architectural model applies to plugins.</p> <ul> <li>Base plugin class: <code>BasePlugin</code>;</li> <li>Specific implementations follow the same pattern <code>(A)sync&lt;WorkingMethod&gt;Plugin</code>.</li> </ul> <p>Example:</p> <ul> <li><code>BasePlugin</code>;</li> <li><code>AsyncPydanticWrapperPlugin</code>.</li> </ul> <p>This ensures consistency between components and plugins and simplifies their joint use.</p>"},{"location":"architecture/components/abstract_classes/#architectural-invariants","title":"Architectural invariants","text":"<ul> <li>Any component must inherit from <code>Base&lt;Component&gt;</code>;</li> <li>Failure to comply with the contract results in an error during class creation.</li> <li>Async/Sync separation is fixed at the type level.</li> <li>Documentation and typing are part of the contract.</li> </ul> <p>These rules make the QTasks architecture strict, predictable, and extensible without hidden agreements.</p>"},{"location":"architecture/components/plugin_system/","title":"Components: Plugin System","text":"<p>This page describes the architecture of the QTasks plugin system at the component level: how plugins are connected, where exactly they are called, and how they affect the execution flow.</p> <p>The plugin system is a built-in mechanism for extending components and does not exist separately from them.</p> <p>Each component determines for itself whether it supports plugins and at which points they can be called. Each component determines for itself whether it supports plugins and at which points they can be called.</p>"},{"location":"architecture/components/plugin_system/#plugins-as-part-of-a-component","title":"Plugins as part of a component","text":"<p>Each core QTasks component has its own set of plugins, accessible via <code>self.plugins</code>.</p> <p>Plugins:</p> <ul> <li>belong to a specific component;</li> <li>are called only at explicitly defined points (triggers);</li> <li>do not have direct access to the internal state of the component.</li> </ul> <p>Thus, behavior extension is controlled and predictable.</p>"},{"location":"architecture/components/plugin_system/#pluginmixin-and-enabling-the-plugin-system","title":"PluginMixin and enabling the plugin system","text":"<p>For a component to use plugins, it must inherit <code>AsyncPluginMixin</code> or <code>SyncPluginMixin</code>.</p> <p>Mixin provides:</p> <ul> <li>the <code>_plugin_trigger()</code> method \u2014 the point at which plugins are called;</li> <li>the <code>add_plugin()</code> method \u2014 a mechanism for registering plugins.</li> </ul> <p>Without connecting the appropriate mixin, the plugin system for the component is considered disabled.</p>"},{"location":"architecture/components/plugin_system/#calling-triggers","title":"Calling triggers","text":"<p>Plugin triggers are called explicitly within the component logic.</p> <p>Example of calling an asynchronous trigger:</p> <pre><code>new_results = await self._plugin_trigger(\n    \"storage_get_all\",\n    storage=self,\n    results=results,\n    return_last=True,\n)\n</code></pre> <p>A trigger is not a \"default\" event, but an architectural decision made by the component author. If the trigger is not called, the plugins are not executed.</p>"},{"location":"architecture/components/plugin_system/#plugin-registration","title":"Plugin registration","text":"<p>Plugins are added via <code>add_plugin()</code>.</p> <pre><code>self.add_plugin(\n    AsyncRetryPlugin(),\n    trigger_names=[\"worker_task_error_retry\"],\n)\n</code></pre> <p><code>add_plugin()</code> accepts:</p> <ul> <li><code>plugin</code> \u2014 a plugin instance;</li> <li><code>trigger_names</code> \u2014 a list of trigger names.</li> </ul> <p>If <code>trigger_names</code> is <code>None</code>, the plugin is considered global and will be called in all component triggers.</p> <p>Note</p> <p>In <code>QueueTasks()</code>, the <code>add_plugin()</code> method additionally accepts the parameter <code>component=\"\"</code>, which allows you to add a plugin not to <code>QueueTasks</code> itself, but to a specific component.</p> <p>Note</p> <p>Worker passes its plugins to <code>TaskExecutor</code> at the task assembly stage.</p> <p>This allows plugins to influence not only task management, but also the process of their immediate execution.</p>"},{"location":"architecture/components/plugin_system/#trigger-types","title":"Trigger types","text":"<p>From an architectural point of view, triggers are divided into two types.</p>"},{"location":"architecture/components/plugin_system/#unidirectional-triggers","title":"Unidirectional triggers","text":"<p>A unidirectional trigger is used for side effects and does not affect the further execution of the component code.</p> <ul> <li>The result of plugin execution is ignored.</li> <li>The trigger is used for logging, metrics, notifications, and similar tasks.</li> </ul>"},{"location":"architecture/components/plugin_system/#returnable-triggers","title":"Returnable triggers","text":"<p>A returnable trigger allows plugins to change data involved in further execution.</p> <ul> <li>plugin results can replace input parameters;</li> <li>the set of returnable values is strictly defined by the trigger contract;</li> <li>Most often, the same data that is passed to the trigger is changed.</li> </ul> <p>Which parameters can be changed is determined by the description of the specific trigger.</p>"},{"location":"architecture/components/plugin_system/#trigger-call-parameters","title":"Trigger call parameters","text":"<p>Each call to <code>_plugin_trigger()</code> has the following logical parameter structure:</p> <ul> <li><code>&lt;self&gt;</code> \u2014 the component that initiated the trigger call;</li> <li><code>[additional component]</code> \u2014 optional, if the trigger is logically related to another component;</li> <li><code>**parameters</code> \u2014 a dictionary of parameters passed to plugins.</li> </ul> <p>Additional execution control parameters:</p> <ul> <li><code>return_last: bool | None = None</code> \u2014 return only the last result, if available;</li> <li><code>safe: bool = True</code> \u2014 if <code>True</code>, plugin errors are not ignored;</li> <li><code>continue_on_fail: bool</code> \u2014 if <code>True</code>, other plugins continue to execute even if an error occurs.</li> </ul>"},{"location":"architecture/components/plugin_system/#component-developer-responsibility","title":"Component developer responsibility","text":"<p>If you are creating your own component and want to support plugins, you must:</p> <ul> <li>connect the appropriate <code>PluginMixin</code>;</li> <li>explicitly place <code>_plugin_trigger()</code> calls in the necessary places in the logic.</li> </ul> <p>If triggers are not added, the plugin system for the component does not actually exist.</p> <p>Similarly, if you want to completely disable plugins in a component, simply do not add triggers.</p>"},{"location":"architecture/components/plugin_system/#architectural-invariants","title":"Architectural invariants","text":"<ul> <li>Plugins belong to components, not to the system as a whole.</li> <li>Triggers are only called explicitly.</li> <li>Plugins do not violate component contracts.</li> <li>The plugin system extends behavior without changing the architectural foundations.</li> </ul> <p>The QTasks plugin system provides a controlled extension of the architecture without hidden dependencies or implicit side effects.</p>"},{"location":"architecture/components/schemas/","title":"Components: Data Schemas","text":"<p>This page describes the role of data schemas in the QTasks architecture and the rules for their use when components interact.</p> <p>Data schemas are the primary mechanism for transferring information between components. They form a strict, typed contract that replaces direct exchange of objects and execution state.</p>"},{"location":"architecture/components/schemas/#role-of-schemas-in-architecture","title":"Role of Schemas in Architecture","text":"<p>When data needs to be transferred from one component to another, both components must adhere to an agreed-upon data schema.</p> <p>Schemas:</p> <ul> <li>define the exact structure of the transmitted data;</li> <li>fix the state of the task at each stage of the life cycle;</li> <li>allow you to serialize, store, and restore data;</li> <li>serve as the basis for typing and static analysis.</li> </ul> <p>The only exception to this rule is adding a task to a Worker via the <code>add</code> contract, where data is passed as parameters and converted to schemas on the Worker side.</p>"},{"location":"architecture/components/schemas/#general-schema-rules","title":"General schema rules","text":"<p>All data schemas in QTasks are subject to uniform architectural rules.</p>"},{"location":"architecture/components/schemas/#1-strict-structure","title":"1. Strict structure","text":"<p>Each schema must be a dataclass-like structure with explicitly defined fields and types. This ensures:</p> <ul> <li>compatibility with <code>mypy</code> and other typing tools;</li> <li>predictability of the data structure;</li> <li>unambiguity of contracts between components.</li> </ul> <p>Schemas are not intended to store logic and should not contain behavior that goes beyond data representation.</p>"},{"location":"architecture/components/schemas/#2-schema-assembly-on-the-sender-side","title":"2. Schema assembly on the sender side","text":"<p>Schema formation always occurs in the sender component.</p> <p>This rule ensures that the receiving component:</p> <ul> <li>receives already validated data;</li> <li>does not depend on the details of structure formation;</li> <li>can work exclusively with the contract.</li> </ul> <p>The exception is Worker (<code>add</code>), which accepts task parameters and independently forms the corresponding schemas.</p>"},{"location":"architecture/components/schemas/#3-schema-stability","title":"3. Schema stability","text":"<p>A schema is considered part of a public architectural contract. Changes to schemas must be deliberate and compatible, as they directly affect the interaction of components and plugins.</p>"},{"location":"architecture/components/schemas/#key-qtasks-schemas","title":"Key QTasks schemas","text":"<p>Below are the main schemas used in the QTasks architecture and their purpose.</p>"},{"location":"architecture/components/schemas/#queueconfig","title":"QueueConfig","text":"<p>A configuration schema used by all components starting with <code>QueueTasks</code>. It defines the basic parameters of the system and is passed during component initialization.</p>"},{"location":"architecture/components/schemas/#task","title":"Task","text":"<p>The task result schema returned to the client. Represents the aggregated state of the task, taking into account its current or final status.</p>"},{"location":"architecture/components/schemas/#basetaskstatusschema","title":"BaseTaskStatusSchema","text":"<p>The basic task status schema. Used to represent the status of the task at individual stages of execution.</p> <p>Derived schemas:</p> <ul> <li><code>TaskStatusNewSchema</code>;</li> <li><code>TaskStatusProcessSchema</code>;</li> <li><code>TaskStatusSuccessSchema</code>;</li> <li><code>TaskStatusErrorSchema</code>;</li> <li><code>TaskStatusCancelSchema</code>.</li> </ul> <p>The main consumer of these schemas is the Storage component.</p>"},{"location":"architecture/components/schemas/#taskexecschema","title":"TaskExecSchema","text":"<p>Schema containing information about the task and its execution function. Used primarily by Worker when preparing a task for execution and transferring it to <code>TaskExecutor</code>.</p>"},{"location":"architecture/components/schemas/#taskpriorityschema","title":"TaskPrioritySchema","text":"<p>Schema for adding a task to Worker. Stores input data passed via <code>add</code>, as well as the execution priority.</p> <p>This schema is the entry point for a task into the Worker execution queue.</p>"},{"location":"architecture/components/schemas/#basetaskcls","title":"BaseTaskCls","text":"<p>Schema of a pre-assembled task, representing an alternative way of creating a task.</p> <p>Derivative variants:</p> <ul> <li><code>AsyncTaskCls</code>;</li> <li><code>SyncTaskCls</code>.</li> </ul> <p>These schemas allow you to work with a task as a call object, rather than through a direct call to <code>add_task</code>.</p>"},{"location":"architecture/components/schemas/#initsexecschema","title":"InitsExecSchema","text":"<p>Schema for event functions used in the QTasks event system.</p> <p>An example of use is handlers of the type:</p> <pre><code>@app.events.on.worker_running\n</code></pre>"},{"location":"architecture/components/schemas/#globalconfigschema","title":"GlobalConfigSchema","text":"<p>The main schema of the <code>GlobalConfig</code> component, designed to store and distribute global parameters.</p> <p>By default, the implementation uses Redis as the storage server.</p>"},{"location":"architecture/components/schemas/#argmeta","title":"ArgMeta","text":"<p>The metadata schema for task arguments.</p> <p>Stores:</p> <ul> <li>argument names;</li> <li>values;</li> <li>position or key;</li> <li>type annotations and auxiliary information.</li> </ul> <p>Used primarily in <code>TaskExecutor</code> and plugins that need to understand the structure of task arguments.</p> <p>For plugins, <code>ArgMeta</code> is passed as a parameter in the corresponding triggers.</p>"},{"location":"architecture/components/schemas/#architectural-invariants","title":"Architectural invariants","text":"<ul> <li>Components exchange only data schemas.</li> <li>Schemas do not contain execution logic.</li> <li>Schemas are formed before data is transferred.</li> <li>Schema stability is critical for component and plugin compatibility.</li> </ul> <p>Data schemas form the \"language\" of interaction between QTasks components and ensure the integrity of the architecture as it expands.</p>"},{"location":"architecture/components/threads_async/","title":"Components: threads and asynchrony","text":"<p>This page describes how QTasks organizes the launch of components in server mode, how execution threads are formed, and where exactly asynchrony occurs in the architecture.</p> <p>This refers exclusively to the application's server mode. In client mode, no background threads, processing cycles, or workers are launched.</p>"},{"location":"architecture/components/threads_async/#the-role-of-starter-in-the-architecture","title":"The role of Starter in the architecture","text":"<p>A separate component, Starter, is used to launch QTasks in server mode.</p> <p>Starter is responsible for the initial initialization of execution threads and managing the life cycle of components. Its task is to start the system and stop it correctly without interfering with the internal logic of the components themselves.</p> <p>Starter:</p> <ul> <li>accepts application launch parameters;</li> <li>distributes them among components;</li> <li>starts and stops components;</li> <li>initiates the launch of plugins. Starter does not determine how components will work after launch.</li> <li>starts and stops components;</li> <li>initiates the launch of plugins.</li> </ul> <p>At the same time, Starter does not determine how components will work after launch. The execution model, queues, blocking, and asynchrony are completely determined by the components themselves.</p>"},{"location":"architecture/components/threads_async/#using-the-default-starter","title":"Using the default Starter","text":"<p>Starter is used automatically when the application is launched via <code>app.run_forever()</code>.</p> <p>Depending on the type of application, the appropriate implementation is used:</p> <ul> <li><code>AsyncStarter</code> \u2014 for <code>qtasks.asyncio.QueueTasks</code>;</li> <li><code>SyncStarter</code> \u2014 for <code>qtasks.QueueTasks</code>.</li> </ul> <p>If necessary, Starter can be replaced with a custom implementation when saving the contract.</p>"},{"location":"architecture/components/threads_async/#startup-sequence","title":"Startup sequence","text":"<p>Starter launches components in a strictly defined order.</p>"},{"location":"architecture/components/threads_async/#launch","title":"Launch","text":"<ol> <li> <p>All registered plugins are launched:</p> </li> <li> <p>Starter plugins;</p> </li> <li>Component plugins.</li> </ol> <p><code>start()</code> is called for each plugin.</p> <ol> <li>Worker is launched via the call:</li> </ol> <pre><code>worker.start(num_workers)\n</code></pre> <ol> <li>Broker is started, to which a reference to Worker is passed:</li> </ol> <pre><code>broker.start(worker)\n</code></pre> <p>At this stage, the system is considered to be running and ready to process tasks.</p>"},{"location":"architecture/components/threads_async/#shutdown-sequence","title":"Shutdown sequence","text":"<p>The system is shut down in reverse order and is also controlled by Starter.</p> <ol> <li> <p>The main components are shut down one by one:</p> </li> <li> <p>Broker;</p> </li> <li>Worker;</li> <li>Storage;</li> <li>GlobalConfig (if present).</li> </ol> <p><code>stop()</code> is called for each component. 1.1. If <code>_global_loop</code> was created during operation, it is also stopped.</p> <ol> <li>After the components are stopped, all running plugins are stopped via <code>stop()</code>.</li> </ol> <p>This sequence ensures that background processes are terminated correctly and resources are freed.</p> <p>Note</p> <p>The <code>GlobalConfig</code> component is an optional core component. Although    it has a default implementation, it may be absent.    In all places where it needs to be started or stopped, you must first check    that the component exists (is not equal to <code>None</code>).</p>"},{"location":"architecture/components/threads_async/#component-startup-architecture-diagram","title":"Component startup architecture diagram","text":"<p>In simplified form, the startup and dependency diagram for components looks like this:</p> <pre><code>Starter\n  \u251c\u2500\u2500 Worker\n  \u251c\u2500\u2500 Broker\n  \u2502     \u2514\u2500\u2500 Storage\n  \u2502           \u2514\u2500\u2500 GlobalConfig (optional)\n</code></pre> <p>This diagram only reflects the startup hierarchy and dependencies, but does not define internal execution models.</p>"},{"location":"architecture/components/threads_async/#asynchrony-as-a-local-property","title":"Asynchrony as a local property","text":"<p>In the QTasks architecture, asynchrony is not a global application state.</p> <ul> <li>Starter only initiates the launch of components;</li> <li> <p>each component independently determines:</p> </li> <li> <p>whether to use an event loop;</p> </li> <li>how to organize queues;</li> <li>which synchronization mechanisms to use.</li> </ul> <p>This allows you to combine synchronous and asynchronous components within a single system and adapt the execution model to a specific infrastructure.</p>"},{"location":"architecture/components/threads_async/#architectural-invariants","title":"Architectural invariants","text":"<ul> <li>Server mode is initiated exclusively through Starter;</li> <li>Starter manages the lifecycle, but not the execution logic;</li> <li>Asynchrony is localized within components;</li> <li>The order of component startup and shutdown is fixed and predictable.</li> </ul> <p>This approach makes execution threads in QTasks manageable and transparent even in complex usage scenarios.</p>"},{"location":"architecture/integrations/","title":"Integration with libraries","text":"<p>This section describes the architectural principles that allow QTasks to be integrated with external libraries and frameworks without imposing strict conditions or restrictions.</p> <p>Although QTasks is a full-fledged framework with its own rules for building applications, its architecture is designed so that developers can integrate it into existing systems on their own terms.</p> <p>, its architecture is designed so that developers can integrate it into existing systems on their own terms.</p>"},{"location":"architecture/integrations/#qtasks-architectural-position","title":"QTasks architectural position","text":"<p>QTasks does not seek to be the \"center of the world\" for an application. It can act as:</p> <ul> <li>as a standalone task processing server;</li> <li>as a built-in component within another framework;</li> <li>as an infrastructure layer serving multiple applications.</li> </ul> <p>This is achieved through a minimal amount of global state and strict isolation of components.</p>"},{"location":"architecture/integrations/#minimizing-global-state","title":"Minimizing global state","text":"<p>In the QTasks architecture, global variables are used deliberately and to a limited extent.</p>"},{"location":"architecture/integrations/#global-reference-to-the-application","title":"Global reference to the application","text":"<p>The main default entry point is created via:</p> <pre><code>app = QueueTasks()\n</code></pre> <p>When the application instance is initialized, <code>self._set_state()</code> is called, resulting in:</p> <ul> <li>the global reference to the application is stored in <code>qtasks._state.app_main</code>;</li> <li>it is used as the default value in places where there is no explicit reference to the application.</li> </ul> <p>It is important to note that the presence of <code>app_main</code> is not a prerequisite for the system to work.</p> <p>In all cases where possible:</p> <ul> <li>tasks declared via <code>@app.task</code> receive a reference to a specific instance of <code>app</code> directly;</li> <li><code>(A)syncRouter</code> routers connected via <code>app.include_router(router)</code> also use an explicit reference.</li> </ul> <p>A global reference is only used in scenarios where the application instance has not been explicitly passed, for example when using <code>@shared_task()</code>.</p>"},{"location":"architecture/integrations/#global-logger","title":"Global logger","text":"<p>In addition to the reference to the application, QTasks has a single point of aggregation for logging.</p> <p>When the application is initialized in <code>_set_state()</code>, a global logger can also be created:</p> <ul> <li>it is stored in <code>qtasks._state.logger_main</code>;</li> <li>it is based on the <code>qtasks.logs.Logger</code> class.</li> </ul> <p>By default, the logger is initialized as follows:</p> <pre><code>Logger(\n    name=app.name,\n    subname=\"QueueTasks\",\n    default_level=app.config.logs_default_level_server,\n    format=app.config.logs_format,)\n</code></pre> <p>If there is no global logger, components and plugins that request a logger must create their own instance based on the same class.</p> <p>Thus, logging can be:</p> <ul> <li>centralized \u2014 if <code>logger_main</code> is present;</li> <li>local \u2014 if there is no global logger.</li> </ul>"},{"location":"architecture/integrations/#architectural-implications-for-integrations","title":"Architectural implications for integrations","text":"<p>This approach to global state offers the following advantages:</p> <ul> <li>QTasks can be integrated into an existing project without conflicting global objects;</li> <li>integration with frameworks such as Django, FastAPI, or custom services does not require rewriting the architecture;</li> <li>the developer controls where and how the application and logger are created;</li> <li>Multiple instances of QTasks can run within a single process.</li> </ul>"},{"location":"architecture/integrations/#purpose-of-this-section","title":"Purpose of this section","text":"<p>This section lays the architectural foundation for all subsequent pages dedicated to specific integrations.</p> <p>Next, we will discuss:</p> <p>The following topics will be covered:</p> <ul> <li>Features of embedding QTasks into other frameworks;</li> <li>Application lifecycle management in a third-party environment;</li> <li>Typical architectural patterns of integration.</li> </ul> <p>All of them are based on the principles described on this page.</p>"},{"location":"architecture/integrations/django/","title":"Integration with Django","text":"<p>This page describes the architectural principles of integrating QTasks with Django. It is not about the user API, but about how QTasks is embedded in the Django loading model and how tasks become available to the framework without a rigid component link.</p>"},{"location":"architecture/integrations/django/#django-architectural-context","title":"Django architectural context","text":"<p>Django has its own application initialization model:</p> <ul> <li>the list of applications is defined via <code>INSTALLED_APPS</code>;</li> <li>modules are loaded when the Django process starts;</li> <li>The logic for registering signals, models, and tasks is often tied to the fact that a module is imported.</li> </ul> <p>The integration of QTasks with Django relies on these features and does not require changing the standard Django application lifecycle.</p>"},{"location":"architecture/integrations/django/#automatic-task-detection","title":"Automatic task detection","text":"<p>For integration with Django, QTasks provides a mechanism for automatically importing task modules.</p> <pre><code>from qtasks.contrib.django import autodiscover_tasks\n\nautodiscover_tasks(qtasks_app, [\"tasks1\", \"tasks2\"])\n</code></pre> <p>This mechanism allows QTasks to discover and register tasks declared within Django applications without explicitly importing each module manually.</p> <p>How autodiscover_tasks works</p>"},{"location":"architecture/integrations/django/#how-autodiscover_tasks-works","title":"How autodiscover_tasks works","text":"<p>The <code>autodiscover_tasks</code> function uses a Django architectural principle: all applications listed in <code>INSTALLED_APPS</code> are already known to the system.</p> <p>At a high level, the process looks like this:</p> <ol> <li>A list of Django applications is obtained from <code>INSTALLED_APPS</code>.</li> <li>For each application, an attempt is made to import the specified modules.</li> <li>If the import is successful, the module code is executed.</li> <li>Tasks declared in these modules are automatically registered in the passed instance of <code>QueueTasks</code>.</li> </ol> <p>Key point: QTasks does not interfere with the task registration process. It only ensures that the modules are imported.</p>"},{"location":"architecture/integrations/django/#autodiscover_tasks-function-contract","title":"autodiscover_tasks function contract","text":"<p>The function signature looks like this:</p> <pre><code>def autodiscover_tasks(app, modules: Optional[list[str]] = None):\n    \"\"\"Automatically imports the specified modules from all INSTALLED_APPS to\n    register tasks in QTasks.\n\n    Args:\n        app (QueueTasks): application.\n        modules (List[str]): modules for autodiscovery.\n            Default: [\"tasks\"].\n    \"\"\"\n</code></pre> <p>From an architectural point of view, the following is important:</p> <ul> <li><code>app</code> is passed explicitly \u2014 integration does not rely on global state;</li> <li>the list of modules is configurable and not hard-coded;</li> <li>the function does not return data and does not affect the application lifecycle.</li> </ul>"},{"location":"architecture/integrations/django/#task-registration","title":"Task registration","text":"<p>Task registration is done in the standard way for QTasks:</p> <ul> <li>when executing the <code>@app.task</code> decorator;</li> <li>when using routers connected to <code>app</code>.</li> </ul> <p><code>autodiscover_tasks</code> only ensures that the code with declarations will be executed at the correct time.</p> <p>Thus:</p> <ul> <li>Django manages application loading;</li> <li>QTasks manages task registration;</li> <li>The point of contact is the module import mechanism.</li> </ul>"},{"location":"architecture/integrations/django/#architectural-advantages-of-the-approach","title":"Architectural advantages of the approach","text":"<p>This integration method offers several important advantages:</p> <ul> <li>No hard dependency of QTasks on Django;</li> <li>Preservation of the standard structure of Django projects;</li> <li>No global side effects.</li> <li>Ability to use multiple instances of QTasks.</li> </ul> <p>The integration remains a thin layer between the systems, rather than an attempt to merge their lifecycles.</p>"},{"location":"architecture/integrations/django/#boundaries-of-responsibility","title":"Boundaries of responsibility","text":"<ul> <li>Django is responsible for discovering and loading applications;</li> <li><code>autodiscover_tasks</code> is responsible for importing task modules;</li> <li>QTasks is responsible for registering and executing tasks.</li> </ul> <p>Adhering to these boundaries allows QTasks to be used in Django projects without violating the architecture of either system.</p>"},{"location":"examples/","title":"Examples","text":"<p>This page provides basic examples of using QTasks. They will help you quickly learn the main scenarios for working with tasks.</p>"},{"location":"examples/#simple-task-example-synchronous","title":"Simple task example (synchronous)","text":"<p>The task accepts a string, outputs it to the console, and returns it back.</p> <pre><code>from qtasks import QueueTasks\n\napp = QueueTasks()\n\n\n@app.task(name=\"print_text\")\ndef print_text(text: str):\n    print(text)\n    return text\n\n\nif __name__ == \"__main__\":\n    app.run_forever()\n\n    # Adding a task to the queue\n    app.add_task(\"print_text\", \"Hello, world!\")\n    # Result: \"Hello, world!\"\n</code></pre> <p>When accessing a task through the function itself (task_func), the <code>task_name</code> parameter can be explicitly specified if you need to override the name:</p> <pre><code>print_text.add_task(\"Hello, world!\")              # task_name = \"print_text\"\nprint_text.add_task(task_name=\"echo_text\")       # task_name = \"echo_text\"\n</code></pre>"},{"location":"examples/#asynchronous-task","title":"Asynchronous task","text":"<p>An asynchronous task that simulates a delay and returns a result.</p> <pre><code>import asyncio\nfrom qtasks.asyncio import QueueTasks\n\napp = QueueTasks()\n\n\n@app.task(name=\"async_task\")\nasync def async_task(text: str):\n    await asyncio.sleep(2)\n    print(f\"Task completed: {text}\")\n    return text\n\n\nif __name__ == \"__main__\":\n    app.run_forever()\n\n    # Adding an asynchronous task\n    asyncio.run(app.add_task(\"async_task\", \"Asynchronous example\"))\n    # Result: \"Task completed: Asynchronous example\"\n</code></pre>"},{"location":"examples/#using-redis-default-broker","title":"Using Redis (default broker)","text":"<p>By default, QTasks uses Redis. You can explicitly specify the URL:</p> <pre><code>from qtasks import QueueTasks\n\napp = QueueTasks(broker_url=\"redis://localhost:6379/0\")\n\n\n@app.task(name=\"redis_example\")\ndef redis_example(value: int):\n    print(f\"Value: {value}\")\n    return value\n\n\nif __name__ == \"__main__\":\n    app.run_forever()\n\n    app.add_task(\"redis_example\", 42)\n    # Result: \"Value: 42\"\n</code></pre>"},{"location":"examples/#using-rabbitmq-as-a-broker","title":"Using RabbitMQ as a broker","text":"<p>Example of RabbitMQ configuration:</p> <pre><code>pip install qtasks[rabbitmq]\n</code></pre> <pre><code>import asyncio\nfrom qtasks.asyncio import QueueTasks\nfrom qtasks.brokers import AsyncRabbitMQBroker\n\n\nbroker = AsyncRabbitMQBroker(url=\"amqp://guest:guest@localhost/\")\napp = QueueTasks(broker=broker)\n\n@app.task(name=\"rabbitmq_example\")\nasync def rabbitmq_example(text: str):\n    print(f\"Message received: {text}\")\n    return text\n\n\nif __name__ == \"__main__\":\n    app.run_forever()\n\n    asyncio.run(app.add_task(\"rabbitmq_example\", \"Message via RabbitMQ\"))\n    # Result: \"Message received: Message via RabbitMQ\"\n</code></pre>"},{"location":"examples/#what-to-look-at-next","title":"What to look at next","text":"<p>Additional examples are available in separate sections:</p> <ul> <li>Tasks and their capabilities \u2014 see section: <code>[Task capabilities](features.md)</code></li> <li>Plugins \u2014 see section: <code>[How to write plugins](plugins.md)</code></li> <li>Integrations \u2014 see section: <code>[QTasks integration](integrations/index.md)</code></li> <li>Analytics and statistics \u2014 see section: <code>[Analytics](analytics.md)</code></li> </ul>"},{"location":"examples/analytics/","title":"Examples \u2192 Analytics","text":"<p>The (A)syncStats component is responsible for collecting and formatting diagnostic information about the <code>QTasks</code> application and its tasks. It is initialized by an instance of <code>QueueTasks</code> and provides a set of methods for introspection. The synchronous version is additionally integrated into the CLI as the <code>qtasks stats</code> command.</p>"},{"location":"examples/analytics/#where-it-is-used","title":"\ud83d\ude80 Where it is used","text":"<ul> <li>Directly from the code: an instance of <code>(A)syncStats</code> is created and analysis methods are called.</li> <li>Via CLI: the synchronous version is available as <code>qtasks stats</code>.</li> </ul> <p>Command example (for reference):</p> <pre><code>qtasks stats inspect tasks my_task json=true\n</code></pre> <p>This command will output a structure describing the tasks (in JSON when <code>json=true</code>).</p>"},{"location":"examples/analytics/#inspect","title":"\ud83d\udd0e <code>inspect()</code>","text":"<p>The <code>inspect()</code> method creates an [<code>InspectStats</code>] object (../api/stats/inspect/inspect_stats.md), which contains functions for detailed inspection:</p> <ul> <li><code>app(json: bool = False)</code> \u2014 information about the application itself</li> <li><code>task(task_name: str, json: bool = False)</code> \u2014 information about a specific task</li> <li><code>tasks(*tasks: Tuple[str], json: bool = False)</code> \u2014 summary of several tasks or all tasks</li> </ul> <p>All these functions support two output formats:</p> <ul> <li>Text (default): aligned columns +</li> <li>JSON (<code>json=True</code>): serialized structure, convenient for parsing and automation</li> </ul>"},{"location":"examples/analytics/#appjson-bool-false-summary-for-the-application","title":"\ud83e\udded <code>app(json: bool = False)</code> \u2014 summary for the application","text":"<p>What is output in text mode:</p> <ul> <li>Application name</li> <li>Launch method</li> <li><code>QTasks</code> version</li> <li>Current configuration (as a string)</li> <li>Number of registered tasks and routers</li> <li>Total number of connected plugins (summed by kernel, broker, worker, starter, storage, and global configuration)</li> <li>Number of registered initializations (<code>on</code> events)</li> <li>Classes of components involved: Broker, Worker, Starter (or <code>\u2014</code>), Storage, GlobalConfig (or <code>\u2014</code>), Logger</li> </ul> <p>Format \u2014 block, with labels aligned by width and a horizontal separator line. Example form (data is conditional):</p> <pre><code>Name: QueueTasks\nMethod: async\nVersion: 1.6.0\nConfiguration: QueueConfig(max_tasks_process=10,\nrunning_older_tasks=True, delete_finished_tasks=True, default_task_priority=0,\nlogs_default_level_server=20, logs_default_level_client=20,\nlogs_format='%(asctime)s [%(name)s: %(levelname)s] (%(subname)s) %(message)s',\nresult_time_interval=0.1, result_statuses_end=['success', 'error', 'cancel'])\nNumber of tasks: 14\nNumber of routers: 1\nNumber of plugins: 3\nNumber of initializations: 0\nBroker: AsyncRedisBroker\nWorker: AsyncWorker\nStarter: \u2014\nStorage: AsyncRedisStorage\nGlobalConfig: AsyncRedisGlobalConfig\nLog: Logger\n--------------------------------------------------\n</code></pre> <p>When <code>json=True</code>, a JSON object with the same keys and values is returned.</p>"},{"location":"examples/analytics/#tasktask_name-json-bool-false-detailed-information-about-the-task","title":"\ud83e\udde9 <code>task(task_name, json: bool = False)</code> \u2014 detailed information about the task","text":"<p>What is displayed in text mode: one block per task with the following fields:</p> <ul> <li>Task name</li> <li>Priority</li> <li>Description (or <code>\u2014</code>)</li> <li>Tags (comma-separated list or <code>\u2014</code>)</li> <li>Asynchronous (flag \"awaiting\")</li> <li>Generation (<code>yield</code> mode, flag \"generating\")</li> <li>\"Self before task\" (<code>echo</code>)</li> <li>Argument signature: <code>Args</code> (positional) and <code>Kwargs</code> (keywords with defaults)</li> </ul> <p>Conditional fields, if specified in the task:</p> <ul> <li><code>Retries</code> (retry)</li> <li><code>Exclude for retries</code> (<code>retry_on_exc</code>, nicely formatted)</li> <li><code>Decoding</code> (<code>decode</code>)</li> <li><code>Generator</code> (<code>generate_handler</code>)</li> <li><code>Executor</code> (<code>executor</code>)</li> <li><code>Middleware before</code> / <code>Middleware after</code></li> <li><code>Additional</code> \u2014 a multi-line section where each key-value pair is output on a separate line with the marker <code>*</code></li> </ul> <p>Example form (data is conditional):</p> <pre><code>Task name: send_email\nPriority: 0\nDescription: Mailing list\nTags: email, marketing\nAsynchronous: True\nGeneration: False\nSelf before task: False\nArgs: recipient: str, subject: str\nKwargs: retries: int=3, timeout: int=30\nRetries: 3\nExceptions for retries: [&lt;class 'KeyError'&gt;]\nMiddleware before: [&lt;class 'AuthMiddleware'&gt;]\nMiddleware after: [&lt;class 'MetricsMiddleware'&gt;]\nAdditional:\n* concurrency: 5\n* queue: high\n--------------------------------------------------\n\n**When `json=True`**, an object with the same data is returned (keys correspond\nto the labels above).\n\n\nIf the task is not found, a corresponding diagnostic message (text) is displayed,\nand when `json=True`, an empty structure or a descriptive error is displayed\n(depending on the CLI/wrapper implementation).\n\n\n---\n\n---\n\n## \ud83d\udcda `tasks(*tasks, json: bool = False)` \u2014 several or all tasks\n\nThe behavior is similar to `task(...)`, but for a set of tasks:\n\n* If task names are passed, only they are displayed, in the order listed\n* If nothing is passed \u2014 **the entire registry** of tasks is displayed\n* Task blocks follow each other, separated by the line.\n\n**Example form (conditional data):**\n\n```text\nTask name: ping\nPriority: 0\nDescription: \u2014\nTags: \u2014\nAsynchronous: True\nGeneration: False\nSelf before task: False\nArgs: host: str\nKwargs: timeout: int=5\n--------------------------------------------------\nTask name: report_daily\nPriority: 1\nDescription: Daily report\nTags: analytics\nAsynchronous: False\nGeneration: False\nSelf before task: False\nArgs: date: datetime.date\nKwargs: format: str=pdf\n----------------------- ---------------------------\n</code></pre> <p>When <code>json=True</code>, a list of JSON objects is returned \u2014 one for each task in the sample.</p>"},{"location":"examples/analytics/#formatting-and-readability","title":"\ud83e\uddf1 Formatting and readability","text":"<p>The text output aligns labels to a fixed width (via the internal <code>label_width</code>), so tables look neat in the terminal and logs. <code>-</code> separators are used to visually separate blocks.</p>"},{"location":"examples/analytics/#what-this-means-in-practice","title":"\u2705 What this means in practice","text":"<ul> <li>Quick audit of application configuration and component environment</li> <li>Full visibility for each task: from argument signatures to middleware and additional options</li> <li>Universal JSON format for integration with monitoring, alerting, and dashboards</li> </ul> <p>This analytics is useful in production, CI, and local debugging alike.</p>"},{"location":"examples/echo/","title":"Example of using self and self.ctx (echo=True)","text":"<p>When <code>echo=True</code> is specified, the task receives the <code>self</code> object of type <code>AsyncTask</code> or <code>SyncTask</code> as its first argument. This provides access to the execution context <code>self.ctx</code>, internal task data, and control methods.</p> <p>Below is an example task demonstrating all the capabilities of <code>self</code> and <code>self.ctx</code>.</p>"},{"location":"examples/echo/#task-example","title":"\ud83e\udde9 Task example","text":"<pre><code>@app.task(\n    echo=True, tags=[\"test\"], priority=1,\n    retry=3, retry_on_exc=[KeyError], decode=json.dumps,\n    # generate_handler=yield_func, executor=MyTaskExecutor,\n    # middlewares_before=[MyTaskMiddleware], middlewares_after=[MyTaskMiddleware],\n    test=\"test\"\n)\nasync def test_echo_ctx(self: AsyncTask):\n    # Get the logger (with the default task name)\n    self.ctx.get_logger().info(\"This is a test task!\")\n\n    # Pause in the task (asynchronous)\n    await self.ctx.sleep(5)\n\n    # Get the current configuration\n    self.ctx.get_logger().info(self.ctx.get_config())\n\n    # Output all available task parameters\n    self.ctx.get_logger().info(\n        f\"\"\"\n            UUID: {self.ctx.task_uuid}\n            Name: {self.task_name}\n            Tags: {self.tags}\n            Priority: {self.priority}\n            Extra parameters: {self.extra}\n\n            Retries via parameter: {self.retry}\n            Exceptions for retry: {self.retry_on_exc}\n            Function for decorator: {self.ctx.generate_handler}\n\n            Is self called: {self.echo}\n            Decoding via parameter: {self.decode}\n\n            TaskExecutor via parameter: {self.executor}\n            Middleware: {self.middlewares}\n\"\"\")\n\n\n# Manually canceling the task\nself.ctx.cancel(\"Test task canceled\")\nreturn \"Hello, world!\"\n</code></pre>"},{"location":"examples/echo/#self-capabilities","title":"\ud83d\udce6 Self capabilities","text":"<ul> <li><code>self.task_name</code>, <code>self.retry</code>, <code>self.tags</code>, <code>self.echo</code> \u2014 task parameters</li> <li><code>await self.add_task(...)</code> \u2014 launch nested tasks</li> <li><code>self.decode</code>, <code>self.executor</code>, <code>self.middlewares</code> \u2014 access to task arguments</li> </ul>"},{"location":"examples/echo/#selfctx-capabilities","title":"\ud83e\udde0 self.ctx capabilities","text":"<ul> <li><code>self.ctx.get_logger()</code> \u2014 logger with the task name or a custom name</li> <li><code>self.ctx.sleep(seconds)</code> \u2014 execution delay</li> <li><code>self.ctx.cancel(reason)</code> \u2014 cancel task with <code>status=CANCEL</code> set</li> <li><code>self.ctx.get_config()</code>, <code>get_component(name)</code>, <code>get_task(uuid)</code>, <code>get_metadata()</code> \u2014 access to infrastructure and status</li> </ul>"},{"location":"examples/echo/#result-in-logs","title":"\u2705 Result in logs","text":"<p>Client:</p> <pre><code>Task(status='cancel', uuid=..., task_name='test_echo_ctx', ...,\ncancel_reason='Test task canceled')\n</code></pre> <p>Server:</p> <pre><code>2025-07-16 ... (test_echo_ctx) This is a test task!...\n\nUUID: ...\nName: test_echo_ctx\nTags: ['test']...\n\nTask ... was canceled due to: Test task canceled\n</code></pre> <p>Using <code>self</code> and <code>self.ctx</code> makes the task not just a function, but a full-fledged object capable of interacting with the QTasks system at all levels.</p>"},{"location":"examples/features/","title":"Features of QTasks tasks","text":"<p>Tasks in QTasks are not just functions. They are extensible objects with context, their own behavior, support for middleware, retry mechanisms, generator-based pipelines, and a dependency system. This page provides an overview of the capabilities available through the <code>@app.task</code> and <code>@shared_task</code> decorators.</p>"},{"location":"examples/features/#shared_task-tasks-outside-the-application","title":"\ud83d\udce6 shared_task \u2014 tasks outside the application","text":"<p><code>shared_task</code> allows you to register tasks outside the <code>QueueTasks</code> application instance \u2014 useful for libraries, reusable modules, and code that needs to work in different projects.</p> <pre><code>from qtasks import shared_task\n\n@shared_task()\ndef shared_func():\n    print(\"Shared task\")\n</code></pre>"},{"location":"examples/features/#converting-shared_task-to-an-asynchronous-task","title":"Converting shared_task to an asynchronous task","text":"<p>If you specify <code>awaiting=True</code>, the task returns <code>AsyncTask</code>, even if the environment is \"synchronous\":</p> <pre><code>@shared_task(awaiting=True)\nasync def async_shared():\n    print(\"async shared task\")\n</code></pre> <p><code>shared_task</code> supports all <code>@app.task</code> parameters:</p> <ul> <li><code>executor</code></li> <li><code>middlewares_before</code> / <code>middlewares_after</code></li> <li><code>generate_handler</code></li> <li><code>echo</code></li> <li><code>retry</code>, <code>retry_on_exc</code></li> <li><code>priority</code>, <code>tags</code>, <code>description</code></li> <li><code>decode</code></li> </ul>"},{"location":"examples/features/#task-routing-asyncrouter","title":"\ud83d\udd00 Task routing: (A)syncRouter","text":"<p>Router allows you to connect sets of tasks to an application, separate logic by modules, and reuse code.</p> <pre><code>from qtasks import AsyncRouter\n\nrouter = AsyncRouter()\n\n@router.task()\nasync def example():\n    print(\"Router task\")\n</code></pre> <p>In the application file:</p> <pre><code>app.include_router(router)\n</code></pre> <p>The router only registers tasks and passes them to the application registry.</p>"},{"location":"examples/features/#echotrue-and-access-to-self-asynctask","title":"\ud83d\udce3 echo=True and access to self (A)SyncTask","text":"<p>If you specify <code>echo=True</code>, the task receives the task object as its first argument:</p> <ul> <li><code>AsyncTask</code> for async</li> <li><code>SyncTask</code> for sync</li> </ul> <pre><code>@app.task(echo=True)\nasync def echo_task(self):\n    print(self.task_name)\n</code></pre>"},{"location":"examples/features/#self-capabilities","title":"<code>self</code> capabilities","text":"<p>Each task has the following fields:</p> Attribute Value <code>self.task_name</code> Task name <code>self.priority</code> Priority (default 0) <code>self.echo</code> Echo mode flag <code>self.max_time</code> Maximum execution time <code>self.retry</code> Number of retries <code>self.retry_on_exc</code> List of exceptions for retry <code>self.decode</code> Result decoder <code>self.middlewares_before</code> Middleware before execution <code>self.middlewares_after</code> Middleware after execution <code>self.extra</code> Any additional parameters <p>This allows you to implement nested tasks:</p> <pre><code>@app.task(echo=True)\nasync def main(self):\n    self.add_task(\"subtask\", 123)\n</code></pre>"},{"location":"examples/features/#task-context-selfctx","title":"\ud83e\udde0 Task context: self.ctx","text":"<p>Context is an API for interacting with the QTasks infrastructure.</p> <pre><code>@app.task(echo=True)\ndef show(self):\n    print(self.ctx.task_uuid)\n</code></pre>"},{"location":"examples/features/#context-capabilities","title":"Context capabilities","text":"Method Description <code>self.ctx.task_uuid</code> Task UUID <code>self.ctx.get_logger(name)</code> Logger for the task <code>self.ctx.get_config()</code> Application config <code>self.ctx.get_metadata(cache=True)</code> Task metadata (result of <code>app.get()</code>) <code>self.ctx.get_task(uuid)</code> Get another task <code>self.ctx.sleep(sec)</code> Delay (async/ sync sleep) <code>self.ctx.cancel(reason)</code> Task cancellation (TaskCancelError) <code>self.ctx.plugin_error(**kwargs)</code> Artificial plugin error call <code>self.ctx.get_component(name)</code> Getting a component (broker, storage, ...) <p>The context allows you to implement complex logic without global variables and singleton structures.</p>"},{"location":"examples/features/#retry-and-retry_on_exc","title":"\ud83d\udd01 retry and retry_on_exc","text":"<p>Retry a task on error:</p> <pre><code>@app.task(retry=5, retry_on_exc=[ZeroDivisionError])\ndef risky():\n    return 1 / 0\n</code></pre> <ul> <li><code>retry=5</code> \u2014 number of retries</li> <li><code>retry_on_exc=[...]</code> \u2014 list of exceptions that trigger a retry</li> </ul>"},{"location":"examples/features/#executor-custom-task-handler","title":"\u2699\ufe0f executor \u2014 custom task handler","text":"<p>Allows you to replace the internal execution mechanism:</p> <pre><code>class MyExec:\n    ...\n\n@app.task(executor=MyExec)\ndef task():\n    ...\n</code></pre> <p>Executor controls:</p> <ul> <li>task execution,</li> <li>middleware,</li> <li>result decoding,</li> <li>retry process,</li> <li>error handling.</li> </ul>"},{"location":"examples/features/#middleware","title":"\ud83e\udde9 Middleware","text":"<p>Middleware is called BEFORE and AFTER task execution.</p> <pre><code>@app.task(\n    middlewares_before=[MyBefore],\n    middlewares_after=[MyAfter])\n\ndef example():\n    pass\n</code></pre> <p>If middleware is not specified, empty lists are used.</p>"},{"location":"examples/features/#support-for-yield-and-generate_handler","title":"\ud83d\udd01 Support for yield and generate_handler","text":"<p>QTasks supports generator-based tasks.</p> <pre><code>@app.task(generate_handler=handler)\ndef mytask():\n    step = yield \"INIT\"\n    return step\n</code></pre> <p><code>handler(result)</code> is called on each value passed through <code>yield</code>.</p> <p>This allows you to implement streaming pipelines:</p> <ul> <li>step-by-step processing,</li> <li>streaming,</li> <li>progress logging,</li> <li>communication between the worker and the executor.</li> </ul>"},{"location":"examples/features/#awaitingtrue-only-for-shared_task","title":"\ud83e\udea2 awaiting=True (only for shared_task)","text":"<p>The <code>awaiting=True</code> option forces a shared task to always run asynchronously.</p> <pre><code>@shared_task(awaiting=True)\nasync def async_shared():\n    ...\n</code></pre> <p>These features make QTasks a powerful tool that can be adapted to any infrastructure and architectural style.</p>"},{"location":"examples/plugins/","title":"Example: Plugins","text":"<p>QTasks has a plugin system. The system is based on calling named and global triggers. For more information about triggers, see the Plugin Trigger Reference.</p> <p>In addition to the main triggers, there is also an exception trigger inside the task function. Exception name: <code>TaskPluginTriggerError</code>. It can be called like this:</p> <pre><code>raise TaskPluginTriggerError(\"This is the reason\")\n</code></pre> <p>or via the task context:</p> <pre><code>self.ctx.plugin_error(\"This is the reason\")\n</code></pre>"},{"location":"examples/plugins/#how-do-triggers-work","title":"\u2699\ufe0f How do triggers work?","text":"<ul> <li>Triggers call the <code>trigger()</code> method inside the plugin.</li> <li>The call depends on whether a synchronous or asynchronous component initiated the event.</li> </ul>"},{"location":"examples/plugins/#abstract-plugin-class-abc","title":"\ud83d\udcd0 Abstract plugin class (ABC)","text":"<pre><code>\"\"\"Base Plugin.\"\"\"\n\nfrom abc import ABC, abstractmethod\nfrom typing import Any, Dict, Optional, Union\nfrom typing_extensions import Annotated, Doc\n\nclass BasePlugin(ABC):\n    \"\"\"\n    `BasePlugin` \u2014 \u0430\u0431\u0441\u0442\u0440\u0430\u043a\u0442\u043d\u044b\u0439 \u043a\u043b\u0430\u0441\u0441, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0444\u0443\u043d\u0434\u0430\u043c\u0435\u043d\u0442\u043e\u043c \u0434\u043b\u044f \u041f\u043b\u0430\u0433\u0438\u043d\u043e\u0432.\n\n    ## \u041f\u0440\u0438\u043c\u0435\u0440\n\n    ```python\n    from qtasks import QueueTasks\n    from qtasks.plugins.base import BasePlugin\n\n    class MyPlugin(BasePlugin):\n        def __init__(self, name: str = None):\n            super().__init__(name=name)\n            pass\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        name: Annotated[\n            Optional[str],\n            Doc(\n                \"\"\"\n                    Project name. This name can be used for Plugin tags.\n\n                    Default: `None`.\n                    \"\"\"\n            ),\n        ] = None,\n    ):\n        self.name: Union[str, None] = name\n        pass\n\n    @abstractmethod\n    def trigger(self, name: str, *args, **kwargs) -&gt; Union[Dict[str, Any], None]:\n        \"\"\"Plugin trigger.\"\"\"\n        pass\n\n@abstractmethod\ndef start(self, *args, **kwargs):\n\"\"\"Starts the plugin.\"\"\"\npass\n\n@abstractmethod\ndef stop(self, *args, **kwargs):\n\"\"\"Stops the plugin.\"\"\"\n        pass\n</code></pre>"},{"location":"examples/plugins/#example-of-a-user-plugin","title":"\ud83d\udd27 Example of a user plugin","text":"<pre><code>from qtasks.plugins.base import BasePlugin\n\nclass TestPlugin(BasePlugin):\n    def __init__(self, name=None):\n        super().__init__(name)\n        self.handlers = {\n            \"task_executor_run_task_trigger_error\": self.task_trigger_error\n        }\n\n    async def start(self, *args, **kwargs):\n        return super().start(*args, **kwargs)\n\n    async def stop(self, *args, **kwargs):\n    return super().stop(*args, **kwargs)\n\n    async def trigger(self, name, **kwargs):\n        handler = self.handlers.get(name)\n        if handler:\n            return handler(**kwargs)\n        return None\n\n    def task_trigger_error(self, **kwargs):\n        print(kwargs)\n        return None\n</code></pre>"},{"location":"examples/plugins/#summary","title":"\u2705 Summary","text":"<ul> <li>The plugin system in <code>QTasks</code> is based on triggers.</li> <li>Plugins can modify arguments, data, models, and task execution results.</li> <li>Exceptions via <code>TaskPluginTriggerError</code> allow you to replace the task result and/or terminate tasks with a meaningful reason.</li> <li>The flexibility of the system allows you to connect both built-in plugins and plugins from third-party developers.</li> </ul>"},{"location":"examples/variables/","title":"Example of variables in task functions","text":"<p>QTasks supports two built-in mechanisms for managing task logic:</p> <ul> <li>Depends \u2014 calling external functions, generators, or context managers when a task is executed.</li> <li>State \u2014 storing and exchanging state between tasks.</li> </ul>"},{"location":"examples/variables/#example-1-depends","title":"\ud83d\udd27 Example 1: Depends","text":"<p><code>Depends</code> allows you to connect resources that need to be initialized and closed upon completion. The function can be simple, generator, or asynchronous context manager.</p> <pre><code>from qtasks.plugins import Depends\nfrom contextlib import asynccontextmanager\n\n@asynccontextmanager\nasync def get_db():\n    db = await connect_to_db()\n    yield db\n    print(\"close...\")\n    await db.disconnect()\n\n@app.task\nasync def test_depends(depends: Depends(get_db)):\n    depends.execute(...)\n    print(\"Call completed\")\n    return\n</code></pre> <p>Console output:</p> <pre><code>&lt;Server starts task&gt;\nCall completed\n&lt;Server completes task&gt;\nclose...\n</code></pre> <p>Result: the task uses a database connection that closes automatically.</p>"},{"location":"examples/variables/#example-2-state-state-between-tasks","title":"\ud83d\udd27 Example 2: State (state between tasks)","text":"<p><code>State</code> is a data store available for sequential steps of a single logic.</p> <pre><code>from qtasks.plugins import AsyncState\n\nclass MyState(AsyncState):\n    pass\n\n@app.task\nasync def step1(state: MyState):\n    await state.set(\"state\", \"await_phone\")\n    await state.update(step=1, prompt=\"Enter phone number\")\n    return \"ok\"\n\n@app.task\nasync def step2(state: MyState):\n    print(await state.get_all())\n\n    cur = await state.get(\"state\")\n    if cur != \"await_phone\":\n        return \"error\"\nawait state.update(step=2)\nawait state.delete(\"state\")\nawait state.clear()\nreturn \"ok\"\n</code></pre> <p>Console output:</p> <pre><code>{\"state\": \"await_phone\", \"step\": 1, \"prompt\": \"Enter phone number\"}\n</code></pre> <p>Result: the first step wrote the data to the state, the second step read it, checked it, and cleared it.</p> <p>\u2699\ufe0f How does this work inside <code>QTasks</code>?</p>"},{"location":"examples/variables/#how-does-it-work-inside-qtasks","title":"\u2699\ufe0f How does it work inside <code>QTasks</code>?","text":"<ul> <li>Depends is registered when the task is called, and the function inside is triggered when TaskExecutor is executed. This is useful for connecting to databases, APIs, or external services.</li> <li>State is implemented as an asynchronous key-value store. It supports <code>set</code>, <code>update</code>, <code>get</code>, <code>delete</code>, <code>clear</code>, as well as reading all data at once (<code>get_all</code>).</li> </ul>"},{"location":"examples/variables/#example-of-use-in-a-company","title":"\ud83c\udfe2 Example of use in a company","text":"<p>Let's say a step-by-step registration form is being implemented:</p> <ol> <li><code>step1</code> shows the user a request to enter their phone number.</li> <li><code>step2</code> checks that the phone number has been entered and moves the process forward.</li> </ol> <p>In this case, <code>Depends</code> can be used to work with the database connection, and <code>State</code> can be used to store the user's intermediate data.</p>"},{"location":"examples/variables/#summary","title":"\u2705 Summary","text":"<ul> <li>Depends \u2014 for connecting dependencies (resources, contexts, services).</li> <li>State \u2014 for step-by-step data storage between tasks.</li> </ul> <p>Together, they allow you to build flexible pipelines: from database integrations to chatbots and complex business processes.</p>"},{"location":"examples/yield/","title":"Example: Task generator (yield)","text":"<p>QTasks supports tasks with yield, both in asynchronous and synchronous form. This allows values to be processed as they are generated, and the task can be launched from an asynchronous <code>QueueTasks</code> application, regardless of the function type.</p>"},{"location":"examples/yield/#example-1-asynchronous-generation-with-intermediate-processing","title":"\ud83d\udd27 Example 1: Asynchronous generation with intermediate processing","text":"<pre><code>async def yield_func(result):\n    print(f\"Processed: {result}\")\n    return result + 2\n\n@app.task(generate_handler=yield_func, echo=True)\nasync def test_yield(n: int):\n    for _ in range(n):\n        n += 1\n        yield n\n</code></pre> <p>Input: <code>5</code></p> <p>Console output:</p> <pre><code>Processed: 6\nProcessed: 7\nProcessed: 8\nProcessed: 9\nProcessed: 10\n</code></pre> <p>Task result: <code>[8, 9, 10, 11, 12]</code></p>"},{"location":"examples/yield/#example-2-synchronous-generation-with-post-processing","title":"\ud83d\udd27 Example 2: Synchronous generation with post-processing","text":"<pre><code>def sync_handler(value):\n    print(\"SYNC:\", value)\n    return value * 2\n\n@app.task(generate_handler=sync_handler)\ndef sync_gen(n: int):\n    for i in range(n):\n        yield i + 1\n</code></pre> <p>Input: <code>5</code></p> <p>Console output:</p> <pre><code>SYNC: 1\nSYNC: 2\nSYNC: 3\nSYNC: 4\nSYNC: 5\n</code></pre> <p>Task result: <code>[2, 4, 6, 8, 10]</code></p>"},{"location":"examples/yield/#example-3-generating-and-collecting-ids-via-an-external-service","title":"\ud83d\udd27 Example 3: Generating and collecting IDs via an external service","text":"<pre><code>async def save_to_db(value):\n    db.insert({\"value\": value})\n    return value\n\n@app.task(generate_handler=save_to_db)\ndef ids():\n    for id_ in range(5):\n        yield f\"user_{id_}\"\n</code></pre> <p>Application: automatic writing to the database and returning a list of records.</p>"},{"location":"examples/yield/#how-does-generate_handler-work-inside-qtasks","title":"\u2699\ufe0f How does generate_handler work inside <code>QTasks</code>?","text":"<ul> <li>The <code>generate_handler</code> argument is called on every value generated by <code>yield</code>.</li> <li>The result of <code>return</code> from the handler is added to the resulting list (<code>list</code>) of the task.</li> <li>If <code>generate_handler</code> is defined, the task is executed via <code>run_task_gen</code>, otherwise, it is executed in the usual way.</li> <li>The <code>generating</code> setting in <code>TaskExecSchema</code> controls the switch to generator mode.</li> </ul>"},{"location":"examples/yield/#example-of-use-in-a-company","title":"\ud83c\udfe2 Example of use in a company","text":"<p>Suppose you have a task that sends notifications to employees on a schedule:</p> <pre><code>async def log_notification(msg):\n    logger.info(\"Sent:\", msg)\n    return msg\n\n@app.task(generate_handler=log_notification)\ndef send_notifications():\n    for employee in get_employees():\n        yield f\"Notification sent: {employee.email}\"\n</code></pre> <p>Result:</p> <ul> <li>The generator iterates through the list of employees.</li> <li>For each message, <code>generate_handler</code> is called, which logs or sends the data to the system.</li> <li>A list of notifications is returned.</li> </ul> <p>This approach is useful for:</p> <ul> <li>Integrations with external APIs</li> <li>Gradual streaming</li> <li>Tasks where transformation and control of each step is important</li> </ul>"},{"location":"examples/yield/#summary","title":"\u2705 Summary","text":"<p>Tasks with <code>yield</code> + <code>generate_handler</code> are a powerful reactive processing tool that makes QTasks flexible for real-time processing, logging, streaming, and more complex pipelines. Support for both <code>async</code> and <code>sync</code> makes it convenient for any development style.</p>"},{"location":"examples/integrations/","title":"Integrations","text":"<p>By default, <code>QTasks</code> is very easy to integrate into a system due to its lightweight memory and threading. It can be integrated into almost any framework, and there are several ways to do this:</p> <ul> <li>Creating tasks via <code>@app.task</code>, <code>@shared_task</code>, <code>@router.task</code></li> <li>Calling a task via <code>app.add_task(...)</code> or <code>this_is_func.add_task(...)</code></li> <li>Running the framework application as a server via <code>app.run_forever()</code>, or via CLI:</li> </ul> <pre><code>qtasks -A file:app run\n</code></pre>"},{"location":"examples/integrations/#current-integrations","title":"\ud83d\udccc Current integrations","text":"<p>Currently, there is a ready-made integration: with Django. For more details, see the section Examples \u2192 Integrations \u2192 Django.</p>"},{"location":"examples/integrations/django/","title":"Integration with Django","text":"<p>Currently, QTasks implements one main integration feature with Django: autodiscover_tasks.</p>"},{"location":"examples/integrations/django/#what-does-autodiscover_tasks-do","title":"\ud83d\udccc What does autodiscover_tasks do?","text":"<p>This function automatically imports the specified modules (e.g., <code>tasks.py</code>) from all applications listed in <code>INSTALLED_APPS</code>. This way, tasks are registered in QTasks without the need for manual connection. Function signature:</p> <pre><code>def autodiscover_tasks(app, modules: List[str] = [\"tasks\"]):\n    \"\"\"Automatically imports the specified modules from all INSTALLED_APPS\n    to register tasks in QTasks.\n\n    Args:\n        app (QueueTasks): application.\n        modules (List[str]): Modules for autodiscovery. Default: [\"tasks\"].\n\"\"\"\n</code></pre> <p>\ud83d\udcd6 A detailed description is available in API \u2192 autodiscover_tasks.</p>"},{"location":"examples/integrations/django/#how-to-use","title":"\ud83d\udd27 How to use","text":"<p>In <code>settings.py</code>:</p> <pre><code>INSTALLED_APPS = [\n    \"django.contrib.admin\",\n    \"django.contrib.auth\",\n    \"myapp\",  # tasks.py will be here\n]\n</code></pre> <p>In <code>myapp/tasks.py</code>:</p> <pre><code>from qtasks import QueueTasks\n\napp = QueueTasks()\n\n@app.task\ndef hello(name: str):\n    return f\"Hello, {name}!\"\n</code></pre> <p>In <code>manage.py</code> or the main module of the project:</p> <pre><code>from qtasks.contrib.django import autodiscover_tasks\nfrom qtasks import QueueTasks\n\napp = QueueTasks()\nautodiscover_tasks(app)\n</code></pre> <p>After calling <code>autodiscover_tasks(app)</code>, all tasks from <code>tasks.py</code> will be automatically registered and available for execution.</p>"},{"location":"examples/integrations/django/#summary","title":"\u2705 Summary","text":"<ul> <li><code>autodiscover_tasks</code> searches for <code>tasks.py</code> (or other modules, if specified) in all <code>INSTALLED_APPS</code> applications.</li> <li>This simplifies the integration of QTasks into Django projects.</li> <li>There is no need to manually register tasks \u2014 simply create them in <code>tasks.py</code> within each application.</li> </ul>"},{"location":"examples/practice/freelancer/","title":"Example of using QTasks for freelancers","text":"<p>The QTasks framework is ideal for freelancers who need to quickly automate tasks, process events from external APIs, and manage data flows. Below is an example of how a freelancer can use QTasks to create a notification and integration system.</p>"},{"location":"examples/practice/freelancer/#scenario","title":"\ud83d\udcbc Scenario","text":"<p>Let's say you are a freelancer creating a Telegram bot for a client. The bot must:</p> <ol> <li>Send reminders on a schedule.</li> <li>Check order statuses with the client's API.</li> <li>Log events and errors.</li> </ol> <p>You want to process these tasks independently and in the background, without relying on heavy solutions like Celery.</p>"},{"location":"examples/practice/freelancer/#application-setup","title":"\ud83d\ude80 Application setup","text":"<pre><code>from qtasks.asyncio import QueueTasks\nfrom qtasks.registries import AsyncTask\nimport logging\n\napp = QueueTasks()\napp.config.logs_default_level = logging.INFO\n</code></pre>"},{"location":"examples/practice/freelancer/#time-based-reminders","title":"\u23f0 Time-based reminders","text":"<pre><code>@app.task(name=\"send_reminder\")\nasync def send_reminder(chat_id: int, text: str):\n    await telegram_api.send_message(chat_id, text)\n</code></pre> <p>You can run this task on a schedule using the built-in timer system:</p> <pre><code>from qtasks.timers import AsyncTimer\nfrom apscheduler.triggers.cron import CronTrigger\n\n# Let's assume that app is already initialized\n\ntimer = AsyncTimer(app=app)\ntimer.add_task(\"send_reminder\", trigger=CronTrigger(minute=\"*/1\"),\nargs=(123456789, \"Don't forget about your order!\"))\n\ntimer.run_forever()\n</code></pre>"},{"location":"examples/practice/freelancer/#checking-orders","title":"\ud83d\udce6 Checking orders","text":"<pre><code>async def check_orders(self: AsyncTask):\n    orders = await external_api.get_orders()\n    for order in orders:\n        if order.status == \"delivered\":\n            await self.add_task(\n                \"send_reminder\",\n                order.user_id,\n                \"Your order has been delivered!\"\n            )\n</code></pre>"},{"location":"examples/practice/freelancer/#error-logging","title":"\ud83d\udccb Error logging","text":"<pre><code>@app.task(name=\"error_logger\")\ndef error_logger(message: str):\n    with open(\"errors.log\", \"a\") as f:\n        f.write(message + \"\\n\")\n</code></pre> <p>You can use this in all tasks:</p> <pre><code>try:\n    ...\nexcept Exception as e:\n    await self.add_task(\"error_logger\", args=(str(e),))\n</code></pre>"},{"location":"examples/practice/freelancer/#why-is-qtasks-useful-for-freelancers","title":"\ud83e\udde9 Why is QTasks useful for freelancers?","text":"<ul> <li>Does not require Redis or RabbitMQ by default.</li> <li>Can be run via <code>python main.py</code>, without dockers or migrations.</li> <li>Flexibility: you can add retry, middleware, custom executors.</li> <li>Supports <code>yield</code>, <code>echo</code>, nested tasks, and logging.</li> </ul>"},{"location":"examples/practice/freelancer/#result","title":"\u2705 Result","text":"<p>You get a powerful background task system with minimal code and dependencies. Ideal for microservices, bots, and API integrations \u2014 the typical freelancer environment.</p>"},{"location":"examples/practice/large_business/","title":"Example of using QTasks in large businesses","text":"<p>QTasks scales for use in high-load systems and is suitable for enterprise-level use thanks to its modular architecture, expandability, and task execution control. This system can be used for task processing in microservice architecture, automation of complex chains, and load distribution.</p>"},{"location":"examples/practice/large_business/#scenario","title":"\ud83c\udfe2 Scenario","text":"<p>A large company has dozens of microservices:</p> <ol> <li>They need to be connected via background task processing.</li> <li>Ensure reliable execution and control.</li> <li>Maintain scalability, fault tolerance, and integration with external systems (Kafka, Redis, PostgreSQL, REST, gRPC).</li> </ol>"},{"location":"examples/practice/large_business/#distributed-task-processing","title":"\u2699\ufe0f Distributed task processing","text":"<p>Deploy workers on different servers/containers:</p> <pre><code>py -m qtasks -A myproject.qtasks_app run --worker-id node1\npy -m qtasks -A myproject.qtasks_app run --worker-id node2\n</code></pre> <p>Can be run with different configurations using environment variables or command line arguments.</p>"},{"location":"examples/practice/large_business/#integration-with-kafka-and-other-brokers","title":"\ud83d\udd00 Integration with Kafka and other brokers","text":"<pre><code>from my_kafka_broker import KafkaBroker\n\napp = QueueTasks(broker=KafkaBroker(...))\n</code></pre> <p>Custom <code>Storage</code>, <code>GlobalConfig</code>, and other components are also supported.</p>"},{"location":"examples/practice/large_business/#taskmanager-for-managing-task-strategies","title":"\ud83e\udde9 TaskManager for managing task strategies","text":"<pre><code>from qtasks.components.task_manager import TaskManager\n\nclass MyManager(TaskManager):\n    def mutate(self, task):\n        if task.name == \"heavy_task\":\n            task.timeout = 120\n        return task\n\napp.config.task_manager = MyManager()\n</code></pre>"},{"location":"examples/practice/large_business/#integration-with-bi-and-internal-services","title":"\ud83d\udcca Integration with BI and internal services","text":"<p>Using <code>generate_handler</code>, <code>yield</code>, <code>middlewares</code>, tasks can be used to build complex pipelines:</p> <pre><code>@app.task(generate_handler=send_to_bi)\ndef export_metrics():\n    for report in generate_big_reports():\n        yield report\n</code></pre>"},{"location":"examples/practice/large_business/#control-and-monitoring","title":"\ud83e\udde0 Control and monitoring","text":"<p>In conjunction with QTasks WebView, you can:</p> <ul> <li>track task status;</li> <li>filter by type/error/time;</li> <li>cancel, restart, view logs;</li> <li>integrate into corporate dashboards.</li> </ul>"},{"location":"examples/practice/large_business/#result","title":"\u2705 Result","text":"<p>QTasks in a large company allows you to:</p> <ul> <li>flexibly configure components (broker, storage, config);</li> <li>manage distributed task processing;</li> <li>extend task behavior without rewriting the core;</li> <li>integrate with BI, monitoring, logging, Kafka, REST, gRPC, etc.</li> </ul> <p>This makes QTasks the foundation of a framework for enterprise-level automation and event processing.</p>"},{"location":"examples/practice/small_business/","title":"Example of using QTasks for small businesses","text":"<p>Small businesses often face automation challenges: notifications, reports, CRM integrations, data exchange between services. QTasks provides an easy-to-use, yet powerful platform that allows you to build reliable solutions without heavy infrastructure costs.</p>"},{"location":"examples/practice/small_business/#scenario","title":"\ud83c\udfea Scenario","text":"<p>Let's say you have an online store. You need to:</p> <ol> <li>Automatically notify customers about their order status.</li> <li>Collect daily sales analytics.</li> <li>Integrate with an external CRM.</li> </ol>"},{"location":"examples/practice/small_business/#customer-notifications","title":"\ud83d\udce6 Customer notifications","text":"<pre><code>@app.task(name=\"notify_status\")\nasync def notify_status(order_id: int):\n    order = await db.get_order(order_id)\n    await sms_api.send(order.phone, f\"Your order {order.id} is now: {order.status}\")\n</code></pre>"},{"location":"examples/practice/small_business/#daily-analytics-with-a-timer","title":"\ud83d\udcca Daily analytics with a timer","text":"<pre><code>from qtasks.timers import AsyncTimer\nfrom apscheduler.triggers.cron import CronTrigger\n\ntimer = AsyncTimer(app=app)\n\ntimer.add_task(\"daily_report\", trigger=CronTrigger(hour=23, minute=59))\n\n@app.task(name=\"daily_report\")\nasync def daily_report():\n    stats = await db.get_today_stats()\nawait mailer.send(\"owner@shop.com\", \"Daily report\", stats.format())\n</code></pre>"},{"location":"examples/practice/small_business/#integration-with-crm-via-yield-and-generate_handler","title":"\ud83d\udd17 Integration with CRM via <code>yield</code> and <code>generate_handler</code>","text":"<pre><code>async def log_crm(result):\n    await crm_api.send_log(result)\n    return result\n\n@app.task(generate_handler=log_crm, echo=True)\nasync def export_orders():\n    for order in await db.get_exportable_orders():\n        yield order.to_dict()\n</code></pre>"},{"location":"examples/practice/small_business/#error-handling-and-task-restart","title":"\ud83d\udee0 Error handling and task restart","text":"<pre><code>@app.task(retry=3, retry_on_exc=[ConnectionError])\nasync def sync_with_crm():\n    await crm_api.sync()\n</code></pre>"},{"location":"examples/practice/small_business/#benefits-of-qtasks-for-business","title":"\ud83d\udcc8 Benefits of QTasks for business","text":"<ul> <li>Automation without external queues (by default)</li> <li>Convenient timers for daily and weekly tasks</li> <li>Built-in error handling and restarts</li> <li>Flexible architecture: can be extended to meet the needs of CRM, BI, warehouses, and logistics.</li> </ul>"},{"location":"examples/practice/small_business/#result","title":"\u2705 Result","text":"<p>With QTasks, small businesses can build an automated data processing system that will work stably, scale as they grow, and does not require a complex DevOps infrastructure from the team.</p>"},{"location":"features/","title":"QTasks Features","text":"<p>QTasks is a modern task queue framework built around the ideas of full extensibility, minimalist architecture, and ease of use. It is equally well suited for small projects and large distributed infrastructures.</p> <p>This page describes the key features of the framework, including its unique architectural features.</p>"},{"location":"features/#simple-and-quick-setup","title":"Simple and quick setup","text":"<ul> <li>Register tasks via <code>@app.task</code> \u2014 synchronous and asynchronous.</li> <li>Native support for <code>asyncio</code> without GIL restrictions.</li> <li>Easy application connection via CLI: <code>qtasks -A app:app run</code>.</li> <li>Flexible configuration: default parameters or custom components.</li> </ul>"},{"location":"features/#unique-architectural-features","title":"Unique architectural features","text":""},{"location":"features/#component-based-architecture","title":"\ud83d\udd27 Component-based architecture","text":"<p>Every element of the system can be replaced:</p> <ul> <li>Broker</li> <li>Worker</li> <li>Storage</li> <li>GlobalConfig</li> <li>Starter</li> <li>TaskExecutor</li> </ul> <p>This allows QTasks to be adapted to any scenario: in-memory testing, distributed systems, custom brokers, alternative executors.</p>"},{"location":"features/#fully-replaceable-taskexecutor","title":"\u2699\ufe0f Fully replaceable TaskExecutor","text":"<p>The task execution logic is isolated in a separate class. It can be replaced via:</p> <pre><code>@app.task(executor=MyTaskExecutor)\n</code></pre> <p>This gives control over:</p> <ul> <li>error handling,</li> <li>retry strategies,</li> <li>middleware,</li> <li>custom execution pipelines.</li> </ul>"},{"location":"features/#working-with-tasks","title":"Working with tasks","text":""},{"location":"features/#support-for-yield-in-tasks","title":"\u2714\ufe0f Support for <code>yield</code> in tasks","text":"<p>QTasks allows you to use generators in tasks.</p> <pre><code>@app.task(generate_handler=gen_handler)\ndef mytask():\n    value = yield \"step1\"\n    return value\n</code></pre> <p><code>gen_handler(result)</code> accepts the value passed through yield, and the result of <code>return</code> is returned to the task.</p> <p>This allows you to build step-by-step task execution scenarios.</p>"},{"location":"features/#depends-support","title":"\u2714\ufe0f Depends support","text":"<p>The Depends plugin allows you to embed dependencies in tasks.</p> <pre><code>@app.task\ndef process(data: int, db=Depends(get_db, scope=\"worker\")):\n    return db.save(data)\n</code></pre> <p>Scopes:</p> <ul> <li><code>task</code></li> <li><code>worker</code></li> <li><code>broker</code></li> <li><code>storage</code></li> <li><code>global_config</code></li> </ul> <p>The framework automatically creates and correctly closes the dependency context.</p>"},{"location":"features/#state-support","title":"\u2714\ufe0f State support","text":"<p>A thread-safe way to transfer data between tasks.</p> <pre><code>from qtasks.plugins import AsyncState\n\nclass MyState(AsyncState):\n    pass\n\n@app.task\ndef sample(state: MyState):\n    ...\n</code></pre> <p>State allows a task to safely transfer intermediate data in stages.</p>"},{"location":"features/#integration-with-message-brokers","title":"Integration with message brokers","text":"<ul> <li>Redis \u2014 the main supported broker.</li> <li>RabbitMQ \u2014 available through additional installation.</li> <li>Kafka \u2014 also supported.</li> </ul> <p>Brokers are easy to connect:</p> <pre><code>app = QueueTasks(broker_url=\"redis://localhost:6379/0\")\n</code></pre> <p>If necessary, you can pass your own broker implementation.</p>"},{"location":"features/#extensibility-and-plugins","title":"Extensibility and plugins","text":"<p>QTasks provides a multi-level trigger system:</p> <ul> <li>for task execution,</li> <li>for argument changes,</li> <li>for result changes,</li> <li>for events within components.</li> </ul> <p>Plugins are easy to add:</p> <pre><code>app.add_plugin(MyPlugin(), trigger_names=[\"task_executor_args_replace\"], component=\"worker\")\n</code></pre> <p>The framework supports the creation of additional tools: gRPC task transfer, unified middleware, Depends, State.</p>"},{"location":"features/#scalability","title":"Scalability","text":"<p>QTasks scales horizontally thanks to a simple, reliable model:</p> <p>\"Whoever takes the task first, processes it.\"</p> <p>This ensures:</p> <ul> <li>multiple workers running simultaneously;</li> <li>natural load balancing;</li> <li>distributed task execution without complex algorithms.</li> </ul>"},{"location":"features/#asynchronous-task-processing","title":"Asynchronous task processing","text":"<p>Asynchronous mode has the following advantages:</p> <ul> <li>high performance;</li> <li>thread safety (using Semaphore and PriorityQueue);</li> <li>task context encapsulation;</li> <li>easy integration into other frameworks.</li> </ul> <p>Asynchronous tasks are declared as:</p> <pre><code>@app.task\nasync def handler(x: int):\n    return x * 2\n</code></pre>"},{"location":"features/#monitoring-and-statistics","title":"Monitoring and statistics","text":"<p>(Description of analytics \u2014 on a separate page.)</p> <p>Features include:</p> <ul> <li><code>(A)syncStats</code> for obtaining application and task statistics;</li> <li>outputting statistics via CLI: <code>qtasks stats inspect ...</code>.</li> </ul> <p>These features make QTasks more than just a task queue; it is a flexible and extensible framework that can be easily adapted to real-world business scenarios.</p>"},{"location":"features/contexts/","title":"Contexts \u2014 Task contexts","text":"<p>During execution, each QTasks task gains access to the execution context \u2014 the (A)syncContext object. The context provides a safe and unified way for the task to interact with the application environment, worker, plugins, and execution metadata.</p> <p>The context is accessible via <code>self.ctx</code> inside the <code>(A)syncTask</code> object.</p> <p>The context is accessible via <code>self.ctx</code> inside the <code>(A)syncTask</code> object.</p>"},{"location":"features/contexts/#passing-the-context-to-the-task-function","title":"Passing the context to the task function","text":"<p>The context can be passed directly to the task function using the <code>echo=True</code> parameter in the <code>@app.task</code> decorator.</p> <pre><code>@app.task(echo=True)\nasync def my_task(self):\n    print(self.ctx.task_name)\n</code></pre> <p>In this case:</p> <ul> <li>the first argument of the function is passed as a duplicated (A)syncContext;</li> <li>the parameter name can be anything;</li> <li>for convenience and consistency, it is recommended to use the name <code>self</code>.</li> </ul> <p>The context is added at the task execution stage and does not affect its registration.</p>"},{"location":"features/contexts/#purpose-of-the-context","title":"Purpose of the context","text":"<p>(A)syncContext is intended for:</p> <ul> <li>accessing the current task data;</li> <li>interacting with the application (<code>QueueTasks</code>);</li> <li>working with logging;</li> <li>managing execution (sleep, cancel);</li> <li>interacting with plugins and triggers;</li> <li>obtaining metadata and configuration.</li> </ul> <p>The context does not contain business logic and serves solely as an interface for the execution environment.</p>"},{"location":"features/contexts/#task-generation-yield","title":"Task generation (yield)","text":"<ul> <li><code>self.ctx.generate_handler</code> \u2014 generation handler function for yield tasks.</li> </ul> <p>Used in conjunction with the decorator parameter:</p> <pre><code>@app.task(generate_handler=gen_func)\n</code></pre>"},{"location":"features/contexts/#logging","title":"Logging","text":"<pre><code>self.ctx.get_logger(name: str | None = None)\n</code></pre> <p>Returns an instance of <code>qtasks.logs.Logger</code> associated with the task.</p> <ul> <li>If <code>name</code> is not specified, <code>task_name</code> is used.</li> <li>If the task name is missing, <code>(A)syncContext</code> is used.</li> </ul>"},{"location":"features/contexts/#configuration-and-metadata","title":"Configuration and metadata","text":"<ul> <li> <p><code>self.ctx.get_config()</code> \u2014 returns <code>app.config</code>.</p> </li> <li> <p><code>self.ctx.get_metadata(cache: bool = True)</code> \u2014 returns task metadata via <code>app.get(self.ctx.task_uuid)</code>.</p> </li> </ul> <p>When <code>cache=True</code>, the result is cached within the context and repeated calls do not access the storage.</p>"},{"location":"features/contexts/#working-with-tasks","title":"Working with tasks","text":"<ul> <li><code>self.ctx.get_task(uuid: UUID | str)</code> \u2014 returns the task via <code>app.get(uuid)</code>.</li> </ul>"},{"location":"features/contexts/#managing-execution","title":"Managing execution","text":"<ul> <li><code>self.ctx.sleep(seconds: float)</code> \u2014 calls <code>time.sleep</code> or <code>asyncio.sleep</code> depending on the task type.</li> <li><code>self.ctx.cancel(reason: str = \"\")</code> \u2014 initiates task cancellation by raising:</li> </ul> <pre><code>raise TaskCancelError(reason or f\"{self.ctx.task_name}.cancel\")\n</code></pre> <pre><code>raise TaskCancelError(reason or f\"{self.ctx.task_name}.cancel\")\n</code></pre> <p>The cancellation is handled by the worker as a correct completion of the task.</p>"},{"location":"features/contexts/#interaction-with-plugins","title":"Interaction with plugins","text":"<ul> <li><code>self.ctx.plugin_error(**kwargs)</code> \u2014 throws <code>TaskPluginTriggerError(**kwargs)</code>.</li> </ul> <p>Used to notify plugins that have a trigger:</p> <pre><code>task_executor_run_task_trigger_error\n</code></pre>"},{"location":"features/contexts/#accessing-application-components","title":"Accessing application components","text":"<ul> <li><code>self.ctx.get_component(name: str)</code> \u2014 equivalent to <code>getattr(app, name, None)</code>. Allows you to access any registered QTasks component.</li> </ul>"},{"location":"features/contexts/#app-source","title":"app source","text":"<p>The <code>app</code> instance enters the context in one of the following ways:</p> <ul> <li>at the task execution stage via <code>TaskExecutor</code>, which complements <code>(A)syncTask</code> and its <code>ctx</code>;</li> <li>via the global reference <code>qtasks._state.app_main</code>, if the task was called outside the explicit context.</li> </ul> <p>This provides unified access to the application regardless of the launch scenario.</p>"},{"location":"features/contexts/#summary","title":"Summary","text":"<p>(A)syncContext:</p> <ul> <li>is the task execution environment interface;</li> <li>isolates business logic from infrastructure;</li> <li>provides access to configuration, logs, and metadata;</li> <li>is used to manage the task lifecycle;</li> <li>serves as a point of integration with plugins and components.</li> </ul> <p>The page is designed as a canvas and can be used as basic documentation for context, echo tasks, and QTasks plugin mechanisms.</p>"},{"location":"features/depends/","title":"Depends","text":"<p>QTasks supports managed dependencies for tasks through the <code>Depends</code> mechanism. It allows you to declare task parameters so that their values are automatically created and correctly cleared in the appropriate context.</p>"},{"location":"features/depends/#example-of-using-depends","title":"Example of using Depends","text":"<pre><code>from typing import Annotated\nfrom contextlib import asynccontextmanager\n\nfrom qtasks.plugins.depends import Depends, ScopeEnum\n\n\n@asynccontextmanager\nasync def test_dep():\n    print(\"Open\")\n    yield 123\n    print(\"Close\")\n\n\n@app.task\nasync def test(dep: Annotated[int, Depends(test_dep, scope=ScopeEnum.TASK)]):\n    print(dep)\n</code></pre> <p>When the task is executed, the output will be as follows:</p> <pre><code>Open\n123\nClose\n</code></pre> <p>What happens:</p> <ul> <li>When the task starts, the <code>test_dep()</code> context opens.</li> <li>The value <code>123</code> is passed to the task body.</li> <li>When the task finishes, the context closes and <code>Close</code> is printed.</li> </ul>"},{"location":"features/depends/#how-depends-works-under-the-hood","title":"How Depends works \"under the hood\"","text":"<p>The Depends mechanism is implemented in a built-in worker plugin \u2014 <code>(A)syncDependsPlugin</code>. Below is a simplified description of the steps.</p>"},{"location":"features/depends/#1-searching-for-depends-in-task-parameters","title":"1. Searching for Depends in task parameters","text":"<p>When preparing to execute a task, the plugin:</p> <ul> <li>checks for the presence of <code>Depends</code> as an explicit parameter value (<code>dep = Depends(...)</code>);</li> <li>or searches for it inside <code>Annotated[..., Depends(...)]</code> (takes the last element of <code>Annotated</code>).</li> </ul> <p>If <code>Depends</code> is found, the task is marked as having a dependency.</p>"},{"location":"features/depends/#2-creating-a-context-via-asyncexitstack","title":"2. Creating a context via (Async)ExitStack","text":"<p><code>AsyncExitStack</code> (or <code>ExitStack</code> for synchronous tasks) is used to manage the dependency lifecycle:</p> <ol> <li>The plugin enters the <code>test_dep()</code> context via the context manager stack.</li> <li>The value obtained from <code>yield</code> (in the example \u2014 <code>123</code>) is saved as a parameter value.</li> </ol>"},{"location":"features/depends/#3-processing-the-scope-lifetime-of-the-dependency","title":"3. Processing the scope (lifetime of the dependency)","text":"<p>The dependency lives in a specific \"scope\" defined by <code>ScopeEnum</code>:</p> <pre><code>class ScopeEnum(Enum):\n    TASK = \"task\"\n    WORKER = \"worker\"\n    BROKER = \"broker\"\n    STORAGE = \"storage\"\n    GLOBAL_CONFIG = \"global_config\"\n</code></pre> <p>Logic:</p> <ul> <li><code>TASK</code> \u2014 the context opens when the task starts and closes when it finishes.</li> <li>The other options (<code>WORKER</code>, <code>BROKER</code>, <code>STORAGE</code>, <code>GLOBAL_CONFIG</code>) link the context to the component resource.</li> </ul> <p>Technically, this is implemented through triggers:</p> <ul> <li><code>TASK</code> \u2014 closes on the <code>task_executor_task_close</code> trigger;</li> <li>the rest \u2014 on component completion triggers: <code>\"{component}_stop\"</code>.</li> </ul>"},{"location":"features/depends/#4-task-argument-substitution","title":"4. Task argument substitution","text":"<p>After receiving a value from the dependency function, the plugin:</p> <ul> <li>replaces the task parameter (<code>dep</code>) with the result of <code>test_dep()</code>;</li> <li>the task receives a ready-made value (for example, an open connection, a session object, a number, a config, etc.).</li> </ul>"},{"location":"features/depends/#why-depends-is-needed","title":"Why Depends is needed","text":"<p>Depends solves the problem of managed dependencies:</p> <ul> <li>creating and closing resources in the right context (at the task or component level);</li> <li>no need to manually work with context managers inside the body of tasks;</li> <li>a single point of description of dependencies for different tasks.</li> </ul> <p>This is a convenient way to embed a connection to a database, an external service client, a cache, a config, and other resources into QTasks tasks so that their lifecycle is controlled by the framework.</p>"},{"location":"features/pydantic/","title":"Pydantic","text":"<p>There is a plugin built into Worker called (A)syncPydanticWrapperPlugin, which automatically converts the input parameters of a task into Pydantic models. It makes working with typed data structures natural and transparent: the model is assembled right before the task function is called, and the developer receives a ready-made, validated object.</p> <p>The plugin works without additional configuration. Any task that accepts a model parameter will support automatic assembly.</p>"},{"location":"features/pydantic/#example-of-use","title":"Example of use","text":"<pre><code>import pydantic\nfrom qtasks.asyncio import QueueTasks\n\napp = QueueTasks()\n\nclass Item(pydantic.BaseModel):\n    name: str\n    value: int\n\n@app.task(\n    description=\"Test task using Pydantic.\",\n    tags=[\"example\"],)\n\nasync def example_pydantic(item: Item):\n    return f\"Hello, {item.name}!\"\n</code></pre> <p>All of the following options will be equivalent \u2014 QTasks will correctly assemble the model:</p> <pre><code>task = await example_pydantic.add_task(\"Test\", value=42, timeout=50)\ntask = await example_pydantic.add_task(\"Test\", 42, timeout=50)\ntask = await example_pydantic.add_task(name=\"Test\", value=42, timeout=50)\n</code></pre> <p>Each of these will result in the creation of the same model:</p> <pre><code>Item(name=\"Test\", value=42)\n</code></pre>"},{"location":"features/pydantic/#under-the-hood","title":"Under the hood","text":"<p>The plugin works sequentially.</p>"},{"location":"features/pydantic/#1-model-assembly","title":"1. Model assembly","text":"<p>The plugin:</p> <ol> <li>Analyzes the task signature.</li> <li>Finds parameters that are inheritors of <code>pydantic.BaseModel</code>.</li> <li>Extracts suitable <code>kwargs</code>.</li> <li>Uses residual positional arguments <code>args</code> if necessary.</li> <li>Assembles the model:</li> </ol> <pre><code>model = Item(*args_from_task, **kwargs_from_task)\n</code></pre>"},{"location":"features/pydantic/#2-cleaning-arguments","title":"2. Cleaning arguments","text":"<p>All parameters used in creating the model are removed from the actual arguments. The remaining arguments are passed to the task unchanged.</p> <p>This allows you to flexibly combine the model with other parameters:</p> <pre><code>@app.task\nasync def task_with_mix(item: Item, retries: int = 3):\n    ...\n</code></pre>"},{"location":"features/pydantic/#returning-models","title":"Returning models","text":"<p>If the task returns a <code>BaseModel</code> object, QTasks automatically converts it to a serializable dictionary using:</p> <pre><code>model.model_dump()\n</code></pre> <p>Example:</p> <pre><code>@app.task\nasync def create_item() -&gt; Item:\n    return Item(name=\"Generated\", value=10)\n</code></pre> <p>Actual result stored in the system:</p> <pre><code>{\"name\": \"Generated\", \"value\": 10}\n</code></pre>"},{"location":"features/pydantic/#features","title":"Features","text":"<ul> <li>Any descendants of <code>BaseModel</code> are supported.</li> <li>Assembly is performed on the Worker side before calling the user function.</li> <li>The plugin does not change the task signature.</li> <li>Models can be combined with positional and named arguments.</li> <li>Models are automatically serialized as a result of the task.</li> </ul>"},{"location":"features/pydantic/#summary","title":"Summary","text":"<p>(A)syncPydanticWrapperPlugin provides:</p> <ul> <li>Transparent work with typed structures.</li> <li>Automatic validation of incoming data.</li> <li>Convenient integration of models into the task signature.</li> <li>Standard data return format.</li> </ul>"},{"location":"features/states/","title":"States","text":"<p>The <code>State</code> mechanism in QTasks allows you to securely store and transfer data between tasks. It is implemented in the built-in worker plugin <code>(A)StatePlugin</code> and provides a convenient interface for working with state.</p>"},{"location":"features/states/#example-of-using-state","title":"Example of using State","text":"<pre><code>from qtasks.plugins.states import AsyncState\n\n\nclass MyState(AsyncState):\n    pass\n\n\n@app.task\nasync def step1(state: MyState):\n    await state.set(\"state\", \"await_phone\")\n    await state.update(step=1, prompt=\"Enter phone number\")\n    return \"ok\"\n\n\n@app.task\nasync def step2(state: MyState):\n    print(await state.get_all())\n\n    cur = await state.get(\"state\")\n    if cur != \"await_phone\":\n        return \"error\"\n\n    await state.update(step=2)\n    await state.delete(\"state\")\n    await state.clear()\n    return \"ok\"\n</code></pre> <p>Output of <code>print(await state.get_all())</code>:</p> <pre><code>{'state': 'await_phone', 'step': 1, 'prompt': 'Enter phone number'}\n</code></pre> <p>Scenario:</p> <ul> <li><code>step1</code> initializes the state and writes several values.</li> <li><code>step2</code> reads the state, checks it, updates it, and clears it.</li> </ul> <p>This way, multiple tasks can work with a shared thread-safe state.</p>"},{"location":"features/states/#how-it-works-under-the-hood","title":"How it works \"under the hood\"","text":"<p>Below is a simplified description of the internal logic of <code>(A)StatePlugin</code>.</p>"},{"location":"features/states/#1-searching-for-state-in-task-parameters","title":"1. Searching for State in task parameters","text":"<p>The plugin analyzes the task signature and checks whether the parameter type is a subclass of <code>AsyncState</code> or <code>State</code>:</p> <pre><code>issubclass(MyState, (AsyncState, State))\n</code></pre> <p>If such a parameter is found, the task is considered to use state.</p>"},{"location":"features/states/#2-initializing-state-and-stateregistry","title":"2. Initializing State and StateRegistry","text":"<p>If <code>__init__</code> has not yet been called for <code>MyState</code>, the plugin:</p> <ul> <li>creates an instance of the state class (<code>MyState()</code>),</li> <li>links it to the internal registry <code>(A)syncStateRegistry</code>.</li> </ul> <p>The registry is responsible for storing values \"inside\" and uses locks:</p> <ul> <li><code>asyncio.Lock()</code> \u2014 for asynchronous tasks,</li> <li><code>threading.Lock()</code> \u2014 for synchronous tasks.</li> </ul> <p>This ensures that parallel tasks cannot simultaneously modify the same data in an inconsistent manner.</p>"},{"location":"features/states/#3-parameter-substitution-in-a-task","title":"3. Parameter substitution in a task","text":"<p>After initialization, the plugin replaces the task function parameter with the ready-made <code>MyState</code> object. Inside the task body, the developer already works with a full-fledged state API.</p>"},{"location":"features/states/#state-asyncstate-api","title":"<code>State</code> / <code>AsyncState</code> API","text":"<p>The main state methods are listed below.</p>"},{"location":"features/states/#get","title":"<code>get</code>","text":"<pre><code>value = await state.get(\"key\", default=None)\n</code></pre> <ul> <li><code>key</code> \u2014 state key (if <code>None</code>, all values are returned).</li> <li><code>default</code> \u2014 default value if the key is not found.</li> </ul>"},{"location":"features/states/#get_all","title":"<code>get_all</code>","text":"<pre><code>data = await state.get_all()\n</code></pre> <p>Returns a dictionary of all state values.</p>"},{"location":"features/states/#set","title":"<code>set</code>","text":"<pre><code>await state.set(\"key\", value)\n</code></pre> <p>Sets the state value by key.</p>"},{"location":"features/states/#update","title":"<code>update</code>","text":"<pre><code>data = await state.update(step=1, prompt=\"Enter phone number\")\n</code></pre> <p>Updates multiple values at once and returns the updated dictionary.</p>"},{"location":"features/states/#delete","title":"<code>delete</code>","text":"<pre><code>await state.delete(\"key\")\n</code></pre> <p>Deletes the value by key.</p>"},{"location":"features/states/#clear","title":"<code>clear</code>","text":"<pre><code>await state.clear()\n</code></pre> <p>Clears all state values.</p>"},{"location":"features/states/#purpose-of-the-state-mechanism","title":"Purpose of the State mechanism","text":"<p>The <code>State</code> mechanism solves the problem of thread-safe data transfer between tasks:</p> <ul> <li>shared memory for related tasks (script steps, chains, dialogs);</li> <li>protection against races during parallel access to the state;</li> <li>a unified interface for reading, writing, and clearing data.</li> </ul> <p>This is a convenient tool for building complex step-by-step processes and scenarios that require context preservation between tasks.</p>"},{"location":"features/stats/","title":"Stats","text":"<p>There is a built-in additional component (A)syncStats designed for analytics and inspection of the QTasks application status. The component is initialized with the <code>app=app</code> parameter and provides access to application metadata and registered tasks without executing them.</p> <p>Stats is focused on diagnostics, debugging, configuration monitoring, and building external tools (CLI, WebView, administration panels).</p> <p>Stats is focused on diagnostics, debugging, configuration monitoring, and building external tools (CLI, WebView, administration panels).</p>"},{"location":"features/stats/#capabilities","title":"Capabilities","text":"<p>Currently, the component provides inspection capabilities through the InspectStats object.</p>"},{"location":"features/stats/#inspectstatsinspect","title":"InspectStats.inspect","text":"<p><code>(A)syncStats.inspect \u2192 InspectStats</code></p> <p>Returns an inspection object through which analytics methods are available.</p>"},{"location":"features/stats/#application-information","title":"Application Information","text":""},{"location":"features/stats/#inspectstatsappjson-bool-false","title":"InspectStats.app(json: bool = False)","text":"<p>Allows you to get complete information about the current instance of QTasks.</p> <p>Example of text output:</p> <pre><code>Name: QueueTasks\nMethod: async\nVersion: 1.7.0\nConfiguration              : QueueConfig(max_tasks_process=10, running_older_tasks=True,\ndelete_finished_tasks=False, task_default_priority=0, task_default_decode=None,\nlogs_default_level_server=10, logs_default_level_client=20, logs_format='%(asctime)s\n[%(name)s: %(levelname)s] (%(subname)s) %(message)s', result_time_interval=0.1,\nresult_statuses_end=['success', 'error', 'cancel'])\nNumber of tasks: 14\nNumber of routers: 1\nNumber of plugins: 16\nBroker: AsyncRedisBroker\nWorker: AsyncWorker\nStarter: AsyncStarter\nStorage: AsyncRedisStorage\nGlobalConfig: AsyncRedisGlobalConfig\nLog: Logger\nNumber of initializations: 0\n--------------------------------------------------\n</code></pre> <p>When <code>json=True</code>, the method returns a structured dictionary suitable for serialization and transfer to external systems.</p>"},{"location":"features/stats/#task-information","title":"Task information","text":""},{"location":"features/stats/#inspectstatstaskstasks-tuplestr-json-bool-false","title":"InspectStats.tasks(*tasks: tuple[str], json: bool = False)","text":"<p>Returns information about registered tasks.</p> <ul> <li>Without arguments \u2014 for all tasks.</li> <li>With task names specified \u2014 only for selected tasks.</li> </ul> <p>Example (abbreviated output for two tasks):</p> <pre><code>Task name: sync_test\nPriority: 0\nDescription: Test synchronous task with decorator.\nTags: \u2014\nAsynchronous: False\nGeneration: sync\nSelf before task: True\nArgs: self: SyncTask\nKwargs: \u2014\nMiddleware after: [&lt;class 'libs.task_middleware.MyTaskMiddleware'&gt;]\n--------------------------------------------------\nTask name: async_test\nPriority: 0\nDescription: Test asynchronous task.\nTags: \u2014\nAsynchronous: True\nGeneration: False\nSelf before task: False\nArgs: \u2014\nKwargs: \u2014\n--------------------------------------------- -----\n</code></pre> <p>When <code>json=True</code>, data is returned as a structured dictionary.</p>"},{"location":"features/stats/#information-about-a-single-task","title":"Information about a single task","text":""},{"location":"features/stats/#inspectstatstasktask_name-str-json-bool-false","title":"InspectStats.task(task_name: str, json: bool = False)","text":"<p>Returns information about a single task. Functionally equivalent to <code>tasks</code>, but intended for specific queries.</p>"},{"location":"features/stats/#using-via-cli","title":"Using via CLI","text":"<p>The Stats component is integrated into the CLI (currently in a synchronous version).</p>"},{"location":"features/stats/#mandatory-inspection-command","title":"Mandatory inspection command","text":"<pre><code>qtasks -A app:app stats inspect\n</code></pre> <p>The command displays basic information and available inspection methods.</p>"},{"location":"features/stats/#calling-inspectstats-methods-via-cli","title":"Calling InspectStats methods via CLI","text":"<pre><code>qtasks -A app:app stats inspect &lt;method&gt; &lt;params&gt;\n</code></pre> <p>The call is made via <code>getattr</code>, which allows you to access any <code>InspectStats</code> method.</p> <p>Example:</p> <pre><code>qtasks -A app:app stats inspect tasks task1 task2 json=True\n</code></pre>"},{"location":"features/stats/#features","title":"Features","text":"<ul> <li>Stats does not initiate task execution.</li> <li>The component only works with metadata and configuration.</li> <li>Text and JSON output formats are supported.</li> <li>Designed for CLI, WebView, and external analytics tools.</li> </ul>"},{"location":"features/stats/#summary","title":"Summary","text":"<p>(A)syncStats provides:</p> <ul> <li>centralized application inspection;</li> <li>access to task metadata and configuration;</li> <li>a basis for monitoring and administration;</li> <li>an extensible API for future analytics.</li> </ul> <p>The page is designed as a canvas and can be used as a template for documenting the analytical and inspection components of QTasks.</p>"},{"location":"features/task/","title":"Task decorator","text":"<p>The <code>@app.task</code> decorator is the key point for registering tasks in QTasks. When the decorator is applied, the task function is converted into a management object that stores both the task metadata and the methods for calling and executing it.</p> <p>When a task is registered, two related views are generated:</p> <p>When a task is registered, two related representations are formed:</p> <ul> <li>(A)syncTask \u2014 the user interface of the task, through which <code>add_task</code> calls and execution control are performed.</li> <li>TaskExecSchema \u2014 a dataclass used inside <code>app.tasks</code> and <code>app.worker.tasks</code> to transfer and store executable task information, including the function itself.</li> </ul> <p>Both objects contain a consistent set of data, but are used at different levels of the system.</p>"},{"location":"features/task/#general-model","title":"General model","text":"<p>For further description, we will assume that <code>task_func</code> is a function wrapped by the <code>@app.task()</code> decorator.</p> <pre><code>@app.task()\nasync def task_func(...):\n    ...\n</code></pre> <p>After registration, <code>task_func</code> ceases to be a regular function and becomes an instance of (A)syncTask.</p>"},{"location":"features/task/#task-parameters","title":"Task parameters","text":"<p>The <code>@app.task</code> decorator accepts the following task configuration parameters:</p> Parameter Type Description <code>name</code> <code>str, optional</code> Task name. Default: <code>func.__name__</code>. <code>priority</code> <code>int, optional</code> Task priority. Default: <code>config.task_default_priority</code>. <code>echo</code> <code>bool, optional</code> Adds AsyncTask as the first parameter. Default: <code>False</code>. <code>max_time</code> <code>float, optional</code> Maximum task execution time in seconds. Default: <code>None</code>. <code>retry</code> <code>int, optional</code> Number of attempts to retry the task. Default: <code>None</code>. <code>retry_on_exc</code> <code>List[Type[Exception]], optional</code> Exceptions that will cause the task to be retried. Default: <code>None</code>. <code>decode</code> <code>Callable, optional</code> Decoder for the task result. Default: <code>None</code>. <code>tags</code> <code>List[str], optional</code> Task tags. Default: <code>None</code>. <code>description</code> <code>str, optional</code> Task description. Default: <code>None</code>. <code>generate_handler</code> <code>Callable, optional</code> Handler generator. Default: <code>None</code>. <code>executor</code> <code>Type[\"BaseTaskExecutor\"], optional</code> <code>BaseTaskExecutor</code> class. Default: <code>AsyncTaskExecutor</code>. <code>middlewares_before</code> <code>List[Type[\"TaskMiddleware\"]], optional</code> Middlewares that will be executed before the task. Default: <code>Empty array</code>. <code>middlewares_after</code> <code>List[Type[\"TaskMiddleware\"]], optional</code> Middleware that will be executed after the task. Default: <code>Empty array</code>. <code>**kwargs</code> - Additional task parameters. Passed as extra in <code>(A)syncTask</code> and <code>TaskExecSchema</code>."},{"location":"features/task/#asynctask","title":"(A)syncTask","text":"<p>(A)syncTask is a wrapper object over a task and provides an API for calling it and pre-configuring it.</p>"},{"location":"features/task/#pre-building-a-task","title":"Pre-building a task","text":"<pre><code>cls = task_func(*args, **kwargs, priority=0, timeout=None)\n</code></pre> <p>In this case:</p> <ul> <li>arguments and parameters are saved in advance;</li> <li>an instance of (A)syncTaskCls (a descendant of <code>BaseTaskCls</code>) is created;</li> <li>the object is a dataclass and contains all the data necessary to queue the task.</li> </ul> <p>Such an object can be passed, modified, or called later.</p>"},{"location":"features/task/#calling-a-task","title":"Calling a task","text":"<p>There are two equivalent ways to start a task:</p> <pre><code>task_func.add_task(*args, **kwargs, priority=0, timeout=None)\n</code></pre> <p>or</p> <pre><code>cls.add_task()\n</code></pre> <p>In both cases, <code>app.add_task</code> is called:</p> <ul> <li>either through <code>app</code>, passed at the time of creating <code>(A)syncTask</code>;</li> <li>or through <code>qtasks._state.app_main</code>, if the task was called outside the explicit context of the application.</li> </ul> <p>This allows tasks to be used both within the application and in isolated modules.</p>"},{"location":"features/task/#waiting-for-a-result-timeout","title":"Waiting for a result (timeout)","text":"<p>The <code>timeout: float | None</code> parameter determines the behavior of the task call.</p> <ul> <li>If <code>timeout is None</code>, <code>add_task</code> immediately returns a <code>Task</code> object with status <code>new</code>.</li> <li>If <code>timeout</code> is specified, the call is blocked until the result is received and returns an <code>(A)syncResult</code> object.</li> </ul> <p>The wait ends when one of the final statuses specified in the application configuration is reached:</p> <pre><code>app.config.result_statuses_end = [\n    TaskStatusEnum.SUCCESS.value,\n    TaskStatusEnum.ERROR.value,\n    TaskStatusEnum.CANCEL.value,\n]\n</code></pre>"},{"location":"features/task/#taskexecschema","title":"TaskExecSchema","text":"<p><code>TaskExecSchema</code> is a dataclass used to transfer tasks between QTasks components.</p> <p>It stores:</p> <ul> <li>task name;</li> <li>priority;</li> <li>execution parameters;</li> <li>reference to the task function;</li> <li>additional metadata.</li> </ul> <p><code>TaskExecSchema</code> instances are created when a task is registered and are available in:</p> <ul> <li><code>app.tasks</code>;</li> <li><code>app.worker.tasks</code>.</li> </ul> <p>Worker uses <code>TaskExecSchema</code> to actually execute the task.</p>"},{"location":"features/task/#separation-of-responsibilities","title":"Separation of responsibilities","text":"<p>This separation allows you to:</p> <ul> <li>isolate the user API from internal execution;</li> <li>safely transfer tasks between components;</li> <li>extend the task model through plugins and schemas;</li> <li>support synchronous and asynchronous modes without duplicating logic.</li> </ul>"},{"location":"features/task/#summary","title":"Summary","text":"<p>The <code>@app.task</code> decorator:</p> <ul> <li>registers the function as a QTasks task;</li> <li>creates an <code>(A)syncTask</code> object to manage calls;</li> <li>forms <code>TaskExecSchema</code> for internal execution;</li> <li>provides flexible control over launch parameters and result waiting.</li> </ul> <p>The page is designed as a canvas and can be used as basic material for sections about tasks, context, and execution.</p>"},{"location":"features/timer/","title":"Timer","text":"<p>There is a built-in additional component (A)syncTimer designed to periodically launch QTasks tasks. The timer integrates directly with <code>QueueTasks</code> through the <code>app</code> parameter and works with tasks as a schedule, rather than with single calls.</p> <p>(A)syncTimer allows you to remove scheduling logic from business code and use declarative triggers to launch tasks on a schedule.</p>"},{"location":"features/timer/#how-it-works","title":"How it works","text":"<p>Timer is a separate component that:</p> <ul> <li>registers periodic tasks;</li> <li>uses external triggers (e.g., cron);</li> <li>initiates task execution through the standard QTasks mechanism;</li> <li>does not change the logic of the tasks themselves.</li> </ul> <p>A task launched through Timer remains a regular QTasks task and can be called manually, through the API, or by other components.</p>"},{"location":"features/timer/#example-of-use","title":"Example of use","text":"<pre><code>from qtasks.timers import AsyncTimer\nfrom apscheduler.triggers.cron import CronTrigger\n\ntimer = AsyncTimer(app=app)\n\ntimer.add_task(\n    \"daily_report\",\n    trigger=CronTrigger(hour=23, minute=59),)\n\n\n@app.task(name=\"daily_report\")\nasync def daily_report():\n    stats = await db.get_today_stats()\n    await mailer.send(\n        \"owner@shop.com\",\n        \"Daily report\",\n        stats.format(),\n    )\n</code></pre> <p>In this example, the <code>daily_report</code> task will automatically run every day at 23:59.</p>"},{"location":"features/timer/#under-the-hood","title":"Under the hood","text":"<p>Timer works in the following stages:</p> <ol> <li>Timer is initialized with an instance of <code>QueueTasks</code>.</li> <li> <p>When <code>add_task</code> is called:</p> </li> <li> <p>the task name is saved;</p> </li> <li>the launch trigger is registered;</li> <li>a \"trigger \u2192 task\" pair is formed.</li> <li> <p>When the trigger is activated:</p> </li> <li> <p>Timer creates a regular task call via <code>add_task</code>;</p> </li> <li>the task goes to the Broker and is processed by the Worker as standard.</li> </ol> <p>Thus, Timer does not execute the task directly and does not bypass the queue.</p>"},{"location":"features/timer/#triggers","title":"Triggers","text":"<p>(A)syncTimer does not restrict the type of trigger. In practice, triggers from <code>apscheduler</code> are most often used, for example:</p> <ul> <li><code>CronTrigger</code> \u2014 cron schedule;</li> <li><code>IntervalTrigger</code> \u2014 launch at fixed intervals;</li> <li><code>DateTrigger</code> \u2014 one-time launch at a specified time. This allows you to flexibly manage the schedule without changing the task code.</li> </ul> <p>This allows you to flexibly manage the schedule without changing the task code.</p>"},{"location":"features/timer/#features","title":"Features","text":"<ul> <li>Timer is an additional component and is not required for QTasks to work.</li> <li>The timer works with tasks by name, not by function reference.</li> <li>Tasks registered in Timer are fully compatible with retry, priority, middlewares, and plugins.</li> <li>Timer does not store the execution status of tasks \u2014 this is handled by the standard QTasks storage.</li> </ul>"},{"location":"features/timer/#summary","title":"Summary","text":"<p>(A)syncTimer provides:</p> <ul> <li>declarative task scheduling;</li> <li>integration with external scheduling systems;</li> <li>a unified mechanism for launching tasks via a queue;</li> <li>a clear separation of business logic and scheduling logic.</li> </ul> <p>The page is designed as a canvas and can be used as a template for documenting other additional QTasks components.</p>"},{"location":"features/uniqueness/","title":"The uniqueness of QTasks","text":"<p>QTasks is not just an alternative to Celery or RQ. It is a framework with a different approach to task queue architecture: flexible, modular, and expansion-oriented. Below are the key features that set it apart.</p>"},{"location":"features/uniqueness/#component-based-architecture","title":"\ud83e\uddec Component-based architecture","text":"<ul> <li>All key elements (Broker, Worker, Storage, GlobalConfig, Starter, TaskExecutor, etc.) are fully replaceable.</li> <li>Components can be rewritten for your own infrastructure without changing the core.</li> <li>Extensions are connected via plugins and starters.</li> </ul> <p>\ud83c\udd9a Celery: monolithic bundle. QTasks: independent components with a plug-and-play approach.</p>"},{"location":"features/uniqueness/#support-for-yield-in-tasks","title":"\ud83d\udd01 Support for <code>yield</code> in tasks","text":"<p>Allows you to build step-by-step, streamlined scenarios.</p> <ul> <li>Support for generators in tasks.</li> <li>Processing of <code>yield</code> results via <code>generate_handler</code>.</li> <li>The final <code>return</code> value is returned as a normal task result.</li> </ul> <pre><code>@app.task(generate_handler=handler)\ndef task():\n    step = yield \"INIT\"\n    return step\n</code></pre> <p>\ud83c\udd9a Most frameworks do not support generator-based tasks.</p>"},{"location":"features/uniqueness/#echo-and-access-to-the-task-via-self","title":"\ud83e\udde0 Echo and access to the task via <code>self</code>","text":"<p>When <code>echo=True</code> is enabled, the task becomes a <code>Task</code> (Async/Sync) object, which opens access to the infrastructure:</p> <ul> <li><code>self.add_task()</code> \u2014 creating nested tasks</li> <li><code>self.ctx.get_logger()</code> \u2014 contextual logger</li> <li><code>self.ctx.cancel()</code> \u2014 terminating a task early</li> <li><code>self.ctx.get_task()</code> \u2014 getting another task by UUID</li> </ul> <p>\ud83c\udd9a In other frameworks, a task is a simple function without a self context.</p>"},{"location":"features/uniqueness/#execution-context-ctx","title":"\u2699\ufe0f Execution context (ctx)","text":"<p>The task context provides:</p> <ul> <li>Task UUID</li> <li>Access to Broker, Storage, GlobalConfig</li> <li>metadata manipulation (<code>get_metadata()</code>)</li> <li>safe sleep (<code>ctx.sleep()</code>)</li> <li>task cancellation (<code>cancel()</code>)</li> </ul> <p>This allows you to build complex scenarios without global variables and third-party singletons.</p>"},{"location":"features/uniqueness/#state-and-depends","title":"\ud83d\udd17 State and Depends","text":""},{"location":"features/uniqueness/#state","title":"State","text":"<p>Thread-safe storage of intermediate data between tasks.</p> <pre><code>from qtasks.plugins import AsyncState\n\nclass MyState(AsyncState):\n    pass\n\n@app.task\ndef sample(state: MyState):\n    ...\n</code></pre>"},{"location":"features/uniqueness/#depends","title":"Depends","text":"<p>Injecting dependencies into tasks:</p> <pre><code>@app.task\ndef job(data: int, db=Depends(connect_db, scope=\"worker\")):\n    return db.save(data)\n</code></pre> <p>Scopes include:</p> <ul> <li>task</li> <li>worker</li> <li>broker</li> <li>storage</li> <li>global_config</li> </ul> <p>QTasks automatically creates and completes dependencies for the specified scope.</p>"},{"location":"features/uniqueness/#plugins-and-starters","title":"\ud83e\udde9 Plugins and starters","text":"<ul> <li>Plugins can be attached to any events (triggers) within the system.</li> <li>You can extend the behavior of Worker, Broker, Storage, and TaskExecutor.</li> <li>Starters manage the lifecycle of components and allow you to implement custom flow scenarios.</li> </ul> <p>\ud83c\udd9a Celery requires monkeypatching or deep modification.</p>"},{"location":"features/uniqueness/#timers-without-a-separate-service","title":"\u23f1 Timers without a separate service","text":"<p>The built-in <code>AsyncTimer</code> runs tasks on a schedule:</p> <ul> <li>cron logic via <code>apscheduler</code></li> <li>integration with the application without a separate process such as Celery Beat</li> </ul>"},{"location":"features/uniqueness/#minimal-dependencies-easy-to-start","title":"\ud83d\udee0 Minimal dependencies, easy to start","text":"<ul> <li>Can work without Redis and brokers \u2014 via in-memory queue.</li> <li>Launch:</li> </ul> <pre><code>python main.py\nqtasks -A app:app run\n</code></pre> <ul> <li>Simplicity allows QTasks to be used in microservices, automation, and freelance projects.</li> </ul>"},{"location":"features/uniqueness/#performance","title":"\ud83d\ude80 Performance","text":"<ul> <li>0.6\u20130.7 seconds per task with Redis.</li> <li>Asynchronous processing via <code>PriorityQueue</code> and <code>anyio.Semaphore</code>.</li> <li>Low overhead even for large volumes of tasks.</li> </ul>"},{"location":"features/uniqueness/#testing-infrastructure","title":"\ud83e\uddea Testing infrastructure","text":"<ul> <li><code>SyncTestCase</code> and <code>AsyncTestCase</code> replace components for isolated testing.</li> <li>Works without running a worker.</li> <li>Supports <code>pytest</code>, <code>unittest</code>, <code>pytest-asyncio</code>.</li> </ul>"},{"location":"features/uniqueness/#suitable-for-any-level-of-developer","title":"\ud83d\udca1 Suitable for any level of developer","text":"<ul> <li>Junior: simplicity of API</li> <li>Middle: plugins, middleware, TaskManager</li> <li>Senior: component replacement, context management, custom executors</li> <li>Lead: monitoring, scaling, system architecture on QTasks</li> </ul> <p>QTasks is a constructor that allows you to assemble a framework for your tasks: from a small script to a distributed service.</p>"},{"location":"features/yield/","title":"Tasks with <code>yield</code>","text":"<p>In QTasks, a task can return not only a single value via <code>return</code>, but also multiple values via <code>yield</code>. Such a task is considered a generator: it sequentially outputs intermediate results that can be processed and converted.</p>"},{"location":"features/yield/#example-generator-task-with-generate_handler","title":"Example: generator task with <code>generate_handler</code>","text":"<pre><code>async def yield_func(result: int) -&gt; int:\n    print(result)\n    return result + 2\n\n\n@app.task(\n    description=\"Test task with a generator.\",\n    generate_handler=yield_func,)\n\nasync def test_yield(n: int):\n    for _ in range(n):\n        n += 1\n        yield n\n</code></pre> <p>Calling the task:</p> <pre><code>task = await test_yield.add_task(5, timeout=50)\nprint(task.returning)\n# Result: [8, 9, 10, 11, 12]\n</code></pre> <p>What is happening here:</p> <ul> <li>The <code>test_yield</code> function is an asynchronous generator: it does <code>yield n</code> inside the loop.</li> <li>For each value of <code>n</code>, <code>yield_func(result)</code> is called, and it is the result of <code>yield_func</code> that ends up in the final list.</li> <li>When <code>n = 5</code>, the loop is executed 5 times, returning the values <code>6, 7, 8, 9, 10</code>,   and <code>yield_func</code> converts them to <code>8, 9, 10, 11, 12</code>.</li> </ul> <p>Conclusion: <code>task.returning</code> is a list of values returned by <code>generate_handler</code>.</p>"},{"location":"features/yield/#how-it-works-under-the-hood","title":"How it works \"under the hood\"","text":"<p>Below is a simplified description of the internal logic without unnecessary details.</p> <ol> <li>Determining that the task is a generator    When declaring <code>@app.task</code> for a function, an internal task model <code>TaskExecSchema</code>    is created.    In it, the <code>generating</code> flag is set to <code>True</code> if the function is a generator:</li> </ol> <pre><code>inspect.isasyncgenfunction(func) or inspect.isgeneratorfunction(func)\n</code></pre> <ol> <li> <p>**Selecting the execution path in TaskExecutor    When <code>(A)syncTaskExecutor</code> starts executing a task (<code>execute()</code>), it checks    <code>generating</code>:</p> </li> <li> <p>if <code>generating == True</code> \u2192 the internal function <code>run_task_gen()</code> is called;</p> </li> <li> <p>otherwise \u2192 the usual path <code>run_task()</code> is used.</p> </li> <li> <p>Iteration over generator values    Inside <code>run_task_gen()</code>, the task is executed as a generator:</p> </li> <li> <p>for <code>async def</code>, <code>async for result in func(...)</code> is used;</p> </li> <li> <p>for a regular <code>def</code>, a <code>while True</code> loop with <code>StopIteration</code> handling is used.</p> </li> <li> <p>Processing via <code>generate_handler</code>    For each <code>result</code> received from <code>yield</code>, <code>generate_handler(result)</code> is called    (if specified).    The return values of <code>generate_handler</code> are collected in a list.</p> </li> <li> <p>Final task result    By default, <code>(A)syncTaskExecutor</code> returns a list of all results received    from the generator:    either directly from <code>yield</code> values,    or from values converted via <code>generate_handler</code>.</p> </li> </ol> <p>Important: both <code>TaskExecSchema</code> and <code>(A)syncTaskExecutor</code> can be replaced    by the user \u2014 including at the <code>@app.task(executor=New)</code> stage.</p> <p>Important: both <code>TaskExecSchema</code> and <code>(A)syncTaskExecutor</code> can be replaced by the user, including at the <code>@app.task(executor=NewTaskExecutor)</code> stage, if a different way of processing generators is required.</p> <p>When to use tasks with <code>yield</code></p>"},{"location":"features/yield/#when-to-use-tasks-with-yield","title":"When to use tasks with <code>yield</code>","text":"<p>Generator tasks are useful when you need to:</p> <ul> <li>get a stream of results instead of a single value;</li> <li>process data in stages (e.g., chunks of files, batches of records);</li> <li>log or aggregate intermediate results via <code>generate_handler</code>;</li> <li>build your own mini-pipelines within a single task.</li> </ul> <p>In other cases, a regular task with <code>return</code> is sufficient.</p>"},{"location":"ru/","title":"QTasks \u2014 \u0424\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a \u0434\u043b\u044f \u043e\u0447\u0435\u0440\u0435\u0434\u0435\u0439 \u0437\u0430\u0434\u0430\u0447","text":"<p>QTasks \u2014 \u044d\u0442\u043e \u0441\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0439 \u0444\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a \u0434\u043b\u044f \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0437\u0430\u0434\u0430\u0447, \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0430\u043d\u043d\u044b\u0439 \u0441 \u0443\u043f\u043e\u0440\u043e\u043c \u043d\u0430 \u043f\u0440\u043e\u0441\u0442\u043e\u0442\u0443, \u0433\u0438\u0431\u043a\u043e\u0441\u0442\u044c \u0438 \u0440\u0430\u0441\u0448\u0438\u0440\u044f\u0435\u043c\u043e\u0441\u0442\u044c. \u041e\u043d \u043b\u0435\u0433\u043a\u043e \u0438\u043d\u0442\u0435\u0433\u0440\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0432 \u043f\u0440\u043e\u0435\u043a\u0442\u044b \u043b\u044e\u0431\u043e\u0433\u043e \u043c\u0430\u0441\u0448\u0442\u0430\u0431\u0430 \u0438 \u043f\u043e\u0434\u0445\u043e\u0434\u0438\u0442 \u043a\u0430\u043a \u043d\u043e\u0432\u0438\u0447\u043a\u0430\u043c, \u0442\u0430\u043a \u0438 \u043e\u043f\u044b\u0442\u043d\u044b\u043c \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u0430\u043c.</p>"},{"location":"ru/#_1","title":"\u0421\u0441\u044b\u043b\u043a\u0438","text":"<ul> <li>PyPI: https://pypi.org/project/qtasks/</li> <li>GitHub: https://github.com/txello/qtasks/</li> </ul>"},{"location":"ru/#_2","title":"\u041e\u0441\u043e\u0431\u0435\u043d\u043d\u043e\u0441\u0442\u0438","text":"<ul> <li> <p>\u041f\u0440\u043e\u0441\u0442\u043e\u0442\u0430 \u0440\u0430\u0431\u043e\u0442\u044b. \u0418\u043d\u0442\u0443\u0438\u0442\u0438\u0432\u043d\u044b\u0439 API \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0431\u044b\u0441\u0442\u0440\u043e \u043d\u0430\u0447\u0430\u0442\u044c \u0440\u0430\u0431\u043e\u0442\u0443 \u0431\u0435\u0437 \u0441\u043b\u043e\u0436\u043d\u044b\u0445 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0439 \u0438 \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0439 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b.</p> </li> <li> <p>\u0413\u0438\u0431\u043a\u043e\u0441\u0442\u044c \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u044b. \u041a\u0430\u0436\u0434\u044b\u0439 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 \u2014 \u0431\u0440\u043e\u043a\u0435\u0440, \u0432\u043e\u0440\u043a\u0435\u0440, \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435, \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u0438 \u0434\u0440\u0443\u0433\u0438\u0435 \u2014 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0437\u0430\u043c\u0435\u043d\u0451\u043d \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u043c\u0438 \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f\u043c\u0438. \u0424\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a \u043d\u0435 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u0432\u0430\u0435\u0442 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u0430 \u0432 \u0432\u044b\u0431\u043e\u0440\u0435 \u0442\u0435\u0445\u043d\u043e\u043b\u043e\u0433\u0438\u0439 \u0438 \u0441\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u0439.</p> </li> <li> <p>\u0420\u0430\u0441\u0448\u0438\u0440\u044f\u0435\u043c\u043e\u0441\u0442\u044c. \u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0442\u044c \u043d\u043e\u0432\u044b\u0435 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438, \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438 \u0438 \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u0443\u044e \u043b\u043e\u0433\u0438\u043a\u0443 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447 \u0431\u0435\u0437 \u0432\u043c\u0435\u0448\u0430\u0442\u0435\u043b\u044c\u0441\u0442\u0432\u0430 \u0432 \u044f\u0434\u0440\u043e.</p> </li> </ul>"},{"location":"ru/blog/","title":"\u0412 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0435","text":""},{"location":"ru/changelog/","title":"\u0418\u0441\u0442\u043e\u0440\u0438\u044f \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439","text":""},{"location":"ru/changelog/#v173-2026-02-17","title":"v1.7.3 2026-02-17","text":"<ul> <li>\u0418\u0441\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0430 \u200b\u200b\u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u044b\u0445 \u043f\u043e\u043f\u044b\u0442\u043e\u043a \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447.</li> <li>\u0418\u0441\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0430 \u200b\u200b\u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u0444\u0443\u043d\u043a\u0446\u0438\u0439 \u0434\u043b\u044f <code>Depends()</code>.</li> </ul>"},{"location":"ru/changelog/#_2","title":"\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f","text":"<ul> <li>\u0418\u0437\u043c\u0435\u043d\u0435\u043d \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 <code>site_url</code> \u0432 <code>mkdocs</code> \u043d\u0430 <code>docs.qtasks.tech</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u044b \u0441\u0441\u044b\u043b\u043a\u0438 \u0432 \u0441\u043f\u0438\u0441\u043a\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0439.</li> </ul>"},{"location":"ru/changelog/#v172-2026-02-05","title":"v1.7.2 2026-02-05","text":"<ul> <li>\u0418\u0441\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0430 \u0441\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0440\u0443\u0441\u0441\u043a\u0438\u0439 \u044f\u0437\u044b\u043a \u0432 \u0444\u0430\u0439\u043b\u0435 mkdocs.yml \u0434\u043b\u044f \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e\u0439 \u043c\u0430\u0440\u0448\u0440\u0443\u0442\u0438\u0437\u0430\u0446\u0438\u0438</li> </ul>"},{"location":"ru/changelog/#v171-2026-02-05","title":"v1.7.1 2026-02-05","text":"<ul> <li>\u0418\u0441\u043f\u0440\u0430\u0432\u043b\u0435\u043d \u043f\u0435\u0440\u0435\u0432\u043e\u0434 \u043a\u043e\u0434\u0430 \u0441 \u0440\u0443\u0441\u0441\u043a\u043e\u0433\u043e \u043d\u0430 \u0430\u043d\u0433\u043b\u0438\u0439\u0441\u043a\u0438\u0439</li> </ul>"},{"location":"ru/changelog/#v170-2026-02-05","title":"v1.7.0 2026-02-05","text":"<ul> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u044b <code>(A)syncTaskUtils</code> \u0438 <code>(A)syncChain</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u044c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0434\u043b\u044f <code>QueueConfig</code> \u0438\u0437 <code>os.environ</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d <code>(A)syncTaskCls</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d <code>(A)syncgRPCPlugin</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u044b \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432 \u0434\u043b\u044f <code>(A)syncStats</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d \u0442\u0440\u0438\u0433\u0433\u0435\u0440 \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432 <code>stats_inspect</code> \u0434\u043b\u044f<code>(A)syncStats</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 ExitStack \u0434\u043b\u044f <code>Depends</code> \u0438\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 <code>scope=</code> \u0434\u043b\u044f \u044d\u0442\u043e\u0433\u043e.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d <code>plugin_cache=</code> \u0434\u043b\u044f \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u043e\u0432 \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432.</li> <li>\u0412\u0435\u0441\u044c \u043a\u043e\u0434 \u043f\u0435\u0440\u0435\u0432\u0435\u0434\u0451\u043d \u043d\u0430 \u0430\u043d\u0433\u043b\u0438\u0439\u0441\u043a\u0438\u0439 \u044f\u0437\u044b\u043a.</li> <li><code>Router</code> \u0438\u0437\u043c\u0435\u043d\u0435\u043d \u043d\u0430 <code>(A)syncRouter</code>.</li> <li>\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u044b \u0432\u044b\u0432\u043e\u0434\u044b \u0434\u0435\u0431\u0430\u0433\u0430.</li> <li>\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u044b \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0440\u0435\u0444\u0430\u043a\u0442\u043e\u0440\u0438\u043d\u0433\u0430 \u043d\u0430 E, W, F, B, I, \u0438 UP.</li> <li>\u0418\u0441\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0430 \u0442\u0438\u043f\u0438\u0437\u0430\u0446\u0438\u044f \u0443 <code>(A)syncRouter.task</code>.</li> <li>\u0418\u0441\u043f\u0440\u0430\u0432\u043b\u0435\u043d \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 \u0443 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 <code>autodiscover_tasks</code>.</li> <li>\u0418\u0441\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u044b \u043c\u043e\u0434\u0435\u043b\u0438 <code>Config</code> \u0438 <code>Task</code>.</li> <li>\u0418\u0441\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u044b \u0432\u044b\u0437\u043e\u0432\u044b \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432.</li> <li>\u0420\u0435\u0444\u0430\u043a\u0442\u043e\u0440\u0438\u043d\u0433 \u043a\u043e\u0434\u0430.</li> </ul>"},{"location":"ru/changelog/#_3","title":"\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f","text":"<ul> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d \u0430\u043d\u0433\u043b\u0438\u0439\u0441\u043a\u0438\u0439 \u044f\u0437\u044b\u043a \u043a\u0430\u043a \u044f\u0437\u044b\u043a \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d \u0431\u043b\u043e\u043a <code>\u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430</code>.</li> <li>\u0412\u0441\u0435 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b \u043f\u0435\u0440\u0435\u0432\u0435\u0434\u0435\u043d\u044b \u043d\u0430 \u0430\u043d\u0433\u043b\u0438\u0439\u0441\u043a\u0438\u0439 \u044f\u0437\u044b\u043a.</li> <li>\u0418\u0441\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0430 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 \u0441\u0445\u0435\u043c <code>mermaid</code>.</li> <li>\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u044b \u0442\u0435\u043a\u0441\u0442\u044b \u0441\u0442\u0440\u0430\u043d\u0438\u0446.</li> </ul>"},{"location":"ru/changelog/#v160-2025-09-20","title":"v1.6.0 2025-09-20","text":"<ul> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d <code>(A)syncSocketBroker</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u044b <code>(A)syncStats</code>, <code>InspectStats</code> \u0438 <code>UtilsInspectStats</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d \u043f\u043b\u0430\u0433\u0438\u043d <code>(A)StatePlugin</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u044b \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b <code>description</code> \u0438 <code>max_time</code> \u0434\u043b\u044f \u0437\u0430\u0434\u0430\u0447.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430 \u0444\u0443\u043d\u043a\u0446\u0438\u044f <code>autodiscover_tasks()</code> \u0434\u043b\u044f \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438 \u0441 Django.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 <code>result_time_interval</code> \u0434\u043b\u044f \u0437\u0430\u0434\u0430\u043d\u0438\u044f \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0434\u043b\u044f <code>(A)syncResult</code>.</li> <li>\u0412 \u0442\u0435\u0441\u0442\u0430\u0445 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430 \u0430\u043d\u0430\u043b\u0438\u0442\u0438\u043a\u0430 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 <code>HTTP+QTasks</code> \u0447\u0435\u0440\u0435\u0437 <code>Locust+FastAPI \u043f\u043b\u0430\u0433\u0438\u043d</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043e \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0447\u0435\u0440\u0435\u0437 <code>tox</code> \u043d\u0430 \u0432\u0435\u0440\u0441\u0438\u044f\u0445 <code>py310</code>, <code>py311</code>, <code>py312</code> \u0438 <code>py313</code> \u0432 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e\u043c \u0438 \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e\u043c \u0440\u0435\u0436\u0438\u043c\u0430\u0445.</li> <li>\u0418\u0437\u043c\u0435\u043d\u0435\u043d \u0441\u043f\u043e\u0441\u043e\u0431 \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u043f\u043b\u0430\u0433\u0438\u043d\u0430\u043c\u0438.</li> <li>\u0418\u0437\u043c\u0435\u043d\u0435\u043d \u0441\u043f\u043e\u0441\u043e\u0431 \u0437\u0430\u043f\u0440\u043e\u0441\u0430 <code>add_task</code> \u0441 <code>args=()</code> \u0438 <code>kwargs={}</code> \u043d\u0430 <code>*args</code> \u0438 <code>**kwargs</code>.</li> <li>\u0418\u0437\u043c\u0435\u043d\u0435\u043d \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 <code>middlewares</code> \u043d\u0430 <code>middlewares_before</code> \u0438 <code>middlewares_after</code>.</li> <li>\u0418\u0437\u043c\u0435\u043d\u0435\u043d \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 <code>logs_default_level</code> \u043d\u0430 <code>logs_default_level_server</code> \u0438 <code>logs_default_level_client</code>.</li> <li>\u0418\u0437\u043c\u0435\u043d\u0435\u043d\u044b \u0444\u0443\u043d\u043a\u0446\u0438\u0438 <code>app.init_*</code> \u043d\u0430 <code>app.events.on.*</code>.</li> <li>\u0418\u0437\u043c\u0435\u043d\u0435\u043d \u0443\u0440\u043e\u0432\u0435\u043d\u044c \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u043e\u0448\u0438\u0431\u043a\u0438 \u0437\u0430\u0434\u0430\u0447\u0438 \u0441 <code>warning</code> \u043d\u0430 <code>error</code>.</li> <li>\u0418\u0437\u043c\u0435\u043d\u0435\u043d\u043e \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0441 <code>unittest</code> \u043d\u0430 <code>pytest</code>.</li> <li>\u0418\u0437\u043c\u0435\u043d\u0435\u043d \u0431\u0440\u043e\u043a\u0435\u0440 \u0432 \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438 \u0441 Redis \u043d\u0430 Socket.</li> <li>\u0418\u0437\u043c\u0435\u043d\u0435\u043d\u044b \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f.</li> <li>\u0418\u0441\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u044b \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u0434\u043b\u044f \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432.</li> <li>\u0418\u0441\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u044b \u043e\u0448\u0438\u0431\u043a\u0438 \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u043c\u0435\u0436\u0434\u0443 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430\u043c\u0438.</li> <li>\u0418\u0441\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u044b \u043e\u0431\u044a\u044f\u0432\u043b\u0435\u043d\u0438\u044f \u0441\u0445\u0435\u043c.</li> <li>\u0418\u0441\u043f\u0440\u0430\u0432\u043b\u0435\u043d <code>(A)syncDependsPlugin</code>.</li> <li>\u0420\u0435\u0444\u0430\u043a\u0442\u043e\u0440\u0438\u043d\u0433 \u043a\u043e\u0434\u0430.</li> </ul>"},{"location":"ru/changelog/#v151-2025-07-17","title":"v1.5.1 2025-07-17","text":"<ul> <li>\u0418\u0441\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0430 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u044c <code>pydantic</code>.</li> </ul>"},{"location":"ru/changelog/#v150-2025-07-16","title":"v1.5.0 2025-07-16","text":"<ul> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d <code>AsyncPluginMixin</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u044b \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u044b \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d \u0441\u0442\u0430\u0442\u0443\u0441 <code>Retry</code> \u0447\u0435\u0440\u0435\u0437 \u0432\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0439 \u043f\u043b\u0430\u0433\u0438\u043d <code>(A)syncRetryPlugin</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u044b \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b <code>**kwargs</code> \u043a\u0430\u043a <code>extra</code> \u0434\u043b\u044f <code>@app.task()</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u044b \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b <code>tags</code> \u0438 <code>decode</code> \u0434\u043b\u044f <code>@app.task()</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 <code>pydantic</code> \u0447\u0435\u0440\u0435\u0437 \u0432\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0439 \u043f\u043b\u0430\u0433\u0438\u043d <code>(A)syncPydanticWrapperPlugin</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 <code>ArgMeta</code> \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c\u0438 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u0437\u0430\u0434\u0430\u0447.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d <code>(A)syncTestPlugin</code> \u043a\u0430\u043a \u043d\u0435\u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u043f\u043b\u0430\u0433\u0438\u043d.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u044b \u043f\u0440\u0438\u043c\u0435\u0440\u044b \u0432 <code>examples/</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u044b \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0434\u043b\u044f \u0432\u044b\u0437\u043e\u0432\u0430 \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u043e\u0432 \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432 <code>_plugin_trigger()</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043e \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 <code>TaskPluginTriggerError</code>.</li> <li>\u0418\u0441\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u044b \u0441\u043f\u043e\u0441\u043e\u0431\u044b \u0438\u0441\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0434\u043b\u044f <code>(A)syncRedisCommandQueue</code>.</li> <li>\u0418\u0441\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u044b \u043e\u0448\u0438\u0431\u043a\u0438 \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u043c\u0435\u0436\u0434\u0443 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430\u043c\u0438.</li> <li>\u0420\u0435\u0444\u0430\u043a\u0442\u043e\u0440\u0438\u043d\u0433 \u043a\u043e\u0434\u0430.</li> </ul>"},{"location":"ru/changelog/#v140-2025-06-12","title":"v1.4.0 2025-06-12","text":"<ul> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 \u0433\u0435\u043d\u0435\u0440\u0430\u0442\u043e\u0440\u043e\u0432 \u0434\u043b\u044f \u0437\u0430\u0434\u0430\u0447.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d \u0441\u0442\u0430\u0442\u0443\u0441 <code>Cancel</code> \u0434\u043b\u044f \u0437\u0430\u0434\u0430\u0447 \u0438 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 \u0432 \u043a\u043e\u0434\u0435.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u044b <code>SyncContext</code> \u0438 <code>AsyncContext</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u044b <code>SyncRetryPlugin</code> \u0438 <code>AsyncRetryPlugin</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d <code>BaseQueueTasks</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u044b \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b <code>retry=</code>, <code>retry_on_exc=</code>, <code>generate_handler=</code>, <code>executor=</code>, <code>middlewares=</code> \u0434\u043b\u044f \u0434\u0435\u043a\u043e\u0440\u0430\u0442\u043e\u0440\u043e\u0432 \u0437\u0430\u0434\u0430\u0447 <code>task()</code>  \u0438 <code>shared_task()</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u044b \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 <code>extra=</code> \u0434\u043b\u044f <code>broker.add</code> \u0438 <code>storage.add</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d <code>broker.default_sleep</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u0434\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u043e\u0439 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445 \u0434\u043b\u044f dataclass.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u044b \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u043f\u043b\u0430\u0433\u0438\u043d\u0430\u043c\u0438.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u044b \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u0434\u043b\u044f \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d <code>subcribe</code> \u0432 <code>QueueConfig</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u044b \u043f\u0440\u0438\u043c\u0435\u0440\u044b \u0432 <code>examples/</code>.</li> <li>\u0418\u0441\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u044b \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0437\u0430\u0434\u0430\u0447.</li> <li>\u0418\u0441\u043f\u0440\u0430\u0432\u043b\u0435\u043d <code>Router</code>.</li> <li>\u0423\u0431\u0440\u0430\u043d <code>ConfigObserver</code> \u0438\u0437 <code>QueueTasks.config</code>, \u0431\u044b\u043b \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0435\u043d <code>QueueConfig</code>.</li> </ul>"},{"location":"ru/changelog/#v130-2025-05-30","title":"v1.3.0 2025-05-30","text":"<ul> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d <code>Logger</code> \u0438 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u044b \u0432\u044b\u0432\u043e\u0434\u044b <code>print()</code> \u043d\u0430 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0439 \u0441\u043f\u043e\u0441\u043e\u0431.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d <code>SyncTaskExecutor</code> \u0438 <code>AsyncTaskExecutor</code> \u0438 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d \u0432 <code>Worker</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u044b <code>SyncRedisCommandQueue</code>  \u0438 <code>AsyncRedisCommandQueue</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d <code>SyncKafkaBroker</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d <code>ConfigObserver</code> \u0438 \u0431\u044b\u043b \u0437\u0430\u043c\u0435\u043d\u0435\u043d \u0432 <code>QueueTasks.config</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d <code>BaseMiddleware</code> \u0438 <code>TaskMiddleware</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d <code>ping()</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d <code>flush_all()</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 <code>echo=</code> \u0434\u043b\u044f \u0434\u0435\u043a\u043e\u0440\u0430\u0442\u043e\u0440\u043e\u0432 \u0437\u0430\u0434\u0430\u0447 [<code>task()</code>](api/queuetasks.md#qtasks.qtasks.QueueTasks.task  \u0438 <code>shared_task()</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 <code>awaiting=</code> \u0434\u043b\u044f \u0434\u0435\u043a\u043e\u0440\u0430\u0442\u043e\u0440\u043e\u0432 \u0437\u0430\u0434\u0430\u0447 <code>shared_task()</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 <code>log=</code> \u0434\u043b\u044f <code>QueueTasks</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 <code>broker_url=</code> \u0434\u043b\u044f <code>QueueTasks</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d \u043f\u0440\u0438\u043c\u0435\u0440 \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u0438 \u0440\u0430\u0431\u043e\u0442\u044b \u043e\u0434\u043d\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445 \u0437\u0430\u0434\u0430\u0447.</li> <li>\u0418\u0437\u043c\u0435\u043d\u0435\u043d\u0430 \u0444\u0443\u043d\u043a\u0446\u0438\u044f <code>storage.start()</code>  \u043d\u0430 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u0442\u0430\u0442\u0443\u0441\u0430 \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u0441 TTL. \u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0439 \u043a\u043e\u043d\u0444\u0438\u0433.</li> <li>\u0418\u0437\u043c\u0435\u043d\u0435\u043d\u044b \u043a\u043b\u0430\u0441\u0441\u044b \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f.</li> <li>\u0418\u0441\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u044b \u0432\u044b\u0437\u043e\u0432\u044b \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e.</li> </ul>"},{"location":"ru/changelog/#v120-2025-05-20","title":"v1.2.0 2025-05-20","text":"<ul> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u044b <code>SyncResult</code>/<code>AsyncResult</code>  \u0434\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447\u0438 real-time.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u044b <code>SyncTask</code>/<code>AsyncTask</code>  \u0434\u043b\u044f \u0437\u0430\u043c\u0435\u043d\u044b \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u0434\u0435\u043a\u043e\u0440\u0430\u0442\u043e\u0440\u043e\u043c.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d <code>qtasks._state.app_main</code>  \u0434\u043b\u044f \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0434\u0443\u0431\u043b\u0438\u043a\u0430\u0442\u0430 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f <code>QueueTasks</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d <code>SyncRedisGlobalConfig</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u044b \u043f\u0440\u0438\u043c\u0435\u0440\u044b \u0432 <code>examples/</code>.</li> <li>\u0417\u0430\u043c\u0435\u043d\u0435\u043d <code>aiounittest</code> \u043d\u0430 <code>unittest.IsolatedAsyncioTestCase</code>.</li> <li>\u0418\u0441\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u044b \u0437\u0430\u043f\u0443\u0441\u043a\u0438 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432.</li> </ul>"},{"location":"ru/changelog/#v110-2025-04-21","title":"v1.1.0 - 2025-04-21","text":"<ul> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d <code>TestCase</code>/<code>AsyncTestCase</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u044b \u0431\u0430\u0437\u043e\u0432\u044b\u0435 \u043a\u043b\u0430\u0441\u0441\u044b \u0434\u043b\u044f \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 <code>global_config</code> \u0434\u043b\u044f <code>BaseStorage</code>.</li> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d <code>TaskStatusEnum</code>.</li> <li>\u0418\u0441\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u044b \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 <code>QueueConfig</code>.</li> <li>\u0418\u0441\u043f\u0440\u0430\u0432\u043b\u0435\u043d <code>BaseWorker</code>.</li> </ul>"},{"location":"ru/changelog/#v101-2025-04-15","title":"v1.0.1 \u2013 2025-04-15","text":"<ul> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043e \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435.</li> <li>\u0418\u0441\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0430 \u043e\u0448\u0438\u0431\u043a\u0430 mkdocs.</li> </ul>"},{"location":"ru/changelog/#v100-2025-04-15","title":"v1.0.0 \u2013 2025-04-15","text":"<ul> <li>\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430 \u043f\u0435\u0440\u0432\u0430\u044f \u0432\u0435\u0440\u0441\u0438\u044f <code>QTasks</code>.</li> </ul>"},{"location":"ru/components/","title":"\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b QueueTasks","text":"<p>\u0424\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a \u043f\u043e\u0441\u0442\u0440\u043e\u0435\u043d \u043d\u0430 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043d\u043e\u0439 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0435: \u043a\u0430\u0436\u0434\u044b\u0439 \u044d\u043b\u0435\u043c\u0435\u043d\u0442 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u043e\u0442\u0432\u0435\u0447\u0430\u0435\u0442 \u0437\u0430 \u0441\u0432\u043e\u044e \u0447\u0430\u0441\u0442\u044c \u0440\u0430\u0431\u043e\u0442\u044b, \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0437\u0430\u043c\u0435\u043d\u0451\u043d, \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d \u0438\u043b\u0438 \u043f\u0435\u0440\u0435\u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0451\u043d. \u042d\u0442\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u0434\u0430\u0451\u0442 \u043e\u0431\u0437\u043e\u0440 \u0432\u0441\u0435\u0445 \u043e\u0441\u043d\u043e\u0432\u043d\u044b\u0445 \u0438 \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0445 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432, \u0431\u0435\u0437 \u0443\u0433\u043b\u0443\u0431\u043b\u0451\u043d\u043d\u043e\u0439 \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0435\u0439 \u043b\u043e\u0433\u0438\u043a\u0438.</p>"},{"location":"ru/components/#_1","title":"\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b","text":""},{"location":"ru/components/#queuetasks_1","title":"QueueTasks","text":"<p>\u0426\u0435\u043d\u0442\u0440\u0430\u043b\u044c\u043d\u044b\u0439 \u043e\u0431\u044a\u0435\u043a\u0442 \u0444\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a\u0430. \u0423\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0435\u0439 \u0437\u0430\u0434\u0430\u0447, \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u043e\u0439 \u0441\u0440\u0435\u0434\u044b \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0438 \u0441\u0432\u044f\u0437\u044b\u0432\u0430\u0435\u0442 \u043c\u0435\u0436\u0434\u0443 \u0441\u043e\u0431\u043e\u0439 \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b.</p> <p>\u041f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430 <code>QueueTasks()</code> \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0444\u043e\u0440\u043c\u0438\u0440\u0443\u044e\u0442\u0441\u044f:</p> <ul> <li>Broker (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e Redis)</li> <li>Storage (Redis)</li> <li>GlobalConfig (Redis)</li> <li>Worker (SyncThreadWorker \u0438\u043b\u0438 AsyncWorker)</li> <li>Starter (SyncStarter \u0438\u043b\u0438 AsyncStarter)</li> </ul> <pre><code>from qtasks import QueueTasks\n\napp = QueueTasks()\n\n@app.task(name=\"test\")\ndef sample_task(id: int):\n    return f\"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c {id} \u0437\u0430\u043f\u0438\u0441\u0430\u043d\"\n</code></pre> <p>QueueTasks \u043c\u043e\u0436\u0435\u0442 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u044c URL \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439 (<code>broker_url</code>, <code>storage_url</code>), \u0430 \u0442\u0430\u043a\u0436\u0435 \u043f\u043e\u043b\u043d\u043e\u0441\u0442\u044c\u044e \u043a\u0430\u0441\u0442\u043e\u043c\u043d\u044b\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b.</p>"},{"location":"ru/components/#broker","title":"Broker \u2014 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a \u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0445 \u0437\u0430\u0434\u0430\u0447","text":"<p>\u041e\u0442\u0432\u0435\u0447\u0430\u0435\u0442 \u0437\u0430 \u043f\u0440\u0438\u0451\u043c \u0437\u0430\u0434\u0430\u0447 \u0438 \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0443 \u0438\u0445 \u0432\u043e\u0440\u043a\u0435\u0440\u0443. \u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f Redis-\u0431\u0440\u043e\u043a\u0435\u0440.</p> <pre><code>from qtasks.asyncio import QueueTasks\nfrom qtasks.brokers import AsyncRedisBroker\n\nbroker = AsyncRedisBroker(url=\"redis://localhost:6379/2\")\n\napp = QueueTasks(broker=broker)\n</code></pre> <p>Broker \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 Storage \u0438, \u043f\u0440\u0438 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438, GlobalConfig.</p>"},{"location":"ru/components/#worker","title":"Worker \u2014 \u0438\u0441\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c \u0437\u0430\u0434\u0430\u0447","text":"<p>\u0412\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442 \u0437\u0430\u0434\u0430\u0447\u0438, \u043f\u043e\u0441\u0442\u0443\u043f\u0430\u044e\u0449\u0438\u0435 \u043e\u0442 \u0431\u0440\u043e\u043a\u0435\u0440\u0430. \u041f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0439 (<code>SyncThreadWorker</code>) \u0438 \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0439 (<code>AsyncWorker</code>) \u0440\u0435\u0436\u0438\u043c\u044b.</p> <pre><code>from qtasks.asyncio import QueueTasks\nfrom qtasks.workers import AsyncWorker\nfrom qtasks.brokers import AsyncRedisBroker\n\nbroker = AsyncRedisBroker(url=\"redis://localhost:6379/2\")\nworker = AsyncWorker(broker=broker)\n\napp = QueueTasks(broker=broker, worker=worker)\n</code></pre> <p>Worker \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0443\u0435\u0442 \u0441 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u043e\u043c \u0437\u0430\u0434\u0430\u0447, retry-\u043b\u043e\u0433\u0438\u043a\u043e\u0439, middleware \u0438 \u043f\u043b\u0430\u0433\u0438\u043d\u0430\u043c\u0438.</p>"},{"location":"ru/components/#storage","title":"Storage \u2014 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 \u0437\u0430\u0434\u0430\u0447","text":"<p>\u0421\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u0442 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0437\u0430\u0434\u0430\u0447\u0430\u0445:</p> <ul> <li>\u0441\u0442\u0430\u0442\u0443\u0441,</li> <li>\u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442,</li> <li>\u043e\u0448\u0438\u0431\u043a\u0438,</li> <li>\u0432\u0440\u0435\u043c\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f.</li> </ul> <p>\u042f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u043c \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u043c, \u043d\u043e \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0437\u0430\u043c\u0435\u043d\u0451\u043d. Broker \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0432\u043d\u0443\u0442\u0440\u0438 \u0441\u0435\u0431\u044f \u0441\u0441\u044b\u043b\u043a\u0443 \u043d\u0430 Storage.</p> <pre><code>from qtasks.asyncio import QueueTasks\nfrom qtasks.storages import AsyncRedisStorage\nfrom qtasks.brokers import AsyncRedisBroker\n\nstorage = AsyncRedisStorage(url=\"redis://localhost:6379/2\")\nbroker = AsyncRedisBroker(url=\"redis://localhost:6379/2\", storage=storage)\n\napp = QueueTasks(broker=broker)\n</code></pre> <p>\u0425\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 \u0442\u0430\u043a\u0436\u0435 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0441\u0432\u044f\u0437\u043a\u0443 \u0441 GlobalConfig.</p>"},{"location":"ru/components/#starter","title":"Starter \u2014 \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u044e\u0449\u0438\u0439 \u0437\u0430\u043f\u0443\u0441\u043a\u043e\u043c \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432","text":"<p>Starter \u043e\u0442\u0432\u0435\u0447\u0430\u0435\u0442 \u0437\u0430 \u0437\u0430\u043f\u0443\u0441\u043a \u0438 \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0443 \u0432\u0441\u0435\u0445 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432. QueueTasks \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 Starter \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e.</p> <p>Starter \u0442\u0430\u043a\u0436\u0435 \u043c\u043e\u0436\u0435\u0442 \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c \u0441\u0446\u0435\u043d\u0430\u0440\u0438\u044f\u043c\u0438 \u043f\u043e\u0442\u043e\u043a\u043e\u0432 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432.</p> <pre><code>from qtasks.asyncio import QueueTasks\nfrom qtasks.starters import AsyncStarter\n\nstarter = AsyncStarter(name=\"QueueTasks\")\napp = QueueTasks()\n\nif __name__ == \"__main__\":\n    app.run_forever(starter=starter)\n</code></pre>"},{"location":"ru/components/#_2","title":"\u0414\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b","text":""},{"location":"ru/components/#globalconfig","title":"GlobalConfig \u2014 \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u0430\u044f \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f","text":"<p>\u0425\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0445 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445 \u0438 \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043a, \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u0432\u0441\u0435\u043c \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430\u043c. \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u043f\u0440\u0438 \u0440\u0430\u0431\u043e\u0442\u0435 WebView: \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441 \u043c\u043e\u0436\u0435\u0442 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0442\u044c\u0441\u044f \u043a Redis \u0431\u0435\u0437 \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f.</p> <pre><code>from qtasks.asyncio import QueueTasks\nfrom qtasks.configs import AsyncRedisGlobalConfig\n\nconfig = AsyncRedisGlobalConfig(url=\"redis://localhost:6379/2\")\napp = QueueTasks(global_config=config)\n</code></pre> <p>GlobalConfig \u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d \u043a\u0430\u043a:</p> <pre><code>app.broker.storage.global_config\n</code></pre> <p>\u0438 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c <code>None</code>.</p>"},{"location":"ru/components/#plugins","title":"Plugins \u2014 \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u043e\u0441\u0442\u0438","text":"<p>\u041f\u043b\u0430\u0433\u0438\u043d\u044b \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u044e\u0442 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0442\u044c \u043b\u044e\u0431\u0443\u044e \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u0443\u044e \u043b\u043e\u0433\u0438\u043a\u0443: \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435, \u043c\u043e\u0434\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044e \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u043e\u0432 \u0437\u0430\u0434\u0430\u0447, \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438.</p> <p>\u0412\u0441\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u044b \u043e\u043f\u0438\u0441\u0430\u043d\u044b \u0437\u0434\u0435\u0441\u044c: \u0422\u0440\u0438\u0433\u0433\u0435\u0440\u044b</p> <p>\u041f\u0440\u0438\u043c\u0435\u0440:</p> <pre><code>from qtasks import QueueTasks\nfrom qtasks.plugins import BasePlugin\n\napp = QueueTasks()\n\nclass TestPlugin(BasePlugin):\n    def __init__(self):\n        super().__init__()\n        self.handlers = {\n            \"task_executor_args_replace\": self.replace\n        }\n\n    def replace(self, **kwargs):\n        print(\"ARGS:\", kwargs)\n        return None\n\napp.add_plugin(\n    TestPlugin(),\n    trigger_names=[\"task_executor_args_replace\"],\n    component=\"worker\"\n)\n</code></pre>"},{"location":"ru/components/#timer","title":"Timer \u2014 \u0437\u0430\u043f\u0443\u0441\u043a \u0437\u0430\u0434\u0430\u0447 \u043f\u043e \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u044e","text":"<p>\u041e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0439 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442, \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u044e\u0449\u0438\u0439 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c cron-\u043f\u043e\u0434\u043e\u0431\u043d\u044b\u0435 \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u044f. \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 APScheduler (<code>CronTrigger</code>).</p> <pre><code>from qtasks import QueueTasks\nfrom qtasks.timers import AsyncTimer\nfrom apscheduler.triggers.cron import CronTrigger\n\napp = QueueTasks()\n\n@app.task\ndef test():\n    print(\"\u0417\u0430\u043f\u0443\u0441\u043a \u0442\u0435\u0441\u0442\u043e\u0432\u043e\u0439 \u0437\u0430\u0434\u0430\u0447\u0438\")\n\n\ntrigger = CronTrigger(second=\"*/10\")\ntimer = AsyncTimer(app=app)\ntimer.add_task(\"test\", trigger=trigger)\n\ntimer.run_forever()\n</code></pre>"},{"location":"ru/components/#webview","title":"WebView \u2014 \u0432\u0438\u0437\u0443\u0430\u043b\u044c\u043d\u044b\u0439 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441","text":"<p>\u041e\u0442\u0434\u0435\u043b\u044c\u043d\u0430\u044f \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0430 \u0434\u043b\u044f \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430 \u0441\u043f\u0438\u0441\u043a\u0430 \u0437\u0430\u0434\u0430\u0447, \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u0432 \u0438 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0438. \u0423\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430:</p> <pre><code>pip install qtasks_webview\n</code></pre> <p>WebView \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u043d\u0430\u043f\u0440\u044f\u043c\u0443\u044e \u0441 Redis \u0438 \u043d\u0435 \u0442\u0440\u0435\u0431\u0443\u0435\u0442 \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043d\u043e\u0433\u043e \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f.</p>"},{"location":"ru/components/#_3","title":"\u041f\u043e\u043b\u043d\u044b\u0439 \u043f\u0440\u0438\u043c\u0435\u0440 \u0440\u0443\u0447\u043d\u043e\u0439 \u0441\u0431\u043e\u0440\u043a\u0438 \u0432\u0441\u0435\u0445 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432","text":"<pre><code>import asyncio\nfrom qtasks.asyncio import QueueTasks\nfrom qtasks.configs import AsyncRedisGlobalConfig\nfrom qtasks.storages import AsyncRedisStorage\nfrom qtasks.brokers import AsyncRedisBroker\nfrom qtasks.workers import AsyncWorker\nfrom qtasks.starters import AsyncStarter\n\n# GlobalConfig \u2014 \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u0438 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438\nglobal_config = AsyncRedisGlobalConfig(\n    name=\"QueueTasks\",\n    url=\"redis://localhost:6379/2\"\n)\n\n# Storage \u2014 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 \u0437\u0430\u0434\u0430\u0447\nstorage = AsyncRedisStorage(\n    name=\"QueueTasks\",\n    global_config=global_config,\n    url=\"redis://localhost:6379/2\"\n)\n\n# Broker \u2014 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a \u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0445 \u0437\u0430\u0434\u0430\u0447\nbroker = AsyncRedisBroker(\n    name=\"QueueTasks\",\n    storage=storage,\n    url=\"redis://localhost:6379/2\"\n)\n\n# Worker \u2014 \u0438\u0441\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c \u0437\u0430\u0434\u0430\u0447\nworker = AsyncWorker(\n    name=\"QueueTasks\",\n    broker=broker\n)\n\n# QueueTasks \u2014 \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u043e\u0431\u044a\u0435\u043a\u0442\napp = QueueTasks(\n    name=\"QueueTasks\",\n    broker=broker,\n    worker=worker\n)\n\n# \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f\napp.config.max_tasks_process = 10\napp.config.running_older_tasks = True\napp.config.delete_finished_tasks = True\n\n\n@app.task(name=\"test\")\nasync def sample_task(id: int):\n    result = f\"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c {id} \u0437\u0430\u043f\u0438\u0441\u0430\u043d\"\n    await asyncio.sleep(id)\n    return result\n\n\nif __name__ == \"__main__\":\n    starter = AsyncStarter(\n        name=\"QueueTasks\",\n        worker=worker,\n        broker=broker\n    )\n    app.run_forever(starter=starter)\n</code></pre>"},{"location":"ru/console/","title":"\u0420\u0430\u0431\u043e\u0442\u0430 \u0441 \u043a\u043e\u043d\u0441\u043e\u043b\u044c\u044e \u0447\u0435\u0440\u0435\u0437 <code>qtasks.__main__</code>","text":"<p>\u041c\u043e\u0434\u0443\u043b\u044c <code>qtasks.__main__</code> \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441 \u043a\u043e\u043c\u0430\u043d\u0434\u043d\u043e\u0439 \u0441\u0442\u0440\u043e\u043a\u0438 \u0434\u043b\u044f \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u0438 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f\u043c\u0438 QTasks. CLI \u043f\u043e\u0434\u0445\u043e\u0434\u0438\u0442 \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0437\u0430\u0446\u0438\u0438, \u0440\u0430\u0431\u043e\u0442\u044b \u0432 \u043f\u0440\u043e\u0434\u0430\u043a\u0448\u0435\u043d\u0435 \u0438 \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438 \u0441 \u0432\u043d\u0435\u0448\u043d\u0438\u043c\u0438 \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u0430\u043c\u0438.</p> <p>\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u0432\u043a\u043b\u044e\u0447\u0430\u044e\u0442:</p> <ul> <li>\u0437\u0430\u043f\u0443\u0441\u043a \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f;</li> <li>\u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0438 \u0447\u0435\u0440\u0435\u0437 <code>(A)syncStats</code>;</li> <li>\u0437\u0430\u043f\u0443\u0441\u043a \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u0432\u0435\u0431\u2011\u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430 (\u0431\u0443\u0434\u0435\u0442 \u043f\u0435\u0440\u0435\u0432\u0435\u0434\u0451\u043d \u043d\u0430 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0443 <code>qtasks_webview</code>).</li> </ul>"},{"location":"ru/console/#cli","title":"\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 CLI","text":"<ul> <li>\u0437\u0430\u043f\u0443\u0441\u043a \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0441 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u043c \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u043e\u043c <code>QueueTasks</code>;</li> <li>\u0432\u044b\u0437\u043e\u0432 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0438 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432 (\u0447\u0435\u0440\u0435\u0437 <code>stats inspect</code>);</li> <li>\u0437\u0430\u043f\u0443\u0441\u043a \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u0432\u0435\u0431-\u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430;</li> <li>\u0443\u043a\u0430\u0437\u0430\u043d\u0438\u0435 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0447\u0435\u0440\u0435\u0437 <code>-A</code> \u0438\u043b\u0438 <code>--app</code> \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 <code>module:variable</code>;</li> <li>\u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u043f\u043e\u0440\u0442\u0430 \u0432\u0435\u0431-\u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430.</li> </ul> <p>\u041a\u043e\u043c\u0430\u043d\u0434\u0430 \u0432\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u0432 \u043e\u0431\u0449\u0435\u043c \u0432\u0438\u0434\u0435:</p> <pre><code>qtasks [\u043e\u043f\u0446\u0438\u0438] &lt;\u043a\u043e\u043c\u0430\u043d\u0434\u0430&gt; [\u043e\u043f\u0446\u0438\u0438]\n</code></pre>"},{"location":"ru/console/#run","title":"\u041a\u043e\u043c\u0430\u043d\u0434\u0430 <code>run</code>","text":"<p>\u0417\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 QTasks \u0441 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u043c \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u043e\u043c <code>QueueTasks</code>.</p> <pre><code>qtasks -A &lt;\u043f\u0443\u0442\u044c_\u043a_\u043c\u043e\u0434\u0443\u043b\u044e:\u0438\u043c\u044f_\u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u0439&gt; run\n</code></pre> <p>\u041f\u0440\u0438\u043c\u0435\u0440:</p> <pre><code>qtasks -A based_async_app:app run\n</code></pre> <p><code>-A</code> \u0438 <code>--app</code> \u043f\u043e\u043b\u043d\u043e\u0441\u0442\u044c\u044e \u044d\u043a\u0432\u0438\u0432\u0430\u043b\u0435\u043d\u0442\u043d\u044b.</p>"},{"location":"ru/console/#stats","title":"\u041a\u043e\u043c\u0430\u043d\u0434\u0430 <code>stats</code>","text":"<p>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445 \u0438\u0437 <code>(A)syncStats</code>. \u0412 \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u0432\u0435\u0440\u0441\u0438\u0438 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u0430 \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u043e\u0434\u043a\u043e\u043c\u0430\u043d\u0434\u0430 <code>inspect</code>.</p> <pre><code>qtasks -A &lt;module:app&gt; stats inspect &lt;target&gt; [\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b]\n</code></pre> <p>\u0413\u0434\u0435 <code>target</code> \u2014 \u043e\u0431\u044a\u0435\u043a\u0442 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0438:</p> <ul> <li><code>app</code> \u2014 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0438;</li> <li><code>tasks</code> \u2014 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0437\u0430\u0434\u0430\u0447\u0430\u0445.</li> </ul> <p>\u041f\u0440\u0438\u043c\u0435\u0440:</p> <pre><code>qtasks -A based_async_app:app stats inspect app json=true\n</code></pre> <p>\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 <code>json=true</code> \u043f\u0435\u0440\u0435\u0434\u0430\u0451\u0442\u0441\u044f \u043a\u0430\u043a \u043f\u043e\u0437\u0438\u0446\u0438\u043e\u043d\u043d\u044b\u0439 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 <code>inspect</code> \u0438 \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u0432\u044b\u0432\u043e\u0434 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 JSON.</p> <p>\u041f\u043e\u0434\u043a\u043e\u043c\u0430\u043d\u0434\u044b <code>inspect app</code> \u0438 <code>inspect tasks</code> \u043d\u0430\u043f\u0440\u044f\u043c\u0443\u044e \u0432\u044b\u0437\u044b\u0432\u0430\u044e\u0442 \u043c\u0435\u0442\u043e\u0434\u044b:</p> <ul> <li><code>(A)syncStats().inspect().app(json=True)</code></li> <li><code>(A)syncStats().inspect().tasks(json=True)</code></li> </ul> <p>\u0420\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u0435 \u0441\u043f\u0438\u0441\u043a\u0430 \u0446\u0435\u043b\u0435\u0439 (<code>inspect workers</code>, <code>inspect broker</code> \u0438 \u0442.\u043f.) \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0431\u0435\u0437 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f CLI.</p>"},{"location":"ru/console/#web","title":"\u041a\u043e\u043c\u0430\u043d\u0434\u0430 <code>web</code> (\u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\u0430\u043b\u044c\u043d\u043e)","text":"<p>\u0417\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442 \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\u0430\u043b\u044c\u043d\u044b\u0439 \u0432\u0435\u0431\u2011\u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441 (\u0432 \u0434\u0430\u043b\u044c\u043d\u0435\u0439\u0448\u0435\u043c \u0431\u0443\u0434\u0435\u0442 \u043f\u0435\u0440\u0435\u043d\u0435\u0441\u0451\u043d \u0432 \u043f\u0440\u043e\u0435\u043a\u0442 <code>qtasks_webview</code>).</p> <pre><code>qtasks web -A &lt;module:app&gt; --port &lt;\u043f\u043e\u0440\u0442&gt;\n</code></pre> <p>\u041f\u0440\u0438\u043c\u0435\u0440:</p> <pre><code>qtasks web -A based_async_app:app --port 8000\n</code></pre> <p>\u0415\u0441\u043b\u0438 \u043f\u043e\u0440\u0442 \u043d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u2014 <code>8000</code>.</p>"},{"location":"ru/console/#cli_1","title":"\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b CLI","text":""},{"location":"ru/console/#-a-app","title":"<code>-A</code>, <code>--app</code>","text":"<p>\u041f\u0443\u0442\u044c \u043a \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044e \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435:</p> <pre><code>\u043c\u043e\u0434\u0443\u043b\u044c:\u0438\u043c\u044f_\u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u0439\n</code></pre> <p>\u041f\u0440\u0438\u043c\u0435\u0440:</p> <pre><code>based_async_app:app\n</code></pre> <p>CLI \u043d\u0435 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u2014 \u044d\u0442\u043e \u043f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u0435 \u043d\u0430\u043c\u0435\u0440\u0435\u043d\u043d\u043e\u0435, \u043f\u043e\u0441\u043a\u043e\u043b\u044c\u043a\u0443 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a \u043c\u043e\u0436\u0435\u0442 \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u0443\u044e \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0443\u044e <code>app</code>.</p>"},{"location":"ru/console/#-port","title":"<code>--port</code>","text":"<p>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u043a\u043e\u043c\u0430\u043d\u0434\u043e\u0439 <code>web</code>. \u0423\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 \u043f\u043e\u0440\u0442 \u0432\u0435\u0431-\u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430.</p>"},{"location":"ru/console/#_1","title":"\u041f\u043e\u0434\u0441\u043a\u0430\u0437\u043a\u0430 \u043f\u043e \u043a\u043e\u043c\u0430\u043d\u0434\u0430\u043c","text":"<p>\u0414\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u043f\u043e\u043b\u043d\u043e\u0433\u043e \u0441\u043f\u0438\u0441\u043a\u0430 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 \u0438 \u043f\u043e\u043c\u043e\u0449\u0438:</p> <pre><code>qtasks --help\n</code></pre> <p>\u0414\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0441\u043f\u0440\u0430\u0432\u043a\u0438 \u043f\u043e \u043a\u043e\u043c\u0430\u043d\u0434\u0435:</p> <pre><code>qtasks &lt;\u043a\u043e\u043c\u0430\u043d\u0434\u0430&gt; --help\n</code></pre>"},{"location":"ru/console/#_2","title":"\u041f\u0440\u0438\u043c\u0435\u0440","text":"<pre><code>qtasks -A based_async_app:app run\nqtasks -A based_async_app:app stats inspect tasks json=true\nqtasks web -A based_async_app:app --port 8000\n</code></pre>"},{"location":"ru/getting_started/","title":"\u041d\u0430\u0447\u0438\u043d\u0430\u0435\u043c \u0440\u0430\u0431\u043e\u0442\u0443 \u0441 QTasks","text":""},{"location":"ru/getting_started/#_1","title":"\u0411\u044b\u0441\u0442\u0440\u044b\u0439 \u0441\u0442\u0430\u0440\u0442: \u043f\u0435\u0440\u0432\u0430\u044f \u0437\u0430\u0434\u0430\u0447\u0430 \u0437\u0430 \u043f\u0430\u0440\u0443 \u043c\u0438\u043d\u0443\u0442","text":"<p>\u041d\u0438\u0436\u0435 \u043f\u0440\u0438\u0432\u0435\u0434\u0451\u043d \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u043f\u0440\u0438\u043c\u0435\u0440 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0438 \u0437\u0430\u043f\u0443\u0441\u043a\u0430 QTasks \u0434\u043b\u044f \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0445 \u0437\u0430\u0434\u0430\u0447, \u0430 \u0442\u0430\u043a\u0436\u0435 \u043a\u0440\u0430\u0442\u043a\u043e\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u0438\u0435, \u043a\u0430\u043a \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0439 \u0432\u0430\u0440\u0438\u0430\u043d\u0442.</p>"},{"location":"ru/getting_started/#1","title":"1. \u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f","text":"<pre><code>from qtasks import QueueTasks\n# \u0434\u043b\u044f \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e\u0433\u043e \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u0430:\n# from qtasks.asyncio import QueueTasks\n\napp = QueueTasks()\n</code></pre> <p>Info</p> <p>\u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0431\u0440\u043e\u043a\u0435\u0440\u0430 \u0438 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f Redis \u043f\u043e \u0430\u0434\u0440\u0435\u0441\u0443 <code>redis://localhost:6379/0</code>.</p>"},{"location":"ru/getting_started/#2","title":"2. \u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u0437\u0430\u0434\u0430\u0447","text":"<p>\u0417\u0430\u0434\u0430\u0447\u0438 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u0443\u044e\u0442\u0441\u044f \u0447\u0435\u0440\u0435\u0437 \u0434\u0435\u043a\u043e\u0440\u0430\u0442\u043e\u0440 <code>@app.task</code>.</p> <pre><code>@app.task(name=\"mytest\")  # \u041e\u0431\u044b\u0447\u043d\u0430\u044f \u0437\u0430\u0434\u0430\u0447\u0430\ndef mytest(text: str):\n    print(text)\n    return text\n\n\n@app.task(name=\"error_zero\")  # \u0417\u0430\u0434\u0430\u0447\u0430 \u0441 \u043e\u0448\u0438\u0431\u043a\u043e\u0439\ndef error_zero():\n    result = 1 / 0\n    return\n</code></pre> <p>Info</p> <p>\u0415\u0441\u043b\u0438 \u0438\u043c\u044f \u0437\u0430\u0434\u0430\u0447\u0438 \u043d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u043e \u044f\u0432\u043d\u043e (\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 <code>name</code>), \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0438\u043c\u044f \u0444\u0443\u043d\u043a\u0446\u0438\u0438.</p> <p>Tip</p> <p>\u0418\u043c\u044f \u0437\u0430\u0434\u0430\u0447\u0438 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043b\u044e\u0431\u044b\u043c, \u043d\u043e \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u043c \u0432 \u043f\u0440\u0435\u0434\u0435\u043b\u0430\u0445 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f. \u0415\u0441\u043b\u0438 \u0437\u0430\u0434\u0430\u0447\u0430 \u0441 \u0442\u0430\u043a\u0438\u043c \u0438\u043c\u0435\u043d\u0435\u043c \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442, \u0431\u0443\u0434\u0435\u0442 \u0432\u044b\u0437\u0432\u0430\u043d\u043e \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043f\u0440\u0438 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438.</p>"},{"location":"ru/getting_started/#3","title":"3. \u0417\u0430\u043f\u0443\u0441\u043a \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u0430 \u0437\u0430\u0434\u0430\u0447","text":"<p>\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a \u0437\u0430\u0434\u0430\u0447 \u043c\u043e\u0436\u043d\u043e \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0434\u0432\u0443\u043c\u044f \u0441\u043f\u043e\u0441\u043e\u0431\u0430\u043c\u0438.</p>"},{"location":"ru/getting_started/#1-run_forever","title":"\u0412\u0430\u0440\u0438\u0430\u043d\u0442 1: \u0447\u0435\u0440\u0435\u0437 <code>run_forever()</code>","text":"<pre><code>if __name__ == \"__main__\":\n    app.run_forever()\n</code></pre>"},{"location":"ru/getting_started/#2-cli","title":"\u0412\u0430\u0440\u0438\u0430\u043d\u0442 2: \u0447\u0435\u0440\u0435\u0437 CLI","text":"<pre><code>qtasks -A app:app run\n</code></pre> <p>\u0413\u0434\u0435 <code>app:app</code> \u2014 \u044d\u0442\u043e <code>module:variable</code>, \u0442\u043e \u0435\u0441\u0442\u044c \u043c\u043e\u0434\u0443\u043b\u044c \u0441 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435\u043c \u0438 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0430\u044f, \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u0445\u0440\u0430\u043d\u0438\u0442\u0441\u044f \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440 <code>QueueTasks</code>.</p>"},{"location":"ru/getting_started/#4","title":"4. \u041f\u043e\u043b\u043d\u044b\u0439 \u043f\u0440\u0438\u043c\u0435\u0440 \u0444\u0430\u0439\u043b\u0430 \u0441 \u0437\u0430\u0434\u0430\u0447\u0430\u043c\u0438","text":"<pre><code># file: app.py\nfrom qtasks import QueueTasks\n\n\napp = QueueTasks()\n\n\n@app.task(name=\"mytest\")  # \u041f\u0440\u0438\u043c\u0435\u0440 \u043e\u0431\u044b\u0447\u043d\u043e\u0439 \u0437\u0430\u0434\u0430\u0447\u0438\ndef mytest(text: str):\n    print(text)\n    return text\n\n\n@app.task(name=\"error_zero\")  # \u041f\u0440\u0438\u043c\u0435\u0440 \u0437\u0430\u0434\u0430\u0447\u0438 \u0441 \u043e\u0448\u0438\u0431\u043a\u043e\u0439\ndef error_zero():\n    result = 1 / 0\n    return\n\n\nif __name__ == \"__main__\":\n    app.run_forever()\n</code></pre>"},{"location":"ru/getting_started/#5","title":"5. \u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447 \u0432 \u043e\u0447\u0435\u0440\u0435\u0434\u044c","text":"<p>\u041f\u043e\u0441\u043b\u0435 \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u0430 \u0437\u0430\u0434\u0430\u0447 \u043c\u043e\u0436\u043d\u043e \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0438 \u0438\u0437 \u0434\u0440\u0443\u0433\u043e\u0433\u043e \u0444\u0430\u0439\u043b\u0430 \u0438\u043b\u0438 \u0438\u043d\u0442\u0435\u0440\u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0433\u043e \u0438\u043d\u0442\u0435\u0440\u043f\u0440\u0435\u0442\u0430\u0442\u043e\u0440\u0430 Python:</p> <pre><code># file: add_tasks.py\nfrom app import app, mytest\n\n# \u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447\u0438 \u043f\u043e \u0438\u043c\u0435\u043d\u0438 \u0447\u0435\u0440\u0435\u0437 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f\napp.add_task(\"mytest\", \"\u0422\u0435\u0441\u0442\")\n\n# \u0412\u044b\u0437\u043e\u0432 \u0447\u0435\u0440\u0435\u0437 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u0443\u044e \u0444\u0443\u043d\u043a\u0446\u0438\u044e \u0437\u0430\u0434\u0430\u0447\u0438\nmytest.add_task(\"\u0422\u0435\u0441\u0442\")\n\n# \u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447\u0438 \u0441 \u043e\u0436\u0438\u0434\u0430\u043d\u0438\u0435\u043c \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430 (timeout \u0432 \u0441\u0435\u043a\u0443\u043d\u0434\u0430\u0445)\nmytest.add_task(\"\u0422\u0435\u0441\u0442\", timeout=50)\n\n# \u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447\u0438, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u043f\u0440\u0438\u0432\u0435\u0434\u0451\u0442 \u043a \u043e\u0448\u0438\u0431\u043a\u0435\napp.add_task(\"error_zero\")\n</code></pre> <p>\u041c\u0435\u0442\u043e\u0434 <code>add_task</code> \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 \u043f\u043e\u0437\u0438\u0446\u0438\u043e\u043d\u043d\u044b\u0435 \u0438 \u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u044b (<code>*args</code>, <code>**kwargs</code>), \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0431\u0443\u0434\u0443\u0442 \u043f\u0435\u0440\u0435\u0434\u0430\u043d\u044b \u0432 \u0444\u0443\u043d\u043a\u0446\u0438\u044e \u0437\u0430\u0434\u0430\u0447\u0438.</p>"},{"location":"ru/getting_started/#6","title":"6. \u0410\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0439 \u0432\u0430\u0440\u0438\u0430\u043d\u0442 (\u043a\u0440\u0430\u0442\u043a\u043e)","text":"<p>\u0410\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0439 \u0432\u0430\u0440\u0438\u0430\u043d\u0442 \u043d\u0430\u0441\u0442\u0440\u0430\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u0430\u043d\u0430\u043b\u043e\u0433\u0438\u0447\u043d\u043e, \u043d\u043e \u0441 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c <code>qtasks.asyncio.QueueTasks</code> \u0438 <code>async</code>-\u0444\u0443\u043d\u043a\u0446\u0438\u0439:</p> <pre><code>from qtasks.asyncio import QueueTasks\n\n\napp = QueueTasks()\n\n\n@app.task(name=\"mytest_async\")\nasync def mytest_async(text: str):\n    print(text)\n    return text\n\n\nif __name__ == \"__main__\":\n    app.run_forever()\n</code></pre> <p>\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435 \u043e\u0431 \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0445 \u0437\u0430\u0434\u0430\u0447\u0430\u0445, <code>AsyncTask</code> \u0438 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f:</p> <ul> <li> <p> (A)syncTask</p> <p>\u0423\u0437\u043d\u0430\u0435\u043c \u0431\u043e\u043b\u044c\u0448\u0435 \u043e \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u043d\u0438\u0438 @app.task</p> <p> \u0414\u0435\u043a\u043e\u0440\u0430\u0442\u043e\u0440 \u0437\u0430\u0434\u0430\u0447\u0438</p> </li> <li> <p> Task Context</p> <p>\u041f\u043e\u043d\u0438\u043c\u0430\u0435\u043c \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447 \u0438 \u0435\u0433\u043e \u043f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u0435</p> <p> \u041a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 \u0437\u0430\u0434\u0430\u0447\u0438</p> </li> </ul>"},{"location":"ru/install/","title":"\u0423\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430","text":"<p><code>QTasks</code> \u043c\u043e\u0436\u043d\u043e \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0447\u0435\u0440\u0435\u0437 PyPI \u0438\u043b\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043d\u0430\u043f\u0440\u044f\u043c\u0443\u044e \u0438\u0437 \u0438\u0441\u0445\u043e\u0434\u043d\u043e\u0433\u043e \u043a\u043e\u0434\u0430. \u0424\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a \u043d\u0435 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u0432\u0430\u0435\u0442 \u0432\u044b\u0431\u043e\u0440 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b \u0438 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0431\u0440\u043e\u043a\u0435\u0440\u043e\u0432 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439. \u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f <code>Redis</code>.</p>"},{"location":"ru/install/#pypi","title":"\u0423\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0447\u0435\u0440\u0435\u0437 PyPI","text":""},{"location":"ru/install/#redis","title":"\u0411\u0430\u0437\u043e\u0432\u0430\u044f \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 (Redis \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e)","text":"<pre><code>pip install qtasks\n</code></pre>"},{"location":"ru/install/#webview","title":"\u0423\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 WebView (\u043e\u043f\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u043e)","text":"<p>\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 <code>QTasks WebView</code> \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0432\u0435\u0431\u2011\u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441 \u0434\u043b\u044f \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u0430 \u0437\u0430\u0434\u0430\u0447.</p> <pre><code>pip install qtasks_webview\n</code></pre>"},{"location":"ru/install/#_2","title":"\u0423\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0441 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u043e\u0439 \u0434\u0440\u0443\u0433\u0438\u0445 \u0431\u0440\u043e\u043a\u0435\u0440\u043e\u0432","text":"<p>Info</p> <p>\u041f\u0435\u0440\u0435\u0434 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u043e\u0439 \u0443\u0431\u0435\u0434\u0438\u0442\u0435\u0441\u044c, \u0447\u0442\u043e \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0439 \u0431\u0440\u043e\u043a\u0435\u0440 \u0440\u0430\u0437\u0432\u0435\u0440\u043d\u0443\u0442 \u0438 \u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d \u0432\u0430\u0448\u0435\u043c\u0443 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044e.</p>"},{"location":"ru/install/#kafka","title":"Kafka","text":"<pre><code>pip install qtasks[kafka]\n</code></pre>"},{"location":"ru/install/#github","title":"\u0423\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0438\u0437 \u0438\u0441\u0445\u043e\u0434\u043d\u043e\u0433\u043e \u043a\u043e\u0434\u0430 (GitHub)","text":"<p>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0438\u0441\u0445\u043e\u0434\u043d\u044b\u0439 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0439, \u0435\u0441\u043b\u0438 \u0432\u0430\u043c \u043d\u0443\u0436\u043d\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u044f\u044f \u0432\u0435\u0440\u0441\u0438\u044f \u0438\u043b\u0438 \u0435\u0441\u043b\u0438 \u0432\u044b \u043f\u043b\u0430\u043d\u0438\u0440\u0443\u0435\u0442\u0435 \u0432\u043d\u043e\u0441\u0438\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f:</p> <pre><code>git clone https://github.com/txello/qtasks.git\ncd qtasks/\npip install .\n</code></pre>"},{"location":"ru/next/","title":"\u0427\u0442\u043e \u0434\u0430\u043b\u044c\u0448\u0435?","text":"<ul> <li> <p> \u0418\u0437\u0443\u0447\u0430\u0435\u043c \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438</p> <p>\u0423\u0437\u043d\u0430\u0435\u043c \u0431\u043e\u043b\u044c\u0448\u0435 \u043e \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044f\u0445 \u0437\u0430\u0434\u0430\u0447 QTasks.</p> <p> \u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438</p> </li> <li> <p> \u041f\u0438\u0448\u0435\u043c \u043f\u043b\u0430\u0433\u0438\u043d\u044b</p> <p>\u041f\u0438\u0448\u0435\u043c \u0441\u0432\u043e\u0438 \u043f\u043b\u0430\u0433\u0438\u043d\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043c\u044f\u0433\u043a\u043e \u0438\u043d\u0442\u0435\u0433\u0440\u0438\u0440\u0443\u044e\u0442\u0441\u044f \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443.</p> <p> \u041a\u0430\u043a \u043f\u0438\u0441\u0430\u0442\u044c \u043f\u043b\u0430\u0433\u0438\u043d\u044b</p> </li> <li> <p> \u0418\u043d\u0442\u0435\u0433\u0440\u0438\u0440\u0443\u0435\u043c</p> <p>\u041d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u043c\u0438 \u0441\u0442\u0440\u043e\u043a\u0430\u043c\u0438 \u043a\u043e\u0434\u0430 \u0438\u043d\u0442\u0435\u0433\u0440\u0438\u0440\u0443\u0435\u043c QTasks \u0432 \u0441\u0432\u043e\u0439 \u043f\u0440\u043e\u0435\u043a\u0442.</p> <p> \u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f</p> </li> <li> <p> \u0410\u043d\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u043c</p> <p>\u0410\u043d\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u043c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435, \u0441\u043c\u043e\u0442\u0440\u0438\u043c \u0437\u0430\u0434\u0430\u0447\u0438 \u0438 \u043f\u0440\u0438\u043c\u0435\u043d\u044f\u0435\u043c \u0432 \u0441\u0432\u043e\u0435\u0439 \u0440\u0430\u0431\u043e\u0442\u0435.</p> <p> \u0410\u043d\u0430\u043b\u0438\u0442\u0438\u043a\u0430</p> </li> </ul>"},{"location":"ru/schemas/","title":"\u0421\u0445\u0435\u043c\u044b","text":""},{"location":"ru/schemas/#background-","title":"Background-\u0441\u0445\u0435\u043c\u0430 \u0441\u0432\u044f\u0437\u0435\u0439 \u0444\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a\u0430","text":"<pre><code>sequenceDiagram\n  autonumber\n  participant QueueTasks\n  participant Starter\n  participant Worker\n  participant Broker\n  participant Storage\n  participant GlobalConfig\n\n  QueueTasks-&gt;&gt;Starter: \u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f / \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f\n  Starter-&gt;&gt;Worker: \u0417\u0430\u043f\u0443\u0441\u043a\n  Starter-&gt;&gt;Broker: \u0417\u0430\u043f\u0443\u0441\u043a\n  Broker-&gt;&gt;Storage: \u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f / \u0437\u0430\u043f\u0443\u0441\u043a\n  Storage-&gt;&gt;GlobalConfig: \u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f (\u0435\u0441\u043b\u0438 \u0435\u0441\u0442\u044c)\n\n  GlobalConfig--&gt;&gt;Storage: \u041e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430\n  Storage--&gt;&gt;Broker: \u041e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430\n  Broker--&gt;&gt;Worker: \u041e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430\n  Starter--&gt;&gt;QueueTasks: \u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u0435</code></pre> <p>\u042d\u0442\u0430 \u0434\u0438\u0430\u0433\u0440\u0430\u043c\u043c\u0430 \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 \u0441\u0432\u044f\u0437\u044c \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432 \u0438 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u043f\u043e\u0440\u044f\u0434\u043e\u043a \u0437\u0430\u043f\u0443\u0441\u043a\u0430:</p> <ul> <li>Starter \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442 \u0442\u043e\u043b\u044c\u043a\u043e Worker \u0438 Broker.</li> <li>Broker \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442 Storage.</li> <li>Storage \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442 GlobalConfig, \u0435\u0441\u043b\u0438 \u043e\u043d \u043f\u0440\u0438\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442.</li> <li>\u041e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442 \u0432 \u043e\u0431\u0440\u0430\u0442\u043d\u043e\u043c \u043f\u043e\u0440\u044f\u0434\u043a\u0435.</li> </ul>"},{"location":"ru/schemas/#_2","title":"\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u0437\u0430\u0434\u0430\u0447\u0438 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u043c","text":"<pre><code>sequenceDiagram\n  autonumber\n  participant Storage\n  participant Broker\n  participant Worker\n  participant TaskExecutor\n\n  Broker-&gt;&gt;Storage: \u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u0437\u0430\u0434\u0430\u0447\u0443\n  Broker-&gt;&gt;Worker: \u041f\u0435\u0440\u0435\u0434\u0430\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0443\n  Worker-&gt;&gt;TaskExecutor: \u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447\u0438\n  TaskExecutor--&gt;&gt;Worker: \u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f\n  Worker-&gt;&gt;Storage: \u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442</code></pre> <p>\u042d\u0442\u0430 \u0434\u0438\u0430\u0433\u0440\u0430\u043c\u043c\u0430 \u043e\u0442\u0440\u0430\u0436\u0430\u0435\u0442 \u0444\u0430\u043a\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u043f\u0440\u043e\u0446\u0435\u0441\u0441:</p> <ol> <li>\u0417\u0430\u0434\u0430\u0447\u0430 \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u0442\u0441\u044f \u0432 Storage.</li> <li>\u0411\u0440\u043e\u043a\u0435\u0440 \u043f\u0435\u0440\u0435\u0434\u0430\u0451\u0442 \u0437\u0430\u0434\u0430\u0447\u0443 \u0432\u043e\u0440\u043a\u0435\u0440\u0443.</li> <li>Worker \u0432\u044b\u0437\u044b\u0432\u0430\u0435\u0442 TaskExecutor \u2014 \u0437\u0430\u043c\u0435\u043d\u044f\u0435\u043c\u044b\u0439 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447.</li> <li>TaskExecutor \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442 \u0444\u0443\u043d\u043a\u0446\u0438\u044e \u0437\u0430\u0434\u0430\u0447\u0438, \u0432\u044b\u0437\u044b\u0432\u0430\u0435\u0442 middlewares_before/middlewares_after, \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0435\u0442 \u043e\u0448\u0438\u0431\u043a\u0438 \u0438 retry.</li> <li>\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u043f\u0435\u0440\u0435\u0434\u0430\u0451\u0442\u0441\u044f \u0432\u043e\u0440\u043a\u0435\u0440\u0443 \u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u0442\u0441\u044f \u0432 Storage.</li> </ol>"},{"location":"ru/schemas/#_3","title":"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447\u0438 \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u043c","text":"<pre><code>sequenceDiagram\n  autonumber\n  participant AT as (A)syncTask.add_task()\n  participant QT as QueueTasks.add_task()\n  participant Broker\n\n  AT-&gt;&gt;QT: \u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0430 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 \u0437\u0430\u0434\u0430\u0447\u0438\n  QT-&gt;&gt;Broker: \u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u043d\u043e\u0432\u043e\u0439 \u0437\u0430\u0434\u0430\u0447\u0438</code></pre> <p>\u041f\u0440\u043e\u0446\u0435\u0441\u0441 \u0432\u044b\u0433\u043b\u044f\u0434\u0438\u0442 \u0442\u0430\u043a:</p> <ol> <li><code>(A)syncTask.add_task()</code> \u0438\u043b\u0438 <code>TaskCls().__call__().add_task()</code> \u043f\u043e\u0434\u0433\u043e\u0442\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b.</li> <li>\u0412\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0435 \u0432\u0441\u0451 \u043f\u0435\u0440\u0435\u0432\u043e\u0434\u0438\u0442\u0441\u044f \u043d\u0430 <code>QueueTasks.add_task()</code>.</li> <li>\u0411\u0440\u043e\u043a\u0435\u0440 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0435\u0442 \u0437\u0430\u0434\u0430\u0447\u0443 \u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u0442 \u0435\u0451 \u0447\u0435\u0440\u0435\u0437 Storage.</li> </ol>"},{"location":"ru/schemas/#_4","title":"\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430 \u0437\u0430\u0434\u0430\u0447\u0438 \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u043c","text":"<pre><code>sequenceDiagram\n  autonumber\n  participant AT as (A)syncTask.add_task()\n  participant AR as (A)syncResult.result()\n  participant QT as QueueTasks\n  participant Broker\n  participant Storage\n\n  AT-&gt;&gt;AR: \u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u0430 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430\n  AR-&gt;&gt;QT: \u0417\u0430\u043f\u0440\u043e\u0441 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430\n  QT-&gt;&gt;Broker: \u041f\u0440\u043e\u043a\u0441\u0438-\u0437\u0430\u043f\u0440\u043e\u0441\n  Broker-&gt;&gt;Storage: \u0427\u0442\u0435\u043d\u0438\u0435 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430\n  Storage--&gt;&gt;Broker: \u0414\u0430\u043d\u043d\u044b\u0435\n  Broker--&gt;&gt;QT: \u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\n  QT--&gt;&gt;AR: \u0412\u043e\u0437\u0432\u0440\u0430\u0442 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430</code></pre> <p>\u042d\u0442\u0430\u043f\u044b:</p> <ol> <li><code>(A)syncTask.add_task()</code> \u0441\u043e\u0437\u0434\u0430\u0451\u0442 <code>(A)syncResult</code>.</li> <li><code>(A)syncResult.result()</code> \u0432\u044b\u0437\u044b\u0432\u0430\u0435\u0442 <code>QueueTasks</code>, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043f\u0440\u043e\u043a\u0441\u0438\u0440\u0443\u0435\u0442 \u0437\u0430\u043f\u0440\u043e\u0441.</li> <li><code>QueueTasks.get()</code> \u043f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0432 <code>Broker.get()</code>.</li> <li>Broker \u0437\u0430\u043f\u0440\u0430\u0448\u0438\u0432\u0430\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u0443 Storage.</li> <li>Storage \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442.</li> <li>\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u043f\u043e\u0434\u043d\u0438\u043c\u0430\u0435\u0442\u0441\u044f \u043e\u0431\u0440\u0430\u0442\u043d\u043e \u0447\u0435\u0440\u0435\u0437 Broker \u2192 QueueTasks \u2192 (A)syncResult.</li> </ol>"},{"location":"ru/tests/","title":"\u0422\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435","text":"<p>QTasks \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447 \u0438 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432 \u043a\u0430\u043a \u0432 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e\u043c, \u0442\u0430\u043a \u0438 \u0432 \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e\u043c \u0440\u0435\u0436\u0438\u043c\u0435. \u0412\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0435 \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u044b Python (<code>unittest</code>, <code>pytest</code>) \u0438 \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0435 \u043d\u0430\u0434\u0441\u0442\u0440\u043e\u0439\u043a\u0438 (<code>pytest-asyncio</code>), \u0430 \u0442\u0430\u043a\u0436\u0435 \u0432\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0435 \u0442\u0435\u0441\u0442\u043e\u0432\u044b\u0435 \u043a\u0435\u0439\u0441\u044b \u0444\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a\u0430.</p>"},{"location":"ru/tests/#_2","title":"\u0411\u044b\u0441\u0442\u0440\u044b\u0439 \u0437\u0430\u043f\u0443\u0441\u043a \u0442\u0435\u0441\u0442\u043e\u0432","text":"<p>\u041c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u043f\u0440\u0438\u043c\u0435\u0440 \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u0442\u0435\u0441\u0442\u043e\u0432 \u043d\u0430\u043f\u0440\u044f\u043c\u0443\u044e:</p> <pre><code>py tests/main.py\n</code></pre> <p>\u041f\u0440\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0438 <code>pytest</code>:</p> <pre><code>pytest -v\n</code></pre> <p>\u041f\u0440\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0438 <code>tox</code> (\u0434\u043b\u044f \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 \u0432\u0435\u0440\u0441\u0438\u0439 Python):</p> <pre><code>tox\n</code></pre> <p>\u041a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0435 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u0435:</p> <pre><code>tox -e py312\n</code></pre>"},{"location":"ru/tests/#_3","title":"\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u043c\u044b\u0435 \u0444\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a\u0438","text":"<ul> <li>\u2705 <code>unittest</code> \u2014 \u0431\u0430\u0437\u043e\u0432\u044b\u0439 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0439 \u0444\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a Python.</li> <li>\u2705 <code>pytest</code> \u2014 \u0433\u0438\u0431\u043a\u0430\u044f \u0438 \u0440\u0430\u0441\u0448\u0438\u0440\u044f\u0435\u043c\u0430\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f.</li> <li>\u2705 <code>pytest-asyncio</code> \u2014 \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0443 <code>async</code>-\u0442\u0435\u0441\u0442\u043e\u0432 \u0434\u043b\u044f <code>pytest</code>.</li> <li>\u2705 <code>SyncTestCase</code> / <code>AsyncTestCase</code> \u2014 \u0432\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0435 \u043a\u0435\u0439\u0441\u044b QTasks \u0434\u043b\u044f \u0442\u043e\u043d\u043a\u043e\u0439 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0441\u0440\u0435\u0434\u044b \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f.</li> </ul> <p>\u0410\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0435 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0438 \u0432\u0440\u043e\u0434\u0435 <code>aiounittest</code> \u043c\u043e\u0436\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043f\u043e \u0436\u0435\u043b\u0430\u043d\u0438\u044e, \u043d\u043e \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u0444\u043e\u043a\u0443\u0441 \u043f\u0440\u0438\u043c\u0435\u0440\u043e\u0432 \u0441\u0434\u0435\u043b\u0430\u043d \u043d\u0430 <code>unittest</code> \u0438 <code>pytest</code>.</p>"},{"location":"ru/tests/#_4","title":"\u0411\u0430\u0437\u043e\u0432\u044b\u0435 \u043f\u0440\u0438\u043c\u0435\u0440\u044b","text":""},{"location":"ru/tests/#unittest","title":"<code>unittest</code> (\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e)","text":"<pre><code>import unittest\nfrom app import app\n\n\nclass TestTasks(unittest.TestCase):\n    def setUp(self):\n        # \u0414\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u043c \u0437\u0430\u0434\u0430\u0447\u0443 \u0432 \u043e\u0447\u0435\u0440\u0435\u0434\u044c\n        self._result = app.add_task(\"test\", 5)\n\n    def test_task_get_result(self):\n        uuid = self._result.uuid\n        result = app.get(uuid=uuid)\n        self.assertIsNotNone(result)\n</code></pre> <p>\u0417\u0434\u0435\u0441\u044c <code>app.get()</code> \u2014 \u043f\u0443\u0431\u043b\u0438\u0447\u043d\u044b\u0439 \u043c\u0435\u0442\u043e\u0434, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043f\u0440\u043e\u043a\u0441\u0438\u0440\u0443\u0435\u0442 \u0437\u0430\u043f\u0440\u043e\u0441 \u043a \u0431\u0440\u043e\u043a\u0435\u0440\u0443 \u0438 \u0434\u0430\u043b\u0435\u0435 \u043a \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0443 (<code>app.broker.get()</code>, <code>app.broker.storage.get()</code>).</p>"},{"location":"ru/tests/#unittest_1","title":"<code>unittest</code> (\u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e)","text":"<pre><code>import unittest\nfrom app import app\n\n\nclass TestAsyncTasks(unittest.IsolatedAsyncioTestCase):\n    async def _add_task(self):\n        return await app.add_task(\"test\", 5)\n\n    async def test_task_get_result(self):\n        task = await self._add_task()\n        result = await app.get(uuid=task.uuid)\n        self.assertIsNotNone(result)\n</code></pre> <p>\u0412 \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0445 \u0442\u0435\u0441\u0442\u0430\u0445 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f <code>IsolatedAsyncioTestCase</code>, \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0439 \u0432 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u043e\u0439 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0435 Python 3.8+.</p>"},{"location":"ru/tests/#qtasks","title":"\u0412\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0435 \u0442\u0435\u0441\u0442\u043e\u0432\u044b\u0435 \u043a\u0435\u0439\u0441\u044b QTasks","text":"<p>QTasks \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0435 \u0442\u0435\u0441\u0442\u043e\u0432\u044b\u0435 \u043e\u0431\u0451\u0440\u0442\u043a\u0438 <code>SyncTestCase</code> \u0438 <code>AsyncTestCase</code>, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u044e\u0442:</p> <ul> <li>\u043f\u043e\u0434\u043c\u0435\u043d\u044f\u0442\u044c \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f (broker, worker, storage) \u043d\u0430 \u0442\u0435\u0441\u0442\u043e\u0432\u044b\u0435 \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0432 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442 <code>TestConfig</code>;</li> <li>\u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0438 \u0431\u0435\u0437 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0432\u0435\u0440\u0430;</li> <li>\u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043b\u043e\u0433\u0438\u043a\u0443 \u0441 \u0440\u0430\u0437\u043d\u043e\u0439 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0435\u0439 \u0441\u0440\u0435\u0434\u044b.</li> </ul> <p>\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435 \u043e <code>TestConfig</code> \u0441\u043c. \u0432 \u0440\u0430\u0437\u0434\u0435\u043b\u0435: API/\u0421\u0445\u0435\u043c\u044b/TestConfig.</p>"},{"location":"ru/tests/#synctestcase","title":"<code>SyncTestCase</code>","text":"<pre><code>import unittest\n\nfrom qtasks.tests import SyncTestCase\nfrom qtasks.schemas.test import TestConfig\nfrom app import app\n\n\nclass TestTasks(unittest.TestCase):\n    def setUp(self):\n        self.case = SyncTestCase(app=app)\n        # \u0412\u043a\u043b\u044e\u0447\u0430\u0435\u043c \u043f\u043e\u043b\u043d\u044b\u0439 \u0442\u0435\u0441\u0442\u043e\u0432\u044b\u0439 \u043a\u043e\u043d\u0444\u0438\u0433\n        self.case.settings(TestConfig.full())\n\n    def test_task_add(self):\n        task = self.case.add_task(\"test\", 5)\n        self.assertIsNotNone(task)\n</code></pre>"},{"location":"ru/tests/#asynctestcase","title":"<code>AsyncTestCase</code>","text":"<pre><code>import unittest\n\nfrom qtasks.tests import AsyncTestCase\nfrom qtasks.schemas.test import TestConfig\nfrom app import app\n\n\nclass TestAsyncQTasks(unittest.IsolatedAsyncioTestCase):\n    def setUp(self):\n        self.case = AsyncTestCase(app=app)\n        self.case.settings(TestConfig.full())\n\n    async def _add_task(self):\n        return await self.case.add_task(\"test\", 5, timeout=10)\n\n    async def test_add_task(self):\n        task = await self._add_task()\n        self.assertIsNotNone(task)\n</code></pre> <p>\u0412 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442 \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043a <code>TestConfig</code> \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u043c\u043e\u0433\u0443\u0442 \u0431\u044b\u0442\u044c \u043f\u043e\u0434\u043c\u0435\u043d\u0435\u043d\u044b \u043d\u0430 \u0442\u0435\u0441\u0442\u043e\u0432\u044b\u0435 (\u043f\u0443\u0441\u0442\u044b\u0435) \u043a\u043b\u0430\u0441\u0441\u044b, \u0447\u0442\u043e \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0438\u0437\u043e\u043b\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0442\u0435\u0441\u0442\u0438\u0440\u0443\u0435\u043c\u0443\u044e \u043b\u043e\u0433\u0438\u043a\u0443.</p>"},{"location":"ru/tests/#pytest-pytest-asyncio","title":"\u041f\u0440\u0438\u043c\u0435\u0440 \u0441 <code>pytest</code> \u0438 <code>pytest-asyncio</code>","text":""},{"location":"ru/tests/#_5","title":"\u0423\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430","text":"<pre><code>pip install pytest pytest-asyncio\n</code></pre>"},{"location":"ru/tests/#teststest_async_taskpy","title":"\u041f\u0440\u0438\u043c\u0435\u0440 \u0444\u0430\u0439\u043b\u0430 <code>tests/test_async_task.py</code>","text":"<pre><code>import pytest\nfrom uuid import uuid4\n\nfrom qtasks.tests import AsyncTestCase\nfrom qtasks.schemas.test import TestConfig\nfrom qtasks.enums.task_status import TaskStatusEnum\n\nfrom tests.apps.app_async import app\n\n\n@pytest.fixture()\ndef test_case():\n    case = AsyncTestCase(app=app)\n    case.settings(TestConfig.full())\n    return case\n\n\n@pytest.mark.asyncio\nasync def test_task_get_result(test_case):\n    task = await test_case.add_task(\"test\", 5)\n    result = await app.get(uuid=task.uuid)\n    assert result is not None\n\n\n@pytest.mark.asyncio\nasync def test_task_returns_expected_result(test_case):\n    task = await test_case.add_task(\"test\", 5, timeout=10)\n    # \u041f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c, \u0447\u0442\u043e \u0437\u0430\u0434\u0430\u0447\u0430 \u0432\u0435\u0440\u043d\u0443\u043b\u0430 \u043e\u0436\u0438\u0434\u0430\u0435\u043c\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435\n    assert task.returning is not None\n\n\n@pytest.mark.asyncio\nasync def test_task_error_handling(test_case):\n    task = await test_case.add_task(\"error_task\", timeout=10)\n    assert task.status == TaskStatusEnum.ERROR.value\n\n\n@pytest.mark.asyncio\nasync def test_task_not_found():\n    # UUID, \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0439 \u0432 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435\n    result = await app.get(uuid=str(uuid4()))\n    assert result is None\n</code></pre>"},{"location":"ru/tests/#_6","title":"\u0417\u0430\u043f\u0443\u0441\u043a \u0442\u0435\u0441\u0442\u043e\u0432","text":"<pre><code>pytest tests/test_async_task.py -v\n</code></pre> <p>\u042d\u0442\u0438 \u043f\u0440\u0438\u043c\u0435\u0440\u044b \u0434\u0435\u043c\u043e\u043d\u0441\u0442\u0440\u0438\u0440\u0443\u044e\u0442 \u0431\u0430\u0437\u043e\u0432\u044b\u0439 \u043f\u043e\u0434\u0445\u043e\u0434 \u043a \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044e \u0437\u0430\u0434\u0430\u0447, \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u0438 \u043e\u0448\u0438\u0431\u043e\u043a \u0432 QTasks. \u0411\u043e\u043b\u0435\u0435 \u043f\u0440\u043e\u0434\u0432\u0438\u043d\u0443\u0442\u044b\u0435 \u0441\u0446\u0435\u043d\u0430\u0440\u0438\u0438 (\u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432, middleware, \u0446\u0435\u043f\u043e\u0447\u0435\u043a \u0437\u0430\u0434\u0430\u0447 \u0438 \u0442.\u043f.) \u043e\u043f\u0438\u0441\u044b\u0432\u0430\u044e\u0442\u0441\u044f \u0432 \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u0440\u0430\u0437\u0434\u0435\u043b\u0430\u0445 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438.</p>"},{"location":"ru/api/webview/","title":"\u0412 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0435","text":""},{"location":"ru/api/plugins/errors/","title":"\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u043e\u0448\u0438\u0431\u043e\u043a \u0447\u0435\u0440\u0435\u0437 \u043f\u043b\u0430\u0433\u0438\u043d\u044b","text":"<p>\u0412 QTasks \u043f\u0440\u0435\u0434\u0443\u0441\u043c\u043e\u0442\u0440\u0435\u043d\u0430 \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u043f\u0435\u0440\u0435\u0445\u0432\u0430\u0442\u0430 \u043e\u0448\u0438\u0431\u043e\u043a \u0437\u0430\u0434\u0430\u0447 \u0447\u0435\u0440\u0435\u0437 \u043f\u043b\u0430\u0433\u0438\u043d\u044b. \u042d\u0442\u043e \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442:</p> <ul> <li>\u0446\u0435\u043d\u0442\u0440\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u043e \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0442\u044c \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f;</li> <li>\u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0442\u044c \u0430\u043b\u044c\u0442\u0435\u0440\u043d\u0430\u0442\u0438\u0432\u043d\u044b\u0439 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u043f\u0440\u0438 \u043e\u0448\u0438\u0431\u043a\u0435;</li> <li>\u0432\u043d\u0435\u0434\u0440\u044f\u0442\u044c \u043a\u0430\u0441\u0442\u043e\u043c\u043d\u0443\u044e \u043b\u043e\u0433\u0438\u043a\u0443 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435, \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f, \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435).</li> </ul>"},{"location":"ru/api/plugins/errors/#_2","title":"\ud83d\udccc \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0439 \u0442\u0440\u0438\u0433\u0433\u0435\u0440","text":"<p>\u0422\u0440\u0438\u0433\u0433\u0435\u0440: <code>task_executor_run_task_trigger_error</code></p> <ul> <li>\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442: <code>TaskExecutor</code></li> <li>\u0412\u044b\u0437\u043e\u0432: \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442 \u043f\u0440\u0438 \u0432\u043e\u0437\u043d\u0438\u043a\u043d\u043e\u0432\u0435\u043d\u0438\u0438 \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f <code>TaskPluginTriggerError</code></li> <li> <p>\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b:</p> </li> <li> <p><code>task_executor</code> \u2014 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440 TaskExecutor</p> </li> <li><code>task_func</code> \u2014 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u043c\u0430\u044f \u0437\u0430\u0434\u0430\u0447\u0430</li> <li><code>task_broker</code> \u2014 \u0431\u0440\u043e\u043a\u0435\u0440 \u0437\u0430\u0434\u0430\u0447\u0438</li> <li><code>e</code> \u2014 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440 \u043e\u0448\u0438\u0431\u043a\u0438 <code>TaskPluginTriggerError</code></li> </ul>"},{"location":"ru/api/plugins/errors/#_3","title":"\ud83e\udde0 \u041c\u0435\u0445\u0430\u043d\u0438\u0437\u043c \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438","text":"<p>\u0415\u0441\u043b\u0438 \u0432 \u0437\u0430\u0434\u0430\u0447\u0435 \u0432\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f:</p> <pre><code>self.ctx.plugin_error()\n</code></pre> <p>\u0442\u043e \u0431\u0443\u0434\u0435\u0442 \u0432\u044b\u0431\u0440\u043e\u0448\u0435\u043d\u043e \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435:</p> <pre><code>from qtasks.exc import TaskPluginTriggerError\n\nraise TaskPluginTriggerError(**kwargs)\n</code></pre> <p>\u0412\u043d\u0443\u0442\u0440\u0438 <code>TaskExecutor</code> \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u0431\u0443\u0434\u0435\u0442 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0430\u043d\u043e \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c:</p> <pre><code>try:\n    self._result = await self.run_task()\nexcept TaskPluginTriggerError as e:\n    new_result = await self._plugin_trigger(\n        \"task_executor_run_task_trigger_error\",\n        task_executor=self,\n        task_func=self.task_func,\n        task_broker=self.task_broker,\n        e=e,\n        return_last=True\n    )\n    if new_result:\n        self._result = new_result\n    else:\n        raise e\n</code></pre> <p>\u0415\u0441\u043b\u0438 \u0445\u043e\u0442\u044f \u0431\u044b \u043e\u0434\u0438\u043d \u043f\u043b\u0430\u0433\u0438\u043d \u0432\u0435\u0440\u043d\u0451\u0442 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u2014 \u043e\u043d\u043e \u0441\u0442\u0430\u043d\u0435\u0442 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u043c \u0437\u0430\u0434\u0430\u0447\u0438. \u0418\u043d\u0430\u0447\u0435 \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043f\u0440\u043e\u0431\u0440\u0430\u0441\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u0434\u0430\u043b\u044c\u0448\u0435.</p>"},{"location":"ru/api/plugins/errors/#_4","title":"\ud83d\udd27 \u041f\u0440\u0438\u043c\u0435\u0440 \u0437\u0430\u0434\u0430\u0447\u0438 \u0441 \u0432\u044b\u0437\u043e\u0432\u043e\u043c \u043e\u0448\u0438\u0431\u043a\u0438","text":"<pre><code>from qtasks.exc import TaskPluginTriggerError\n\n@app.task(echo=True)\nasync def test_task(self: AsyncTask):\n    self.ctx.plugin_error(message=\"\u041d\u0435\u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u0430\u044f \u0441\u0438\u0442\u0443\u0430\u0446\u0438\u044f\")\n    # \u0410\u043b\u044c\u0442\u0435\u0440\u043d\u0430\u0442\u0438\u0432\u0430: raise TaskPluginTriggerError(\"\u041e\u0448\u0438\u0431\u043a\u0430 \u043d\u0430\u043f\u0440\u044f\u043c\u0443\u044e\")\n</code></pre>"},{"location":"ru/api/plugins/errors/#_5","title":"\ud83d\udd0c \u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u0432 \u043f\u043b\u0430\u0433\u0438\u043d\u0435","text":"<pre><code>class TestPlugin(BasePlugin):\n    def __init__(self, name=None):\n        super().__init__(name)\n        self.handlers = {\n            \"task_executor_run_task_trigger_error\": self.task_trigger_error\n        }\n\n    async def start(self, *args, **kwargs):\n        return super().start(*args, **kwargs)\n\n    async def stop(self, *args, **kwargs):\n        return super().stop(*args, **kwargs)\n\n    async def trigger(self, name, **kwargs):\n        handler = self.handlers.get(name)\n        if handler:\n            return handler(**kwargs)\n        return None\n\n    def task_trigger_error(self, **kwargs):\n        print(kwargs)\n        return 123\n</code></pre>"},{"location":"ru/api/plugins/errors/#_6","title":"\ud83d\udcd8 \u0421\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u044b","text":"<ul> <li>\ud83d\udcc4 \u0422\u0440\u0438\u0433\u0433\u0435\u0440\u044b \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432</li> <li>\u26a0\ufe0f \u0418\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f</li> </ul> <p>\u0421\u0438\u0441\u0442\u0435\u043c\u0430 <code>plugin_error</code> \u0434\u0430\u0451\u0442 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c \u043d\u0430\u0434 \u043b\u043e\u0433\u0438\u043a\u043e\u0439 \u043e\u0448\u0438\u0431\u043e\u043a \u0438 \u043c\u043e\u0436\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u043a\u0430\u043a \u0442\u043e\u0447\u043a\u0430 \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u044f \u043f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447.</p>"},{"location":"ru/api/plugins/triggers/","title":"\u0421\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u043e\u0432 \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432","text":"<p>QTasks \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0433\u0438\u0431\u043a\u0438\u0439 \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c \u0432\u043d\u0435\u0434\u0440\u0435\u043d\u0438\u044f \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432 \u0441 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u043e\u0432. \u042d\u0442\u0438 \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u044b \u0432\u044b\u0437\u044b\u0432\u0430\u044e\u0442\u0441\u044f \u0432\u043d\u0443\u0442\u0440\u0438 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432 \u0438 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u044e\u0442:</p> <ul> <li>\u0418\u0437\u043c\u0435\u043d\u044f\u0442\u044c \u0432\u0445\u043e\u0434\u043d\u044b\u0435 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u044b \u0437\u0430\u0434\u0430\u0447</li> <li>\u0417\u0430\u043c\u0435\u043d\u044f\u0442\u044c \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0444\u0443\u043d\u043a\u0446\u0438\u0439</li> <li>\u0420\u0435\u0430\u0433\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043d\u0430 \u0441\u043e\u0431\u044b\u0442\u0438\u044f \u0431\u0435\u0437 \u0432\u043c\u0435\u0448\u0430\u0442\u0435\u043b\u044c\u0441\u0442\u0432\u0430 \u0432 \u043e\u0441\u043d\u043e\u0432\u043d\u0443\u044e \u043b\u043e\u0433\u0438\u043a\u0443</li> </ul>"},{"location":"ru/api/plugins/triggers/#_2","title":"\ud83d\udcd8 \u041f\u0440\u0430\u0432\u0438\u043b\u0430 \u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u044f","text":"<ul> <li>\u0428\u0430\u0431\u043b\u043e\u043d: <code>{\u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442}_{\u0444\u0443\u043d\u043a\u0446\u0438\u044f}_{\u0434\u043e\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435}</code></li> <li>\u0418\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435: \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 <code>QueueTasks</code> \u043e\u0431\u043e\u0437\u043d\u0430\u0447\u0430\u0435\u0442\u0441\u044f \u043a\u0430\u043a <code>qtasks</code></li> <li>\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b: \u043f\u0435\u0440\u0432\u044b\u043c \u0432\u0441\u0435\u0433\u0434\u0430 \u0438\u0434\u0451\u0442 \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, <code>self</code>), \u0434\u0430\u043b\u0435\u0435 \u2014 \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b \u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0430</li> </ul>"},{"location":"ru/api/plugins/triggers/#return","title":"\ud83d\udccc \u041f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u0435 <code>return</code>","text":"<ul> <li><code>new_args</code> / <code>new_model</code> / <code>new_data</code> / <code>new_result</code> \u0437\u0430\u043c\u0435\u043d\u044f\u044e\u0442 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435, \u0435\u0441\u043b\u0438 \u043f\u0440\u0438\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442</li> <li>\u0415\u0441\u043b\u0438 <code>return</code> \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u0438\u043b\u0438 <code>None</code>, \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u043e\u0441\u0442\u0430\u044e\u0442\u0441\u044f \u0431\u0435\u0437 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0439</li> <li>\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u043f\u043b\u0430\u0433\u0438\u043d \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u043e\u0442 \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u0433\u043e. \u0415\u0441\u043b\u0438 \u0443 \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u0433\u043e \u043f\u043b\u0430\u0433\u0438\u043d\u0430 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 - <code>None</code>, \u0442\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435, \u0438\u043b\u0438 \u0441\u0430\u043c\u043e\u0435 \u043f\u0435\u0440\u0432\u043e\u0435.</li> <li>\u041f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0439 \u0441\u0440\u0430\u0431\u043e\u0442\u0430\u0432\u0448\u0438\u0439 \u043f\u043b\u0430\u0433\u0438\u043d \u0438\u043c\u0435\u0435\u0442 \u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442 \u043d\u0430 \u0437\u0430\u043c\u0435\u043d\u0443</li> </ul> <p>\u041f\u0440\u0438\u043c\u0435\u0440: \u0435\u0441\u043b\u0438 <code>new_args</code>, \u0442\u043e \u0432 \u043d\u0451\u043c \u0445\u0440\u0430\u043d\u0438\u0442\u0441\u044f <code>{\"args\": (123,), \"kw\": {\"test\": 123}}</code>. \u0415\u0441\u043b\u0438 \u043e\u0434\u0438\u043d \u0438\u0437 \u0435\u0433\u043e \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 \u0440\u0430\u0432\u0435\u043d <code>None</code>, \u0442\u043e \u043f\u0440\u0438\u043c\u0435\u043d\u044f\u0435\u0442\u0441\u044f \u043b\u043e\u0433\u0438\u043a\u0430 \u0432\u044b\u0448\u0435.</p>"},{"location":"ru/api/plugins/triggers/#_3","title":"\ud83d\udd37 \u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b","text":""},{"location":"ru/api/plugins/triggers/#queuetasks-qtasks","title":"\ud83d\udd39 QueueTasks (<code>qtasks</code>)","text":"\u0422\u0440\u0438\u0433\u0433\u0435\u0440 Return \u041d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 <code>qtasks_add_task_before_broker</code> <code>new_args: dict</code> \u0417\u0430\u043c\u0435\u043d\u044f\u0435\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0437\u0430\u0434\u0430\u0447\u0438 \u0434\u043e \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 \u0431\u0440\u043e\u043a\u0435\u0440\u0443 <code>qtasks_add_task_after_broker</code> \u2014 \u0412\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u043f\u043e\u0441\u043b\u0435 \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 \u0437\u0430\u0434\u0430\u0447\u0438 \u0431\u0440\u043e\u043a\u0435\u0440\u0443 <code>qtasks_get</code> <code>new_result: Task</code> \u0417\u0430\u043c\u0435\u043d\u044f\u0435\u0442 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447\u0438 <code>qtasks_stop</code> \u2014 \u0412\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u043f\u0440\u0438 \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0435 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f <code>qtasks_ping</code> \u2014 \u041f\u0438\u043d\u0433\u0443\u0435\u0442 global_config <code>qtasks_flush_all</code> \u2014 \u0421\u0431\u0440\u043e\u0441 \u043e\u0447\u0435\u0440\u0435\u0434\u0435\u0439 \u0438 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449"},{"location":"ru/api/plugins/triggers/#broker","title":"\ud83d\udd39 Broker","text":"\u0422\u0440\u0438\u0433\u0433\u0435\u0440 Return \u041d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 <code>broker_listen_start</code> \u2014 \u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u043f\u0440\u043e\u0441\u043b\u0443\u0448\u0438\u0432\u0430\u043d\u0438\u044f <code>broker_add_worker</code> <code>new_args: dict</code> \u0417\u0430\u043c\u0435\u043d\u044f\u0435\u0442 \u0432\u0445\u043e\u0434\u043d\u044b\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0437\u0430\u0434\u0430\u0447\u0438 \u0434\u043b\u044f \u0432\u043e\u0440\u043a\u0435\u0440\u0430 <code>broker_add_before</code> <code>new_model: TaskStatusNewSchema</code> \u0417\u0430\u043c\u0435\u043d\u044f\u0435\u0442 \u043c\u043e\u0434\u0435\u043b\u044c \u043f\u0435\u0440\u0435\u0434 \u0437\u0430\u043f\u0438\u0441\u044c\u044e \u0432 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 <code>broker_add_after</code> \u2014 \u0412\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u043f\u043e\u0441\u043b\u0435 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0432 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 <code>broker_get</code> <code>new_task: Task</code> \u0417\u0430\u043c\u0435\u043d\u044f\u0435\u0442 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447\u0438 <code>broker_update</code> <code>new_kw: dict</code> \u0417\u0430\u043c\u0435\u043d\u044f\u0435\u0442 kwargs \u043f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u0437\u0430\u0434\u0430\u0447\u0438 <code>broker_start</code> \u2014 \u0417\u0430\u043f\u0443\u0441\u043a \u0431\u0440\u043e\u043a\u0435\u0440\u0430 <code>broker_stop</code> \u2014 \u041e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0431\u0440\u043e\u043a\u0435\u0440\u0430 <code>broker_remove_finished_task</code> <code>new_model</code> \u0417\u0430\u043c\u0435\u043d\u044f\u0435\u0442 \u043c\u043e\u0434\u0435\u043b\u044c \u0434\u043b\u044f \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0437\u0430\u0432\u0435\u0440\u0448\u0451\u043d\u043d\u043e\u0439 \u0437\u0430\u0434\u0430\u0447\u0438 <code>broker_running_older_tasks</code> \u2014 \u0412\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u043f\u0440\u0438 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u0441\u0442\u0430\u0440\u044b\u0445 \u0437\u0430\u0434\u0430\u0447 <code>broker_flush_all</code> \u2014 \u0421\u0431\u0440\u043e\u0441 \u043e\u0447\u0435\u0440\u0435\u0434\u0435\u0439"},{"location":"ru/api/plugins/triggers/#globalconfig","title":"\ud83d\udd39 GlobalConfig","text":"\u0422\u0440\u0438\u0433\u0433\u0435\u0440 Return \u041d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 <code>global_config_set</code> <code>new_data: dict</code> \u0417\u0430\u043c\u0435\u043d\u044f\u0435\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u043f\u0435\u0440\u0435\u0434 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u043e\u0439 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f <code>global_config_get</code> <code>new_result</code> \u0417\u0430\u043c\u0435\u043d\u044f\u0435\u0442 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u043d\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 <code>global_config_get_all</code> <code>new_result</code> \u0417\u0430\u043c\u0435\u043d\u044f\u0435\u0442 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0432\u0441\u0435\u0445 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439 <code>global_config_get_match</code> <code>new_result</code> \u0417\u0430\u043c\u0435\u043d\u044f\u0435\u0442 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u043f\u043e\u0438\u0441\u043a\u0430 \u043f\u043e \u0448\u0430\u0431\u043b\u043e\u043d\u0443 <code>global_config_start</code> \u2014 \u0417\u0430\u043f\u0443\u0441\u043a \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430 <code>global_config_stop</code> \u2014 \u041e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430 <code>global_config_set_status</code> \u2014 \u0421\u0438\u0433\u043d\u0430\u043b \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u0441\u0442\u0430\u0442\u0443\u0441\u0430"},{"location":"ru/api/plugins/triggers/#taskexecutor","title":"\ud83d\udd39 TaskExecutor","text":"\u0422\u0440\u0438\u0433\u0433\u0435\u0440 Return \u041d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 <code>task_executor_args_replace</code> <code>new_args: Tuple[list, dict]</code> \u0417\u0430\u043c\u0435\u043d\u044f\u0435\u0442 args \u0438 kwargs \u0434\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f <code>task_executor_middlewares_execute</code> \u2014 \u0412\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u043f\u0435\u0440\u0435\u0434 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435\u043c \u0437\u0430\u0434\u0430\u0447\u0438 \u0441 \u043c\u0438\u0434\u043b\u0432\u0430\u0440\u0430\u043c\u0438 <code>task_executor_run_task</code> <code>new_result</code> \u0417\u0430\u043c\u0435\u043d\u044f\u0435\u0442 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447\u0438 <code>task_executor_run_task_gen</code> <code>new_results</code> \u0417\u0430\u043c\u0435\u043d\u044f\u0435\u0442 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u0433\u0435\u043d\u0435\u0440\u0430\u0442\u043e\u0440\u0430 <code>task_executor_run_task_trigger_error</code> <code>new_result</code> \u0417\u0430\u043c\u0435\u043d\u044f\u0435\u0442 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u043f\u0440\u0438 \u0432\u044b\u0437\u043e\u0432\u0435 \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f <code>TaskPluginTriggerError</code> <code>task_executor_decode</code> <code>new_result</code> \u0417\u0430\u043c\u0435\u043d\u044f\u0435\u0442 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0434\u0435\u043a\u043e\u0434\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430"},{"location":"ru/api/plugins/triggers/#starter","title":"\ud83d\udd39 Starter","text":"\u0422\u0440\u0438\u0433\u0433\u0435\u0440 Return \u041d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 <code>starter_start</code> \u2014 \u0417\u0430\u043f\u0443\u0441\u043a \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430 Starter <code>starter_stop</code> \u2014 \u041e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430 Starter"},{"location":"ru/api/plugins/triggers/#storage","title":"\ud83d\udd39 Storage","text":"\u0422\u0440\u0438\u0433\u0433\u0435\u0440 Return \u041d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 <code>storage_add</code> <code>new_data</code> \u0417\u0430\u043c\u0435\u043d\u044f\u0435\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u043f\u0435\u0440\u0435\u0434 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435\u043c \u0437\u0430\u0434\u0430\u0447\u0438 <code>storage_get</code> <code>new_result: Task</code> \u0417\u0430\u043c\u0435\u043d\u044f\u0435\u0442 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447\u0438 <code>storage_get_all</code> <code>new_results: List[Task]</code> \u0417\u0430\u043c\u0435\u043d\u044f\u0435\u0442 \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u043d\u044b\u0445 \u0437\u0430\u0434\u0430\u0447 <code>storage_update</code> <code>new_kw: dict</code> \u0417\u0430\u043c\u0435\u043d\u044f\u0435\u0442 kwargs \u043f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 <code>storage_remove_finished_task</code> \u2014 \u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0437\u0430\u0432\u0435\u0440\u0448\u0451\u043d\u043d\u043e\u0439 \u0437\u0430\u0434\u0430\u0447\u0438 <code>storage_start</code> \u2014 \u0417\u0430\u043f\u0443\u0441\u043a \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430 <code>storage_stop</code> \u2014 \u041e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430 <code>storage_add_process</code> <code>new_data</code> \u0417\u0430\u043c\u0435\u043d\u044f\u0435\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u043f\u0440\u0438 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0438 \u0432 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0438\u043d\u0433 <code>storage_running_older_tasks</code> <code>new_data</code> \u0417\u0430\u043c\u0435\u043d\u044f\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u0440\u0438 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u0437\u0430\u0434\u0430\u0447 <code>storage_delete_finished_tasks</code> \u2014 \u041e\u0447\u0438\u0441\u0442\u043a\u0430 \u0437\u0430\u0432\u0435\u0440\u0448\u0451\u043d\u043d\u044b\u0445 \u0437\u0430\u0434\u0430\u0447 <code>storage_flush_all</code> \u2014 \u0421\u0431\u0440\u043e\u0441 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0430"},{"location":"ru/api/plugins/triggers/#worker","title":"\ud83d\udd39 Worker","text":"\u0422\u0440\u0438\u0433\u0433\u0435\u0440 Return \u041d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 <code>worker_execute_before</code> <code>new_model</code> \u0417\u0430\u043c\u0435\u043d\u044f\u0435\u0442 \u043c\u043e\u0434\u0435\u043b\u044c \u043f\u0435\u0440\u0435\u0434 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435\u043c <code>worker_execute_after</code> \u2014 \u0412\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u043f\u043e\u0441\u043b\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447\u0438 <code>worker_add</code> <code>new_data</code> \u0417\u0430\u043c\u0435\u043d\u044f\u0435\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447\u0438 <code>worker_start</code> \u2014 \u0417\u0430\u043f\u0443\u0441\u043a \u0432\u043e\u0440\u043a\u0435\u0440\u0430 <code>worker_stop</code> \u2014 \u041e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0432\u043e\u0440\u043a\u0435\u0440\u0430 <code>worker_run_task_before</code> <code>new_data</code> \u0417\u0430\u043c\u0435\u043d\u044f\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u0434\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447\u0438 <code>worker_task_error_retry</code> <code>plugin_result</code> \u0417\u0430\u043c\u0435\u043d\u044f\u0435\u0442 TaskStatusErrorSchema \u043f\u0440\u0438 \u043f\u043e\u0432\u0442\u043e\u0440\u0435 <code>worker_remove_finished_task</code> <code>new_data</code> \u0417\u0430\u043c\u0435\u043d\u044f\u0435\u0442 TaskPrioritySchema \u0438 TaskStatus... \u0434\u043b\u044f \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0438\u0437 \u043e\u0447\u0435\u0440\u0435\u0434\u0438"},{"location":"ru/api/plugins/triggers/#stats","title":"\ud83d\udd39 Stats","text":"\u0422\u0440\u0438\u0433\u0433\u0435\u0440 Return \u041d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 <code>stats_inspect</code> \u2014 \u0412\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u0434\u043e \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u044f <code>InspectStats</code> <p>\u042d\u0442\u043e \u0441\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a \u043c\u043e\u0436\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u0438 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0435 \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432, \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0439 \u0438\u043b\u0438 \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u043e\u0439 \u043b\u043e\u0433\u0438\u043a\u0438 \u043f\u043e\u0432\u0435\u0440\u0445 QTasks.</p>"},{"location":"ru/architecture/","title":"\u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430 QTasks","text":"<p>\u042d\u0442\u043e\u0442 \u0440\u0430\u0437\u0434\u0435\u043b \u043e\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u044b\u0435 \u043f\u0440\u0438\u043d\u0446\u0438\u043f\u044b QTasks: \u043a\u0430\u043a \u0443\u0441\u0442\u0440\u043e\u0435\u043d \u0444\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a \u043d\u0430 \u0443\u0440\u043e\u0432\u043d\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432, \u043f\u043e\u0442\u043e\u043a\u043e\u0432 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0438 \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 \u0434\u0430\u043d\u043d\u044b\u0445. \u0417\u0434\u0435\u0441\u044c \u043d\u0435 \u0440\u0430\u0441\u0441\u043c\u0430\u0442\u0440\u0438\u0432\u0430\u044e\u0442\u0441\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u0435 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438, API \u0438\u043b\u0438 \u043f\u0440\u0438\u043c\u0435\u0440\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u2014 \u0444\u043e\u043a\u0443\u0441 \u0441\u0434\u0435\u043b\u0430\u043d \u0438\u0441\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043d\u0430 \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0435\u043c \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0435 \u0438 \u0438\u043d\u0436\u0435\u043d\u0435\u0440\u043d\u044b\u0445 \u0440\u0435\u0448\u0435\u043d\u0438\u044f\u0445.</p> <p>QTasks \u0441\u043f\u0440\u043e\u0435\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d \u043a\u0430\u043a \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043d\u044b\u0439 task\u2011framework, \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u043a\u0430\u0436\u0434\u044b\u0439 \u044d\u043b\u0435\u043c\u0435\u043d\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442 \u0441\u0442\u0440\u043e\u0433\u043e \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u043d\u0443\u044e \u0440\u043e\u043b\u044c \u0438 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0443\u0435\u0442 \u0441 \u0434\u0440\u0443\u0433\u0438\u043c\u0438 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u0430\u043c\u0438 \u0447\u0435\u0440\u0435\u0437 \u0444\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u044b \u0434\u0430\u043d\u043d\u044b\u0445. \u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430 \u043e\u0440\u0438\u0435\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0430 \u043d\u0430 \u0440\u0430\u0441\u0448\u0438\u0440\u044f\u0435\u043c\u043e\u0441\u0442\u044c, \u043f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0443\u0435\u043c\u043e\u0441\u0442\u044c \u043f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u044f \u0438 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u0437\u0430\u043c\u0435\u043d\u044b \u043b\u044e\u0431\u043e\u0433\u043e \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430 \u0431\u0435\u0437 \u043f\u0435\u0440\u0435\u043f\u0438\u0441\u044b\u0432\u0430\u043d\u0438\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0446\u0435\u043b\u0438\u043a\u043e\u043c.</p>"},{"location":"ru/architecture/#_1","title":"\u0414\u043b\u044f \u043a\u043e\u0433\u043e \u043f\u0440\u0435\u0434\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d \u044d\u0442\u043e\u0442 \u0440\u0430\u0437\u0434\u0435\u043b","text":"<p>\u0420\u0430\u0437\u0434\u0435\u043b \u00ab\u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430\u00bb \u043e\u0440\u0438\u0435\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d \u043d\u0430 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u043e\u0432, \u043a\u043e\u0442\u043e\u0440\u044b\u0435:</p> <ul> <li>\u0432\u0441\u0442\u0440\u0430\u0438\u0432\u0430\u044e\u0442 QTasks \u0432 \u0441\u043b\u043e\u0436\u043d\u044b\u0435 \u043f\u0440\u043e\u0435\u043a\u0442\u044b;</li> <li>\u0440\u0430\u0437\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u044e\u0442 \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b \u0438\u043b\u0438 \u043f\u043b\u0430\u0433\u0438\u043d\u044b;</li> <li>\u0430\u043d\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u044e\u0442 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0438 \u043f\u043e\u0442\u043e\u043a\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f;</li> <li>\u043f\u0440\u0438\u043d\u0438\u043c\u0430\u044e\u0442 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u044b\u0435 \u0440\u0435\u0448\u0435\u043d\u0438\u044f \u043d\u0430 \u0443\u0440\u043e\u0432\u043d\u0435 \u0441\u0438\u0441\u0442\u0435\u043c\u044b.</li> </ul> <p>\u041f\u043e\u043d\u0438\u043c\u0430\u043d\u0438\u0435 \u044d\u0442\u043e\u0433\u043e \u0440\u0430\u0437\u0434\u0435\u043b\u0430 \u043d\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u043c \u0434\u043b\u044f \u043f\u043e\u0432\u0441\u0435\u0434\u043d\u0435\u0432\u043d\u043e\u0433\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f QTasks, \u043d\u043e \u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0441\u044f \u043a\u0440\u0438\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0432\u0430\u0436\u043d\u044b\u043c \u043f\u0440\u0438 \u0433\u043b\u0443\u0431\u043e\u043a\u043e\u0439 \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438 \u0438 \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u0438 \u0444\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a\u0430.</p>"},{"location":"ru/architecture/#_2","title":"\u0411\u0430\u0437\u043e\u0432\u0430\u044f \u0444\u0438\u043b\u043e\u0441\u043e\u0444\u0438\u044f \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u044b","text":"<p>\u0412 \u043e\u0441\u043d\u043e\u0432\u0435 QTasks \u043b\u0435\u0436\u0438\u0442 \u043f\u0440\u0438\u043d\u0446\u0438\u043f \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u0438\u0437\u043c\u0430 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432. \u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 \u0440\u0435\u0430\u043b\u0438\u0437\u0443\u0435\u0442 \u0442\u043e\u043b\u044c\u043a\u043e \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u0443\u044e \u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0441\u0442\u044c \u0438 \u043d\u0435 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u043b\u043e\u0433\u0438\u043a\u0438, \u043e\u0442\u043d\u043e\u0441\u044f\u0449\u0435\u0439\u0441\u044f \u043a \u0434\u0440\u0443\u0433\u0438\u043c \u0443\u0440\u043e\u0432\u043d\u044f\u043c \u0441\u0438\u0441\u0442\u0435\u043c\u044b. \u0417\u0430 \u0441\u0447\u0451\u0442 \u044d\u0442\u043e\u0433\u043e \u0434\u043e\u0441\u0442\u0438\u0433\u0430\u0435\u0442\u0441\u044f:</p> <ul> <li>\u0441\u043b\u0430\u0431\u0430\u044f \u0441\u0432\u044f\u0437\u043d\u043e\u0441\u0442\u044c \u043c\u0435\u0436\u0434\u0443 \u0447\u0430\u0441\u0442\u044f\u043c\u0438 \u0441\u0438\u0441\u0442\u0435\u043c\u044b;</li> <li>\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u043d\u0435\u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0439 \u0437\u0430\u043c\u0435\u043d\u044b \u0431\u0440\u043e\u043a\u0435\u0440\u0430, \u0432\u043e\u0440\u043a\u0435\u0440\u0430, \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0430 \u0438 \u0432\u0441\u043f\u043e\u043c\u043e\u0433\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0445 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432;</li> <li>\u043f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0443\u0435\u043c\u044b\u0439 \u0436\u0438\u0437\u043d\u0435\u043d\u043d\u044b\u0439 \u0446\u0438\u043a\u043b \u0437\u0430\u0434\u0430\u0447;</li> <li>\u0443\u043f\u0440\u043e\u0449\u0451\u043d\u043d\u043e\u0435 \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0438 \u043e\u0442\u043b\u0430\u0434\u043a\u0430.</li> </ul> <p>\u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430 \u043d\u0435 \u0441\u0442\u0440\u043e\u0438\u0442\u0441\u044f \u0432\u043e\u043a\u0440\u0443\u0433 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u0442\u0440\u0430\u043d\u0441\u043f\u043e\u0440\u0442\u0430, \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0430 \u0438\u043b\u0438 \u0441\u043f\u043e\u0441\u043e\u0431\u0430 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f. \u042d\u0442\u0438 \u0434\u0435\u0442\u0430\u043b\u0438 \u0432\u044b\u043d\u0435\u0441\u0435\u043d\u044b \u0437\u0430 \u043f\u0440\u0435\u0434\u0435\u043b\u044b \u044f\u0434\u0440\u0430 \u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u044e\u0442\u0441\u044f \u0447\u0435\u0440\u0435\u0437 \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0430\u0431\u0441\u0442\u0440\u0430\u043a\u0442\u043d\u044b\u0445 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u043e\u0432.</p>"},{"location":"ru/architecture/#_3","title":"\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043d\u0430\u044f \u043c\u043e\u0434\u0435\u043b\u044c","text":"<p>QTasks \u0441\u043e\u0441\u0442\u043e\u0438\u0442 \u0438\u0437 \u043d\u0430\u0431\u043e\u0440\u0430 \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438 \u043d\u0435\u0437\u0430\u0432\u0438\u0441\u0438\u043c\u044b\u0445 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043e\u0431\u0440\u0430\u0437\u0443\u044e\u0442 \u043a\u043e\u043d\u0432\u0435\u0439\u0435\u0440 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0437\u0430\u0434\u0430\u0447. \u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b \u043d\u0435 \u0432\u044b\u0437\u044b\u0432\u0430\u044e\u0442 \u0434\u0440\u0443\u0433 \u0434\u0440\u0443\u0433\u0430 \u043d\u0430\u043f\u0440\u044f\u043c\u0443\u044e \u0438 \u043d\u0435 \u043e\u0431\u043c\u0435\u043d\u0438\u0432\u0430\u044e\u0442\u0441\u044f \u0431\u0438\u0437\u043d\u0435\u0441\u2011\u043e\u0431\u044a\u0435\u043a\u0442\u0430\u043c\u0438. \u0412\u0441\u0435 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u044f\u0442 \u0447\u0435\u0440\u0435\u0437 \u0441\u0445\u0435\u043c\u044b \u0434\u0430\u043d\u043d\u044b\u0445 \u0438 \u0447\u0451\u0442\u043a\u043e \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0451\u043d\u043d\u044b\u0435 \u0442\u043e\u0447\u043a\u0438 \u0432\u0445\u043e\u0434\u0430.</p> <p>\u0422\u0430\u043a\u043e\u0439 \u043f\u043e\u0434\u0445\u043e\u0434 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0440\u0430\u0441\u0441\u043c\u0430\u0442\u0440\u0438\u0432\u0430\u0442\u044c \u0441\u0438\u0441\u0442\u0435\u043c\u0443 \u043a\u0430\u043a \u043d\u0430\u0431\u043e\u0440 \u0438\u0437\u043e\u043b\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u0443\u0437\u043b\u043e\u0432, \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u0442\u043e\u043a\u0430\u043c\u0438 \u0434\u0430\u043d\u043d\u044b\u0445, \u0430 \u043d\u0435 \u043a\u0430\u043a \u043c\u043e\u043d\u043e\u043b\u0438\u0442\u043d\u044b\u0439 \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u0441 \u0440\u0430\u0437\u0434\u0435\u043b\u044f\u0435\u043c\u044b\u043c \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435\u043c.</p>"},{"location":"ru/architecture/#_4","title":"\u041f\u043e\u0442\u043e\u043a\u0438 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0438 \u0434\u0430\u043d\u043d\u044b\u0445","text":"<p>\u0412 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0435 QTasks \u0440\u0430\u0437\u043b\u0438\u0447\u0430\u044e\u0442\u0441\u044f \u0434\u0432\u0430 \u0442\u0438\u043f\u0430 \u043f\u043e\u0442\u043e\u043a\u043e\u0432:</p> <ul> <li>\u043f\u043e\u0442\u043e\u043a \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u2014 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442 \u043f\u043e\u0440\u044f\u0434\u043e\u043a \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u044d\u0442\u0430\u043f\u043e\u0432 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0437\u0430\u0434\u0430\u0447\u0438;</li> <li>\u043f\u043e\u0442\u043e\u043a \u0434\u0430\u043d\u043d\u044b\u0445 \u2014 \u043e\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442, \u043a\u0430\u043a\u0438\u0435 \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u0435\u0440\u0435\u0434\u0430\u044e\u0442\u0441\u044f \u043c\u0435\u0436\u0434\u0443 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430\u043c\u0438 \u0438 \u0432 \u043a\u0430\u043a\u043e\u043c \u0432\u0438\u0434\u0435.</li> </ul> <p>\u0417\u0430\u0434\u0430\u0447\u0430 \u043d\u0430 \u043a\u0430\u0436\u0434\u043e\u043c \u044d\u0442\u0430\u043f\u0435 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0430 \u043d\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0435\u0439 \u0438 \u043d\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u043c Python, \u0430 \u0441\u0445\u0435\u043c\u043e\u0439 \u0434\u0430\u043d\u043d\u044b\u0445, \u043f\u0440\u0438\u0433\u043e\u0434\u043d\u043e\u0439 \u0434\u043b\u044f \u0441\u0435\u0440\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438, \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f, \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0438 \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 \u043c\u0435\u0436\u0434\u0443 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430\u043c\u0438 \u0438\u043b\u0438 \u0443\u0437\u043b\u0430\u043c\u0438.</p> <p>\u0410\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e\u0441\u0442\u044c \u0438 \u043f\u0430\u0440\u0430\u043b\u043b\u0435\u043b\u0438\u0437\u043c \u0440\u0430\u0441\u0441\u043c\u0430\u0442\u0440\u0438\u0432\u0430\u044e\u0442\u0441\u044f \u043a\u0430\u043a \u0441\u0432\u043e\u0439\u0441\u0442\u0432\u0430 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u0445 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432 \u0438 \u0438\u0445 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f, \u0430 \u043d\u0435 \u043a\u0430\u043a \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0432\u0441\u0435\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b.</p>"},{"location":"ru/architecture/#_5","title":"\u0413\u0440\u0430\u043d\u0438\u0446\u044b \u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0441\u0442\u0438","text":"<p>\u041a\u0430\u0436\u0434\u044b\u0439 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 QTasks \u0438\u043c\u0435\u0435\u0442 \u0447\u0451\u0442\u043a\u043e \u043e\u0447\u0435\u0440\u0447\u0435\u043d\u043d\u0443\u044e \u0437\u043e\u043d\u0443 \u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0441\u0442\u0438. \u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b \u043d\u0435 \u0437\u043d\u0430\u044e\u0442 \u043e \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0445 \u0434\u0435\u0442\u0430\u043b\u044f\u0445 \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0434\u0440\u0443\u0433 \u0434\u0440\u0443\u0433\u0430 \u0438 \u043e\u043f\u0438\u0440\u0430\u044e\u0442\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u043d\u0430 \u043f\u0443\u0431\u043b\u0438\u0447\u043d\u044b\u0435 \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u044b.</p> <p>\u042d\u0442\u043e \u043f\u0440\u0430\u0432\u0438\u043b\u043e \u043d\u0430\u043c\u0435\u0440\u0435\u043d\u043d\u043e \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u0432\u0430\u0435\u0442 \u00ab\u0443\u043c\u00bb \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432, \u043d\u043e \u0434\u0435\u043b\u0430\u0435\u0442 \u0441\u0438\u0441\u0442\u0435\u043c\u0443 \u0443\u0441\u0442\u043e\u0439\u0447\u0438\u0432\u043e\u0439 \u043a \u0440\u043e\u0441\u0442\u0443 \u0441\u043b\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u0438 \u043f\u043e\u044f\u0432\u043b\u0435\u043d\u0438\u044e \u043d\u043e\u0432\u044b\u0445 \u0441\u0446\u0435\u043d\u0430\u0440\u0438\u0435\u0432 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f.</p>"},{"location":"ru/architecture/#_6","title":"\u0420\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u0435 \u0431\u0435\u0437 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u043e\u0432","text":"<p>\u0412 QTasks \u043d\u0435\u0442 \u00ab\u044f\u0434\u0440\u0430\u00bb \u043a\u0430\u043a \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u043e\u0433\u043e \u043c\u043e\u043d\u043e\u043b\u0438\u0442\u0430, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043d\u0443\u0436\u043d\u043e \u0440\u0430\u0441\u0448\u0438\u0440\u044f\u0442\u044c. \u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u0441\u043e\u0441\u0442\u043e\u0438\u0442 \u0438\u0437 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432, \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u0430\u043c\u0438 \u2014 \u0430\u0431\u0441\u0442\u0440\u0430\u043a\u0442\u043d\u044b\u043c\u0438 \u043a\u043b\u0430\u0441\u0441\u0430\u043c\u0438 \u0438 \u0441\u0445\u0435\u043c\u0430\u043c\u0438 \u0434\u0430\u043d\u043d\u044b\u0445.</p> <p>\u0420\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u0435 \u0434\u043e\u0441\u0442\u0438\u0433\u0430\u0435\u0442\u0441\u044f \u0434\u0432\u0443\u043c\u044f \u0431\u0430\u0437\u043e\u0432\u044b\u043c\u0438 \u043f\u0443\u0442\u044f\u043c\u0438:</p> <ul> <li>\u0437\u0430\u043c\u0435\u043d\u0430 \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430 \u043f\u0440\u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0438 \u0435\u0433\u043e \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u0430 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u0438\u043d\u043e\u0439 \u0442\u0440\u0430\u043d\u0441\u043f\u043e\u0440\u0442, \u0438\u043d\u0430\u044f \u043c\u043e\u0434\u0435\u043b\u044c \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f, \u0438\u043d\u043e\u0439 \u0438\u0441\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c);</li> <li>\u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043d\u043e\u0432\u044b\u0445 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432 \u0438\u043b\u0438 \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c\u043e\u0432 \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u044f, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u044e\u0442\u0441\u044f \u043a \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u043c \u043f\u043e\u0442\u043e\u043a\u0430\u043c, \u043d\u0435 \u043b\u043e\u043c\u0430\u044f \u0443\u0436\u0435 \u0437\u0430\u0434\u0430\u043d\u043d\u044b\u0435 \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u044b.</li> </ul> <p>\u041a\u043b\u044e\u0447\u0435\u0432\u043e\u0439 \u043f\u0440\u0438\u043d\u0446\u0438\u043f \u0437\u0434\u0435\u0441\u044c \u2014 \u044d\u0432\u043e\u043b\u044e\u0446\u0438\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0447\u0435\u0440\u0435\u0437 \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u044b: \u043f\u043e\u043a\u0430 \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442 \u0441\u0442\u0430\u0431\u0438\u043b\u0435\u043d, \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u043e\u0441\u0442\u0438 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430 \u043c\u043e\u0436\u043d\u043e \u043c\u0435\u043d\u044f\u0442\u044c \u0441\u0432\u043e\u0431\u043e\u0434\u043d\u043e, \u0430 \u044d\u043a\u043e\u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u0432\u043e\u043a\u0440\u0443\u0433 \u043e\u0441\u0442\u0430\u0451\u0442\u0441\u044f \u0441\u043e\u0432\u043c\u0435\u0441\u0442\u0438\u043c\u043e\u0439.</p>"},{"location":"ru/architecture/configuration/#single-configuration-schema","title":"Single configuration schema","text":"<p>All QTasks configuration is stored in a single dataclass schema \u2014 <code>QueueConfig</code>.</p> <p>A configuration instance:</p> <ul> <li>is created by default when <code>QueueTasks</code> is initialized;</li> <li>is accessible as <code>app.config</code>;</li> <li>is passed to all components when they are created as the <code>config=config</code> parameter;</li> <li>is saved by components as <code>self.config</code>.</li> </ul> <p>If a component does not receive the configuration explicitly, it must create its own <code>QueueConfig</code> instance. This allows components to be used in isolation, without depending on the global state of the application.</p>"},{"location":"ru/architecture/configuration/#loading-configuration-from-environment-variables","title":"Loading configuration from environment variables","text":"<p><code>QueueConfig</code> supports automatic initialization of parameters from environment variables (<code>os.environ</code>).</p> <p>Loading is performed at the <code>__post_init__</code> stage of the <code>QueueConfig</code> dataclass schema, i.e. immediately after creating a configuration instance, but before passing it to components.</p> <p>This allows you to:</p> <ul> <li>configure QTasks without changing the code;</li> <li>use the 12-factor approach;</li> <li>safely pass settings through the environment (Docker, CI/CD, systemd);</li> <li>override default values at the application launch level.</li> </ul>"},{"location":"ru/architecture/configuration/#how-it-works","title":"How it works","text":"<p>During the execution of <code>__post_init__</code>:</p> <ol> <li><code>QueueConfig</code> reads values from <code>os.environ</code>;</li> <li>matches them with known configuration fields;</li> <li>if a value is found, it overrides the corresponding field;</li> <li>the change goes through the standard <code>setattr</code> mechanism.</li> </ol> <p>Since the override is performed through the usual setting of attributes:</p> <ul> <li>changes participate in the subscription mechanism;</li> <li>subscribers receive notifications;</li> <li>components automatically receive the current values.</li> </ul> <p>Thus, environment variables are the primary source of values relative to default values, but do not violate the architectural contract of the configuration.</p>"},{"location":"ru/architecture/configuration/#architectural-guarantees","title":"Architectural guarantees","text":"<ul> <li>Loading from <code>os.environ</code> occurs once, during configuration initialization.</li> <li>Values become part of <code>QueueConfig</code>, not external state.</li> <li>Further parameter changes work through the standard subscription mechanism.</li> <li>Components do not read <code>os.environ</code> directly.</li> </ul> <p>This preserves a key invariant of the system: components depend only on configuration, not on the execution environment.</p>"},{"location":"ru/architecture/configuration/#practical-use-cases","title":"Practical use cases","text":"<ul> <li>configuring the broker and storage via environment variables;</li> <li>managing logging levels;</li> <li>enabling and disabling debug modes;</li> <li>using different configurations for <code>dev / stage / prod</code>;</li> <li>running multiple instances of QTasks with different parameters in the same environment.</li> </ul>"},{"location":"ru/architecture/configuration/#configuration-as-an-architectural-contract","title":"Configuration as an architectural contract","text":"<p><code>QueueConfig</code> is not just a set of parameters, but part of the architectural contract between components.</p> <p>Through configuration:</p> <ul> <li>component behavior parameters are set;</li> <li>consistency of settings between them is ensured;</li> <li>centralized updating of critical parameters is implemented.</li> </ul> <p>Components do not synchronize their settings directly with each other \u2014 they rely exclusively on configuration.</p>"},{"location":"ru/architecture/configuration/#change-subscription-mechanism","title":"Change subscription mechanism","text":"<p>One of the key features of <code>QueueConfig</code> is support for subscribing to parameter changes.</p> <p>Two mechanisms are used for this:</p> <ul> <li><code>subscribe</code> \u2014 registration of change handlers;</li> <li><code>_notify</code> \u2014 notification of subscribers when a value changes.</li> </ul> <p>Notification occurs automatically when an attribute is changed via <code>setattr</code>.</p>"},{"location":"ru/architecture/configuration/#the-subscribe-function","title":"The subscribe function","text":"<p><code>subscribe</code> allows you to subscribe to changes in both existing and dynamically added configuration parameters.</p> <p>The subscriber receives the following arguments:</p> <ul> <li><code>config: QueueConfig</code> \u2014 configuration instance;</li> <li><code>key</code> \u2014 name of the changed parameter;</li> <li><code>value</code> \u2014 new parameter value.</li> </ul> <p>This allows a component or subsystem to respond to configuration changes without polling the state.</p>"},{"location":"ru/architecture/configuration/#automatic-propagation-of-changes","title":"Automatic propagation of changes","text":"<p>By default, the subscription to configuration changes is registered in <code>QueueTasks.__init__</code>.</p> <p>It is bound to an internal method:</p> <pre><code>self._update_configs()\n</code></pre> <p>This method is responsible for synchronizing critical parameters between components.</p> <p>At the time of writing, it is used, in particular, to update component loggers:</p> <pre><code>component.log.update_logger(**kwargs)\n</code></pre> <p>Thus, a configuration change leads to an immediate update of the state of components without restarting them.</p>"},{"location":"ru/architecture/configuration/#dynamic-configuration-parameters","title":"Dynamic configuration parameters","text":"<p>The <code>QueueConfig</code> architecture allows parameters to be added during runtime.</p> <p>Such parameters:</p> <ul> <li>become part of the overall configuration;</li> <li>participate in the subscription mechanism;</li> <li>can be used by both components and plugins.</li> </ul> <p>This allows you to extend the configuration without changing the basic schema and without violating component compatibility.</p>"},{"location":"ru/architecture/configuration/#boundaries-of-responsibility","title":"Boundaries of Responsibility","text":"<ul> <li><code>QueueConfig</code> is responsible for storing and distributing parameters;</li> <li>components are responsible for responding to changes, not for coordinating them;</li> <li>the configuration does not contain task execution logic.</li> </ul> <p>This separation makes the configuration system predictable, extensible, and safe for complex scenarios.</p>"},{"location":"ru/architecture/configuration/#architectural-invariants","title":"Architectural Invariants","text":"<ul> <li>There is a single source of configuration in the system;</li> <li>Configuration is typed and serializable;</li> <li>Parameter changes are propagated automatically;</li> <li>Components do not depend on the global state.</li> </ul> <p>This configuration model allows QTasks to remain consistent even with dynamic changes during operation.</p>"},{"location":"ru/architecture/extensibility/","title":"\u0420\u0430\u0441\u0448\u0438\u0440\u044f\u0435\u043c\u043e\u0441\u0442\u044c","text":"<p>\u042d\u0442\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043e\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u044b\u0439 \u043f\u043e\u0434\u0445\u043e\u0434 QTasks \u043a \u0440\u0430\u0441\u0448\u0438\u0440\u044f\u0435\u043c\u043e\u0441\u0442\u0438: \u0437\u0430 \u0441\u0447\u0451\u0442 \u043a\u0430\u043a\u0438\u0445 \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c\u043e\u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u0430\u0434\u0430\u043f\u0442\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u043f\u043e\u0434 \u043d\u043e\u0432\u044b\u0435 \u0441\u0446\u0435\u043d\u0430\u0440\u0438\u0438, \u043c\u0430\u0441\u0448\u0442\u0430\u0431\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0438 \u0438\u043d\u0442\u0435\u0433\u0440\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0441 \u0432\u043d\u0435\u0448\u043d\u0438\u043c\u0438 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0430\u043c\u0438 \u0438 \u0444\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a\u0430\u043c\u0438.</p> <p>\u0420\u0430\u0441\u0448\u0438\u0440\u044f\u0435\u043c\u043e\u0441\u0442\u044c \u0432 QTasks \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442\u0441\u044f \u043d\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e\u043c \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043a, \u0430 \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u043e\u0439 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u044b: \u043d\u0430\u0431\u043e\u0440\u043e\u043c \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432, \u0438\u0445 \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u0430\u043c\u0438 \u0438 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c\u044e \u0432\u043d\u0435\u0434\u0440\u0435\u043d\u0438\u044f \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0433\u043e \u043f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u044f \u0447\u0435\u0440\u0435\u0437 \u043f\u043b\u0430\u0433\u0438\u043d\u044b.</p>"},{"location":"ru/architecture/extensibility/#_2","title":"\u0411\u0430\u0437\u043e\u0432\u044b\u0439 \u043f\u0440\u0438\u043d\u0446\u0438\u043f \u0440\u0430\u0441\u0448\u0438\u0440\u044f\u0435\u043c\u043e\u0441\u0442\u0438","text":"<p>QTasks \u0438\u0437\u043d\u0430\u0447\u0430\u043b\u044c\u043d\u043e \u0441\u043f\u0440\u043e\u0435\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d \u0442\u0430\u043a, \u0447\u0442\u043e\u0431\u044b \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u0435 \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u043b\u043e \u0447\u0435\u0440\u0435\u0437 \u043a\u043e\u043c\u043f\u043e\u0437\u0438\u0446\u0438\u044e, \u0430 \u043d\u0435 \u0447\u0435\u0440\u0435\u0437 \u043c\u043e\u0434\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044e.</p> <p>\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u0444\u0430\u043a\u0442\u043e\u0440\u044b \u0440\u0430\u0441\u0448\u0438\u0440\u044f\u0435\u043c\u043e\u0441\u0442\u0438:</p> <ul> <li>\u0437\u0430\u043c\u0435\u043d\u0430 \u0438\u043b\u0438 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432;</li> <li>\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432;</li> <li>\u0441\u043e\u0431\u043b\u044e\u0434\u0435\u043d\u0438\u0435 \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u043e\u0432 \u0430\u0431\u0441\u0442\u0440\u0430\u043a\u0442\u043d\u044b\u0445 \u043a\u043b\u0430\u0441\u0441\u043e\u0432;</li> <li>\u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u0447\u0435\u0440\u0435\u0437 \u0441\u0445\u0435\u043c\u044b.</li> </ul> <p>\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0438\u0433\u0440\u0430\u044e\u0442 \u0432\u0442\u043e\u0440\u0438\u0447\u043d\u0443\u044e \u0440\u043e\u043b\u044c \u0438 \u043d\u0435 \u044f\u0432\u043b\u044f\u044e\u0442\u0441\u044f \u043e\u0441\u043d\u043e\u0432\u043d\u044b\u043c \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c\u043e\u043c \u043c\u0430\u0441\u0448\u0442\u0430\u0431\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0438\u043b\u0438 \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438.</p>"},{"location":"ru/architecture/extensibility/#_3","title":"\u041c\u0430\u0441\u0448\u0442\u0430\u0431\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0447\u0435\u0440\u0435\u0437 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b","text":"<p>\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b QTasks \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u043e\u0440\u0438\u0435\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u044b \u043d\u0430 \u0433\u043e\u0440\u0438\u0437\u043e\u043d\u0442\u0430\u043b\u044c\u043d\u043e\u0435 \u043c\u0430\u0441\u0448\u0442\u0430\u0431\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435.</p> <p>\u042d\u0442\u043e \u043e\u0437\u043d\u0430\u0447\u0430\u0435\u0442, \u0447\u0442\u043e \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u043f\u0440\u0435\u0434\u043f\u043e\u043b\u0430\u0433\u0430\u0435\u0442:</p> <ul> <li>\u0434\u0443\u0431\u043b\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0441\u0435\u0440\u0432\u0435\u0440\u043d\u044b\u0445 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u043e\u0432 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f;</li> <li>\u0441\u043e\u0432\u043c\u0435\u0441\u0442\u043d\u0443\u044e \u0440\u0430\u0431\u043e\u0442\u0443 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 \u0432\u043e\u0440\u043a\u0435\u0440\u043e\u0432;</li> <li>\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043e\u0431\u0449\u0435\u0433\u043e \u0431\u0440\u043e\u043a\u0435\u0440\u0430 \u0438 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0430.</li> </ul> <p>\u0418\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u043c\u043e\u0434\u0435\u043b\u0438 \u043c\u0430\u0441\u0448\u0442\u0430\u0431\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0434\u043e\u0441\u0442\u0438\u0433\u0430\u0435\u0442\u0441\u044f \u043d\u0435 \u0447\u0435\u0440\u0435\u0437 \u0444\u043b\u0430\u0433\u0438 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438, \u0430 \u0447\u0435\u0440\u0435\u0437:</p> <ul> <li>\u0437\u0430\u043c\u0435\u043d\u0443 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u0445 \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0439 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432;</li> <li>\u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0438\u0445 \u043f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u044f \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432;</li> <li>\u0432\u043d\u0435\u0434\u0440\u0435\u043d\u0438\u0435 \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0445 \u0441\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u0439 \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438.</li> </ul> <p>\u0422\u0430\u043a\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c, \u043c\u0430\u0441\u0448\u0442\u0430\u0431\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0441\u044f \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u044b\u043c \u0440\u0435\u0448\u0435\u043d\u0438\u0435\u043c, \u0430 \u043d\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u043e\u0439.</p>"},{"location":"ru/architecture/extensibility/#_4","title":"\u041f\u043b\u0430\u0433\u0438\u043d\u044b \u043a\u0430\u043a \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u044f","text":"<p>\u041f\u043b\u0430\u0433\u0438\u043d\u044b \u0432 QTasks \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f \u0434\u043b\u044f \u0432\u043d\u0435\u0434\u0440\u0435\u043d\u0438\u044f \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0433\u043e \u043f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u044f \u0432 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0435 \u043f\u043e\u0442\u043e\u043a\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f.</p> <p>\u0427\u0435\u0440\u0435\u0437 \u043f\u043b\u0430\u0433\u0438\u043d\u044b \u043c\u043e\u0436\u043d\u043e:</p> <ul> <li>\u043c\u043e\u0434\u0438\u0444\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0436\u0438\u0437\u043d\u0435\u043d\u043d\u044b\u0439 \u0446\u0438\u043a\u043b \u0437\u0430\u0434\u0430\u0447;</li> <li>\u0432\u043d\u0435\u0434\u0440\u044f\u0442\u044c \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435, \u043c\u0435\u0442\u0440\u0438\u043a\u0438 \u0438 \u0442\u0440\u0430\u0441\u0441\u0438\u0440\u043e\u0432\u043a\u0443;</li> <li>\u0438\u0437\u043c\u0435\u043d\u044f\u0442\u044c \u0441\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u044e \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0431\u0435\u0437 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432;</li> <li>\u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0442\u044c \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0435 \u0441\u043b\u043e\u0438.</li> </ul> <p>\u041f\u043b\u0430\u0433\u0438\u043d\u044b \u043d\u0435 \u043d\u0430\u0440\u0443\u0448\u0430\u044e\u0442 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u044b\u0435 \u0438\u043d\u0432\u0430\u0440\u0438\u0430\u043d\u0442\u044b \u0438 \u043d\u0435 \u0442\u0440\u0435\u0431\u0443\u044e\u0442 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u043e\u0432 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432.</p>"},{"location":"ru/architecture/extensibility/#_5","title":"\u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f \u0441 \u0432\u043d\u0435\u0448\u043d\u0438\u043c\u0438 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0430\u043c\u0438","text":"<p>QTasks \u0434\u043e\u043f\u0443\u0441\u043a\u0430\u0435\u0442 \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044e \u0441 \u0432\u043d\u0435\u0448\u043d\u0438\u043c\u0438 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0430\u043c\u0438 \u0438 \u0444\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a\u0430\u043c\u0438 \u0441 \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u043c\u0438 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u044f\u043c\u0438.</p> <p>\u042d\u0442\u043e \u0434\u043e\u0441\u0442\u0438\u0433\u0430\u0435\u0442\u0441\u044f \u0437\u0430 \u0441\u0447\u0451\u0442:</p> <ul> <li>\u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0438\u044f \u0441\u0438\u0433\u043d\u0430\u043b\u043e\u0432 \u0438 \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0445 \u0434\u0438\u0441\u043f\u0435\u0442\u0447\u0435\u0440\u043e\u0432;</li> <li>\u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0445 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445;</li> <li>\u0436\u0451\u0441\u0442\u043a\u043e\u0433\u043e \u0440\u0430\u0437\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0441\u0442\u0438 \u043c\u0435\u0436\u0434\u0443 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430\u043c\u0438;</li> <li>\u043f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u044b\u0445 \u043f\u043e\u0442\u043e\u043a\u043e\u0432 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f;</li> <li>\u044f\u0432\u043d\u043e\u0433\u043e \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0436\u0438\u0437\u043d\u0435\u043d\u043d\u044b\u043c \u0446\u0438\u043a\u043b\u043e\u043c.</li> </ul> <p>\u0412 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0435 QTasks \u043c\u043e\u0436\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u043a\u0430\u043a \u0444\u043e\u043d\u043e\u0432\u0430\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447 \u0432\u043d\u0443\u0442\u0440\u0438 \u0434\u0440\u0443\u0433\u0438\u0445 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439, \u043d\u0435 \u043d\u0430\u0432\u044f\u0437\u044b\u0432\u0430\u044f \u0438\u043c \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u0443\u044e \u043c\u043e\u0434\u0435\u043b\u044c \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f.</p>"},{"location":"ru/architecture/extensibility/#fastapi","title":"\u041f\u0440\u0438\u043c\u0435\u0440 \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438 \u0441 FastAPI","text":"<p>\u041d\u0438\u0436\u0435 \u043f\u0440\u0438\u0432\u0435\u0434\u0451\u043d \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u044b\u0439 \u043f\u0440\u0438\u043c\u0435\u0440 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f QTasks \u0441\u043e\u0432\u043c\u0435\u0441\u0442\u043d\u043e \u0441 FastAPI.</p>"},{"location":"ru/architecture/extensibility/#_6","title":"\u041e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447","text":"<pre><code># tasks.py\nfrom qtasks import AsyncRouter\n\nrouter = AsyncRouter()\n\n@router.task()\nasync def example_task(x: int, y: int) -&gt; int:\n    return x + y\n</code></pre>"},{"location":"ru/architecture/extensibility/#api","title":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447\u0438 \u0432 API","text":"<pre><code># api.py\nfrom fastapi import FastAPI\nfrom .tasks import example_task\n\napp = FastAPI()\n\n@app.get(\"/\")\nasync def read_root():\n    task = await example_task.add_task(1, 2, timeout=50)\n    return {\"result\": task.returning}\n</code></pre>"},{"location":"ru/architecture/extensibility/#qtasks","title":"\u0421\u0435\u0440\u0432\u0435\u0440 QTasks","text":"<pre><code># qtasks_app.py\nfrom qtasks.asyncio import QueueTasks\nfrom .tasks import router as tasks_router\n\napp = QueueTasks()\napp.include_router(tasks_router)\n\nif __name__ == \"__main__\":\n    app.run_forever()\n</code></pre>"},{"location":"ru/architecture/extensibility/#_7","title":"\u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u044b\u0439 \u0440\u0430\u0437\u0431\u043e\u0440 \u043f\u0440\u0438\u043c\u0435\u0440\u0430","text":"<p>\u0412 \u044d\u0442\u043e\u043c \u0441\u0446\u0435\u043d\u0430\u0440\u0438\u0438:</p> <ul> <li>API \u0432\u044b\u0437\u044b\u0432\u0430\u0435\u0442 \u0437\u0430\u0434\u0430\u0447\u0443 \u043d\u0430\u043f\u0440\u044f\u043c\u0443\u044e \u0447\u0435\u0440\u0435\u0437 \u043e\u0431\u044a\u0435\u043a\u0442 \u0437\u0430\u0434\u0430\u0447\u0438, \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u043d\u044b\u0439 \u0438\u0437 \u0440\u043e\u0443\u0442\u0435\u0440\u0430;</li> <li>\u0432\u044b\u0437\u043e\u0432 \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442 \u0447\u0435\u0440\u0435\u0437 \u0431\u0440\u043e\u043a\u0435\u0440 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, Redis), \u0431\u0435\u0437 \u043f\u0440\u044f\u043c\u043e\u0439 \u0441\u0432\u044f\u0437\u0438 \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u043c QTasks;</li> <li>API \u043e\u0436\u0438\u0434\u0430\u0435\u0442 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0447\u0435\u0440\u0435\u0437 <code>AsyncResult</code>, \u0442\u0430\u043a \u043a\u0430\u043a \u0443\u043a\u0430\u0437\u0430\u043d <code>timeout</code>;</li> <li>\u0441\u0435\u0440\u0432\u0435\u0440 QTasks \u043c\u043e\u0436\u0435\u0442 \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u0432 \u0434\u0440\u0443\u0433\u043e\u043c \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0435 \u0438\u043b\u0438 \u043d\u0430 \u0434\u0440\u0443\u0433\u043e\u043c \u0443\u0437\u043b\u0435;</li> <li>\u0441\u0435\u0440\u0432\u0435\u0440 \u0437\u043d\u0430\u0435\u0442 \u043e \u0437\u0430\u0434\u0430\u0447\u0435 \u0431\u043b\u0430\u0433\u043e\u0434\u0430\u0440\u044f <code>include_router</code>, \u0430 \u043d\u0435 \u0437\u0430 \u0441\u0447\u0451\u0442 \u0436\u0451\u0441\u0442\u043a\u043e\u0439 \u0441\u0432\u044f\u0437\u043a\u0438 \u0441 API.</li> </ul> <p>\u041a\u043b\u0438\u0435\u043d\u0442\u0443 \u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0443 \u0432 \u0431\u0440\u043e\u043a\u0435\u0440 \u2014 \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u0430\u044f \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442 \u043d\u0435\u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e.</p>"},{"location":"ru/architecture/extensibility/#_8","title":"\u041e\u0431 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0438 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u043e\u043c \u0438 \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u043c\u0438 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u043c\u0438","text":"<p>\u0412 \u043f\u0440\u0438\u0432\u0435\u0434\u0451\u043d\u043d\u043e\u043c \u043f\u0440\u0438\u043c\u0435\u0440\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u043f\u0440\u044f\u043c\u043e\u0439 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0437\u0430\u0434\u0430\u0447\u0435 \u0447\u0435\u0440\u0435\u0437 \u0440\u043e\u0443\u0442\u0435\u0440.</p> <p>\u0415\u0441\u043b\u0438 \u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u043e\u0442\u043a\u0430\u0437\u0430\u0442\u044c\u0441\u044f \u043e\u0442 \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0445 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445, \u0437\u0430\u0434\u0430\u0447\u0430 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043e\u0431\u044a\u044f\u0432\u043b\u0435\u043d\u0430 \u0447\u0435\u0440\u0435\u0437 <code>@app.task</code>. \u0412 \u044d\u0442\u043e\u043c \u0441\u043b\u0443\u0447\u0430\u0435:</p> <ul> <li>\u0441\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 <code>app</code> \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u0442\u0441\u044f \u0432\u043d\u0443\u0442\u0440\u0438 <code>AsyncTask</code>;</li> <li><code>AsyncResult</code> \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0441\u0432\u044f\u0437\u0430\u043d \u0441 \u043d\u0443\u0436\u043d\u044b\u043c \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u043e\u043c \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f;</li> <li>\u0432\u044b\u0437\u043e\u0432 \u0437\u0430\u0434\u0430\u0447\u0438 \u043e\u0441\u0442\u0430\u0451\u0442\u0441\u044f \u043f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u044b\u043c \u0434\u043b\u044f \u043a\u043b\u0438\u0435\u043d\u0442\u0430.</li> </ul> <p>\u042d\u0442\u043e \u043f\u043e\u0434\u0447\u0451\u0440\u043a\u0438\u0432\u0430\u0435\u0442, \u0447\u0442\u043e \u0432\u044b\u0431\u043e\u0440 \u043c\u043e\u0434\u0435\u043b\u0438 \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438 \u2014 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u043e\u0435 \u0440\u0435\u0448\u0435\u043d\u0438\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f, \u0430 \u043d\u0435 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 QTasks.</p>"},{"location":"ru/architecture/extensibility/#_9","title":"\u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u044b\u0435 \u0438\u043d\u0432\u0430\u0440\u0438\u0430\u043d\u0442\u044b","text":"<ul> <li>\u0440\u0430\u0441\u0448\u0438\u0440\u044f\u0435\u043c\u043e\u0441\u0442\u044c \u0434\u043e\u0441\u0442\u0438\u0433\u0430\u0435\u0442\u0441\u044f \u0447\u0435\u0440\u0435\u0437 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b \u0438 \u043f\u043b\u0430\u0433\u0438\u043d\u044b;</li> <li>\u043c\u0430\u0441\u0448\u0442\u0430\u0431\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0441\u043b\u0435\u0434\u0441\u0442\u0432\u0438\u0435\u043c \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u044b, \u0430 \u043d\u0435 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438;</li> <li>QTasks \u043d\u0435 \u043d\u0430\u0432\u044f\u0437\u044b\u0432\u0430\u0435\u0442 \u0432\u043d\u0435\u0448\u043d\u0438\u043c \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f\u043c \u0441\u0432\u043e\u044e \u043c\u043e\u0434\u0435\u043b\u044c \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f;</li> <li>\u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438 \u043d\u0435 \u0442\u0440\u0435\u0431\u0443\u044e\u0442 \u0432\u043c\u0435\u0448\u0430\u0442\u0435\u043b\u044c\u0441\u0442\u0432\u0430 \u0432 \u044f\u0434\u0440\u043e \u0441\u0438\u0441\u0442\u0435\u043c\u044b.</li> </ul> <p>\u0422\u0430\u043a\u0430\u044f \u043c\u043e\u0434\u0435\u043b\u044c \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c QTasks \u043a\u0430\u043a \u043e\u0441\u043d\u043e\u0432\u0443 \u0434\u043b\u044f \u0441\u043b\u043e\u0436\u043d\u044b\u0445 \u0438 \u043d\u0435\u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0445 \u0441\u0446\u0435\u043d\u0430\u0440\u0438\u0435\u0432 \u0431\u0435\u0437 \u043f\u043e\u0442\u0435\u0440\u0438 \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u043c\u043e\u0441\u0442\u0438.</p>"},{"location":"ru/architecture/task_flow/","title":"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447","text":"<p>\u042d\u0442\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043e\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442 \u043f\u043e\u043b\u043d\u044b\u0439 \u0436\u0438\u0437\u043d\u0435\u043d\u043d\u044b\u0439 \u0446\u0438\u043a\u043b \u0437\u0430\u0434\u0430\u0447\u0438 \u0432 QTasks: \u043e\u0442 \u043c\u043e\u043c\u0435\u043d\u0442\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438 \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u043c \u0434\u043e \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043d\u0430 \u0441\u0442\u043e\u0440\u043e\u043d\u0435 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430. \u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0441\u0444\u043e\u043a\u0443\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u043e \u043d\u0430 \u043f\u043e\u0442\u043e\u043a\u0430\u0445 \u0434\u0430\u043d\u043d\u044b\u0445, \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u0430\u0445 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432 \u0438 \u043f\u043e\u0440\u044f\u0434\u043a\u0435 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f, \u0430 \u043d\u0435 \u043d\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u043e\u043c API.</p> <p>\u0412 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u043e\u043f\u043e\u0440\u043d\u043e\u0433\u043e \u043f\u0440\u0438\u043c\u0435\u0440\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u0441 Redis \u0432 \u0440\u043e\u043b\u0438 \u0431\u0440\u043e\u043a\u0435\u0440\u0430 \u0438 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0430.</p>"},{"location":"ru/architecture/task_flow/#_2","title":"\u041e\u0431\u0449\u0430\u044f \u0441\u0445\u0435\u043c\u0430 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432","text":"<pre><code>sequenceDiagram\n    participant Client\n    participant Broker\n    participant Storage\n    participant Worker\n    participant TaskExecutor\n\n    Client-&gt;&gt;Broker: add_task()\n    Broker-&gt;&gt;Storage: add()\n    Broker--&gt;&gt;Client: Task(status=\"new\")\n\n    Broker-&gt;&gt;Broker: lpop(queue)\n    Broker-&gt;&gt;Storage: add_process()\n    Broker-&gt;&gt;Storage: get()\n    Broker-&gt;&gt;Worker: add()\n\n    Worker-&gt;&gt;TaskExecutor: execute()\n    TaskExecutor--&gt;&gt;Worker: result\n\n    Worker-&gt;&gt;Broker: remove_finished_task()\n    Broker-&gt;&gt;Storage: remove_finished_task()</code></pre> <p>\u0414\u0438\u0430\u0433\u0440\u0430\u043c\u043c\u0430 \u043e\u0442\u0440\u0430\u0436\u0430\u0435\u0442 \u0442\u043e\u043b\u044c\u043a\u043e \u0432\u0435\u0440\u0445\u043d\u0435\u0443\u0440\u043e\u0432\u043d\u0435\u0432\u044b\u0439 \u043f\u043e\u0440\u044f\u0434\u043e\u043a \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0439. \u0414\u0435\u0442\u0430\u043b\u0438 \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u044d\u0442\u0430\u043f\u0430 \u0440\u0430\u0441\u043a\u0440\u044b\u0432\u0430\u044e\u0442\u0441\u044f \u043d\u0438\u0436\u0435.</p>"},{"location":"ru/architecture/task_flow/#_3","title":"\u041e\u0442\u043f\u0440\u0430\u0432\u043a\u0430 \u0437\u0430\u0434\u0430\u0447\u0438 \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u043c","text":"<p>\u041d\u0430 \u0441\u0442\u043e\u0440\u043e\u043d\u0435 \u043a\u043b\u0438\u0435\u043d\u0442\u0430 \u0437\u0430\u0434\u0430\u0447\u0430 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 \u0438\u0441\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0432 \u0432\u0438\u0434\u0435 \u0441\u0445\u0435\u043c\u044b \u0434\u0430\u043d\u043d\u044b\u0445 \u0438 \u043d\u0435 \u0441\u0432\u044f\u0437\u0430\u043d\u0430 \u0441 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u043c \u0441\u043f\u043e\u0441\u043e\u0431\u043e\u043c \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f.</p> <ol> <li>\u041a\u043b\u0438\u0435\u043d\u0442 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u0437\u0430\u0434\u0430\u0447\u0443 \u0432 \u0411\u0440\u043e\u043a\u0435\u0440 \u043f\u043e \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u0443 <code>add_task</code>, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0432\u043d\u0443\u0442\u0440\u0438 \u0442\u0440\u0430\u043d\u0441\u043b\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0432 \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442 <code>add</code>.</li> <li>\u0411\u0440\u043e\u043a\u0435\u0440 \u043f\u0435\u0440\u0435\u0434\u0430\u0451\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u0437\u0430\u0434\u0430\u0447\u0438 \u0432 \u0425\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 \u043f\u043e \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u0443 <code>add</code>.</li> <li>\u0425\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 \u0441\u0435\u0440\u0438\u0430\u043b\u0438\u0437\u0443\u0435\u0442 \u0441\u0442\u0430\u0442\u0443\u0441 \u0437\u0430\u0434\u0430\u0447\u0438 \u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u0442 \u0435\u0433\u043e, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 \u0434\u043b\u044f Redis:</li> </ol> <pre><code>hset(\"{storage_name}:{uuid}\", mapping=task_status.__dict__)\n</code></pre> <ol> <li>\u0411\u0440\u043e\u043a\u0435\u0440 \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442 \u0441\u0441\u044b\u043b\u043a\u0443 \u043d\u0430 \u0437\u0430\u0434\u0430\u0447\u0443 \u0432 \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u0443\u044e \u043e\u0447\u0435\u0440\u0435\u0434\u044c:</li> </ol> <pre><code>rpush(queue_name, \"{task_name}:{uuid}:{priority}\")\n</code></pre> <ol> <li>\u0411\u0440\u043e\u043a\u0435\u0440 \u043d\u0435\u043c\u0435\u0434\u043b\u0435\u043d\u043d\u043e \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u043a\u043b\u0438\u0435\u043d\u0442\u0443 \u0441\u0445\u0435\u043c\u0443 <code>Task</code> \u0441\u043e \u0441\u0442\u0430\u0442\u0443\u0441\u043e\u043c <code>new</code>.</li> </ol> <p>\u041d\u0430 \u044d\u0442\u043e\u043c \u044d\u0442\u0430\u043f\u0435 \u0437\u0430\u0434\u0430\u0447\u0430 \u0441\u0447\u0438\u0442\u0430\u0435\u0442\u0441\u044f \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0439, \u043d\u043e \u0435\u0449\u0451 \u043d\u0435 \u0432\u0437\u044f\u0442\u043e\u0439 \u0432 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0443.</p>"},{"location":"ru/architecture/task_flow/#_4","title":"\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447\u0438 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u043c","text":"<p>\u0411\u0440\u043e\u043a\u0435\u0440, \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0449\u0438\u0439 \u0432 \u0441\u0435\u0440\u0432\u0435\u0440\u043d\u043e\u043c \u0440\u0435\u0436\u0438\u043c\u0435, \u043f\u043e\u0441\u0442\u043e\u044f\u043d\u043d\u043e \u043e\u043f\u0440\u0430\u0448\u0438\u0432\u0430\u0435\u0442 \u043e\u0447\u0435\u0440\u0435\u0434\u044c \u0437\u0430\u0434\u0430\u0447.</p> <ol> <li>\u0411\u0440\u043e\u043a\u0435\u0440 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442 <code>lpop(queue_name)</code>.    1.1. \u0415\u0441\u043b\u0438 \u043e\u0447\u0435\u0440\u0435\u0434\u044c \u043f\u0443\u0441\u0442\u0430, \u0411\u0440\u043e\u043a\u0435\u0440 \u043f\u0440\u0438\u043e\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u043d\u0430 <code>default_sleep</code>    \u0441\u0435\u043a\u0443\u043d\u0434 (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e <code>0.01</code>).</li> <li>\u041f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0437\u0430\u0434\u0430\u0447\u0438 \u0411\u0440\u043e\u043a\u0435\u0440 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u044f\u0435\u0442 \u0425\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 \u043e \u043d\u0430\u0447\u0430\u043b\u0435 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u043f\u043e \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u0443 <code>add_process</code>.</li> <li>\u0425\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442 \u0437\u0430\u0434\u0430\u0447\u0443 \u0432 \u043e\u0447\u0435\u0440\u0435\u0434\u044c \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u043c\u044b\u0445 \u0437\u0430\u0434\u0430\u0447, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440:</li> </ol> <pre><code>zadd(queue_process, {task_data: priority})\n</code></pre> <ol> <li>\u0411\u0440\u043e\u043a\u0435\u0440 \u0437\u0430\u043f\u0440\u0430\u0448\u0438\u0432\u0430\u0435\u0442 \u043f\u043e\u043b\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0437\u0430\u0434\u0430\u0447\u0438 \u0443 \u0425\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0430 \u043f\u043e \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u0443 <code>get</code>.</li> <li>\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u0435\u0440\u0435\u0434\u0430\u044e\u0442\u0441\u044f \u0432 \u0412\u043e\u0440\u043a\u0435\u0440 \u043f\u043e \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u0443 <code>add</code>.</li> </ol>"},{"location":"ru/architecture/task_flow/#worker","title":"\u041e\u0447\u0435\u0440\u0435\u0434\u044c \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0432 Worker","text":"<ol> <li>\u0412\u043e\u0440\u043a\u0435\u0440 \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u0443\u0435\u0442 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0432 <code>TaskPrioritySchema</code>.</li> <li>\u0421\u0445\u0435\u043c\u0430 \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0432\u043e \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u044e\u044e \u043e\u0447\u0435\u0440\u0435\u0434\u044c \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f <code>self.queue</code>.</li> <li>\u041d\u0435\u043c\u0435\u0434\u043b\u0435\u043d\u043d\u043e \u0444\u043e\u0440\u043c\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0438 \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442\u0441\u044f \u0441\u0442\u0430\u0442\u0443\u0441 \u0437\u0430\u0434\u0430\u0447\u0438 <code>new</code>.</li> <li>\u0421\u0430\u0431\u0432\u043e\u0440\u043a\u0435\u0440\u044b, \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043d\u044b\u0435 \u0432\u043d\u0443\u0442\u0440\u0438 Worker, \u0441\u043b\u0443\u0448\u0430\u044e\u0442 \u043e\u0434\u043d\u0443 \u043e\u0431\u0449\u0443\u044e \u043e\u0447\u0435\u0440\u0435\u0434\u044c.</li> <li>\u0417\u0430\u0445\u0432\u0430\u0442 \u0437\u0430\u0434\u0430\u0447\u0438 \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442 \u043f\u043e \u043f\u0440\u0438\u043d\u0446\u0438\u043f\u0443 \u00ab\u043a\u0442\u043e \u043f\u0435\u0440\u0432\u044b\u0439 \u0432\u0437\u044f\u043b\u00bb \u0441 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c <code>Condition</code> \u0438 <code>Semaphore(max_tasks_process)</code>.</li> </ol> <p>\u0422\u0430\u043a\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c, \u043f\u0430\u0440\u0430\u043b\u043b\u0435\u043b\u0438\u0437\u043c \u0438 \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e\u0441\u0442\u044c \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u0432\u0430\u044e\u0442\u0441\u044f \u0438 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u0438\u0440\u0443\u044e\u0442\u0441\u044f \u043d\u0430 \u0443\u0440\u043e\u0432\u043d\u0435 Worker.</p>"},{"location":"ru/architecture/task_flow/#_5","title":"\u041f\u0435\u0440\u0435\u0445\u043e\u0434 \u0437\u0430\u0434\u0430\u0447\u0438 \u0432 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f","text":"<ol> <li>\u041f\u0435\u0440\u0435\u0434 \u0444\u0430\u043a\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u043c \u0437\u0430\u043f\u0443\u0441\u043a\u043e\u043c Worker \u0444\u043e\u0440\u043c\u0438\u0440\u0443\u0435\u0442 <code>TaskStatusProcessSchema</code>.</li> <li>\u0421\u0442\u0430\u0442\u0443\u0441 \u043f\u0435\u0440\u0435\u0434\u0430\u0451\u0442\u0441\u044f \u0432 \u0411\u0440\u043e\u043a\u0435\u0440 \u043f\u043e \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u0443 <code>update</code>.</li> <li>\u0411\u0440\u043e\u043a\u0435\u0440 \u0442\u0440\u0430\u043d\u0441\u043b\u0438\u0440\u0443\u0435\u0442 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0432 \u0425\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435:</li> </ol> <pre><code>hset(\"{storage_name}:{uuid}\", mapping=asdict(model))\n</code></pre> <p>\u041d\u0430 \u044d\u0442\u043e\u043c \u044d\u0442\u0430\u043f\u0435 \u0437\u0430\u0434\u0430\u0447\u0430 \u043e\u0444\u0438\u0446\u0438\u0430\u043b\u044c\u043d\u043e \u0441\u0447\u0438\u0442\u0430\u0435\u0442\u0441\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u043c\u043e\u0439.</p>"},{"location":"ru/architecture/task_flow/#_6","title":"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u0437\u0430\u0434\u0430\u0447\u0438","text":"<ol> <li>Worker \u0438\u0437\u0432\u043b\u0435\u043a\u0430\u0435\u0442 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447\u0438 \u0438\u0437 <code>app._tasks</code> \u0432 \u0432\u0438\u0434\u0435 <code>TaskExecSchema</code>.</li> <li>\u042d\u0442\u0430 \u0441\u0445\u0435\u043c\u0430 \u043f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u044f\u0435\u0442\u0441\u044f \u043a \u0434\u0430\u043d\u043d\u044b\u043c \u0437\u0430\u0434\u0430\u0447\u0438.</li> <li>Worker \u043f\u0435\u0440\u0435\u0434\u0430\u0451\u0442 \u0437\u0430\u0434\u0430\u0447\u0443 \u0432 <code>TaskExecutor</code> \u0447\u0435\u0440\u0435\u0437 \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442 <code>execute()</code>.</li> </ol> <p>\u041f\u043e\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0432\u043d\u0443\u0442\u0440\u0438 <code>TaskExecutor</code>:</p> <ul> <li>\u0432\u044b\u0437\u043e\u0432 <code>execute_middlewares_before()</code>;</li> <li>\u0432\u044b\u0437\u043e\u0432 <code>before_execute()</code>;</li> <li>\u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 <code>run_task()</code>;</li> <li>\u043f\u0440\u0438 \u0433\u0435\u043d\u0435\u0440\u0430\u0442\u043e\u0440\u043d\u043e\u0439 \u0437\u0430\u0434\u0430\u0447\u0435 \u2014 \u0434\u0435\u043b\u0435\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0432 <code>run_task_gen()</code>;</li> <li>\u0432\u044b\u0437\u043e\u0432 <code>after_execute()</code>;</li> <li>\u0432\u044b\u0437\u043e\u0432 <code>execute_middlewares_after()</code>;</li> <li>\u043f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u0435 <code>decode()</code> (\u0435\u0441\u043b\u0438 \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u043e, \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u2014 \u0434\u0430).</li> </ul> <p><code>TaskExecutor</code> \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u0432 Worker \u043b\u0438\u0431\u043e \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442, \u043b\u0438\u0431\u043e \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435.</p>"},{"location":"ru/architecture/task_flow/#_7","title":"\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447\u0438","text":"<p>\u0412 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430 Worker \u0444\u043e\u0440\u043c\u0438\u0440\u0443\u0435\u0442 \u043e\u0434\u043d\u0443 \u0438\u0437 \u0444\u0438\u043d\u0430\u043b\u044c\u043d\u044b\u0445 \u0441\u0445\u0435\u043c:</p> <ul> <li><code>TaskStatusSuccessSchema</code>;</li> <li><code>TaskStatusErrorSchema</code>;</li> <li> <p><code>TaskStatusCancelSchema</code>.</p> </li> <li> <p>\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u043f\u0435\u0440\u0435\u0434\u0430\u0451\u0442\u0441\u044f \u0432 <code>remove_finished_task()</code>.</p> </li> <li>Worker \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u0432 \u0411\u0440\u043e\u043a\u0435\u0440 \u043f\u043e \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u0443 <code>remove_finished_task()</code>.</li> <li>\u0411\u0440\u043e\u043a\u0435\u0440 \u043f\u0435\u0440\u0435\u0434\u0430\u0451\u0442 \u0438\u0445 \u0432 \u0425\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435.</li> </ul> <p>\u0425\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442 \u0434\u0432\u0430 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f:</p> <pre><code>hset(\"{storage_name}:{uuid}\", mapping=model.__dict__)\nzrem(queue_process, \"{task_name}:{uuid}:{priority}\")\n</code></pre>"},{"location":"ru/architecture/task_flow/#redis","title":"\u041e\u0447\u0435\u0440\u0435\u0434\u044c \u043a\u043e\u043c\u0430\u043d\u0434 Redis","text":"<p>\u041f\u0440\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0438 Redis \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438 \u0437\u0430\u043f\u0438\u0441\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u044e\u0442\u0441\u044f \u0447\u0435\u0440\u0435\u0437 <code>(A)syncRedisCommandQueue</code>.</p> <ol> <li>\u041a\u043e\u043c\u0430\u043d\u0434\u044b \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u044e\u0442\u0441\u044f \u0432\u043e \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u044e\u044e \u043e\u0447\u0435\u0440\u0435\u0434\u044c \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f.</li> <li>\u0415\u0441\u043b\u0438 \u043e\u0447\u0435\u0440\u0435\u0434\u044c \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u2014 \u043e\u043d\u0430 \u0441\u043e\u0437\u0434\u0430\u0451\u0442\u0441\u044f \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438.</li> <li>\u041e\u0447\u0435\u0440\u0435\u0434\u044c \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f \u043f\u043e\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u043d\u043e.</li> <li>\u041f\u043e\u0441\u043b\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0439 \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u043e\u0447\u0435\u0440\u0435\u0434\u044c \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0437\u0430\u0432\u0435\u0440\u0448\u0430\u0435\u0442\u0441\u044f.</li> </ol> <p>\u042d\u0442\u043e\u0442 \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c \u0441\u043d\u0438\u0436\u0430\u0435\u0442 \u043d\u0430\u043a\u043b\u0430\u0434\u043d\u044b\u0435 \u0440\u0430\u0441\u0445\u043e\u0434\u044b \u0438 \u0443\u043f\u043e\u0440\u044f\u0434\u043e\u0447\u0438\u0432\u0430\u0435\u0442 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438 \u0437\u0430\u043f\u0438\u0441\u0438.</p>"},{"location":"ru/architecture/task_flow/#_8","title":"\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430 \u0437\u0430\u0434\u0430\u0447\u0438","text":"<p>\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447\u0438 \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442 \u0447\u0435\u0440\u0435\u0437 \u0425\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435.</p> <ol> <li>\u041f\u043e \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u0443 <code>get()</code> \u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u0437\u0432\u043b\u0435\u043a\u0430\u044e\u0442\u0441\u044f \u0438 \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u0443\u044e\u0442\u0441\u044f \u0432 <code>Task</code>.</li> <li>\u0415\u0441\u043b\u0438 \u043f\u0440\u0438 <code>add_task()</code> \u0443\u043a\u0430\u0437\u0430\u043d <code>timeout</code>, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f <code>(A)syncResult</code>.</li> <li><code>(A)syncResult</code> \u043f\u0435\u0440\u0438\u043e\u0434\u0438\u0447\u0435\u0441\u043a\u0438 \u0437\u0430\u043f\u0440\u0430\u0448\u0438\u0432\u0430\u0435\u0442 \u0425\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 \u0441 \u0438\u043d\u0442\u0435\u0440\u0432\u0430\u043b\u043e\u043c <code>result_time_interval</code>.</li> <li> <p>\u041e\u0436\u0438\u0434\u0430\u043d\u0438\u0435 \u0440\u0435\u0430\u043b\u0438\u0437\u0443\u0435\u0442\u0441\u044f \u0447\u0435\u0440\u0435\u0437:</p> </li> <li> <p><code>ThreadPoolExecutor(max_workers=1)</code> \u0434\u043b\u044f sync-\u0440\u0435\u0436\u0438\u043c\u0430;</p> </li> <li><code>asyncio.wait_for()</code> \u0434\u043b\u044f async-\u0440\u0435\u0436\u0438\u043c\u0430.</li> <li>\u0415\u0441\u043b\u0438 \u0441\u0442\u0430\u0442\u0443\u0441 \u0437\u0430\u0434\u0430\u0447\u0438 \u043d\u0435 \u0432\u0445\u043e\u0434\u0438\u0442 \u0432 <code>result_statuses_end</code> (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e: <code>SUCCESS</code>, <code>ERROR</code>, <code>CANCEL</code>), \u043e\u0436\u0438\u0434\u0430\u043d\u0438\u0435 \u043f\u0440\u043e\u0434\u043e\u043b\u0436\u0430\u0435\u0442\u0441\u044f.</li> </ol> <p>\u041f\u043e\u0441\u043b\u0435 \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u044f \u043a\u043e\u043d\u0435\u0447\u043d\u043e\u0433\u043e \u0441\u0442\u0430\u0442\u0443\u0441\u0430 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442\u0441\u044f \u043a\u043b\u0438\u0435\u043d\u0442\u0443.</p>"},{"location":"ru/architecture/task_flow/#_9","title":"\u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u044b\u0435 \u0438\u043d\u0432\u0430\u0440\u0438\u0430\u043d\u0442\u044b","text":"<ul> <li>\u0417\u0430\u0434\u0430\u0447\u0430 \u043d\u0430 \u0432\u0441\u0435\u0445 \u044d\u0442\u0430\u043f\u0430\u0445 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0430 \u0441\u0445\u0435\u043c\u0430\u043c\u0438 \u0434\u0430\u043d\u043d\u044b\u0445, \u0430 \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u043d\u044f\u0435\u043c\u044b\u043c\u0438 \u043e\u0431\u044a\u0435\u043a\u0442\u0430\u043c\u0438.</li> <li>\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0443\u044e\u0442 \u0438\u0441\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0447\u0435\u0440\u0435\u0437 \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u044b.</li> <li>\u0411\u0440\u043e\u043a\u0435\u0440 \u043d\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442 \u0437\u0430\u0434\u0430\u0447\u0438 \u0438 \u043d\u0435 \u0437\u043d\u0430\u0435\u0442 \u0438\u0445 \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0435\u0439 \u043b\u043e\u0433\u0438\u043a\u0438.</li> <li>Worker \u043d\u0435 \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435\u043c \u0434\u0430\u043d\u043d\u044b\u0445.</li> <li>\u0425\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 \u043d\u0435 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u043b\u043e\u0433\u0438\u043a\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f.</li> </ul> <p>\u042d\u0442\u0438 \u0438\u043d\u0432\u0430\u0440\u0438\u0430\u043d\u0442\u044b \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u044e\u0442 \u043f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0443\u0435\u043c\u043e\u0441\u0442\u044c \u043f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u044f \u0438 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u0437\u0430\u043c\u0435\u043d\u044b \u043b\u044e\u0431\u043e\u0433\u043e \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430 \u0431\u0435\u0437 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0445.</p>"},{"location":"ru/architecture/components/","title":"\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b: \u043e\u0431\u0449\u0435\u0435","text":"<p>\u042d\u0442\u043e\u0442 \u0440\u0430\u0437\u0434\u0435\u043b \u043e\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043d\u0443\u044e \u043c\u043e\u0434\u0435\u043b\u044c QTasks \u043a\u0430\u043a \u043e\u0441\u043d\u043e\u0432\u0443 \u0432\u0441\u0435\u0439 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u044b \u0444\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a\u0430. \u0417\u0434\u0435\u0441\u044c \u0444\u043e\u0440\u043c\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u043e\u0431\u0449\u0435\u0435 \u043f\u043e\u043d\u0438\u043c\u0430\u043d\u0438\u0435 \u0442\u043e\u0433\u043e, \u0447\u0442\u043e \u0442\u0430\u043a\u043e\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 \u0432 QTasks, \u043a\u0430\u043a\u0438\u0435 \u043f\u0440\u0438\u043d\u0446\u0438\u043f\u044b \u043b\u0435\u0436\u0430\u0442 \u0432 \u043e\u0441\u043d\u043e\u0432\u0435 \u0438\u0445 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u0438 \u043a\u0430\u043a\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c \u043e\u043d\u0438 \u043e\u0431\u0440\u0430\u0437\u0443\u044e\u0442 \u0446\u0435\u043b\u043e\u0441\u0442\u043d\u0443\u044e \u0441\u0438\u0441\u0442\u0435\u043c\u0443.</p> <p>\u0412\u0441\u0435 \u043f\u043e\u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b \u0432\u043a\u043b\u0430\u0434\u043a\u0438 \u00ab\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b\u00bb \u0440\u0430\u0437\u0432\u0438\u0432\u0430\u044e\u0442 \u0438 \u0434\u0435\u0442\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u044e\u0442 \u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u044f, \u043e\u043f\u0438\u0441\u0430\u043d\u043d\u044b\u0435 \u0437\u0434\u0435\u0441\u044c, \u0444\u043e\u043a\u0443\u0441\u0438\u0440\u0443\u044f\u0441\u044c \u043d\u0430 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0445 \u0430\u0441\u043f\u0435\u043a\u0442\u0430\u0445: \u0430\u0431\u0441\u0442\u0440\u0430\u043a\u0442\u043d\u044b\u0445 \u043a\u043b\u0430\u0441\u0441\u0430\u0445, \u0441\u0445\u0435\u043c\u0430\u0445 \u0434\u0430\u043d\u043d\u044b\u0445, \u043f\u043e\u0442\u043e\u043a\u0430\u0445 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f, \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e\u0441\u0442\u0438 \u0438 \u043f\u043b\u0430\u0433\u0438\u043d\u043d\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u0435.</p>"},{"location":"ru/architecture/components/#qtasks","title":"\u0427\u0442\u043e \u0442\u0430\u043a\u043e\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 \u0432 QTasks","text":"<p>\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 \u0432 QTasks \u2014 \u044d\u0442\u043e \u0438\u0437\u043e\u043b\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0439 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u044b\u0439 \u044d\u043b\u0435\u043c\u0435\u043d\u0442, \u0440\u0435\u0430\u043b\u0438\u0437\u0443\u044e\u0449\u0438\u0439 \u0441\u0442\u0440\u043e\u0433\u043e \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0451\u043d\u043d\u0443\u044e \u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0441\u0442\u044c \u0438 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0439 \u0441 \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u043e\u0439 \u0438\u0441\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0447\u0435\u0440\u0435\u0437 \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u044b.</p> <p>\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442:</p> <ul> <li>\u043d\u0435 \u0437\u043d\u0430\u0435\u0442 \u043e \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u0445 \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f\u0445 \u0434\u0440\u0443\u0433\u0438\u0445 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432;</li> <li>\u043d\u0435 \u0445\u0440\u0430\u043d\u0438\u0442 \u0441\u0441\u044b\u043b\u043e\u043a \u043d\u0430 \u0438\u0445 \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0435\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435;</li> <li>\u043d\u0435 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0431\u0438\u0437\u043d\u0435\u0441-\u043b\u043e\u0433\u0438\u043a\u0438, \u0432\u044b\u0445\u043e\u0434\u044f\u0449\u0435\u0439 \u0437\u0430 \u043f\u0440\u0435\u0434\u0435\u043b\u044b \u0441\u0432\u043e\u0435\u0439 \u0437\u043e\u043d\u044b \u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0441\u0442\u0438.</li> </ul> <p>\u0422\u0430\u043a\u043e\u0435 \u0440\u0430\u0437\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0440\u0430\u0441\u0441\u043c\u0430\u0442\u0440\u0438\u0432\u0430\u0442\u044c QTasks \u043d\u0435 \u043a\u0430\u043a \u0435\u0434\u0438\u043d\u044b\u0439 \u043f\u0440\u043e\u0446\u0435\u0441\u0441, \u0430 \u043a\u0430\u043a \u0441\u0438\u0441\u0442\u0435\u043c\u0443 \u0432\u0437\u0430\u0438\u043c\u043e\u0437\u0430\u043c\u0435\u043d\u044f\u0435\u043c\u044b\u0445 \u0443\u0437\u043b\u043e\u0432, \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u0442\u043e\u043a\u0430\u043c\u0438 \u0434\u0430\u043d\u043d\u044b\u0445.</p>"},{"location":"ru/architecture/components/#_2","title":"\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u0438 \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b","text":"<p>\u0412 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0435 QTasks \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b \u0443\u0441\u043b\u043e\u0432\u043d\u043e \u0434\u0435\u043b\u044f\u0442\u0441\u044f \u043d\u0430 \u0434\u0432\u0435 \u0433\u0440\u0443\u043f\u043f\u044b:</p> <ul> <li>\u043e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b \u2014 \u0444\u043e\u0440\u043c\u0438\u0440\u0443\u044e\u0442 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u043a\u043e\u043d\u0432\u0435\u0439\u0435\u0440 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0437\u0430\u0434\u0430\u0447;</li> <li>\u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b \u2014 \u0440\u0430\u0441\u0448\u0438\u0440\u044f\u044e\u0442 \u043f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u0435 \u0441\u0438\u0441\u0442\u0435\u043c\u044b, \u043d\u0435 \u044f\u0432\u043b\u044f\u044f\u0441\u044c \u043a\u0440\u0438\u0442\u0438\u0447\u043d\u044b\u043c\u0438 \u0434\u043b\u044f \u0431\u0430\u0437\u043e\u0432\u043e\u0433\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447.</li> </ul> <p>\u0413\u0440\u0430\u043d\u0438\u0446\u0430 \u043c\u0435\u0436\u0434\u0443 \u044d\u0442\u0438\u043c\u0438 \u0433\u0440\u0443\u043f\u043f\u0430\u043c\u0438 \u043f\u0440\u043e\u0445\u043e\u0434\u0438\u0442 \u043d\u0435 \u043f\u043e \u0443\u0440\u043e\u0432\u043d\u044e \u0432\u0430\u0436\u043d\u043e\u0441\u0442\u0438, \u0430 \u043f\u043e \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u043e\u0439 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438: \u043e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b \u0437\u0430\u0434\u0430\u044e\u0442 \u0438\u043d\u0432\u0430\u0440\u0438\u0430\u043d\u0442\u044b \u0441\u0438\u0441\u0442\u0435\u043c\u044b, \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u2014 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442 \u044d\u0442\u0438 \u0438\u043d\u0432\u0430\u0440\u0438\u0430\u043d\u0442\u044b \u0434\u043b\u044f \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u044f \u0444\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u043e\u0441\u0442\u0438.</p>"},{"location":"ru/architecture/components/#_3","title":"\u041a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u044b \u0438 \u0430\u0431\u0441\u0442\u0440\u0430\u043a\u0446\u0438\u0438","text":"<p>\u0412\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432 \u0441\u0442\u0440\u043e\u0438\u0442\u0441\u044f \u043d\u0430 \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u0430\u0445, \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u043d\u044b\u0445 \u0447\u0435\u0440\u0435\u0437 \u0430\u0431\u0441\u0442\u0440\u0430\u043a\u0442\u043d\u044b\u0435 \u043a\u043b\u0430\u0441\u0441\u044b \u0438 \u0441\u0445\u0435\u043c\u044b \u0434\u0430\u043d\u043d\u044b\u0445.</p> <p>\u041a\u043e\u043d\u0442\u0440\u0430\u043a\u0442 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442:</p> <ul> <li>\u043a\u0430\u043a\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0435\u0442 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442;</li> <li>\u043a\u0430\u043a\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u043e\u043d \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442;</li> <li>\u0432 \u043a\u0430\u043a\u0438\u0445 \u0442\u043e\u0447\u043a\u0430\u0445 \u0434\u043e\u043f\u0443\u0441\u043a\u0430\u0435\u0442\u0441\u044f \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u0435 \u043f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u044f.</li> </ul> <p>\u0420\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0437\u0430\u043c\u0435\u043d\u0435\u043d\u0430 \u0446\u0435\u043b\u0438\u043a\u043e\u043c, \u0435\u0441\u043b\u0438 \u043e\u043d\u0430 \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u0442 \u0441\u043e\u0432\u043c\u0435\u0441\u0442\u0438\u043c\u043e\u0441\u0442\u044c \u0441 \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u043e\u043c. \u042d\u0442\u043e \u043a\u043b\u044e\u0447\u0435\u0432\u043e\u0439 \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c \u044d\u0432\u043e\u043b\u044e\u0446\u0438\u0438 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u044b QTasks.</p>"},{"location":"ru/architecture/components/#_4","title":"\u041f\u0435\u0440\u0435\u0434\u0430\u0447\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u043c\u0435\u0436\u0434\u0443 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430\u043c\u0438","text":"<p>\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b QTasks \u043d\u0435 \u043e\u0431\u043c\u0435\u043d\u0438\u0432\u0430\u044e\u0442\u0441\u044f \u043e\u0431\u044a\u0435\u043a\u0442\u0430\u043c\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0438\u043b\u0438 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435\u043c Python-\u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430. \u0412\u0441\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u0435\u0440\u0435\u0434\u0430\u044e\u0442\u0441\u044f \u0432 \u0432\u0438\u0434\u0435 \u0441\u0445\u0435\u043c \u2014 \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445, \u0441\u0435\u0440\u0438\u0430\u043b\u0438\u0437\u0443\u0435\u043c\u044b\u0445 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u0439 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447\u0438 \u0438 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0430 \u0435\u0451 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438.</p> <p>\u0422\u0430\u043a\u043e\u0439 \u043f\u043e\u0434\u0445\u043e\u0434 \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442:</p> <ul> <li>\u043f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u043e\u0441\u0442\u044c \u043f\u043e\u0442\u043e\u043a\u043e\u0432 \u0434\u0430\u043d\u043d\u044b\u0445;</li> <li>\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0438 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f;</li> <li>\u043d\u0435\u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u044c \u043e\u0442 \u0441\u0440\u0435\u0434\u044b \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f;</li> <li>\u0443\u043f\u0440\u043e\u0449\u0451\u043d\u043d\u0443\u044e \u043e\u0442\u043b\u0430\u0434\u043a\u0443 \u0438 \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435.</li> </ul>"},{"location":"ru/architecture/components/#_5","title":"\u041f\u043e\u0442\u043e\u043a\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0438 \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e\u0441\u0442\u044c","text":"<p>\u0410\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e\u0441\u0442\u044c \u0438 \u043f\u0430\u0440\u0430\u043b\u043b\u0435\u043b\u0438\u0437\u043c \u0432 QTasks \u043d\u0435 \u044f\u0432\u043b\u044f\u044e\u0442\u0441\u044f \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u043c \u0441\u0432\u043e\u0439\u0441\u0442\u0432\u043e\u043c \u0441\u0438\u0441\u0442\u0435\u043c\u044b. \u041e\u043d\u0438 \u043b\u043e\u043a\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u044b \u0432\u043d\u0443\u0442\u0440\u0438 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u0445 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432 \u0438 \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u044e\u0442\u0441\u044f \u0438\u043c\u0438 \u0441\u0430\u043c\u043e\u0441\u0442\u043e\u044f\u0442\u0435\u043b\u044c\u043d\u043e.</p> <p>\u041a\u0430\u0436\u0434\u044b\u0439 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442:</p> <ul> <li>\u0441\u0430\u043c \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442 \u043c\u043e\u0434\u0435\u043b\u044c \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f (sync / async);</li> <li>\u0441\u0430\u043c \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u0438\u0440\u0443\u0435\u0442 \u043e\u0447\u0435\u0440\u0435\u0434\u0438, \u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0438 \u0438 \u0441\u0435\u043c\u0430\u0444\u043e\u0440\u044b;</li> <li>\u043d\u0435 \u043d\u0430\u0432\u044f\u0437\u044b\u0432\u0430\u0435\u0442 \u0441\u0432\u043e\u044e \u043c\u043e\u0434\u0435\u043b\u044c \u0434\u0440\u0443\u0433\u0438\u043c \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430\u043c.</li> </ul> <p>\u042d\u0442\u043e \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0441\u043e\u0447\u0435\u0442\u0430\u0442\u044c \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u0435 \u043c\u043e\u0434\u0435\u043b\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0432 \u0440\u0430\u043c\u043a\u0430\u0445 \u043e\u0434\u043d\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b.</p>"},{"location":"ru/architecture/components/#_6","title":"\u041f\u043b\u0430\u0433\u0438\u043d\u044b \u0438 \u0442\u043e\u0447\u043a\u0438 \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u044f","text":"<p>\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u044e\u0442 \u0437\u0430\u0440\u0430\u043d\u0435\u0435 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0451\u043d\u043d\u044b\u0435 \u0442\u043e\u0447\u043a\u0438 \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u044f, \u0432 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0432\u043d\u0435\u0434\u0440\u0435\u043d\u043e \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u0435.</p> <p>\u041f\u043b\u0430\u0433\u0438\u043d\u044b:</p> <ul> <li>\u043d\u0435 \u0438\u0437\u043c\u0435\u043d\u044f\u044e\u0442 \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u044b \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432;</li> <li>\u043d\u0435 \u0432\u043c\u0435\u0448\u0438\u0432\u0430\u044e\u0442\u0441\u044f \u0432 \u0438\u0445 \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0435\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043d\u0430\u043f\u0440\u044f\u043c\u0443\u044e;</li> <li>\u0432\u0441\u0442\u0440\u0430\u0438\u0432\u0430\u044e\u0442\u0441\u044f \u0432 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0435 \u043f\u043e\u0442\u043e\u043a\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f.</li> </ul> <p>\u0422\u0430\u043a\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c, \u0440\u0430\u0441\u0448\u0438\u0440\u044f\u0435\u043c\u043e\u0441\u0442\u044c \u0434\u043e\u0441\u0442\u0438\u0433\u0430\u0435\u0442\u0441\u044f \u0431\u0435\u0437 \u043d\u0430\u0440\u0443\u0448\u0435\u043d\u0438\u044f \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u044b\u0445 \u0438\u043d\u0432\u0430\u0440\u0438\u0430\u043d\u0442\u043e\u0432.</p>"},{"location":"ru/architecture/components/#_7","title":"\u0418\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0438 \u0437\u0430\u043c\u0435\u043d\u0430 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432","text":"<p>\u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430 QTasks \u0434\u043e\u043f\u0443\u0441\u043a\u0430\u0435\u0442 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435 \u0441\u0446\u0435\u043d\u0430\u0440\u0438\u0438 \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430\u043c\u0438:</p> <ul> <li>\u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0433\u043e \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430 \u0441 \u043d\u0443\u043b\u044f;</li> <li>\u0437\u0430\u043c\u0435\u043d\u0430 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u043e\u0439 \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043d\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0443\u044e;</li> <li>\u043f\u043e\u043b\u043d\u043e\u0435 \u043e\u0442\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043d\u0435\u043d\u0443\u0436\u043d\u043e\u0433\u043e \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430;</li> <li>\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0440\u0430\u0437\u043d\u044b\u0445 \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0439 \u043e\u0434\u043d\u043e\u0433\u043e \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430 \u0432 \u0440\u0430\u0437\u043d\u044b\u0445 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f\u0445.</li> </ul> <p>\u0415\u0434\u0438\u043d\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u0443\u0441\u043b\u043e\u0432\u0438\u0435 \u2014 \u0441\u043e\u0431\u043b\u044e\u0434\u0435\u043d\u0438\u0435 \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u0430, \u043e\u0436\u0438\u0434\u0430\u0435\u043c\u043e\u0433\u043e \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u043e\u0439.</p>"},{"location":"ru/architecture/components/#_8","title":"\u0420\u043e\u043b\u044c \u044d\u0442\u043e\u0433\u043e \u0440\u0430\u0437\u0434\u0435\u043b\u0430","text":"<p>\u0420\u0430\u0437\u0434\u0435\u043b \u00ab\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b\u00bb \u043f\u0440\u0435\u0434\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d \u0434\u043b\u044f \u0444\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u043e\u0433\u043e \u043c\u044b\u0448\u043b\u0435\u043d\u0438\u044f \u043f\u0440\u0438 \u0440\u0430\u0431\u043e\u0442\u0435 \u0441 QTasks. \u041e\u043d \u043e\u0431\u044a\u044f\u0441\u043d\u044f\u0435\u0442 \u043d\u0435 \u0442\u043e\u043b\u044c\u043a\u043e \u043a\u0430\u043a \u0443\u0441\u0442\u0440\u043e\u0435\u043d\u044b \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b, \u043d\u043e \u0438 \u043f\u043e\u0447\u0435\u043c\u0443 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430 \u0432\u044b\u0433\u043b\u044f\u0434\u0438\u0442 \u0438\u043c\u0435\u043d\u043d\u043e \u0442\u0430\u043a.</p> <p>\u041f\u043e\u043d\u0438\u043c\u0430\u043d\u0438\u0435 \u044d\u0442\u043e\u0433\u043e \u0440\u0430\u0437\u0434\u0435\u043b\u0430 \u043a\u0440\u0438\u0442\u0438\u0447\u043d\u043e \u043f\u0440\u0438:</p> <ul> <li>\u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0435 \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0445 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432;</li> <li>\u0433\u043b\u0443\u0431\u043e\u043a\u043e\u0439 \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438 QTasks \u0432 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0443;</li> <li>\u0430\u043d\u0430\u043b\u0438\u0437\u0435 \u043f\u043e\u0442\u043e\u043a\u043e\u0432 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0438 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438;</li> <li>\u043f\u0440\u043e\u0435\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438 \u043d\u0435\u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0445 \u0441\u0446\u0435\u043d\u0430\u0440\u0438\u0435\u0432 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f.</li> </ul>"},{"location":"ru/architecture/components/abstract_classes/","title":"\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b: \u0430\u0431\u0441\u0442\u0440\u0430\u043a\u0442\u043d\u044b\u0435 \u043a\u043b\u0430\u0441\u0441\u044b","text":"<p>\u042d\u0442\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043e\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442 \u0440\u043e\u043b\u044c \u0438 \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u043e \u0430\u0431\u0441\u0442\u0440\u0430\u043a\u0442\u043d\u044b\u0445 \u043a\u043b\u0430\u0441\u0441\u043e\u0432 \u0432 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0435 QTasks. \u0410\u0431\u0441\u0442\u0440\u0430\u043a\u0442\u043d\u044b\u0435 \u043a\u043b\u0430\u0441\u0441\u044b \u0444\u043e\u0440\u043c\u0438\u0440\u0443\u044e\u0442 \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u044b \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432 \u0438 \u044f\u0432\u043b\u044f\u044e\u0442\u0441\u044f \u043a\u043b\u044e\u0447\u0435\u0432\u044b\u043c \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c\u043e\u043c \u0441\u043e\u0433\u043b\u0430\u0441\u043e\u0432\u0430\u043d\u043d\u043e\u0441\u0442\u0438 \u0432\u0441\u0435\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b.</p> <p>\u0412 QTasks \u0430\u0431\u0441\u0442\u0440\u0430\u043a\u0442\u043d\u044b\u0435 \u043a\u043b\u0430\u0441\u0441\u044b \u2014 \u044d\u0442\u043e \u043d\u0435 \u0432\u0441\u043f\u043e\u043c\u043e\u0433\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u044d\u043b\u0435\u043c\u0435\u043d\u0442, \u0430 \u043e\u0441\u043d\u043e\u0432\u0430 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u044b: \u0438\u043c\u0435\u043d\u043d\u043e \u043e\u043d\u0438 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u044e\u0442 \u0434\u043e\u043f\u0443\u0441\u0442\u0438\u043c\u043e\u0435 \u043f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432, \u0438\u0445 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u044b \u0438 \u0442\u043e\u0447\u043a\u0438 \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u044f.</p>"},{"location":"ru/architecture/components/abstract_classes/#_2","title":"\u0420\u043e\u043b\u044c \u0430\u0431\u0441\u0442\u0440\u0430\u043a\u0442\u043d\u044b\u0445 \u043a\u043b\u0430\u0441\u0441\u043e\u0432","text":"<p>\u041a\u0430\u0436\u0434\u044b\u0439 \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u0438 \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 QTasks \u043e\u0431\u044f\u0437\u0430\u043d \u043d\u0430\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u043e\u0442 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0435\u0433\u043e \u0430\u0431\u0441\u0442\u0440\u0430\u043a\u0442\u043d\u043e\u0433\u043e \u043a\u043b\u0430\u0441\u0441\u0430. \u042d\u0442\u0438 \u043a\u043b\u0430\u0441\u0441\u044b:</p> <ul> <li>\u0437\u0430\u0434\u0430\u044e\u0442 \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430 \u0441 \u0441\u0438\u0441\u0442\u0435\u043c\u043e\u0439;</li> <li>\u0444\u0438\u043a\u0441\u0438\u0440\u0443\u044e\u0442 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043c\u0435\u0442\u043e\u0434\u044b \u0438 \u0438\u0445 \u0441\u0438\u0433\u043d\u0430\u0442\u0443\u0440\u044b;</li> <li>\u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u044e\u0442 \u043c\u043e\u0434\u0435\u043b\u044c \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e\u0433\u043e \u0438 \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e\u0433\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f;</li> <li>\u0441\u043b\u0443\u0436\u0430\u0442 \u0435\u0434\u0438\u043d\u044b\u043c \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u043e\u043c \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438 \u0438 \u0442\u0438\u043f\u0438\u0437\u0430\u0446\u0438\u0438.</li> </ul> <p>\u0415\u0441\u043b\u0438 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 \u043d\u0435 \u0440\u0435\u0430\u043b\u0438\u0437\u0443\u0435\u0442 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u043c\u0435\u0442\u043e\u0434, \u043e\u0431\u044a\u044f\u0432\u043b\u0435\u043d\u043d\u044b\u0439 \u0447\u0435\u0440\u0435\u0437 <code>@abstractmethod</code>, \u0435\u0433\u043e \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043f\u0440\u0438\u0432\u043e\u0434\u0438\u0442 \u043a \u043e\u0448\u0438\u0431\u043a\u0435 \u043d\u0430 \u0443\u0440\u043e\u0432\u043d\u0435 Python, \u0435\u0449\u0451 \u0434\u043e \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u0441\u0438\u0441\u0442\u0435\u043c\u044b.</p>"},{"location":"ru/architecture/components/abstract_classes/#_3","title":"\u0411\u0430\u0437\u043e\u0432\u043e\u0435 \u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435","text":"<p>\u0412\u0441\u0435 \u0430\u0431\u0441\u0442\u0440\u0430\u043a\u0442\u043d\u044b\u0435 \u043a\u043b\u0430\u0441\u0441\u044b \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432 \u0441\u043b\u0435\u0434\u0443\u044e\u0442 \u0435\u0434\u0438\u043d\u043e\u043c\u0443 \u0448\u0430\u0431\u043b\u043e\u043d\u0443 \u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u044f:</p> <ul> <li><code>Base&lt;Component&gt;</code> \u2014 \u0430\u0431\u0441\u0442\u0440\u0430\u043a\u0442\u043d\u044b\u0439 \u043a\u043b\u0430\u0441\u0441;</li> <li><code>(A)sync&lt;\u0421\u043f\u043e\u0441\u043e\u0431\u0420\u0430\u0431\u043e\u0442\u044b&gt;&lt;Component&gt;</code> \u2014 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u0430\u044f \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f.</li> </ul> <p>\u041f\u0440\u0438\u043c\u0435\u0440:</p> <ul> <li><code>BaseStorage</code> \u2014 \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f;</li> <li><code>AsyncRedisStorage</code> \u2014 \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u0430\u044f \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0430 \u043d\u0430 \u0431\u0430\u0437\u0435 Redis.</li> </ul> <p>\u0422\u0430\u043a\u043e\u0435 \u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435 \u0434\u0435\u043b\u0430\u0435\u0442 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0443 \u0441\u0430\u043c\u043e\u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0438\u0440\u0443\u0435\u043c\u043e\u0439 \u0438 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0441\u0440\u0430\u0437\u0443 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u0442\u044c \u0440\u043e\u043b\u044c \u0438 \u043c\u043e\u0434\u0435\u043b\u044c \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430.</p>"},{"location":"ru/architecture/components/abstract_classes/#async-sync","title":"\u0420\u0430\u0437\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u043d\u0430 Async \u0438 Sync","text":"<p>\u0410\u0431\u0441\u0442\u0440\u0430\u043a\u0442\u043d\u044b\u0435 \u043a\u043b\u0430\u0441\u0441\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0438\u0437\u0430\u0446\u0438\u044e \u0447\u0435\u0440\u0435\u0437 <code>Generic[TAsyncFlag]</code> \u0434\u043b\u044f \u0441\u0442\u0440\u043e\u0433\u043e\u0433\u043e \u0440\u0430\u0437\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0445 \u0438 \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0445 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432.</p> <ul> <li><code>TAsyncFlag = True</code> \u2014 \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0439 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442;</li> <li><code>TAsyncFlag = False</code> \u2014 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0439 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442.</li> </ul> <p>\u042d\u0442\u043e \u0440\u0430\u0437\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u043e\u0442\u0440\u0430\u0436\u0430\u0435\u0442\u0441\u044f \u0432 \u0442\u0438\u043f\u0430\u0445 \u043c\u0435\u0442\u043e\u0434\u043e\u0432 \u0447\u0435\u0440\u0435\u0437 <code>@overload</code>, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440:</p> <ul> <li><code>self: BaseBroker[Literal[True]]</code> \u2014 \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0439 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442;</li> <li><code>self: BaseBroker[Literal[False]]</code> \u2014 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0439 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442.</li> </ul> <p>\u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u043e\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u043e:</p> <ul> <li>\u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b \u043c\u043e\u0433\u0443\u0442 \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u0441 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u043c\u0438 \u0444\u0443\u043d\u043a\u0446\u0438\u044f\u043c\u0438;</li> <li>\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b \u043d\u0435 \u0434\u043e\u043f\u0443\u0441\u043a\u0430\u044e\u0442 \u0432\u044b\u0437\u043e\u0432\u0430 \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0445 \u0444\u0443\u043d\u043a\u0446\u0438\u0439.</li> </ul> <p>\u042d\u0442\u043e \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u043d\u0430\u043c\u0435\u0440\u0435\u043d\u043d\u043e \u0436\u0451\u0441\u0442\u043a\u043e\u0435 \u0438 \u043f\u0440\u0435\u0434\u043e\u0442\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u043d\u0435\u044f\u0432\u043d\u044b\u0435 \u043e\u0448\u0438\u0431\u043a\u0438 \u0438\u0441\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f.</p>"},{"location":"ru/architecture/components/abstract_classes/#_4","title":"\u041a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0442\u043e\u0440 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430","text":"<p>\u041a\u0430\u0436\u0434\u044b\u0439 \u0430\u0431\u0441\u0442\u0440\u0430\u043a\u0442\u043d\u044b\u0439 \u043a\u043b\u0430\u0441\u0441 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442 \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0439 <code>__init__</code>, \u0447\u0435\u0440\u0435\u0437 \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043f\u0440\u043e\u0445\u043e\u0434\u0438\u0442 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430.</p> <p>\u0427\u0435\u0440\u0435\u0437 \u043a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0442\u043e\u0440:</p> <ul> <li>\u043f\u0435\u0440\u0435\u0434\u0430\u044e\u0442\u0441\u044f \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438;</li> <li>\u0437\u0430\u0434\u0430\u044e\u0442\u0441\u044f \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438;</li> <li>\u0444\u0438\u043a\u0441\u0438\u0440\u0443\u044e\u0442\u0441\u044f \u0438\u043d\u0432\u0430\u0440\u0438\u0430\u043d\u0442\u044b \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430.</li> </ul> <p>\u041d\u0430\u0431\u043e\u0440 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 \u0440\u0430\u0437\u043b\u0438\u0447\u0430\u0435\u0442\u0441\u044f \u043c\u0435\u0436\u0434\u0443 \u0431\u0430\u0437\u043e\u0432\u044b\u043c\u0438 \u043a\u043b\u0430\u0441\u0441\u0430\u043c\u0438, \u043d\u043e \u0441\u0430\u043c\u0430 \u0438\u0434\u0435\u044f \u0446\u0435\u043d\u0442\u0440\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u043e\u0439 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043e\u0431\u0449\u0435\u0439 \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432.</p>"},{"location":"ru/architecture/components/abstract_classes/#_5","title":"\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043c\u0435\u0442\u043e\u0434\u044b \u0438 \u043f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u0435 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e","text":"<p>\u0410\u0431\u0441\u0442\u0440\u0430\u043a\u0442\u043d\u044b\u0435 \u043a\u043b\u0430\u0441\u0441\u044b \u0432 QTasks \u043c\u043e\u0433\u0443\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c:</p> <ul> <li>\u043c\u0435\u0442\u043e\u0434\u044b, \u043f\u043e\u043c\u0435\u0447\u0435\u043d\u043d\u044b\u0435 <code>@abstractmethod</code>, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043e\u0431\u044f\u0437\u0430\u043d\u044b \u0431\u044b\u0442\u044c \u0440\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u044b;</li> <li>\u043c\u0435\u0442\u043e\u0434\u044b \u0441 \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0435\u0439 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e;</li> <li>\u0432\u0441\u043f\u043e\u043c\u043e\u0433\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043c\u0435\u0442\u043e\u0434\u044b, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0435 \u0432\u043d\u0443\u0442\u0440\u0438 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430.</li> </ul> <p>\u0422\u0430\u043a\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c, \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442 \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u043d\u0435 \u0442\u043e\u043b\u044c\u043a\u043e \u0441\u0438\u0433\u043d\u0430\u0442\u0443\u0440\u044b, \u043d\u043e \u0438 \u0431\u0430\u0437\u043e\u0432\u043e\u0435 \u043f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u0435, \u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u0441\u0447\u0438\u0442\u0430\u0435\u0442\u0441\u044f \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u043c \u0434\u043b\u044f \u0434\u0430\u043d\u043d\u043e\u0433\u043e \u0442\u0438\u043f\u0430 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430.</p>"},{"location":"ru/architecture/components/abstract_classes/#_6","title":"\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f \u0438 \u0442\u0438\u043f\u0438\u0437\u0430\u0446\u0438\u044f","text":"<p>\u041a\u0430\u0436\u0434\u044b\u0439 \u043c\u0435\u0442\u043e\u0434 \u0432 \u0430\u0431\u0441\u0442\u0440\u0430\u043a\u0442\u043d\u044b\u0445 \u043a\u043b\u0430\u0441\u0441\u0430\u0445 \u0441\u043e\u043f\u0440\u043e\u0432\u043e\u0436\u0434\u0430\u0435\u0442\u0441\u044f \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0435\u0439 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 Google docstring.</p> <p>\u042d\u0442\u043e \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442:</p> <ul> <li>\u0435\u0434\u0438\u043d\u044b\u0439 \u0441\u0442\u0438\u043b\u044c \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438 \u0432\u043e \u0432\u0441\u0451\u043c QTasks;</li> <li>\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u044e \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u043e\u0433\u043e \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u044f \u0438 \u043a\u043e\u0434\u0430;</li> <li>\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u0443\u044e \u0440\u0430\u0431\u043e\u0442\u0443 IDE, \u0441\u0442\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u0430\u043d\u0430\u043b\u0438\u0437\u0430 \u0438 \u0430\u0432\u0442\u043e\u0434\u043e\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f.</li> </ul> <p>\u0410\u0431\u0441\u0442\u0440\u0430\u043a\u0442\u043d\u044b\u0439 \u043a\u043b\u0430\u0441\u0441 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043a\u0430\u043d\u043e\u043d\u0438\u0447\u0435\u0441\u043a\u0438\u043c \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u043e\u043c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u0442\u043e\u043c, \u043a\u0430\u043a \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 \u0434\u043e\u043b\u0436\u0435\u043d \u0441\u0435\u0431\u044f \u0432\u0435\u0441\u0442\u0438.</p>"},{"location":"ru/architecture/components/abstract_classes/#_7","title":"\u0410\u0431\u0441\u0442\u0440\u0430\u043a\u0442\u043d\u044b\u0435 \u043a\u043b\u0430\u0441\u0441\u044b \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432","text":"<p>\u0422\u0430 \u0436\u0435 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u0430\u044f \u043c\u043e\u0434\u0435\u043b\u044c \u043f\u0440\u0438\u043c\u0435\u043d\u044f\u0435\u0442\u0441\u044f \u0438 \u043a \u043f\u043b\u0430\u0433\u0438\u043d\u0430\u043c.</p> <ul> <li>\u0431\u0430\u0437\u043e\u0432\u044b\u0439 \u043a\u043b\u0430\u0441\u0441 \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432: <code>BasePlugin</code>;</li> <li>\u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u0435 \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0441\u043b\u0435\u0434\u0443\u044e\u0442 \u0442\u043e\u043c\u0443 \u0436\u0435 \u0448\u0430\u0431\u043b\u043e\u043d\u0443 <code>(A)sync&lt;\u0421\u043f\u043e\u0441\u043e\u0431\u0420\u0430\u0431\u043e\u0442\u044b&gt;Plugin</code>.</li> </ul> <p>\u041f\u0440\u0438\u043c\u0435\u0440:</p> <ul> <li><code>BasePlugin</code>;</li> <li><code>AsyncPydanticWrapperPlugin</code>.</li> </ul> <p>\u042d\u0442\u043e \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442 \u0435\u0434\u0438\u043d\u043e\u043e\u0431\u0440\u0430\u0437\u0438\u0435 \u043c\u0435\u0436\u0434\u0443 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430\u043c\u0438 \u0438 \u043f\u043b\u0430\u0433\u0438\u043d\u0430\u043c\u0438 \u0438 \u0443\u043f\u0440\u043e\u0449\u0430\u0435\u0442 \u0438\u0445 \u0441\u043e\u0432\u043c\u0435\u0441\u0442\u043d\u043e\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435.</p>"},{"location":"ru/architecture/components/abstract_classes/#_8","title":"\u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u044b\u0435 \u0438\u043d\u0432\u0430\u0440\u0438\u0430\u043d\u0442\u044b","text":"<ul> <li>\u043b\u044e\u0431\u043e\u0439 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 \u043e\u0431\u044f\u0437\u0430\u043d \u043d\u0430\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u043e\u0442 <code>Base&lt;Component&gt;</code>;</li> <li>\u043d\u0435\u0441\u043e\u0431\u043b\u044e\u0434\u0435\u043d\u0438\u0435 \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u0430 \u043f\u0440\u0438\u0432\u043e\u0434\u0438\u0442 \u043a \u043e\u0448\u0438\u0431\u043a\u0435 \u043d\u0430 \u044d\u0442\u0430\u043f\u0435 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u043a\u043b\u0430\u0441\u0441\u0430;</li> <li>\u0440\u0430\u0437\u0434\u0435\u043b\u0435\u043d\u0438\u0435 Async/Sync \u0444\u0438\u043a\u0441\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u043d\u0430 \u0443\u0440\u043e\u0432\u043d\u0435 \u0442\u0438\u043f\u043e\u0432;</li> <li>\u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f \u0438 \u0442\u0438\u043f\u0438\u0437\u0430\u0446\u0438\u044f \u044f\u0432\u043b\u044f\u044e\u0442\u0441\u044f \u0447\u0430\u0441\u0442\u044c\u044e \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u0430.</li> </ul> <p>\u042d\u0442\u0438 \u043f\u0440\u0430\u0432\u0438\u043b\u0430 \u0434\u0435\u043b\u0430\u044e\u0442 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0443 QTasks \u0441\u0442\u0440\u043e\u0433\u043e\u0439, \u043f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0443\u0435\u043c\u043e\u0439 \u0438 \u0440\u0430\u0441\u0448\u0438\u0440\u044f\u0435\u043c\u043e\u0439 \u0431\u0435\u0437 \u0441\u043a\u0440\u044b\u0442\u044b\u0445 \u0441\u043e\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u0439.</p>"},{"location":"ru/architecture/components/plugin_system/","title":"\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b: \u043f\u043b\u0430\u0433\u0438\u043d\u043d\u0430\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u0430","text":"<p>\u042d\u0442\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043e\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0443 \u043f\u043b\u0430\u0433\u0438\u043d\u043d\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b QTasks \u043d\u0430 \u0443\u0440\u043e\u0432\u043d\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432: \u043a\u0430\u043a \u043f\u043b\u0430\u0433\u0438\u043d\u044b \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u044e\u0442\u0441\u044f, \u0433\u0434\u0435 \u0438\u043c\u0435\u043d\u043d\u043e \u043e\u043d\u0438 \u0432\u044b\u0437\u044b\u0432\u0430\u044e\u0442\u0441\u044f \u0438 \u043a\u0430\u043a\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c \u0432\u043b\u0438\u044f\u044e\u0442 \u043d\u0430 \u043f\u043e\u0442\u043e\u043a \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f.</p> <p>\u041f\u043b\u0430\u0433\u0438\u043d\u043d\u0430\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0432\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u043c \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c\u043e\u043c \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u044f \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432 \u0438 \u043d\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u043e \u043e\u0442 \u043d\u0438\u0445. \u041a\u0430\u0436\u0434\u044b\u0439 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 \u0441\u0430\u043c \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442, \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 \u043b\u0438 \u043e\u043d \u043f\u043b\u0430\u0433\u0438\u043d\u044b \u0438 \u0432 \u043a\u0430\u043a\u0438\u0445 \u0442\u043e\u0447\u043a\u0430\u0445 \u043e\u043d\u0438 \u043c\u043e\u0433\u0443\u0442 \u0431\u044b\u0442\u044c \u0432\u044b\u0437\u0432\u0430\u043d\u044b.</p>"},{"location":"ru/architecture/components/plugin_system/#_2","title":"\u041f\u043b\u0430\u0433\u0438\u043d\u044b \u043a\u0430\u043a \u0447\u0430\u0441\u0442\u044c \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430","text":"<p>\u0423 \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0433\u043e \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430 QTasks \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0439 \u043d\u0430\u0431\u043e\u0440 \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432, \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0439 \u0447\u0435\u0440\u0435\u0437 <code>self.plugins</code>.</p> <p>\u041f\u043b\u0430\u0433\u0438\u043d\u044b:</p> <ul> <li>\u043f\u0440\u0438\u043d\u0430\u0434\u043b\u0435\u0436\u0430\u0442 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u043c\u0443 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0443;</li> <li>\u0432\u044b\u0437\u044b\u0432\u0430\u044e\u0442\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u0432 \u044f\u0432\u043d\u043e \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0451\u043d\u043d\u044b\u0445 \u0442\u043e\u0447\u043a\u0430\u0445 (\u0442\u0440\u0438\u0433\u0433\u0435\u0440\u0430\u0445);</li> <li>\u043d\u0435 \u0438\u043c\u0435\u044e\u0442 \u043f\u0440\u044f\u043c\u043e\u0433\u043e \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0435\u043c\u0443 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044e \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430.</li> </ul> <p>\u0422\u0430\u043a\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c, \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u0435 \u043f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u044f \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u0438\u0440\u0443\u0435\u043c\u043e \u0438 \u043f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0443\u0435\u043c\u043e.</p>"},{"location":"ru/architecture/components/plugin_system/#pluginmixin","title":"PluginMixin \u0438 \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043f\u043b\u0430\u0433\u0438\u043d\u043d\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b","text":"<p>\u0427\u0442\u043e\u0431\u044b \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 \u043c\u043e\u0433 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043f\u043b\u0430\u0433\u0438\u043d\u044b, \u043e\u043d \u0434\u043e\u043b\u0436\u0435\u043d \u0443\u043d\u0430\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u044c <code>AsyncPluginMixin</code> \u0438\u043b\u0438 <code>SyncPluginMixin</code>.</p> <p>Mixin \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442:</p> <ul> <li>\u043c\u0435\u0442\u043e\u0434 <code>_plugin_trigger()</code> \u2014 \u0442\u043e\u0447\u043a\u0443 \u0432\u044b\u0437\u043e\u0432\u0430 \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432;</li> <li>\u043c\u0435\u0442\u043e\u0434 <code>add_plugin()</code> \u2014 \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438 \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432.</li> </ul> <p>\u0411\u0435\u0437 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0435\u0433\u043e mixin \u043f\u043b\u0430\u0433\u0438\u043d\u043d\u0430\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u0434\u043b\u044f \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430 \u0441\u0447\u0438\u0442\u0430\u0435\u0442\u0441\u044f \u043e\u0442\u043a\u043b\u044e\u0447\u0451\u043d\u043d\u043e\u0439.</p>"},{"location":"ru/architecture/components/plugin_system/#_3","title":"\u0412\u044b\u0437\u043e\u0432 \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u043e\u0432","text":"<p>\u0422\u0440\u0438\u0433\u0433\u0435\u0440\u044b \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432 \u0432\u044b\u0437\u044b\u0432\u0430\u044e\u0442\u0441\u044f \u044f\u0432\u043d\u043e \u0432\u043d\u0443\u0442\u0440\u0438 \u043b\u043e\u0433\u0438\u043a\u0438 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430.</p> <p>\u041f\u0440\u0438\u043c\u0435\u0440 \u0432\u044b\u0437\u043e\u0432\u0430 \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e\u0433\u043e \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u0430:</p> <pre><code>new_results = await self._plugin_trigger(\n    \"storage_get_all\",\n    storage=self,\n    results=results,\n    return_last=True,\n)\n</code></pre> <p>\u0422\u0440\u0438\u0433\u0433\u0435\u0440 \u2014 \u044d\u0442\u043e \u043d\u0435 \u0441\u043e\u0431\u044b\u0442\u0438\u0435 \u00ab\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e\u00bb, \u0430 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u043e\u0435 \u0440\u0435\u0448\u0435\u043d\u0438\u0435 \u0430\u0432\u0442\u043e\u0440\u0430 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430. \u0415\u0441\u043b\u0438 \u0442\u0440\u0438\u0433\u0433\u0435\u0440 \u043d\u0435 \u0432\u044b\u0437\u0432\u0430\u043d, \u043f\u043b\u0430\u0433\u0438\u043d\u044b \u043d\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u044e\u0442\u0441\u044f.</p>"},{"location":"ru/architecture/components/plugin_system/#_4","title":"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432","text":"<p>\u041f\u043b\u0430\u0433\u0438\u043d\u044b \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u044e\u0442\u0441\u044f \u0447\u0435\u0440\u0435\u0437 <code>add_plugin()</code>.</p> <pre><code>self.add_plugin(\n    AsyncRetryPlugin(),\n    trigger_names=[\"worker_task_error_retry\"],\n)\n</code></pre> <p><code>add_plugin()</code> \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0435\u0442:</p> <ul> <li><code>plugin</code> \u2014 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440 \u043f\u043b\u0430\u0433\u0438\u043d\u0430;</li> <li><code>trigger_names</code> \u2014 \u0441\u043f\u0438\u0441\u043e\u043a \u0438\u043c\u0451\u043d \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u043e\u0432.</li> </ul> <p>\u0415\u0441\u043b\u0438 <code>trigger_names</code> \u0440\u0430\u0432\u0435\u043d <code>None</code>, \u043f\u043b\u0430\u0433\u0438\u043d \u0441\u0447\u0438\u0442\u0430\u0435\u0442\u0441\u044f \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u043c \u0438 \u0431\u0443\u0434\u0435\u0442 \u0432\u044b\u0437\u044b\u0432\u0430\u0442\u044c\u0441\u044f \u0432\u043e \u0432\u0441\u0435\u0445 \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u0430\u0445 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430.</p> <p>Note</p> <p>\u0412 <code>QueueTasks()</code> \u043c\u0435\u0442\u043e\u0434 <code>add_plugin()</code> \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0435\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 <code>component=\"\"</code>, \u0447\u0442\u043e \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u043b\u0430\u0433\u0438\u043d \u043d\u0435 \u0441\u0430\u043c\u043e\u043c\u0443 <code>QueueTasks</code>, \u0430 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u043c\u0443 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0443.</p> <p>Note</p> <p>Worker \u043f\u0435\u0440\u0435\u0434\u0430\u0451\u0442 \u0441\u0432\u043e\u0438 \u043f\u043b\u0430\u0433\u0438\u043d\u044b \u0432 <code>TaskExecutor</code> \u043d\u0430 \u044d\u0442\u0430\u043f\u0435 \u0441\u0431\u043e\u0440\u043a\u0438 \u0437\u0430\u0434\u0430\u0447\u0438.</p> <p>\u042d\u0442\u043e \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043f\u043b\u0430\u0433\u0438\u043d\u0430\u043c \u0432\u043b\u0438\u044f\u0442\u044c \u043d\u0435 \u0442\u043e\u043b\u044c\u043a\u043e \u043d\u0430 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447\u0430\u043c\u0438, \u043d\u043e \u0438 \u043d\u0430 \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u0438\u0445 \u043d\u0435\u043f\u043e\u0441\u0440\u0435\u0434\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0433\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f.</p>"},{"location":"ru/architecture/components/plugin_system/#_5","title":"\u0422\u0438\u043f\u044b \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u043e\u0432","text":"<p>\u0421 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u043e\u0439 \u0442\u043e\u0447\u043a\u0438 \u0437\u0440\u0435\u043d\u0438\u044f \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u044b \u0434\u0435\u043b\u044f\u0442\u0441\u044f \u043d\u0430 \u0434\u0432\u0430 \u0442\u0438\u043f\u0430.</p>"},{"location":"ru/architecture/components/plugin_system/#_6","title":"\u041e\u0434\u043d\u043e\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0435 \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u044b","text":"<p>\u041e\u0434\u043d\u043e\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0439 \u0442\u0440\u0438\u0433\u0433\u0435\u0440 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u043f\u043e\u0431\u043e\u0447\u043d\u044b\u0445 \u044d\u0444\u0444\u0435\u043a\u0442\u043e\u0432 \u0438 \u043d\u0435 \u0432\u043b\u0438\u044f\u0435\u0442 \u043d\u0430 \u0434\u0430\u043b\u044c\u043d\u0435\u0439\u0448\u0435\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u043a\u043e\u0434\u0430 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430.</p> <ul> <li>\u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432 \u0438\u0433\u043d\u043e\u0440\u0438\u0440\u0443\u0435\u0442\u0441\u044f;</li> <li>\u0442\u0440\u0438\u0433\u0433\u0435\u0440 \u0441\u043b\u0443\u0436\u0438\u0442 \u0434\u043b\u044f \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f, \u043c\u0435\u0442\u0440\u0438\u043a, \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u0439 \u0438 \u0430\u043d\u0430\u043b\u043e\u0433\u0438\u0447\u043d\u044b\u0445 \u0437\u0430\u0434\u0430\u0447.</li> </ul>"},{"location":"ru/architecture/components/plugin_system/#_7","title":"\u0412\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u043c\u044b\u0435 \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u044b","text":"<p>\u0412\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u043c\u044b\u0439 \u0442\u0440\u0438\u0433\u0433\u0435\u0440 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043f\u043b\u0430\u0433\u0438\u043d\u0430\u043c \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435, \u0443\u0447\u0430\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0435 \u0432 \u0434\u0430\u043b\u044c\u043d\u0435\u0439\u0448\u0435\u043c \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0438.</p> <ul> <li>\u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432 \u043c\u043e\u0433\u0443\u0442 \u0437\u0430\u043c\u0435\u043d\u044f\u0442\u044c \u0432\u0445\u043e\u0434\u043d\u044b\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b;</li> <li>\u043d\u0430\u0431\u043e\u0440 \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u043c\u044b\u0445 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439 \u0441\u0442\u0440\u043e\u0433\u043e \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0451\u043d \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u043e\u043c \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u0430;</li> <li>\u0447\u0430\u0449\u0435 \u0432\u0441\u0435\u0433\u043e \u0438\u0437\u043c\u0435\u043d\u044f\u044e\u0442\u0441\u044f \u0442\u0435 \u0436\u0435 \u0434\u0430\u043d\u043d\u044b\u0435, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043f\u0435\u0440\u0435\u0434\u0430\u044e\u0442\u0441\u044f \u0432 \u0442\u0440\u0438\u0433\u0433\u0435\u0440.</li> </ul> <p>\u041a\u0430\u043a\u0438\u0435 \u0438\u043c\u0435\u043d\u043d\u043e \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u043c\u043e\u0433\u0443\u0442 \u0431\u044b\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u044b, \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442\u0441\u044f \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435\u043c \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u0430.</p>"},{"location":"ru/architecture/components/plugin_system/#_8","title":"\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0432\u044b\u0437\u043e\u0432\u0430 \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u043e\u0432","text":"<p>\u041a\u0430\u0436\u0434\u044b\u0439 \u0432\u044b\u0437\u043e\u0432 <code>_plugin_trigger()</code> \u0438\u043c\u0435\u0435\u0442 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0443\u044e \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0443\u044e \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0443 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432:</p> <ul> <li><code>&lt;self&gt;</code> \u2014 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442, \u0438\u043d\u0438\u0446\u0438\u0438\u0440\u043e\u0432\u0430\u0432\u0448\u0438\u0439 \u0432\u044b\u0437\u043e\u0432 \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u0430;</li> <li><code>[\u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442]</code> \u2014 \u043e\u043f\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u043e, \u0435\u0441\u043b\u0438 \u0442\u0440\u0438\u0433\u0433\u0435\u0440 \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438 \u0441\u0432\u044f\u0437\u0430\u043d \u0441 \u0434\u0440\u0443\u0433\u0438\u043c \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u043c;</li> <li><code>**parameters</code> \u2014 \u0441\u043b\u043e\u0432\u0430\u0440\u044c \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432, \u043f\u0435\u0440\u0435\u0434\u0430\u0432\u0430\u0435\u043c\u044b\u0445 \u043f\u043b\u0430\u0433\u0438\u043d\u0430\u043c.</li> </ul> <p>\u0414\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435\u043c:</p> <ul> <li><code>return_last: bool | None = None</code> \u2014 \u0432\u0435\u0440\u043d\u0443\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0439 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442, \u0435\u0441\u043b\u0438 \u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d;</li> <li><code>safe: bool = True</code> \u2014 \u0435\u0441\u043b\u0438 <code>True</code>, \u043e\u0448\u0438\u0431\u043a\u0438 \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432 \u043d\u0435 \u0438\u0433\u043d\u043e\u0440\u0438\u0440\u0443\u044e\u0442\u0441\u044f;</li> <li><code>continue_on_fail: bool</code> \u2014 \u0435\u0441\u043b\u0438 <code>True</code>, \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u0434\u0440\u0443\u0433\u0438\u0445 \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432 \u043f\u0440\u043e\u0434\u043e\u043b\u0436\u0430\u0435\u0442\u0441\u044f \u0434\u0430\u0436\u0435 \u043f\u0440\u0438 \u043e\u0448\u0438\u0431\u043a\u0435.</li> </ul>"},{"location":"ru/architecture/components/plugin_system/#_9","title":"\u041e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0441\u0442\u044c \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u0430 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430","text":"<p>\u0415\u0441\u043b\u0438 \u0432\u044b \u0441\u043e\u0437\u0434\u0430\u0451\u0442\u0435 \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0439 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 \u0438 \u0445\u043e\u0442\u0438\u0442\u0435 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0442\u044c \u043f\u043b\u0430\u0433\u0438\u043d\u044b, \u0432\u044b \u043e\u0431\u044f\u0437\u0430\u043d\u044b:</p> <ul> <li>\u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0439 <code>PluginMixin</code>;</li> <li>\u044f\u0432\u043d\u043e \u0440\u0430\u0441\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u0432\u044b\u0437\u043e\u0432\u044b <code>_plugin_trigger()</code> \u0432 \u043d\u0443\u0436\u043d\u044b\u0445 \u043c\u0435\u0441\u0442\u0430\u0445 \u043b\u043e\u0433\u0438\u043a\u0438.</li> </ul> <p>\u0415\u0441\u043b\u0438 \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u044b \u043d\u0435 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u044b, \u043f\u043b\u0430\u0433\u0438\u043d\u043d\u0430\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u0434\u043b\u044f \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430 \u0444\u0430\u043a\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u043d\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442.</p> <p>\u0410\u043d\u0430\u043b\u043e\u0433\u0438\u0447\u043d\u043e, \u0435\u0441\u043b\u0438 \u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u043f\u043e\u043b\u043d\u043e\u0441\u0442\u044c\u044e \u0437\u0430\u043f\u0440\u0435\u0442\u0438\u0442\u044c \u043f\u043b\u0430\u0433\u0438\u043d\u044b \u0432 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0435, \u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u043d\u0435 \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0442\u044c \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u044b.</p>"},{"location":"ru/architecture/components/plugin_system/#_10","title":"\u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u044b\u0435 \u0438\u043d\u0432\u0430\u0440\u0438\u0430\u043d\u0442\u044b","text":"<ul> <li>\u043f\u043b\u0430\u0433\u0438\u043d\u044b \u043f\u0440\u0438\u043d\u0430\u0434\u043b\u0435\u0436\u0430\u0442 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430\u043c, \u0430 \u043d\u0435 \u0441\u0438\u0441\u0442\u0435\u043c\u0435 \u0432 \u0446\u0435\u043b\u043e\u043c;</li> <li>\u0442\u0440\u0438\u0433\u0433\u0435\u0440\u044b \u0432\u044b\u0437\u044b\u0432\u0430\u044e\u0442\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u044f\u0432\u043d\u043e;</li> <li>\u043f\u043b\u0430\u0433\u0438\u043d\u044b \u043d\u0435 \u043d\u0430\u0440\u0443\u0448\u0430\u044e\u0442 \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u044b \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432;</li> <li>\u043f\u043b\u0430\u0433\u0438\u043d\u043d\u0430\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u0440\u0430\u0441\u0448\u0438\u0440\u044f\u0435\u0442 \u043f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u0435, \u043d\u0435 \u0438\u0437\u043c\u0435\u043d\u044f\u044f \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u044b\u0445 \u043e\u0441\u043d\u043e\u0432.</li> </ul> <p>\u041f\u043b\u0430\u0433\u0438\u043d\u043d\u0430\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u0430 QTasks \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442 \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u043c\u043e\u0435 \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u0435 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u044b \u0431\u0435\u0437 \u0441\u043a\u0440\u044b\u0442\u044b\u0445 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0435\u0439 \u0438 \u043d\u0435\u044f\u0432\u043d\u044b\u0445 \u043f\u043e\u0431\u043e\u0447\u043d\u044b\u0445 \u044d\u0444\u0444\u0435\u043a\u0442\u043e\u0432.</p>"},{"location":"ru/architecture/components/schemas/","title":"\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b: \u0441\u0445\u0435\u043c\u044b \u0434\u0430\u043d\u043d\u044b\u0445","text":"<p>\u042d\u0442\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043e\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442 \u0440\u043e\u043b\u044c \u0441\u0445\u0435\u043c \u0434\u0430\u043d\u043d\u044b\u0445 \u0432 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0435 QTasks \u0438 \u043f\u0440\u0430\u0432\u0438\u043b\u0430 \u0438\u0445 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u043f\u0440\u0438 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0438 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432.</p> <p>\u0421\u0445\u0435\u043c\u044b \u0434\u0430\u043d\u043d\u044b\u0445 \u2014 \u044d\u0442\u043e \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043c\u0435\u0436\u0434\u0443 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430\u043c\u0438. \u041e\u043d\u0438 \u0444\u043e\u0440\u043c\u0438\u0440\u0443\u044e\u0442 \u0441\u0442\u0440\u043e\u0433\u0438\u0439, \u0442\u0438\u043f\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0439 \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0437\u0430\u043c\u0435\u043d\u044f\u0435\u0442 \u043f\u0440\u044f\u043c\u043e\u0439 \u043e\u0431\u043c\u0435\u043d \u043e\u0431\u044a\u0435\u043a\u0442\u0430\u043c\u0438 \u0438 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435\u043c \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f.</p>"},{"location":"ru/architecture/components/schemas/#_2","title":"\u0420\u043e\u043b\u044c \u0441\u0445\u0435\u043c \u0432 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0435","text":"<p>\u041a\u043e\u0433\u0434\u0430 \u0434\u0430\u043d\u043d\u044b\u0435 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c \u043e\u0442 \u043e\u0434\u043d\u043e\u0433\u043e \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430 \u043a \u0434\u0440\u0443\u0433\u043e\u043c\u0443, \u043e\u0431\u0430 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430 \u043e\u0431\u044f\u0437\u0430\u043d\u044b \u043f\u0440\u0438\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0442\u044c\u0441\u044f \u0441\u043e\u0433\u043b\u0430\u0441\u043e\u0432\u0430\u043d\u043d\u043e\u0439 \u0441\u0445\u0435\u043c\u044b \u0434\u0430\u043d\u043d\u044b\u0445.</p> <p>\u0421\u0445\u0435\u043c\u044b:</p> <ul> <li>\u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u044e\u0442 \u0442\u043e\u0447\u043d\u0443\u044e \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0443 \u043f\u0435\u0440\u0435\u0434\u0430\u0432\u0430\u0435\u043c\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445;</li> <li>\u0444\u0438\u043a\u0441\u0438\u0440\u0443\u044e\u0442 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447\u0438 \u043d\u0430 \u043a\u0430\u0436\u0434\u043e\u043c \u044d\u0442\u0430\u043f\u0435 \u0436\u0438\u0437\u043d\u0435\u043d\u043d\u043e\u0433\u043e \u0446\u0438\u043a\u043b\u0430;</li> <li>\u043f\u043e\u0437\u0432\u043e\u043b\u044f\u044e\u0442 \u0441\u0435\u0440\u0438\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u0442\u044c, \u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0438 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435;</li> <li>\u0441\u043b\u0443\u0436\u0430\u0442 \u043e\u0441\u043d\u043e\u0432\u043e\u0439 \u0434\u043b\u044f \u0442\u0438\u043f\u0438\u0437\u0430\u0446\u0438\u0438 \u0438 \u0441\u0442\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u0430\u043d\u0430\u043b\u0438\u0437\u0430.</li> </ul> <p>\u0415\u0434\u0438\u043d\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0435 \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u0438\u0437 \u044d\u0442\u043e\u0433\u043e \u043f\u0440\u0430\u0432\u0438\u043b\u0430 \u2014 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447\u0438 \u0432 Worker \u0447\u0435\u0440\u0435\u0437 \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442 <code>add</code>, \u0433\u0434\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u0435\u0440\u0435\u0434\u0430\u044e\u0442\u0441\u044f \u0432 \u0432\u0438\u0434\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 \u0438 \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u0443\u044e\u0442\u0441\u044f \u0432 \u0441\u0445\u0435\u043c\u044b \u0443\u0436\u0435 \u043d\u0430 \u0441\u0442\u043e\u0440\u043e\u043d\u0435 Worker.</p>"},{"location":"ru/architecture/components/schemas/#_3","title":"\u041e\u0431\u0449\u0438\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u0430 \u0441\u0445\u0435\u043c","text":"<p>\u0414\u043b\u044f \u0432\u0441\u0435\u0445 \u0441\u0445\u0435\u043c \u0434\u0430\u043d\u043d\u044b\u0445 \u0432 QTasks \u0434\u0435\u0439\u0441\u0442\u0432\u0443\u044e\u0442 \u0435\u0434\u0438\u043d\u044b\u0435 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u044b\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u0430.</p>"},{"location":"ru/architecture/components/schemas/#1","title":"1. \u0421\u0442\u0440\u043e\u0433\u0430\u044f \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0441\u0442\u044c","text":"<p>\u041a\u0430\u0436\u0434\u0430\u044f \u0441\u0445\u0435\u043c\u0430 \u0434\u043e\u043b\u0436\u043d\u0430 \u0431\u044b\u0442\u044c dataclass-\u043f\u043e\u0434\u043e\u0431\u043d\u043e\u0439 \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u043e\u0439 \u0441 \u044f\u0432\u043d\u043e \u0437\u0430\u0434\u0430\u043d\u043d\u044b\u043c\u0438 \u043f\u043e\u043b\u044f\u043c\u0438 \u0438 \u0442\u0438\u043f\u0430\u043c\u0438. \u042d\u0442\u043e \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442:</p> <ul> <li>\u0441\u043e\u0432\u043c\u0435\u0441\u0442\u0438\u043c\u043e\u0441\u0442\u044c \u0441 <code>mypy</code> \u0438 \u0434\u0440\u0443\u0433\u0438\u043c\u0438 \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u0430\u043c\u0438 \u0442\u0438\u043f\u0438\u0437\u0430\u0446\u0438\u0438;</li> <li>\u043f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0443\u0435\u043c\u043e\u0441\u0442\u044c \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b \u0434\u0430\u043d\u043d\u044b\u0445;</li> <li>\u043e\u0434\u043d\u043e\u0437\u043d\u0430\u0447\u043d\u043e\u0441\u0442\u044c \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u043e\u0432 \u043c\u0435\u0436\u0434\u0443 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430\u043c\u0438.</li> </ul> <p>\u0421\u0445\u0435\u043c\u044b \u043d\u0435 \u043f\u0440\u0435\u0434\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u044b \u0434\u043b\u044f \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u043b\u043e\u0433\u0438\u043a\u0438 \u0438 \u043d\u0435 \u0434\u043e\u043b\u0436\u043d\u044b \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u043f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u044f, \u0432\u044b\u0445\u043e\u0434\u044f\u0449\u0435\u0433\u043e \u0437\u0430 \u0440\u0430\u043c\u043a\u0438 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445.</p>"},{"location":"ru/architecture/components/schemas/#2","title":"2. \u0421\u0431\u043e\u0440\u043a\u0430 \u0441\u0445\u0435\u043c \u043d\u0430 \u0441\u0442\u043e\u0440\u043e\u043d\u0435 \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u0435\u043b\u044f","text":"<p>\u0424\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0441\u0445\u0435\u043c\u044b \u0432\u0441\u0435\u0433\u0434\u0430 \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442 \u0432 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0435-\u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u0435\u043b\u0435.</p> <p>\u042d\u0442\u043e \u043f\u0440\u0430\u0432\u0438\u043b\u043e \u0433\u0430\u0440\u0430\u043d\u0442\u0438\u0440\u0443\u0435\u0442, \u0447\u0442\u043e \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u044e\u0449\u0438\u0439 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442:</p> <ul> <li>\u043f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0443\u0436\u0435 \u0432\u0430\u043b\u0438\u0434\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435;</li> <li>\u043d\u0435 \u0437\u0430\u0432\u0438\u0441\u0438\u0442 \u043e\u0442 \u0434\u0435\u0442\u0430\u043b\u0435\u0439 \u0444\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b;</li> <li>\u043c\u043e\u0436\u0435\u0442 \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u0438\u0441\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0441 \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u043e\u043c.</li> </ul> <p>\u0418\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u2014 Worker (<code>add</code>), \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0435\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0437\u0430\u0434\u0430\u0447\u0438 \u0438 \u0441\u0430\u043c\u043e\u0441\u0442\u043e\u044f\u0442\u0435\u043b\u044c\u043d\u043e \u0444\u043e\u0440\u043c\u0438\u0440\u0443\u0435\u0442 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0435 \u0441\u0445\u0435\u043c\u044b.</p>"},{"location":"ru/architecture/components/schemas/#3","title":"3. \u0421\u0442\u0430\u0431\u0438\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0441\u0445\u0435\u043c","text":"<p>\u0421\u0445\u0435\u043c\u0430 \u0440\u0430\u0441\u0441\u043c\u0430\u0442\u0440\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u043a\u0430\u043a \u0447\u0430\u0441\u0442\u044c \u043f\u0443\u0431\u043b\u0438\u0447\u043d\u043e\u0433\u043e \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u043e\u0433\u043e \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u0430. \u0418\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0432 \u0441\u0445\u0435\u043c\u0430\u0445 \u0434\u043e\u043b\u0436\u043d\u044b \u0431\u044b\u0442\u044c \u043e\u0441\u043e\u0437\u043d\u0430\u043d\u043d\u044b\u043c\u0438 \u0438 \u0441\u043e\u0432\u043c\u0435\u0441\u0442\u0438\u043c\u044b\u043c\u0438, \u0442\u0430\u043a \u043a\u0430\u043a \u043e\u043d\u0438 \u043d\u0430\u043f\u0440\u044f\u043c\u0443\u044e \u0432\u043b\u0438\u044f\u044e\u0442 \u043d\u0430 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432 \u0438 \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432.</p>"},{"location":"ru/architecture/components/schemas/#qtasks","title":"\u041a\u043b\u044e\u0447\u0435\u0432\u044b\u0435 \u0441\u0445\u0435\u043c\u044b QTasks","text":"<p>\u041d\u0438\u0436\u0435 \u043f\u0435\u0440\u0435\u0447\u0438\u0441\u043b\u0435\u043d\u044b \u043e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u0441\u0445\u0435\u043c\u044b, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0435 \u0432 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0435 QTasks, \u0438 \u0438\u0445 \u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435.</p>"},{"location":"ru/architecture/components/schemas/#queueconfig","title":"QueueConfig","text":"<p>\u0421\u0445\u0435\u043c\u0430 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u0430\u044f \u0432\u0441\u0435\u043c\u0438 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430\u043c\u0438, \u043d\u0430\u0447\u0438\u043d\u0430\u044f \u0441 <code>QueueTasks</code>. \u041e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442 \u0431\u0430\u0437\u043e\u0432\u044b\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0440\u0430\u0431\u043e\u0442\u044b \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0438 \u043f\u0435\u0440\u0435\u0434\u0430\u0451\u0442\u0441\u044f \u043f\u0440\u0438 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432.</p>"},{"location":"ru/architecture/components/schemas/#task","title":"Task","text":"<p>\u0421\u0445\u0435\u043c\u0430 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430 \u0437\u0430\u0434\u0430\u0447\u0438, \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u043c\u0430\u044f \u043a\u043b\u0438\u0435\u043d\u0442\u0443. \u041f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0430\u0433\u0440\u0435\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447\u0438 \u0441 \u0443\u0447\u0451\u0442\u043e\u043c \u0435\u0451 \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u0438\u043b\u0438 \u043a\u043e\u043d\u0435\u0447\u043d\u043e\u0433\u043e \u0441\u0442\u0430\u0442\u0443\u0441\u0430.</p>"},{"location":"ru/architecture/components/schemas/#basetaskstatusschema","title":"BaseTaskStatusSchema","text":"<p>\u0411\u0430\u0437\u043e\u0432\u0430\u044f \u0441\u0445\u0435\u043c\u0430 \u0441\u0442\u0430\u0442\u0443\u0441\u0430 \u0437\u0430\u0434\u0430\u0447\u0438. \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447\u0438 \u043d\u0430 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0445 \u044d\u0442\u0430\u043f\u0430\u0445 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f.</p> <p>\u041f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u043d\u044b\u0435 \u0441\u0445\u0435\u043c\u044b:</p> <ul> <li><code>TaskStatusNewSchema</code>;</li> <li><code>TaskStatusProcessSchema</code>;</li> <li><code>TaskStatusSuccessSchema</code>;</li> <li><code>TaskStatusErrorSchema</code>;</li> <li><code>TaskStatusCancelSchema</code>.</li> </ul> <p>\u041e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u043f\u043e\u0442\u0440\u0435\u0431\u0438\u0442\u0435\u043b\u044c \u044d\u0442\u0438\u0445 \u0441\u0445\u0435\u043c \u2014 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 Storage.</p>"},{"location":"ru/architecture/components/schemas/#taskexecschema","title":"TaskExecSchema","text":"<p>\u0421\u0445\u0435\u043c\u0430, \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0449\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0437\u0430\u0434\u0430\u0447\u0435 \u0438 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u0435\u0451 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f. \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u043f\u0440\u0435\u0438\u043c\u0443\u0449\u0435\u0441\u0442\u0432\u0435\u043d\u043d\u043e Worker \u043f\u0440\u0438 \u043f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0435 \u0437\u0430\u0434\u0430\u0447\u0438 \u043a \u0438\u0441\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044e \u0438 \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0435 \u0432 <code>TaskExecutor</code>.</p>"},{"location":"ru/architecture/components/schemas/#taskpriorityschema","title":"TaskPrioritySchema","text":"<p>\u0421\u0445\u0435\u043c\u0430 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447\u0438 \u0432 Worker. \u0425\u0440\u0430\u043d\u0438\u0442 \u0432\u0445\u043e\u0434\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435, \u043f\u0435\u0440\u0435\u0434\u0430\u043d\u043d\u044b\u0435 \u0447\u0435\u0440\u0435\u0437 <code>add</code>, \u0430 \u0442\u0430\u043a\u0436\u0435 \u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f.</p> <p>\u042d\u0442\u0430 \u0441\u0445\u0435\u043c\u0430 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0442\u043e\u0447\u043a\u043e\u0439 \u0432\u0445\u043e\u0434\u0430 \u0437\u0430\u0434\u0430\u0447\u0438 \u0432 \u043e\u0447\u0435\u0440\u0435\u0434\u044c \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f Worker.</p>"},{"location":"ru/architecture/components/schemas/#basetaskcls","title":"BaseTaskCls","text":"<p>\u0421\u0445\u0435\u043c\u0430 \u043f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0441\u043e\u0431\u0440\u0430\u043d\u043d\u043e\u0439 \u0437\u0430\u0434\u0430\u0447\u0438, \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u044f\u044e\u0449\u0430\u044f \u0430\u043b\u044c\u0442\u0435\u0440\u043d\u0430\u0442\u0438\u0432\u043d\u044b\u0439 \u0441\u043f\u043e\u0441\u043e\u0431 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447\u0438.</p> <p>\u041f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u043d\u044b\u0435 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u044b:</p> <ul> <li><code>AsyncTaskCls</code>;</li> <li><code>SyncTaskCls</code>.</li> </ul> <p>\u0422\u0430\u043a\u0438\u0435 \u0441\u0445\u0435\u043c\u044b \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u044e\u0442 \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u0441 \u0437\u0430\u0434\u0430\u0447\u0435\u0439 \u043a\u0430\u043a \u0441 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u043c \u0432\u044b\u0437\u043e\u0432\u0430, \u0430 \u043d\u0435 \u0447\u0435\u0440\u0435\u0437 \u043f\u0440\u044f\u043c\u043e\u0439 \u0432\u044b\u0437\u043e\u0432 <code>add_task</code>.</p>"},{"location":"ru/architecture/components/schemas/#initsexecschema","title":"InitsExecSchema","text":"<p>\u0421\u0445\u0435\u043c\u0430 \u0434\u043b\u044f \u0438\u0432\u0435\u043d\u0442\u043e\u0432\u044b\u0445 \u0444\u0443\u043d\u043a\u0446\u0438\u0439, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0445 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0435 \u0441\u043e\u0431\u044b\u0442\u0438\u0439 QTasks.</p> <p>\u041f\u0440\u0438\u043c\u0435\u0440 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u2014 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u0438 \u0432\u0438\u0434\u0430:</p> <pre><code>@app.events.on.worker_running\n</code></pre>"},{"location":"ru/architecture/components/schemas/#globalconfigschema","title":"GlobalConfigSchema","text":"<p>\u041e\u0441\u043d\u043e\u0432\u043d\u0430\u044f \u0441\u0445\u0435\u043c\u0430 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430 <code>GlobalConfig</code>, \u043f\u0440\u0435\u0434\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u043d\u043e\u0433\u043e \u0434\u043b\u044f \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0438 \u0440\u0430\u0441\u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0445 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432.</p> <p>\u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 Redis \u043a\u0430\u043a \u0441\u0435\u0440\u0432\u0435\u0440 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f.</p>"},{"location":"ru/architecture/components/schemas/#argmeta","title":"ArgMeta","text":"<p>\u0421\u0445\u0435\u043c\u0430 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0445 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u043e\u0432 \u0437\u0430\u0434\u0430\u0447\u0438.</p> <p>\u0425\u0440\u0430\u043d\u0438\u0442:</p> <ul> <li>\u0438\u043c\u0435\u043d\u0430 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u043e\u0432;</li> <li>\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f;</li> <li>\u043f\u043e\u0437\u0438\u0446\u0438\u044e \u0438\u043b\u0438 \u043a\u043b\u044e\u0447;</li> <li>\u0430\u043d\u043d\u043e\u0442\u0430\u0446\u0438\u0438 \u0442\u0438\u043f\u043e\u0432 \u0438 \u0432\u0441\u043f\u043e\u043c\u043e\u0433\u0430\u0442\u0435\u043b\u044c\u043d\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e.</li> </ul> <p>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u043f\u0440\u0435\u0438\u043c\u0443\u0449\u0435\u0441\u0442\u0432\u0435\u043d\u043d\u043e \u0432 <code>TaskExecutor</code> \u0438 \u043f\u043b\u0430\u0433\u0438\u043d\u0430\u0445, \u043a\u043e\u0442\u043e\u0440\u044b\u043c \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043f\u043e\u043d\u0438\u043c\u0430\u0442\u044c \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0443 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u043e\u0432 \u0437\u0430\u0434\u0430\u0447\u0438.</p> <p>\u0414\u043b\u044f \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432 <code>ArgMeta</code> \u043f\u0435\u0440\u0435\u0434\u0430\u0451\u0442\u0441\u044f \u043a\u0430\u043a \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 \u0432 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0445 \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u0430\u0445.</p>"},{"location":"ru/architecture/components/schemas/#_4","title":"\u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u044b\u0435 \u0438\u043d\u0432\u0430\u0440\u0438\u0430\u043d\u0442\u044b","text":"<ul> <li>\u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b \u043e\u0431\u043c\u0435\u043d\u0438\u0432\u0430\u044e\u0442\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u0441\u0445\u0435\u043c\u0430\u043c\u0438 \u0434\u0430\u043d\u043d\u044b\u0445;</li> <li>\u0441\u0445\u0435\u043c\u044b \u043d\u0435 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442 \u043b\u043e\u0433\u0438\u043a\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f;</li> <li>\u0444\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0441\u0445\u0435\u043c \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442 \u0434\u043e \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 \u0434\u0430\u043d\u043d\u044b\u0445;</li> <li>\u0441\u0442\u0430\u0431\u0438\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0441\u0445\u0435\u043c \u043a\u0440\u0438\u0442\u0438\u0447\u043d\u0430 \u0434\u043b\u044f \u0441\u043e\u0432\u043c\u0435\u0441\u0442\u0438\u043c\u043e\u0441\u0442\u0438 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432 \u0438 \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432.</li> </ul> <p>\u0421\u0445\u0435\u043c\u044b \u0434\u0430\u043d\u043d\u044b\u0445 \u0444\u043e\u0440\u043c\u0438\u0440\u0443\u044e\u0442 \u00ab\u044f\u0437\u044b\u043a\u00bb \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432 QTasks \u0438 \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u044e\u0442 \u0446\u0435\u043b\u043e\u0441\u0442\u043d\u043e\u0441\u0442\u044c \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u044b \u043f\u0440\u0438 \u0435\u0451 \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u0438.</p>"},{"location":"ru/architecture/components/threads_async/","title":"\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b: \u043f\u043e\u0442\u043e\u043a\u0438 \u0438 \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e\u0441\u0442\u044c","text":"<p>\u042d\u0442\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043e\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442, \u043a\u0430\u043a \u0432 QTasks \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0443\u0435\u0442\u0441\u044f \u0437\u0430\u043f\u0443\u0441\u043a \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432 \u0432 \u0441\u0435\u0440\u0432\u0435\u0440\u043d\u043e\u043c \u0440\u0435\u0436\u0438\u043c\u0435, \u043a\u0430\u043a \u0444\u043e\u0440\u043c\u0438\u0440\u0443\u044e\u0442\u0441\u044f \u043f\u043e\u0442\u043e\u043a\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0438 \u0433\u0434\u0435 \u0438\u043c\u0435\u043d\u043d\u043e \u0432 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0435 \u0432\u043e\u0437\u043d\u0438\u043a\u0430\u0435\u0442 \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e\u0441\u0442\u044c.</p> <p>\u0420\u0435\u0447\u044c \u0438\u0434\u0451\u0442 \u0438\u0441\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043e \u0440\u0435\u0436\u0438\u043c\u0435 \u0440\u0430\u0431\u043e\u0442\u044b \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u043a\u0430\u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0430. \u0412 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u043c \u0440\u0435\u0436\u0438\u043c\u0435 \u043d\u0438\u043a\u0430\u043a\u0438\u0435 \u0444\u043e\u043d\u043e\u0432\u044b\u0435 \u043f\u043e\u0442\u043e\u043a\u0438, \u0446\u0438\u043a\u043b\u044b \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0438\u043b\u0438 \u0432\u043e\u0440\u043a\u0435\u0440\u044b \u043d\u0435 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u044e\u0442\u0441\u044f.</p>"},{"location":"ru/architecture/components/threads_async/#starter","title":"\u0420\u043e\u043b\u044c Starter \u0432 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0435","text":"<p>\u0414\u043b\u044f \u0437\u0430\u043f\u0443\u0441\u043a\u0430 QTasks \u0432 \u0441\u0435\u0440\u0432\u0435\u0440\u043d\u043e\u043c \u0440\u0435\u0436\u0438\u043c\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0439 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 \u2014 Starter.</p> <p>Starter \u043e\u0442\u0432\u0435\u0447\u0430\u0435\u0442 \u0437\u0430 \u043f\u0435\u0440\u0432\u0438\u0447\u043d\u0443\u044e \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044e \u043f\u043e\u0442\u043e\u043a\u043e\u0432 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0438 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0436\u0438\u0437\u043d\u0435\u043d\u043d\u044b\u043c \u0446\u0438\u043a\u043b\u043e\u043c \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432. \u0415\u0433\u043e \u0437\u0430\u0434\u0430\u0447\u0430 \u2014 \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0441\u0438\u0441\u0442\u0435\u043c\u0443 \u0438 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e \u0435\u0451 \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c, \u043d\u0435 \u0432\u043c\u0435\u0448\u0438\u0432\u0430\u044f\u0441\u044c \u0432\u043e \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u044e\u044e \u043b\u043e\u0433\u0438\u043a\u0443 \u0441\u0430\u043c\u0438\u0445 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432.</p> <p>Starter:</p> <ul> <li>\u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0435\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f;</li> <li>\u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442 \u0438\u0445 \u043c\u0435\u0436\u0434\u0443 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430\u043c\u0438;</li> <li>\u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442 \u0438 \u043e\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b;</li> <li>\u0438\u043d\u0438\u0446\u0438\u0438\u0440\u0443\u0435\u0442 \u0437\u0430\u043f\u0443\u0441\u043a \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432.</li> </ul> <p>\u041f\u0440\u0438 \u044d\u0442\u043e\u043c Starter \u043d\u0435 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442, \u043a\u0430\u043a\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b \u0431\u0443\u0434\u0443\u0442 \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u043f\u043e\u0441\u043b\u0435 \u0437\u0430\u043f\u0443\u0441\u043a\u0430. \u041c\u043e\u0434\u0435\u043b\u044c \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f, \u043e\u0447\u0435\u0440\u0435\u0434\u0438, \u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0438 \u0438 \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e\u0441\u0442\u044c \u043f\u043e\u043b\u043d\u043e\u0441\u0442\u044c\u044e \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u044e\u0442\u0441\u044f \u0441\u0430\u043c\u0438\u043c\u0438 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430\u043c\u0438.</p>"},{"location":"ru/architecture/components/threads_async/#starter_1","title":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 Starter \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e","text":"<p>Starter \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u043f\u0440\u0438 \u0437\u0430\u043f\u0443\u0441\u043a\u0435 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0447\u0435\u0440\u0435\u0437 <code>app.run_forever()</code>.</p> <p>\u0412 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442 \u0442\u0438\u043f\u0430 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u043f\u0440\u0438\u043c\u0435\u043d\u044f\u0435\u0442\u0441\u044f \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0430\u044f \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f:</p> <ul> <li><code>AsyncStarter</code> \u2014 \u0434\u043b\u044f <code>qtasks.asyncio.QueueTasks</code>;</li> <li><code>SyncStarter</code> \u2014 \u0434\u043b\u044f <code>qtasks.QueueTasks</code>.</li> </ul> <p>\u041f\u0440\u0438 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438 Starter \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0437\u0430\u043c\u0435\u043d\u0451\u043d \u043d\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0443\u044e \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044e \u043f\u0440\u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0438 \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u0430.</p>"},{"location":"ru/architecture/components/threads_async/#_2","title":"\u041f\u043e\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0437\u0430\u043f\u0443\u0441\u043a\u0430","text":"<p>Starter \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b \u0432 \u0441\u0442\u0440\u043e\u0433\u043e \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0451\u043d\u043d\u043e\u043c \u043f\u043e\u0440\u044f\u0434\u043a\u0435.</p>"},{"location":"ru/architecture/components/threads_async/#_3","title":"\u0417\u0430\u043f\u0443\u0441\u043a","text":"<ol> <li> <p>\u0417\u0430\u043f\u0443\u0441\u043a\u0430\u044e\u0442\u0441\u044f \u0432\u0441\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u043f\u043b\u0430\u0433\u0438\u043d\u044b:</p> </li> <li> <p>\u043f\u043b\u0430\u0433\u0438\u043d\u044b \u0441\u0430\u043c\u043e\u0433\u043e Starter;</p> </li> <li>\u043f\u043b\u0430\u0433\u0438\u043d\u044b \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432.</li> </ol> <p>\u0414\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u043f\u043b\u0430\u0433\u0438\u043d\u0430 \u0432\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f <code>start()</code>.</p> <ol> <li>\u0417\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442\u0441\u044f Worker \u0447\u0435\u0440\u0435\u0437 \u0432\u044b\u0437\u043e\u0432:</li> </ol> <pre><code>worker.start(num_workers)\n</code></pre> <ol> <li>\u0417\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442\u0441\u044f Broker, \u043a\u043e\u0442\u043e\u0440\u043e\u043c\u0443 \u043f\u0435\u0440\u0435\u0434\u0430\u0451\u0442\u0441\u044f \u0441\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 Worker:</li> </ol> <pre><code>broker.start(worker)\n</code></pre> <p>\u041d\u0430 \u044d\u0442\u043e\u043c \u044d\u0442\u0430\u043f\u0435 \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u0441\u0447\u0438\u0442\u0430\u0435\u0442\u0441\u044f \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043d\u043e\u0439 \u0438 \u0433\u043e\u0442\u043e\u0432\u043e\u0439 \u043a \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0435 \u0437\u0430\u0434\u0430\u0447.</p>"},{"location":"ru/architecture/components/threads_async/#_4","title":"\u041f\u043e\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438","text":"<p>\u041e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f \u0432 \u043e\u0431\u0440\u0430\u0442\u043d\u043e\u043c \u043f\u043e\u0440\u044f\u0434\u043a\u0435 \u0438 \u0442\u0430\u043a\u0436\u0435 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u0438\u0440\u0443\u0435\u0442\u0441\u044f Starter.</p> <ol> <li> <p>\u041f\u043e\u043e\u0447\u0435\u0440\u0451\u0434\u043d\u043e \u043e\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u044e\u0442\u0441\u044f \u043e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b:</p> </li> <li> <p>Broker;</p> </li> <li>Worker;</li> <li>Storage;</li> <li>GlobalConfig (\u0435\u0441\u043b\u0438 \u043f\u0440\u0438\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442).</li> </ol> <p>\u0414\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430 \u0432\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f <code>stop()</code>. 1.1. \u0415\u0441\u043b\u0438 \u0432 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0435 \u0440\u0430\u0431\u043e\u0442\u044b \u0431\u044b\u043b \u0441\u043e\u0437\u0434\u0430\u043d <code>_global_loop</code>, \u043e\u043d \u0442\u0430\u043a\u0436\u0435 \u043e\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442\u0441\u044f. 2. \u041f\u043e\u0441\u043b\u0435 \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432 \u043e\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u044e\u0442\u0441\u044f \u0432\u0441\u0435 \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043d\u044b\u0435 \u043f\u043b\u0430\u0433\u0438\u043d\u044b \u0447\u0435\u0440\u0435\u0437 <code>stop()</code>.</p> <p>\u0422\u0430\u043a\u0430\u044f \u043f\u043e\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0433\u0430\u0440\u0430\u043d\u0442\u0438\u0440\u0443\u0435\u0442 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e\u0435 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u0435 \u0444\u043e\u043d\u043e\u0432\u044b\u0445 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432 \u0438 \u043e\u0441\u0432\u043e\u0431\u043e\u0436\u0434\u0435\u043d\u0438\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432.</p> <p>Note</p> <p>\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 <code>GlobalConfig</code> \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043d\u0435\u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u043c \u043e\u0441\u043d\u043e\u0432\u043d\u044b\u043c \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u043c. \u041d\u0435\u0441\u043c\u043e\u0442\u0440\u044f \u043d\u0430 \u043d\u0430\u043b\u0438\u0447\u0438\u0435 \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e, \u043e\u043d \u043c\u043e\u0436\u0435\u0442 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u043e\u0432\u0430\u0442\u044c. \u0412\u043e \u0432\u0441\u0435\u0445 \u043c\u0435\u0441\u0442\u0430\u0445, \u0433\u0434\u0435 \u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0435\u0433\u043e \u0437\u0430\u043f\u0443\u0441\u043a \u0438\u043b\u0438 \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430, \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0442\u044c, \u0447\u0442\u043e \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 (\u043d\u0435 \u0440\u0430\u0432\u0435\u043d <code>None</code>).</p>"},{"location":"ru/architecture/components/threads_async/#_5","title":"\u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u0430\u044f \u0441\u0445\u0435\u043c\u0430 \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432","text":"<p>\u0412 \u0443\u043f\u0440\u043e\u0449\u0451\u043d\u043d\u043e\u043c \u0432\u0438\u0434\u0435 \u0441\u0445\u0435\u043c\u0430 \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u0438 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432 \u0432\u044b\u0433\u043b\u044f\u0434\u044f\u0442 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c:</p> <pre><code>Starter\n  \u251c\u2500\u2500 Worker\n  \u251c\u2500\u2500 Broker\n  \u2502     \u2514\u2500\u2500 Storage\n  \u2502           \u2514\u2500\u2500 GlobalConfig (\u043e\u043f\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u043e)\n</code></pre> <p>\u042d\u0442\u0430 \u0441\u0445\u0435\u043c\u0430 \u043e\u0442\u0440\u0430\u0436\u0430\u0435\u0442 \u0442\u043e\u043b\u044c\u043a\u043e \u0438\u0435\u0440\u0430\u0440\u0445\u0438\u044e \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u0438 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438, \u043d\u043e \u043d\u0435 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442 \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0435 \u043c\u043e\u0434\u0435\u043b\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f.</p>"},{"location":"ru/architecture/components/threads_async/#_6","title":"\u0410\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e\u0441\u0442\u044c \u043a\u0430\u043a \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0435 \u0441\u0432\u043e\u0439\u0441\u0442\u0432\u043e","text":"<p>\u0412 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0435 QTasks \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e\u0441\u0442\u044c \u043d\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u043c \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435\u043c \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f.</p> <ul> <li>Starter \u043b\u0438\u0448\u044c \u0438\u043d\u0438\u0446\u0438\u0438\u0440\u0443\u0435\u0442 \u0437\u0430\u043f\u0443\u0441\u043a \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432;</li> <li> <p>\u043a\u0430\u0436\u0434\u044b\u0439 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 \u0441\u0430\u043c\u043e\u0441\u0442\u043e\u044f\u0442\u0435\u043b\u044c\u043d\u043e \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442:</p> </li> <li> <p>\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043b\u0438 event loop;</p> </li> <li>\u043a\u0430\u043a \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u043e\u0432\u0430\u0442\u044c \u043e\u0447\u0435\u0440\u0435\u0434\u0438;</li> <li>\u043a\u0430\u043a\u0438\u0435 \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c\u044b \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438 \u043f\u0440\u0438\u043c\u0435\u043d\u044f\u0442\u044c.</li> </ul> <p>\u042d\u0442\u043e \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0441\u043e\u0447\u0435\u0442\u0430\u0442\u044c \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0435 \u0438 \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b \u0432 \u0440\u0430\u043c\u043a\u0430\u0445 \u043e\u0434\u043d\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0438 \u0430\u0434\u0430\u043f\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043c\u043e\u0434\u0435\u043b\u044c \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043f\u043e\u0434 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u0443\u044e \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0443.</p>"},{"location":"ru/architecture/components/threads_async/#_7","title":"\u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u044b\u0435 \u0438\u043d\u0432\u0430\u0440\u0438\u0430\u043d\u0442\u044b","text":"<ul> <li>\u0441\u0435\u0440\u0432\u0435\u0440\u043d\u044b\u0439 \u0440\u0435\u0436\u0438\u043c \u0440\u0430\u0431\u043e\u0442\u044b \u0438\u043d\u0438\u0446\u0438\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0438\u0441\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0447\u0435\u0440\u0435\u0437 Starter;</li> <li>Starter \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u0436\u0438\u0437\u043d\u0435\u043d\u043d\u044b\u043c \u0446\u0438\u043a\u043b\u043e\u043c, \u043d\u043e \u043d\u0435 \u043b\u043e\u0433\u0438\u043a\u043e\u0439 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f;</li> <li>\u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e\u0441\u0442\u044c \u043b\u043e\u043a\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u0430 \u0432\u043d\u0443\u0442\u0440\u0438 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432;</li> <li>\u043f\u043e\u0440\u044f\u0434\u043e\u043a \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u0438 \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432 \u0444\u0438\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u043d \u0438 \u043f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0443\u0435\u043c.</li> </ul> <p>\u0422\u0430\u043a\u043e\u0439 \u043f\u043e\u0434\u0445\u043e\u0434 \u0434\u0435\u043b\u0430\u0435\u0442 \u043f\u043e\u0442\u043e\u043a\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0432 QTasks \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u043c\u044b\u043c\u0438 \u0438 \u043f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u044b\u043c\u0438 \u0434\u0430\u0436\u0435 \u043f\u0440\u0438 \u0441\u043b\u043e\u0436\u043d\u044b\u0445 \u0441\u0446\u0435\u043d\u0430\u0440\u0438\u044f\u0445 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f.</p>"},{"location":"ru/architecture/integrations/","title":"\u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f \u0441 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0430\u043c\u0438","text":"<p>\u042d\u0442\u043e\u0442 \u0440\u0430\u0437\u0434\u0435\u043b \u043e\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u044b\u0435 \u043f\u0440\u0438\u043d\u0446\u0438\u043f\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u044e\u0442 \u0438\u043d\u0442\u0435\u0433\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c QTasks \u0441 \u0432\u043d\u0435\u0448\u043d\u0438\u043c\u0438 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0430\u043c\u0438 \u0438 \u0444\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a\u0430\u043c\u0438 \u0431\u0435\u0437 \u043d\u0430\u0432\u044f\u0437\u044b\u0432\u0430\u043d\u0438\u044f \u0436\u0451\u0441\u0442\u043a\u0438\u0445 \u0443\u0441\u043b\u043e\u0432\u0438\u0439 \u0438\u043b\u0438 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0439.</p> <p>\u041d\u0435\u0441\u043c\u043e\u0442\u0440\u044f \u043d\u0430 \u0442\u043e \u0447\u0442\u043e QTasks \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043f\u043e\u043b\u043d\u043e\u0446\u0435\u043d\u043d\u044b\u043c \u0444\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a\u043e\u043c \u0441\u043e \u0441\u0432\u043e\u0438\u043c\u0438 \u043f\u0440\u0430\u0432\u0438\u043b\u0430\u043c\u0438 \u043f\u043e\u0441\u0442\u0440\u043e\u0435\u043d\u0438\u044f \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439, \u0435\u0433\u043e \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430 \u0441\u043f\u0440\u043e\u0435\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0430 \u0442\u0430\u043a\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c, \u0447\u0442\u043e\u0431\u044b \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a \u043c\u043e\u0433 \u0438\u043d\u0442\u0435\u0433\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0435\u0433\u043e \u0432 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0443\u044e \u0441\u0438\u0441\u0442\u0435\u043c\u0443 \u043d\u0430 \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0445 \u0443\u0441\u043b\u043e\u0432\u0438\u044f\u0445.</p>"},{"location":"ru/architecture/integrations/#qtasks","title":"\u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u0430\u044f \u043f\u043e\u0437\u0438\u0446\u0438\u044f QTasks","text":"<p>QTasks \u043d\u0435 \u0441\u0442\u0440\u0435\u043c\u0438\u0442\u0441\u044f \u0431\u044b\u0442\u044c \u00ab\u0446\u0435\u043d\u0442\u0440\u043e\u043c \u043c\u0438\u0440\u0430\u00bb \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f. \u041e\u043d \u043c\u043e\u0436\u0435\u0442 \u0432\u044b\u0441\u0442\u0443\u043f\u0430\u0442\u044c:</p> <ul> <li>\u043a\u0430\u043a \u0430\u0432\u0442\u043e\u043d\u043e\u043c\u043d\u044b\u0439 \u0441\u0435\u0440\u0432\u0435\u0440 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0437\u0430\u0434\u0430\u0447;</li> <li>\u043a\u0430\u043a \u0432\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0439 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 \u0432\u043d\u0443\u0442\u0440\u0438 \u0434\u0440\u0443\u0433\u043e\u0433\u043e \u0444\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a\u0430;</li> <li>\u043a\u0430\u043a \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u043d\u044b\u0439 \u0441\u043b\u043e\u0439, \u043e\u0431\u0441\u043b\u0443\u0436\u0438\u0432\u0430\u044e\u0449\u0438\u0439 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439.</li> </ul> <p>\u042d\u0442\u043e \u0434\u043e\u0441\u0442\u0438\u0433\u0430\u0435\u0442\u0441\u044f \u0437\u0430 \u0441\u0447\u0451\u0442 \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0430 \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u0438 \u0441\u0442\u0440\u043e\u0433\u043e\u0439 \u0438\u0437\u043e\u043b\u044f\u0446\u0438\u0438 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432.</p>"},{"location":"ru/architecture/integrations/#_2","title":"\u041c\u0438\u043d\u0438\u043c\u0438\u0437\u0430\u0446\u0438\u044f \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f","text":"<p>\u0412 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0435 QTasks \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f \u043e\u0441\u043e\u0437\u043d\u0430\u043d\u043d\u043e \u0438 \u0432 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u043d\u043e\u043c \u043e\u0431\u044a\u0451\u043c\u0435.</p>"},{"location":"ru/architecture/integrations/#_3","title":"\u0413\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u0430\u044f \u0441\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435","text":"<p>\u041e\u0441\u043d\u043e\u0432\u043d\u0430\u044f \u0442\u043e\u0447\u043a\u0430 \u0432\u0445\u043e\u0434\u0430 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0441\u043e\u0437\u0434\u0430\u0451\u0442\u0441\u044f \u0447\u0435\u0440\u0435\u0437:</p> <pre><code>app = QueueTasks()\n</code></pre> <p>\u041f\u0440\u0438 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0432\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f <code>self._set_state()</code>, \u0432 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0435 \u0447\u0435\u0433\u043e:</p> <ul> <li>\u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u0430\u044f \u0441\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u0442\u0441\u044f \u0432 <code>qtasks._state.app_main</code>;</li> <li>\u043e\u043d\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u043a\u0430\u043a \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0432 \u0442\u0435\u0445 \u043c\u0435\u0441\u0442\u0430\u0445, \u0433\u0434\u0435 \u044f\u0432\u043d\u0430\u044f \u0441\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442.</li> </ul> <p>\u0412\u0430\u0436\u043d\u043e \u043e\u0442\u043c\u0435\u0442\u0438\u0442\u044c, \u0447\u0442\u043e \u043d\u0430\u043b\u0438\u0447\u0438\u0435 <code>app_main</code> \u043d\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u043c \u0443\u0441\u043b\u043e\u0432\u0438\u0435\u043c \u0440\u0430\u0431\u043e\u0442\u044b \u0441\u0438\u0441\u0442\u0435\u043c\u044b.</p> <p>\u0412\u043e \u0432\u0441\u0435\u0445 \u0441\u043b\u0443\u0447\u0430\u044f\u0445, \u0433\u0434\u0435 \u044d\u0442\u043e \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e:</p> <ul> <li>\u0437\u0430\u0434\u0430\u0447\u0438, \u043e\u0431\u044a\u044f\u0432\u043b\u0435\u043d\u043d\u044b\u0435 \u0447\u0435\u0440\u0435\u0437 <code>@app.task</code>, \u043f\u043e\u043b\u0443\u0447\u0430\u044e\u0442 \u0441\u0441\u044b\u043b\u043a\u0443 \u043d\u0430 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u0439 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440 <code>app</code> \u043d\u0430\u043f\u0440\u044f\u043c\u0443\u044e;</li> <li>\u0440\u043e\u0443\u0442\u0435\u0440\u044b <code>(A)syncRouter</code>, \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0451\u043d\u043d\u044b\u0435 \u0447\u0435\u0440\u0435\u0437 <code>app.include_router(router)</code>, \u0442\u0430\u043a\u0436\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442 \u044f\u0432\u043d\u0443\u044e \u0441\u0441\u044b\u043b\u043a\u0443.</li> </ul> <p>\u0413\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u0430\u044f \u0441\u0441\u044b\u043b\u043a\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u0432 \u0441\u0446\u0435\u043d\u0430\u0440\u0438\u044f\u0445, \u0433\u0434\u0435 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u043d\u0435 \u0431\u044b\u043b \u043f\u0435\u0440\u0435\u0434\u0430\u043d \u044f\u0432\u043d\u043e, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 \u043f\u0440\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0438 <code>@shared_task()</code>.</p>"},{"location":"ru/architecture/integrations/#_4","title":"\u0413\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0439 \u043b\u043e\u0433\u0433\u0435\u0440","text":"<p>\u041f\u043e\u043c\u0438\u043c\u043e \u0441\u0441\u044b\u043b\u043a\u0438 \u043d\u0430 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435, \u0432 QTasks \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 \u0435\u0434\u0438\u043d\u0430\u044f \u0442\u043e\u0447\u043a\u0430 \u0430\u0433\u0440\u0435\u0433\u0430\u0446\u0438\u0438 \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f.</p> <p>\u041f\u0440\u0438 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0432 <code>_set_state()</code> \u0442\u0430\u043a\u0436\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0441\u043e\u0437\u0434\u0430\u043d \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0439 \u043b\u043e\u0433\u0433\u0435\u0440:</p> <ul> <li>\u043e\u043d \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u0442\u0441\u044f \u0432 <code>qtasks._state.logger_main</code>;</li> <li>\u0431\u0430\u0437\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u043d\u0430 \u043a\u043b\u0430\u0441\u0441\u0435 <code>qtasks.logs.Logger</code>.</li> </ul> <p>\u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u043b\u043e\u0433\u0433\u0435\u0440 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c:</p> <pre><code>Logger(\n    name=app.name,\n    subname=\"QueueTasks\",\n    default_level=app.config.logs_default_level_server,\n    format=app.config.logs_format,\n)\n</code></pre> <p>\u0415\u0441\u043b\u0438 \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0439 \u043b\u043e\u0433\u0433\u0435\u0440 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442, \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b \u0438 \u043f\u043b\u0430\u0433\u0438\u043d\u044b, \u0437\u0430\u043f\u0440\u0430\u0448\u0438\u0432\u0430\u044e\u0449\u0438\u0435 \u043b\u043e\u0433\u0433\u0435\u0440, \u043e\u0431\u044f\u0437\u0430\u043d\u044b \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0439 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440 \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435 \u0442\u043e\u0433\u043e \u0436\u0435 \u043a\u043b\u0430\u0441\u0441\u0430.</p> <p>\u0422\u0430\u043a\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c, \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c:</p> <ul> <li>\u0446\u0435\u043d\u0442\u0440\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u043c \u2014 \u043f\u0440\u0438 \u043d\u0430\u043b\u0438\u0447\u0438\u0438 <code>logger_main</code>;</li> <li>\u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u043c \u2014 \u043f\u0440\u0438 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0438\u0438 \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043b\u043e\u0433\u0433\u0435\u0440\u0430.</li> </ul>"},{"location":"ru/architecture/integrations/#_5","title":"\u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u044b\u0435 \u043f\u043e\u0441\u043b\u0435\u0434\u0441\u0442\u0432\u0438\u044f \u0434\u043b\u044f \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0439","text":"<p>\u0422\u0430\u043a\u043e\u0439 \u043f\u043e\u0434\u0445\u043e\u0434 \u043a \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u043e\u043c\u0443 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044e \u0434\u0430\u0451\u0442 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435 \u043f\u0440\u0435\u0438\u043c\u0443\u0449\u0435\u0441\u0442\u0432\u0430:</p> <ul> <li>QTasks \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0432\u0441\u0442\u0440\u043e\u0435\u043d \u0432 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0439 \u043f\u0440\u043e\u0435\u043a\u0442 \u0431\u0435\u0437 \u043a\u043e\u043d\u0444\u043b\u0438\u043a\u0442\u0430 \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0445 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432;</li> <li>\u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f \u0441 \u0444\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a\u0430\u043c\u0438 \u0432\u0440\u043e\u0434\u0435 Django, FastAPI \u0438\u043b\u0438 \u043a\u0430\u0441\u0442\u043e\u043c\u043d\u044b\u043c\u0438 \u0441\u0435\u0440\u0432\u0438\u0441\u0430\u043c\u0438 \u043d\u0435 \u0442\u0440\u0435\u0431\u0443\u0435\u0442 \u043f\u0435\u0440\u0435\u043f\u0438\u0441\u044b\u0432\u0430\u043d\u0438\u044f \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u044b;</li> <li>\u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a \u0441\u0430\u043c \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u0438\u0440\u0443\u0435\u0442, \u0433\u0434\u0435 \u0438 \u043a\u0430\u043a \u0441\u043e\u0437\u0434\u0430\u0451\u0442\u0441\u044f \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0438 \u043b\u043e\u0433\u0433\u0435\u0440;</li> <li>\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u0430 \u0440\u0430\u0431\u043e\u0442\u0430 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u043e\u0432 QTasks \u0432 \u0440\u0430\u043c\u043a\u0430\u0445 \u043e\u0434\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430.</li> </ul>"},{"location":"ru/architecture/integrations/#_6","title":"\u041d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u044d\u0442\u043e\u0433\u043e \u0440\u0430\u0437\u0434\u0435\u043b\u0430","text":"<p>\u042d\u0442\u043e\u0442 \u0440\u0430\u0437\u0434\u0435\u043b \u0437\u0430\u043a\u043b\u0430\u0434\u044b\u0432\u0430\u0435\u0442 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u0443\u044e \u043e\u0441\u043d\u043e\u0432\u0443 \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u043f\u043e\u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0445 \u0441\u0442\u0440\u0430\u043d\u0438\u0446, \u043f\u043e\u0441\u0432\u044f\u0449\u0451\u043d\u043d\u044b\u0445 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u043c \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f\u043c.</p> <p>\u0414\u0430\u043b\u0435\u0435 \u0431\u0443\u0434\u0443\u0442 \u0440\u0430\u0441\u0441\u043c\u043e\u0442\u0440\u0435\u043d\u044b:</p> <ul> <li>\u043e\u0441\u043e\u0431\u0435\u043d\u043d\u043e\u0441\u0442\u0438 \u0432\u0441\u0442\u0440\u0430\u0438\u0432\u0430\u043d\u0438\u044f QTasks \u0432 \u0434\u0440\u0443\u0433\u0438\u0435 \u0444\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a\u0438;</li> <li>\u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0436\u0438\u0437\u043d\u0435\u043d\u043d\u044b\u043c \u0446\u0438\u043a\u043b\u043e\u043c \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0432 \u0441\u0442\u043e\u0440\u043e\u043d\u043d\u0435\u0439 \u0441\u0440\u0435\u0434\u0435;</li> <li>\u0442\u0438\u043f\u043e\u0432\u044b\u0435 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u044b\u0435 \u043f\u0430\u0442\u0442\u0435\u0440\u043d\u044b \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438.</li> </ul> <p>\u0412\u0441\u0435 \u043e\u043d\u0438 \u043e\u043f\u0438\u0440\u0430\u044e\u0442\u0441\u044f \u043d\u0430 \u043f\u0440\u0438\u043d\u0446\u0438\u043f\u044b, \u043e\u043f\u0438\u0441\u0430\u043d\u043d\u044b\u0435 \u043d\u0430 \u044d\u0442\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435.</p>"},{"location":"ru/architecture/integrations/django/","title":"\u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f \u0441 Django","text":"<p>\u042d\u0442\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043e\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u044b\u0435 \u043f\u0440\u0438\u043d\u0446\u0438\u043f\u044b \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438 QTasks \u0441 Django. \u0420\u0435\u0447\u044c \u0438\u0434\u0451\u0442 \u043d\u0435 \u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u043e\u043c API, \u0430 \u043e \u0442\u043e\u043c, \u043a\u0430\u043a QTasks \u0432\u0441\u0442\u0440\u0430\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u0432 \u043c\u043e\u0434\u0435\u043b\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 Django \u0438 \u043a\u0430\u043a\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c \u0437\u0430\u0434\u0430\u0447\u0438 \u0441\u0442\u0430\u043d\u043e\u0432\u044f\u0442\u0441\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u043c\u0438 \u0444\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a\u0443 \u0431\u0435\u0437 \u0436\u0451\u0441\u0442\u043a\u043e\u0439 \u0441\u0432\u044f\u0437\u043a\u0438 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432.</p>"},{"location":"ru/architecture/integrations/django/#django_1","title":"\u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u044b\u0439 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 Django","text":"<p>Django \u043e\u0431\u043b\u0430\u0434\u0430\u0435\u0442 \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0439 \u043c\u043e\u0434\u0435\u043b\u044c\u044e \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f:</p> <ul> <li>\u0441\u043f\u0438\u0441\u043e\u043a \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442\u0441\u044f \u0447\u0435\u0440\u0435\u0437 <code>INSTALLED_APPS</code>;</li> <li>\u043c\u043e\u0434\u0443\u043b\u0438 \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u044e\u0442\u0441\u044f \u043f\u0440\u0438 \u0441\u0442\u0430\u0440\u0442\u0435 Django-\u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430;</li> <li>\u043b\u043e\u0433\u0438\u043a\u0430 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438 \u0441\u0438\u0433\u043d\u0430\u043b\u043e\u0432, \u043c\u043e\u0434\u0435\u043b\u0435\u0439 \u0438 \u0437\u0430\u0434\u0430\u0447 \u0447\u0430\u0441\u0442\u043e \u0437\u0430\u0432\u044f\u0437\u0430\u043d\u0430 \u043d\u0430 \u0444\u0430\u043a\u0442 \u0438\u043c\u043f\u043e\u0440\u0442\u0430 \u043c\u043e\u0434\u0443\u043b\u044f.</li> </ul> <p>\u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f QTasks \u0441 Django \u043e\u043f\u0438\u0440\u0430\u0435\u0442\u0441\u044f \u043d\u0430 \u044d\u0442\u0438 \u043e\u0441\u043e\u0431\u0435\u043d\u043d\u043e\u0441\u0442\u0438 \u0438 \u043d\u0435 \u0442\u0440\u0435\u0431\u0443\u0435\u0442 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u043e\u0433\u043e \u0436\u0438\u0437\u043d\u0435\u043d\u043d\u043e\u0433\u043e \u0446\u0438\u043a\u043b\u0430 Django-\u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f.</p>"},{"location":"ru/architecture/integrations/django/#_1","title":"\u0410\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u043e\u0431\u043d\u0430\u0440\u0443\u0436\u0435\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447","text":"<p>\u0414\u043b\u044f \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438 \u0441 Django \u0432 QTasks \u043f\u0440\u0435\u0434\u0443\u0441\u043c\u043e\u0442\u0440\u0435\u043d \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u0438\u043c\u043f\u043e\u0440\u0442\u0430 \u043c\u043e\u0434\u0443\u043b\u0435\u0439 \u0437\u0430\u0434\u0430\u0447.</p> <pre><code>from qtasks.contrib.django import autodiscover_tasks\n\nautodiscover_tasks(qtasks_app, [\"tasks1\", \"tasks2\"])\n</code></pre> <p>\u042d\u0442\u043e\u0442 \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c \u043f\u0440\u0435\u0434\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d \u0434\u043b\u044f \u0442\u043e\u0433\u043e, \u0447\u0442\u043e\u0431\u044b QTasks \u043c\u043e\u0433 \u043e\u0431\u043d\u0430\u0440\u0443\u0436\u0438\u0442\u044c \u0438 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0438, \u043e\u0431\u044a\u044f\u0432\u043b\u0435\u043d\u043d\u044b\u0435 \u0432\u043d\u0443\u0442\u0440\u0438 Django-\u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439, \u0431\u0435\u0437 \u044f\u0432\u043d\u043e\u0433\u043e \u0438\u043c\u043f\u043e\u0440\u0442\u0430 \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u043c\u043e\u0434\u0443\u043b\u044f \u0432\u0440\u0443\u0447\u043d\u0443\u044e.</p>"},{"location":"ru/architecture/integrations/django/#autodiscover_tasks","title":"\u041f\u0440\u0438\u043d\u0446\u0438\u043f \u0440\u0430\u0431\u043e\u0442\u044b autodiscover_tasks","text":"<p>\u0424\u0443\u043d\u043a\u0446\u0438\u044f <code>autodiscover_tasks</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u044b\u0439 \u043f\u0440\u0438\u043d\u0446\u0438\u043f Django: \u0432\u0441\u0435 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f, \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0435 \u0432 <code>INSTALLED_APPS</code>, \u0443\u0436\u0435 \u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b \u0441\u0438\u0441\u0442\u0435\u043c\u0435.</p> <p>\u041d\u0430 \u0432\u044b\u0441\u043e\u043a\u043e\u043c \u0443\u0440\u043e\u0432\u043d\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u0432\u044b\u0433\u043b\u044f\u0434\u0438\u0442 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c:</p> <ol> <li>\u041f\u043e\u043b\u0443\u0447\u0430\u0435\u0442\u0441\u044f \u0441\u043f\u0438\u0441\u043e\u043a Django-\u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439 \u0438\u0437 <code>INSTALLED_APPS</code>.</li> <li>\u0414\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f \u043f\u043e\u043f\u044b\u0442\u043a\u0430 \u0438\u043c\u043f\u043e\u0440\u0442\u0430 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0445 \u043c\u043e\u0434\u0443\u043b\u0435\u0439.</li> <li>\u041f\u0440\u0438 \u0443\u0441\u043f\u0435\u0448\u043d\u043e\u043c \u0438\u043c\u043f\u043e\u0440\u0442\u0435 \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u043a\u043e\u0434\u0430 \u043c\u043e\u0434\u0443\u043b\u044f.</li> <li>\u0417\u0430\u0434\u0430\u0447\u0438, \u043e\u0431\u044a\u044f\u0432\u043b\u0435\u043d\u043d\u044b\u0435 \u0432 \u044d\u0442\u0438\u0445 \u043c\u043e\u0434\u0443\u043b\u044f\u0445, \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u0443\u044e\u0442\u0441\u044f \u0432 \u043f\u0435\u0440\u0435\u0434\u0430\u043d\u043d\u043e\u043c \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0435 <code>QueueTasks</code>.</li> </ol> <p>\u041a\u043b\u044e\u0447\u0435\u0432\u043e\u0439 \u043c\u043e\u043c\u0435\u043d\u0442: QTasks \u043d\u0435 \u0432\u043c\u0435\u0448\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u0432 \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438 \u0437\u0430\u0434\u0430\u0447. \u041e\u043d \u043b\u0438\u0448\u044c \u0433\u0430\u0440\u0430\u043d\u0442\u0438\u0440\u0443\u0435\u0442, \u0447\u0442\u043e \u043c\u043e\u0434\u0443\u043b\u0438 \u0431\u0443\u0434\u0443\u0442 \u0438\u043c\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u044b.</p>"},{"location":"ru/architecture/integrations/django/#autodiscover_tasks_1","title":"\u041a\u043e\u043d\u0442\u0440\u0430\u043a\u0442 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 autodiscover_tasks","text":"<p>\u0421\u0438\u0433\u043d\u0430\u0442\u0443\u0440\u0430 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u0432\u044b\u0433\u043b\u044f\u0434\u0438\u0442 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c:</p> <pre><code>def autodiscover_tasks(app, modules: Optional[list[str]] = None):\n    \"\"\"\u0410\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0438\u043c\u043f\u043e\u0440\u0442\u0438\u0440\u0443\u0435\u0442 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0435 \u043c\u043e\u0434\u0443\u043b\u0438 \u0438\u0437 \u0432\u0441\u0435\u0445 INSTALLED_APPS,\n    \u0447\u0442\u043e\u0431\u044b \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0438 \u0432 QTasks.\n\n    Args:\n        app (QueueTasks): \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435.\n        modules (List[str]): \u043c\u043e\u0434\u0443\u043b\u0438 \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u0434\u0438\u0441\u043a\u0430\u0432\u0435\u0440\u0438.\n            \u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e: [\"tasks\"].\n    \"\"\"\n</code></pre> <p>\u0421 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u043e\u0439 \u0442\u043e\u0447\u043a\u0438 \u0437\u0440\u0435\u043d\u0438\u044f \u0432\u0430\u0436\u043d\u043e \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u0435:</p> <ul> <li><code>app</code> \u043f\u0435\u0440\u0435\u0434\u0430\u0451\u0442\u0441\u044f \u044f\u0432\u043d\u043e \u2014 \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f \u043d\u0435 \u043f\u043e\u043b\u0430\u0433\u0430\u0435\u0442\u0441\u044f \u043d\u0430 \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435;</li> <li>\u0441\u043f\u0438\u0441\u043e\u043a \u043c\u043e\u0434\u0443\u043b\u0435\u0439 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0438\u0440\u0443\u0435\u043c \u0438 \u043d\u0435 \u0437\u0430\u0448\u0438\u0442 \u0436\u0451\u0441\u0442\u043a\u043e;</li> <li>\u0444\u0443\u043d\u043a\u0446\u0438\u044f \u043d\u0435 \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u0438 \u043d\u0435 \u0432\u043b\u0438\u044f\u0435\u0442 \u043d\u0430 \u0436\u0438\u0437\u043d\u0435\u043d\u043d\u044b\u0439 \u0446\u0438\u043a\u043b \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f.</li> </ul>"},{"location":"ru/architecture/integrations/django/#_2","title":"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u0437\u0430\u0434\u0430\u0447","text":"<p>\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u0437\u0430\u0434\u0430\u0447 \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u043c \u0434\u043b\u044f QTasks \u0441\u043f\u043e\u0441\u043e\u0431\u043e\u043c:</p> <ul> <li>\u043f\u0440\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0438 \u0434\u0435\u043a\u043e\u0440\u0430\u0442\u043e\u0440\u0430 <code>@app.task</code>;</li> <li>\u043f\u0440\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0438 \u0440\u043e\u0443\u0442\u0435\u0440\u043e\u0432, \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0451\u043d\u043d\u044b\u0445 \u043a <code>app</code>.</li> </ul> <p><code>autodiscover_tasks</code> \u043b\u0438\u0448\u044c \u0433\u0430\u0440\u0430\u043d\u0442\u0438\u0440\u0443\u0435\u0442, \u0447\u0442\u043e \u043a\u043e\u0434 \u0441 \u043e\u0431\u044a\u044f\u0432\u043b\u0435\u043d\u0438\u044f\u043c\u0438 \u0431\u0443\u0434\u0435\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d \u0432 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u043c\u043e\u043c\u0435\u043d\u0442 \u0432\u0440\u0435\u043c\u0435\u043d\u0438.</p> <p>\u0422\u0430\u043a\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c:</p> <ul> <li>Django \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u043e\u0439 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439;</li> <li>QTasks \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0435\u0439 \u0437\u0430\u0434\u0430\u0447;</li> <li>\u0442\u043e\u0447\u043a\u043e\u0439 \u0441\u043e\u043f\u0440\u0438\u043a\u043e\u0441\u043d\u043e\u0432\u0435\u043d\u0438\u044f \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c \u0438\u043c\u043f\u043e\u0440\u0442\u0430 \u043c\u043e\u0434\u0443\u043b\u0435\u0439.</li> </ul>"},{"location":"ru/architecture/integrations/django/#_3","title":"\u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u044b\u0435 \u043f\u0440\u0435\u0438\u043c\u0443\u0449\u0435\u0441\u0442\u0432\u0430 \u043f\u043e\u0434\u0445\u043e\u0434\u0430","text":"<p>\u0422\u0430\u043a\u043e\u0439 \u0441\u043f\u043e\u0441\u043e\u0431 \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438 \u0434\u0430\u0451\u0442 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0432\u0430\u0436\u043d\u044b\u0445 \u043f\u0440\u0435\u0438\u043c\u0443\u0449\u0435\u0441\u0442\u0432:</p> <ul> <li>\u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0438\u0435 \u0436\u0451\u0441\u0442\u043a\u043e\u0439 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 QTasks \u043e\u0442 Django;</li> <li>\u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u043e\u0439 \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b Django-\u043f\u0440\u043e\u0435\u043a\u0442\u043e\u0432;</li> <li>\u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0438\u0435 \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0445 \u043f\u043e\u0431\u043e\u0447\u043d\u044b\u0445 \u044d\u0444\u0444\u0435\u043a\u0442\u043e\u0432;</li> <li>\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u043e\u0432 QTasks.</li> </ul> <p>\u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f \u043e\u0441\u0442\u0430\u0451\u0442\u0441\u044f \u0442\u043e\u043d\u043a\u0438\u043c \u0441\u043b\u043e\u0435\u043c \u043c\u0435\u0436\u0434\u0443 \u0441\u0438\u0441\u0442\u0435\u043c\u0430\u043c\u0438, \u0430 \u043d\u0435 \u043f\u043e\u043f\u044b\u0442\u043a\u043e\u0439 \u043e\u0431\u044a\u0435\u0434\u0438\u043d\u0438\u0442\u044c \u0438\u0445 \u0436\u0438\u0437\u043d\u0435\u043d\u043d\u044b\u0435 \u0446\u0438\u043a\u043b\u044b.</p>"},{"location":"ru/architecture/integrations/django/#_4","title":"\u0413\u0440\u0430\u043d\u0438\u0446\u044b \u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0441\u0442\u0438","text":"<ul> <li>Django \u043e\u0442\u0432\u0435\u0447\u0430\u0435\u0442 \u0437\u0430 \u043e\u0431\u043d\u0430\u0440\u0443\u0436\u0435\u043d\u0438\u0435 \u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0443 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439;</li> <li><code>autodiscover_tasks</code> \u043e\u0442\u0432\u0435\u0447\u0430\u0435\u0442 \u0437\u0430 \u0438\u043c\u043f\u043e\u0440\u0442 \u043c\u043e\u0434\u0443\u043b\u0435\u0439 \u0437\u0430\u0434\u0430\u0447;</li> <li>QTasks \u043e\u0442\u0432\u0435\u0447\u0430\u0435\u0442 \u0437\u0430 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044e \u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447.</li> </ul> <p>\u0421\u043e\u0431\u043b\u044e\u0434\u0435\u043d\u0438\u0435 \u044d\u0442\u0438\u0445 \u0433\u0440\u0430\u043d\u0438\u0446 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c QTasks \u0432 Django-\u043f\u0440\u043e\u0435\u043a\u0442\u0430\u0445 \u0431\u0435\u0437 \u043d\u0430\u0440\u0443\u0448\u0435\u043d\u0438\u044f \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u044b \u043e\u0431\u0435\u0438\u0445 \u0441\u0438\u0441\u0442\u0435\u043c.</p>"},{"location":"ru/examples/","title":"\u041f\u0440\u0438\u043c\u0435\u0440\u044b","text":"<p>\u041d\u0430 \u044d\u0442\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435 \u043f\u0440\u0438\u0432\u0435\u0434\u0435\u043d\u044b \u0431\u0430\u0437\u043e\u0432\u044b\u0435 \u043f\u0440\u0438\u043c\u0435\u0440\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f QTasks. \u041e\u043d\u0438 \u043f\u043e\u043c\u043e\u0433\u0443\u0442 \u0431\u044b\u0441\u0442\u0440\u043e \u043e\u0441\u0432\u043e\u0438\u0442\u044c \u043e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u0441\u0446\u0435\u043d\u0430\u0440\u0438\u0438 \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u0437\u0430\u0434\u0430\u0447\u0430\u043c\u0438.</p>"},{"location":"ru/examples/#_2","title":"\u041f\u0440\u043e\u0441\u0442\u043e\u0439 \u043f\u0440\u0438\u043c\u0435\u0440 \u0437\u0430\u0434\u0430\u0447\u0438 (\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e)","text":"<p>\u0417\u0430\u0434\u0430\u0447\u0430 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0435\u0442 \u0441\u0442\u0440\u043e\u043a\u0443, \u0432\u044b\u0432\u043e\u0434\u0438\u0442 \u0435\u0451 \u0432 \u043a\u043e\u043d\u0441\u043e\u043b\u044c \u0438 \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u043e\u0431\u0440\u0430\u0442\u043d\u043e.</p> <pre><code>from qtasks import QueueTasks\n\napp = QueueTasks()\n\n\n@app.task(name=\"print_text\")\ndef print_text(text: str):\n    print(text)\n    return text\n\n\nif __name__ == \"__main__\":\n    app.run_forever()\n\n    # \u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447\u0438 \u0432 \u043e\u0447\u0435\u0440\u0435\u0434\u044c\n    app.add_task(\"print_text\", \"\u041f\u0440\u0438\u0432\u0435\u0442, \u043c\u0438\u0440!\")\n    # \u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442: \"\u041f\u0440\u0438\u0432\u0435\u0442, \u043c\u0438\u0440!\"\n</code></pre> <p>\u041f\u0440\u0438 \u043e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u0438 \u043a \u0437\u0430\u0434\u0430\u0447\u0435 \u0447\u0435\u0440\u0435\u0437 \u0441\u0430\u043c\u0443 \u0444\u0443\u043d\u043a\u0446\u0438\u044e (task_func) \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 <code>task_name</code> \u043c\u043e\u0436\u043d\u043e \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u044f\u0432\u043d\u043e, \u0435\u0441\u043b\u0438 \u043d\u0443\u0436\u043d\u043e \u043f\u0435\u0440\u0435\u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u0442\u044c \u0438\u043c\u044f:</p> <pre><code>print_text.add_task(\"\u041f\u0440\u0438\u0432\u0435\u0442, \u043c\u0438\u0440!\")              # task_name = \"print_text\"\nprint_text.add_task(task_name=\"echo_text\")       # task_name = \"echo_text\"\n</code></pre>"},{"location":"ru/examples/#_3","title":"\u0410\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u0430\u044f \u0437\u0430\u0434\u0430\u0447\u0430","text":"<p>\u0410\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u0430\u044f \u0437\u0430\u0434\u0430\u0447\u0430, \u0438\u043c\u0438\u0442\u0438\u0440\u0443\u044e\u0449\u0430\u044f \u0437\u0430\u0434\u0435\u0440\u0436\u043a\u0443 \u0438 \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u044e\u0449\u0430\u044f \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442.</p> <pre><code>import asyncio\nfrom qtasks.asyncio import QueueTasks\n\napp = QueueTasks()\n\n\n@app.task(name=\"async_task\")\nasync def async_task(text: str):\n    await asyncio.sleep(2)\n    print(f\"\u0417\u0430\u0434\u0430\u0447\u0430 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430: {text}\")\n    return text\n\n\nif __name__ == \"__main__\":\n    app.run_forever()\n\n    # \u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e\u0439 \u0437\u0430\u0434\u0430\u0447\u0438\n    asyncio.run(app.add_task(\"async_task\", \"\u0410\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0439 \u043f\u0440\u0438\u043c\u0435\u0440\"))\n    # \u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442: \"\u0417\u0430\u0434\u0430\u0447\u0430 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430: \u0410\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0439 \u043f\u0440\u0438\u043c\u0435\u0440\"\n</code></pre>"},{"location":"ru/examples/#redis","title":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 Redis (\u0431\u0440\u043e\u043a\u0435\u0440 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e)","text":"<p>\u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e QTasks \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 Redis. \u041c\u043e\u0436\u043d\u043e \u044f\u0432\u043d\u043e \u0443\u043a\u0430\u0437\u0430\u0442\u044c URL:</p> <pre><code>from qtasks import QueueTasks\n\napp = QueueTasks(broker_url=\"redis://localhost:6379/0\")\n\n\n@app.task(name=\"redis_example\")\ndef redis_example(value: int):\n    print(f\"\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435: {value}\")\n    return value\n\n\nif __name__ == \"__main__\":\n    app.run_forever()\n\n    app.add_task(\"redis_example\", 42)\n    # \u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442: \"\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435: 42\"\n</code></pre>"},{"location":"ru/examples/#rabbitmq","title":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 RabbitMQ \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0431\u0440\u043e\u043a\u0435\u0440\u0430","text":"<p>\u041f\u0440\u0438\u043c\u0435\u0440 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 RabbitMQ:</p> <pre><code>pip install qtasks[rabbitmq]\n</code></pre> <pre><code>import asyncio\nfrom qtasks.asyncio import QueueTasks\nfrom qtasks.brokers import AsyncRabbitMQBroker\n\n\nbroker = AsyncRabbitMQBroker(url=\"amqp://guest:guest@localhost/\")\napp = QueueTasks(broker=broker)\n\n\n@app.task(name=\"rabbitmq_example\")\nasync def rabbitmq_example(text: str):\n    print(f\"\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u043e \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435: {text}\")\n    return text\n\n\nif __name__ == \"__main__\":\n    app.run_forever()\n\n    asyncio.run(app.add_task(\"rabbitmq_example\", \"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u0447\u0435\u0440\u0435\u0437 RabbitMQ\"))\n    # \u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442: \"\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u043e \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435: \u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u0447\u0435\u0440\u0435\u0437 RabbitMQ\"\n</code></pre>"},{"location":"ru/examples/#_4","title":"\u0427\u0442\u043e \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0434\u0430\u043b\u044c\u0448\u0435","text":"<p>\u0414\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u0440\u0438\u043c\u0435\u0440\u044b \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b \u0432 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0445 \u0440\u0430\u0437\u0434\u0435\u043b\u0430\u0445:</p> <ul> <li>\u0417\u0430\u0434\u0430\u0447\u0438 \u0438 \u0438\u0445 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u2014 \u0441\u043c. \u0440\u0430\u0437\u0434\u0435\u043b: <code>[\u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u0437\u0430\u0434\u0430\u0447](features.md)</code></li> <li>\u041f\u043b\u0430\u0433\u0438\u043d\u044b \u2014 \u0441\u043c. \u0440\u0430\u0437\u0434\u0435\u043b: <code>[\u041a\u0430\u043a \u043f\u0438\u0441\u0430\u0442\u044c \u043f\u043b\u0430\u0433\u0438\u043d\u044b](plugins.md)</code></li> <li>\u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438 \u2014 \u0441\u043c. \u0440\u0430\u0437\u0434\u0435\u043b: <code>[\u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f QTasks](integrations/index.md)</code></li> <li>\u0410\u043d\u0430\u043b\u0438\u0442\u0438\u043a\u0430 \u0438 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u2014 \u0441\u043c. \u0440\u0430\u0437\u0434\u0435\u043b: <code>[\u0410\u043d\u0430\u043b\u0438\u0442\u0438\u043a\u0430](analytics.md)</code></li> </ul>"},{"location":"ru/examples/analytics/","title":"\u041f\u0440\u0438\u043c\u0435\u0440\u044b \u2192 \u0410\u043d\u0430\u043b\u0438\u0442\u0438\u043a\u0430","text":"<p>\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 (A)syncStats \u043e\u0442\u0432\u0435\u0447\u0430\u0435\u0442 \u0437\u0430 \u0441\u0431\u043e\u0440 \u0438 \u0444\u043e\u0440\u043c\u0430\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0439 \u0432\u044b\u0432\u043e\u0434 \u0434\u0438\u0430\u0433\u043d\u043e\u0441\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0439 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043f\u043e \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044e <code>QTasks</code> \u0438 \u0435\u0433\u043e \u0437\u0430\u0434\u0430\u0447\u0430\u043c. \u041e\u043d \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u043e\u043c <code>QueueTasks</code> \u0438 \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u043d\u0430\u0431\u043e\u0440 \u043c\u0435\u0442\u043e\u0434\u043e\u0432 \u0434\u043b\u044f \u0438\u043d\u0442\u0440\u043e\u0441\u043f\u0435\u043a\u0446\u0438\u0438. \u0421\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u0430\u044f \u0432\u0435\u0440\u0441\u0438\u044f \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0438\u043d\u0442\u0435\u0433\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0430 \u0432 CLI \u043a\u0430\u043a \u043a\u043e\u043c\u0430\u043d\u0434\u0430 <code>qtasks stats</code>.</p>"},{"location":"ru/examples/analytics/#_2","title":"\ud83d\ude80 \u0413\u0434\u0435 \u044d\u0442\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f","text":"<ul> <li>\u041f\u0440\u044f\u043c\u043e \u0438\u0437 \u043a\u043e\u0434\u0430: \u0441\u043e\u0437\u0434\u0430\u0451\u0442\u0441\u044f \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440 <code>(A)syncStats</code> \u0438 \u0432\u044b\u0437\u044b\u0432\u0430\u044e\u0442\u0441\u044f \u043c\u0435\u0442\u043e\u0434\u044b \u0430\u043d\u0430\u043b\u0438\u0437\u0430.</li> <li>\u0427\u0435\u0440\u0435\u0437 CLI: \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u0430\u044f \u0432\u0435\u0440\u0441\u0438\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u0430 \u043a\u0430\u043a <code>qtasks stats</code>.</li> </ul> <p>\u041f\u0440\u0438\u043c\u0435\u0440 \u043a\u043e\u043c\u0430\u043d\u0434\u044b (\u0434\u043b\u044f \u043e\u0440\u0438\u0435\u043d\u0442\u0438\u0440\u0430):</p> <pre><code>qtasks stats inspect tasks my_task json=true\n</code></pre> <p>\u042d\u0442\u0430 \u043a\u043e\u043c\u0430\u043d\u0434\u0430 \u0432\u044b\u0432\u0435\u0434\u0435\u0442 \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0443 \u0441 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435\u043c \u0437\u0430\u0434\u0430\u0447 (\u0432 JSON \u043f\u0440\u0438 <code>json=true</code>).</p>"},{"location":"ru/examples/analytics/#inspect","title":"\ud83d\udd0e <code>inspect()</code>","text":"<p>\u041c\u0435\u0442\u043e\u0434 <code>inspect()</code> \u0441\u043e\u0437\u0434\u0430\u0451\u0442 \u043e\u0431\u044a\u0435\u043a\u0442 <code>InspectStats</code>, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u0434\u043b\u044f \u0434\u0435\u0442\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043e\u0441\u043c\u043e\u0442\u0440\u0430:</p> <ul> <li><code>app(json: bool = False)</code> \u2014 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0441\u0430\u043c\u043e\u043c \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0438</li> <li><code>task(task_name: str, json: bool = False)</code> \u2014 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0439 \u0437\u0430\u0434\u0430\u0447\u0435</li> <li><code>tasks(*tasks: Tuple[str], json: bool = False)</code> \u2014 \u0441\u0432\u043e\u0434\u043a\u0430 \u043f\u043e \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u043c \u0437\u0430\u0434\u0430\u0447\u0430\u043c \u0438\u043b\u0438 \u043f\u043e \u0432\u0441\u0435\u043c</li> </ul> <p>\u0412\u0441\u0435 \u044d\u0442\u0438 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u044e\u0442 \u0434\u0432\u0430 \u0444\u043e\u0440\u043c\u0430\u0442\u0430 \u0432\u044b\u0432\u043e\u0434\u0430:</p> <ul> <li>\u0422\u0435\u043a\u0441\u0442\u043e\u0432\u044b\u0439 (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e): \u0432\u044b\u0440\u043e\u0432\u043d\u0435\u043d\u043d\u044b\u0435 \u043a\u043e\u043b\u043e\u043d\u043a\u0438 + \u0440\u0430\u0437\u0434\u0435\u043b\u0438\u0442\u0435\u043b\u0438</li> <li>JSON (<code>json=True</code>): \u0441\u0435\u0440\u0438\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u0430\u044f \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430, \u0443\u0434\u043e\u0431\u043d\u0430\u044f \u0434\u043b\u044f \u043f\u0430\u0440\u0441\u0438\u043d\u0433\u0430 \u0438 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0437\u0430\u0446\u0438\u0438</li> </ul>"},{"location":"ru/examples/analytics/#appjson-bool-false","title":"\ud83e\udded <code>app(json: bool = False)</code> \u2014 \u0441\u0432\u043e\u0434\u043a\u0430 \u043f\u043e \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044e","text":"<p>\u0427\u0442\u043e \u0432\u044b\u0432\u043e\u0434\u0438\u0442\u0441\u044f \u0432 \u0442\u0435\u043a\u0441\u0442\u043e\u0432\u043e\u043c \u0440\u0435\u0436\u0438\u043c\u0435:</p> <ul> <li>\u0418\u043c\u044f \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f</li> <li>\u041c\u0435\u0442\u043e\u0434 \u0437\u0430\u043f\u0443\u0441\u043a\u0430</li> <li>\u0412\u0435\u0440\u0441\u0438\u044f <code>QTasks</code></li> <li>\u0422\u0435\u043a\u0443\u0449\u0430\u044f \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f (\u043a\u0430\u043a \u0441\u0442\u0440\u043e\u043a\u0430)</li> <li>\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u0437\u0430\u0434\u0430\u0447 \u0438 \u0440\u043e\u0443\u0442\u0435\u0440\u043e\u0432</li> <li>\u041e\u0431\u0449\u0435\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0451\u043d\u043d\u044b\u0445 \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432 (\u0441\u0443\u043c\u043c\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u043f\u043e \u044f\u0434\u0440\u0443, \u0431\u0440\u043e\u043a\u0435\u0440\u0443, \u0432\u043e\u0440\u043a\u0435\u0440\u0443, \u0441\u0442\u0430\u0440\u0442\u0435\u0440\u0443, \u0441\u0442\u043e\u0440\u0438\u0434\u0436\u0443 \u0438 \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u043e\u0439 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438)</li> <li>\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0439 (\u0441\u043e\u0431\u044b\u0442\u0438\u0439 <code>on</code>)</li> <li>\u041a\u043b\u0430\u0441\u0441\u044b \u0437\u0430\u0434\u0435\u0439\u0441\u0442\u0432\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432: \u0411\u0440\u043e\u043a\u0435\u0440, \u0412\u043e\u0440\u043a\u0435\u0440, \u0421\u0442\u0430\u0440\u0442\u0435\u0440 (\u0438\u043b\u0438 <code>\u2014</code>), \u0425\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435, GlobalConfig (\u0438\u043b\u0438 <code>\u2014</code>), \u041b\u043e\u0433\u0435\u0440</li> </ul> <p>\u0424\u043e\u0440\u043c\u0430\u0442 \u2014 \u0431\u043b\u043e\u0447\u043d\u044b\u0439, \u0441 \u0432\u044b\u0440\u0430\u0432\u043d\u0438\u0432\u0430\u043d\u0438\u0435\u043c \u043c\u0435\u0442\u043e\u043a \u043f\u043e \u0448\u0438\u0440\u0438\u043d\u0435 \u0438 \u0433\u043e\u0440\u0438\u0437\u043e\u043d\u0442\u0430\u043b\u044c\u043d\u043e\u0439 \u043b\u0438\u043d\u0438\u0435\u0439-\u0440\u0430\u0437\u0434\u0435\u043b\u0438\u0442\u0435\u043b\u0435\u043c. \u041f\u0440\u0438\u043c\u0435\u0440 \u0444\u043e\u0440\u043c\u044b (\u0434\u0430\u043d\u043d\u044b\u0435 \u0443\u0441\u043b\u043e\u0432\u043d\u044b\u0435):</p> <pre><code>\u0418\u043c\u044f                       : QueueTasks\n\u041c\u0435\u0442\u043e\u0434                     : async\n\u0412\u0435\u0440\u0441\u0438\u044f                    : 1.6.0\n\u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f              : QueueConfig(max_tasks_process=10,\nrunning_older_tasks=True, delete_finished_tasks=True, default_task_priority=0,\nlogs_default_level_server=20, logs_default_level_client=20,\nlogs_format='%(asctime)s [%(name)s: %(levelname)s] (%(subname)s) %(message)s',\nresult_time_interval=0.1, result_statuses_end=['success', 'error', 'cancel'])\n\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0437\u0430\u0434\u0430\u0447          : 14\n\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0440\u043e\u0443\u0442\u0435\u0440\u043e\u0432       : 1\n\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432       : 3\n\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0439  : 0\n\u0411\u0440\u043e\u043a\u0435\u0440                    : AsyncRedisBroker\n\u0412\u043e\u0440\u043a\u0435\u0440                    : AsyncWorker\n\u0421\u0442\u0430\u0440\u0442\u0435\u0440                   : \u2014\n\u0425\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435                 : AsyncRedisStorage\nGlobalConfig              : AsyncRedisGlobalConfig\n\u041b\u043e\u0433                       : Logger\n--------------------------------------------------\n</code></pre> <p>\u041f\u0440\u0438 <code>json=True</code> \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442\u0441\u044f JSON-\u043e\u0431\u044a\u0435\u043a\u0442 \u0441 \u0442\u0435\u043c\u0438 \u0436\u0435 \u043a\u043b\u044e\u0447\u0430\u043c\u0438 \u0438 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f\u043c\u0438.</p>"},{"location":"ru/examples/analytics/#tasktask_name-json-bool-false","title":"\ud83e\udde9 <code>task(task_name, json: bool = False)</code> \u2014 \u0434\u0435\u0442\u0430\u043b\u044c\u043d\u043e \u043e \u0437\u0430\u0434\u0430\u0447\u0435","text":"<p>\u0427\u0442\u043e \u0432\u044b\u0432\u043e\u0434\u0438\u0442\u0441\u044f \u0432 \u0442\u0435\u043a\u0441\u0442\u043e\u0432\u043e\u043c \u0440\u0435\u0436\u0438\u043c\u0435: \u043e\u0434\u0438\u043d \u0431\u043b\u043e\u043a \u043f\u043e \u0437\u0430\u0434\u0430\u0447\u0435 \u0441 \u043f\u043e\u043b\u044f\u043c\u0438:</p> <ul> <li>\u0418\u043c\u044f \u0437\u0430\u0434\u0430\u0447\u0438</li> <li>\u041f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442</li> <li>\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 (\u0438\u043b\u0438 <code>\u2014</code>)</li> <li>\u0422\u0435\u0433\u0438 (\u0441\u043f\u0438\u0441\u043a\u043e\u043c \u0447\u0435\u0440\u0435\u0437 \u0437\u0430\u043f\u044f\u0442\u0443\u044e \u0438\u043b\u0438 <code>\u2014</code>)</li> <li>\u0410\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e\u0441\u0442\u044c (\u0444\u043b\u0430\u0433 \u00abawaiting\u00bb)</li> <li>\u0413\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f (<code>yield</code>-\u0440\u0435\u0436\u0438\u043c, \u0444\u043b\u0430\u0433 \u00abgenerating\u00bb)</li> <li>\u00abSelf \u043f\u0435\u0440\u0435\u0434 \u0437\u0430\u0434\u0430\u0447\u0435\u0439\u00bb (<code>echo</code>)</li> <li>\u0421\u0438\u0433\u043d\u0430\u0442\u0443\u0440\u0430 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u043e\u0432: <code>Args</code> (\u043f\u043e\u0437\u0438\u0446\u0438\u043e\u043d\u043d\u044b\u0435) \u0438 <code>Kwargs</code> (\u043a\u043b\u044e\u0447\u0435\u0432\u044b\u0435 \u0441 \u0434\u0435\u0444\u043e\u043b\u0442\u0430\u043c\u0438)</li> </ul> <p>\u0423\u0441\u043b\u043e\u0432\u043d\u044b\u0435 \u043f\u043e\u043b\u044f, \u0435\u0441\u043b\u0438 \u0437\u0430\u0434\u0430\u043d\u044b \u0432 \u0437\u0430\u0434\u0430\u0447\u0435:</p> <ul> <li><code>\u041f\u043e\u0432\u0442\u043e\u0440\u043e\u0432</code> (retry)</li> <li><code>\u0418\u0441\u043a\u043b. \u0434\u043b\u044f \u043f\u043e\u0432\u0442\u043e\u0440\u043e\u0432</code> (<code>retry_on_exc</code>, \u043a\u0440\u0430\u0441\u0438\u0432\u043e \u0444\u043e\u0440\u043c\u0430\u0442\u0438\u0440\u0443\u0435\u0442\u0441\u044f)</li> <li><code>\u0414\u0435\u043a\u043e\u0434\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435</code> (<code>decode</code>)</li> <li><code>\u0413\u0435\u043d\u0435\u0440\u0430\u0442\u043e\u0440</code> (<code>generate_handler</code>)</li> <li><code>\u0418\u0441\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c</code> (<code>executor</code>)</li> <li><code>\u041c\u0438\u0434\u043b\u0432\u0430\u0440\u0438 \u0434\u043e</code> / <code>\u041c\u0438\u0434\u043b\u0432\u0430\u0440\u0438 \u043f\u043e\u0441\u043b\u0435</code></li> <li><code>\u0414\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u043e</code> \u2014 \u043c\u043d\u043e\u0433\u043e\u0441\u0442\u0440\u043e\u0447\u043d\u044b\u0439 \u0440\u0430\u0437\u0434\u0435\u043b, \u0433\u0434\u0435 \u043a\u0430\u0436\u0434\u0430\u044f \u043f\u0430\u0440\u0430 \u043a\u043b\u044e\u0447-\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0432\u044b\u0432\u043e\u0434\u0438\u0442\u0441\u044f \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u043e\u0439 \u0441\u0442\u0440\u043e\u043a\u043e\u0439 \u0441 \u043c\u0430\u0440\u043a\u0435\u0440\u043e\u043c <code>*</code></li> </ul> <p>\u041f\u0440\u0438\u043c\u0435\u0440 \u0444\u043e\u0440\u043c\u044b (\u0434\u0430\u043d\u043d\u044b\u0435 \u0443\u0441\u043b\u043e\u0432\u043d\u044b\u0435):</p> <pre><code>\u0418\u043c\u044f \u0437\u0430\u0434\u0430\u0447\u0438              : send_email\n\u041f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442               : 0\n\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435                : \u0420\u0430\u0441\u0441\u044b\u043b\u043a\u0430 \u043f\u0438\u0441\u0435\u043c\n\u0422\u0435\u0433\u0438                    : email, marketing\n\u0410\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e\u0441\u0442\u044c           : True\n\u0413\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f               : False\nSelf \u043f\u0435\u0440\u0435\u0434 \u0437\u0430\u0434\u0430\u0447\u0435\u0439      : False\nArgs                    : recipient: str, subject: str\nKwargs                  : retries: int=3, timeout: int=30\n\u041f\u043e\u0432\u0442\u043e\u0440\u043e\u0432                : 3\n\u0418\u0441\u043a\u043b. \u0434\u043b\u044f \u043f\u043e\u0432\u0442\u043e\u0440\u043e\u0432      : [&lt;class 'KeyError'&gt;]\n\u041c\u0438\u0434\u043b\u0432\u0430\u0440\u0438 \u0434\u043e             : [&lt;class 'AuthMiddleware'&gt;]\n\u041c\u0438\u0434\u043b\u0432\u0430\u0440\u0438 \u043f\u043e\u0441\u043b\u0435          : [&lt;class 'MetricsMiddleware'&gt;]\n\u0414\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u043e           :\n * concurrency: 5\n * queue: high\n--------------------------------------------------\n</code></pre> <p>\u041f\u0440\u0438 <code>json=True</code> \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442\u0441\u044f \u043e\u0431\u044a\u0435\u043a\u0442 \u0441 \u0442\u0435\u043c\u0438 \u0436\u0435 \u0434\u0430\u043d\u043d\u044b\u043c\u0438 (\u043a\u043b\u044e\u0447\u0438 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0442 \u043c\u0435\u0442\u043a\u0430\u043c \u0432\u044b\u0448\u0435).</p> <p>\u0415\u0441\u043b\u0438 \u0437\u0430\u0434\u0430\u0447\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430 \u2014 \u0432\u044b\u0432\u043e\u0434\u0438\u0442\u0441\u044f \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0435\u0435 \u0434\u0438\u0430\u0433\u043d\u043e\u0441\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 (\u0442\u0435\u043a\u0441\u0442), \u0430 \u043f\u0440\u0438 <code>json=True</code> \u2014 \u043f\u0443\u0441\u0442\u0430\u044f \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u0438\u043b\u0438 \u043e\u043f\u0438\u0441\u0430\u0442\u0435\u043b\u044c\u043d\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430 (\u0432 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442 \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 CLI/\u043e\u0431\u0451\u0440\u0442\u043a\u0438).</p>"},{"location":"ru/examples/analytics/#taskstasks-json-bool-false","title":"\ud83d\udcda <code>tasks(*tasks, json: bool = False)</code> \u2014 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0438\u043b\u0438 \u0432\u0441\u0435 \u0437\u0430\u0434\u0430\u0447\u0438","text":"<p>\u041f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u0435 \u0430\u043d\u0430\u043b\u043e\u0433\u0438\u0447\u043d\u043e <code>task(...)</code>, \u043d\u043e \u0434\u043b\u044f \u043d\u0430\u0431\u043e\u0440\u0430 \u0437\u0430\u0434\u0430\u0447:</p> <ul> <li>\u0415\u0441\u043b\u0438 \u0438\u043c\u0435\u043d\u0430 \u0437\u0430\u0434\u0430\u0447 \u043f\u0435\u0440\u0435\u0434\u0430\u043d\u044b \u2014 \u0432\u044b\u0432\u043e\u0434\u044f\u0442\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u043e\u043d\u0438, \u0432 \u043f\u043e\u0440\u044f\u0434\u043a\u0435 \u043f\u0435\u0440\u0435\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u044f</li> <li>\u0415\u0441\u043b\u0438 \u043d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u043f\u0435\u0440\u0435\u0434\u0430\u043d\u043e \u2014 \u0432\u044b\u0432\u043e\u0434\u0438\u0442\u0441\u044f \u0432\u0435\u0441\u044c \u0440\u0435\u0435\u0441\u0442\u0440 \u0437\u0430\u0434\u0430\u0447</li> <li>\u0411\u043b\u043e\u043a\u0438 \u0437\u0430\u0434\u0430\u0447 \u0441\u043b\u0435\u0434\u0443\u044e\u0442 \u0434\u0440\u0443\u0433 \u0437\u0430 \u0434\u0440\u0443\u0433\u043e\u043c, \u0440\u0430\u0437\u0434\u0435\u043b\u0435\u043d\u044b \u043b\u0438\u043d\u0438\u0435\u0439</li> </ul> <p>\u041f\u0440\u0438\u043c\u0435\u0440 \u0444\u043e\u0440\u043c\u044b (\u0443\u0441\u043b\u043e\u0432\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435):</p> <pre><code>\u0418\u043c\u044f \u0437\u0430\u0434\u0430\u0447\u0438              : ping\n\u041f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442               : 0\n\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435                : \u2014\n\u0422\u0435\u0433\u0438                    : \u2014\n\u0410\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e\u0441\u0442\u044c           : True\n\u0413\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f               : False\nSelf \u043f\u0435\u0440\u0435\u0434 \u0437\u0430\u0434\u0430\u0447\u0435\u0439      : False\nArgs                    : host: str\nKwargs                  : timeout: int=5\n--------------------------------------------------\n\u0418\u043c\u044f \u0437\u0430\u0434\u0430\u0447\u0438              : report_daily\n\u041f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442               : 1\n\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435                : \u0415\u0436\u0435\u0434\u043d\u0435\u0432\u043d\u044b\u0439 \u043e\u0442\u0447\u0451\u0442\n\u0422\u0435\u0433\u0438                    : analytics\n\u0410\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e\u0441\u0442\u044c           : False\n\u0413\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f               : False\nSelf \u043f\u0435\u0440\u0435\u0434 \u0437\u0430\u0434\u0430\u0447\u0435\u0439      : False\nArgs                    : date: datetime.date\nKwargs                  : format: str=pdf\n--------------------------------------------------\n</code></pre> <p>\u041f\u0440\u0438 <code>json=True</code> \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442\u0441\u044f \u0441\u043f\u0438\u0441\u043e\u043a JSON-\u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 \u2014 \u043f\u043e \u043e\u0434\u043d\u043e\u043c\u0443 \u043d\u0430 \u043a\u0430\u0436\u0434\u0443\u044e \u0437\u0430\u0434\u0430\u0447\u0443 \u0432 \u0432\u044b\u0431\u043e\u0440\u043a\u0435.</p>"},{"location":"ru/examples/analytics/#_3","title":"\ud83e\uddf1 \u0424\u043e\u0440\u043c\u0430\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0438 \u0443\u0434\u043e\u0431\u0441\u0442\u0432\u043e \u0447\u0442\u0435\u043d\u0438\u044f","text":"<p>\u0422\u0435\u043a\u0441\u0442\u043e\u0432\u044b\u0439 \u0432\u044b\u0432\u043e\u0434 \u0432\u044b\u0440\u0430\u0432\u043d\u0438\u0432\u0430\u0435\u0442 \u043c\u0435\u0442\u043a\u0438 \u043f\u043e \u0444\u0438\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0439 \u0448\u0438\u0440\u0438\u043d\u0435 (\u0447\u0435\u0440\u0435\u0437 \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0439 <code>label_width</code>), \u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u0442\u0430\u0431\u043b\u0438\u0446\u044b \u0432\u044b\u0433\u043b\u044f\u0434\u044f\u0442 \u0430\u043a\u043a\u0443\u0440\u0430\u0442\u043d\u043e \u0432 \u0442\u0435\u0440\u043c\u0438\u043d\u0430\u043b\u0435 \u0438 \u043b\u043e\u0433\u0430\u0445. \u0420\u0430\u0437\u0434\u0435\u043b\u0438\u0442\u0435\u043b\u0438 <code>-</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f \u0434\u043b\u044f \u0432\u0438\u0437\u0443\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043e\u0442\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u0431\u043b\u043e\u043a\u043e\u0432.</p>"},{"location":"ru/examples/analytics/#_4","title":"\u2705 \u0427\u0442\u043e \u044d\u0442\u043e \u0434\u0430\u0451\u0442 \u043d\u0430 \u043f\u0440\u0430\u043a\u0442\u0438\u043a\u0435","text":"<ul> <li>\u0411\u044b\u0441\u0442\u0440\u044b\u0439 \u0430\u0443\u0434\u0438\u0442 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0438 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432</li> <li>\u041f\u043e\u043b\u043d\u0430\u044f \u0432\u0438\u0434\u0438\u043c\u043e\u0441\u0442\u044c \u043f\u043e \u043a\u0430\u0436\u0434\u043e\u0439 \u0437\u0430\u0434\u0430\u0447\u0435: \u043e\u0442 \u0441\u0438\u0433\u043d\u0430\u0442\u0443\u0440\u044b \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u043e\u0432 \u0434\u043e middleware \u0438 \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0445 \u043e\u043f\u0446\u0438\u0439</li> <li>\u0423\u043d\u0438\u0432\u0435\u0440\u0441\u0430\u043b\u044c\u043d\u044b\u0439 JSON-\u0444\u043e\u0440\u043c\u0430\u0442 \u0434\u043b\u044f \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438 \u0441 \u043d\u0430\u0431\u043b\u044e\u0434\u0435\u043d\u0438\u0435\u043c, \u0430\u043b\u0435\u0440\u0442\u0438\u043d\u0433\u043e\u043c \u0438 \u0434\u0430\u0448\u0431\u043e\u0440\u0434\u0430\u043c\u0438</li> </ul> <p>\u042d\u0442\u0430 \u0430\u043d\u0430\u043b\u0438\u0442\u0438\u043a\u0430 \u043f\u043e\u043b\u0435\u0437\u043d\u0430 \u0432 \u043f\u0440\u043e\u0434\u0435, \u043d\u0430 CI \u0438 \u0432 \u043e\u0442\u043b\u0430\u0434\u043a\u0435 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e \u2014 \u043e\u0434\u0438\u043d\u0430\u043a\u043e\u0432\u043e.</p>"},{"location":"ru/examples/echo/","title":"\u041f\u0440\u0438\u043c\u0435\u0440 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f self \u0438 self.ctx (echo=True)","text":"<p>\u041f\u0440\u0438 \u0443\u043a\u0430\u0437\u0430\u043d\u0438\u0438 <code>echo=True</code>, \u0437\u0430\u0434\u0430\u0447\u0430 \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u043f\u0435\u0440\u0432\u044b\u043c \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u043e\u043c \u043e\u0431\u044a\u0435\u043a\u0442 <code>self</code> \u0442\u0438\u043f\u0430 <code>AsyncTask</code> \u0438\u043b\u0438 <code>SyncTask</code>. \u042d\u0442\u043e \u043e\u0442\u043a\u0440\u044b\u0432\u0430\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0443 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f <code>self.ctx</code>, \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u043c \u0434\u0430\u043d\u043d\u044b\u043c \u0437\u0430\u0434\u0430\u0447\u0438 \u0438 \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u044e\u0449\u0438\u043c \u043c\u0435\u0442\u043e\u0434\u0430\u043c.</p> <p>\u041d\u0438\u0436\u0435 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d \u043f\u0440\u0438\u043c\u0435\u0440 \u0437\u0430\u0434\u0430\u0447\u0438 \u0441 \u0434\u0435\u043c\u043e\u043d\u0441\u0442\u0440\u0430\u0446\u0438\u0435\u0439 \u0432\u0441\u0435\u0445 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0435\u0439 <code>self</code> \u0438 <code>self.ctx</code>.</p>"},{"location":"ru/examples/echo/#_1","title":"\ud83e\udde9 \u041f\u0440\u0438\u043c\u0435\u0440 \u0437\u0430\u0434\u0430\u0447\u0438","text":"<pre><code>@app.task(\n    echo=True, tags=[\"test\"], priority=1,\n    retry=3, retry_on_exc=[KeyError], decode=json.dumps,\n    # generate_handler=yield_func, executor=MyTaskExecutor,\n    # middlewares_before=[MyTaskMiddleware], middlewares_after=[MyTaskMiddleware],\n    test=\"test\"\n)\nasync def test_echo_ctx(self: AsyncTask):\n    # \u041f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u043b\u043e\u0433\u0433\u0435\u0440 (\u0441 \u0438\u043c\u0435\u043d\u0435\u043c \u0437\u0430\u0434\u0430\u0447\u0438 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e)\n    self.ctx.get_logger().info(\"\u042d\u0442\u043e \u0442\u0435\u0441\u0442\u043e\u0432\u0430\u044f \u0437\u0430\u0434\u0430\u0447\u0430!\")\n\n    # \u041f\u0430\u0443\u0437\u0430 \u0432 \u0437\u0430\u0434\u0430\u0447\u0435 (\u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u0430\u044f)\n    await self.ctx.sleep(5)\n\n    # \u041f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u0442\u0435\u043a\u0443\u0449\u0443\u044e \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e\n    self.ctx.get_logger().info(self.ctx.get_config())\n\n    # \u0412\u044b\u0432\u043e\u0434 \u0432\u0441\u0435\u0445 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 \u0437\u0430\u0434\u0430\u0447\u0438\n    self.ctx.get_logger().info(\n        f\"\"\"\n            UUID: {self.ctx.task_uuid}\n            \u0418\u043c\u044f: {self.task_name}\n            \u0422\u0435\u0433\u0438: {self.tags}\n            \u041f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442: {self.priority}\n            \u0414\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b: {self.extra}\n\n            \u041f\u043e\u0432\u0442\u043e\u0440\u0435\u043d\u0438\u0439 \u0447\u0435\u0440\u0435\u0437 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440: {self.retry}\n            \u0418\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u043f\u043e\u0432\u0442\u043e\u0440\u0430: {self.retry_on_exc}\n            \u0424\u0443\u043d\u043a\u0446\u0438\u044f \u0434\u043b\u044f \u0434\u0435\u043a\u043e\u0440\u0430\u0442\u043e\u0440\u0430: {self.ctx.generate_handler}\n\n            \u0412\u044b\u0437\u0432\u0430\u043d \u043b\u0438 self: {self.echo}\n            \u0414\u0435\u043a\u043e\u0440\u0434\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0447\u0435\u0440\u0435\u0437 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440: {self.decode}\n\n            TaskExecutor \u0447\u0435\u0440\u0435\u0437 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440: {self.executor}\n            \u041c\u0438\u0434\u0434\u043b\u0432\u0430\u0440\u0438: {self.middlewares}\n        \"\"\"\n    )\n\n    # \u041e\u0442\u043c\u0435\u043d\u0430 \u0437\u0430\u0434\u0430\u0447\u0438 \u0432\u0440\u0443\u0447\u043d\u0443\u044e\n    self.ctx.cancel(\"\u0422\u0435\u0441\u0442\u043e\u0432\u0430\u044f \u0437\u0430\u0434\u0430\u0447\u0430 \u043e\u0442\u043c\u0435\u043d\u0435\u043d\u0430\")\n    return \"Hello, world!\"\n</code></pre>"},{"location":"ru/examples/echo/#self","title":"\ud83d\udce6 \u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 self","text":"<ul> <li><code>self.task_name</code>, <code>self.retry</code>, <code>self.tags</code>, <code>self.echo</code> \u2014 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0437\u0430\u0434\u0430\u0447\u0438</li> <li><code>await self.add_task(...)</code> \u2014 \u0437\u0430\u043f\u0443\u0441\u043a \u0432\u043b\u043e\u0436\u0435\u043d\u043d\u044b\u0445 \u0437\u0430\u0434\u0430\u0447</li> <li><code>self.decode</code>, <code>self.executor</code>, <code>self.middlewares</code> \u2014 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u0430\u043c \u0437\u0430\u0434\u0430\u0447\u0438</li> </ul>"},{"location":"ru/examples/echo/#selfctx","title":"\ud83e\udde0 \u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 self.ctx","text":"<ul> <li><code>self.ctx.get_logger()</code> \u2014 \u043b\u043e\u0433\u0433\u0435\u0440 \u0441 \u0438\u043c\u0435\u043d\u0435\u043c \u0437\u0430\u0434\u0430\u0447\u0438 \u0438\u043b\u0438 \u043a\u0430\u0441\u0442\u043e\u043c\u043d\u044b\u043c \u0438\u043c\u0435\u043d\u0435\u043c</li> <li><code>self.ctx.sleep(seconds)</code> \u2014 \u0437\u0430\u0434\u0435\u0440\u0436\u043a\u0430 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f</li> <li><code>self.ctx.cancel(reason)</code> \u2014 \u043e\u0442\u043c\u0435\u043d\u0430 \u0437\u0430\u0434\u0430\u0447\u0438 \u0441 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u043e\u0439 <code>status=CANCEL</code></li> <li><code>self.ctx.get_config()</code>, <code>get_component(name)</code>, <code>get_task(uuid)</code>, <code>get_metadata()</code> \u2014 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0435 \u0438 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044e</li> </ul>"},{"location":"ru/examples/echo/#_2","title":"\u2705 \u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0432 \u043b\u043e\u0433\u0430\u0445","text":"<p>\u041a\u043b\u0438\u0435\u043d\u0442:</p> <pre><code>Task(status='cancel', uuid=..., task_name='test_echo_ctx', ...,\ncancel_reason='\u0422\u0435\u0441\u0442\u043e\u0432\u0430\u044f \u0437\u0430\u0434\u0430\u0447\u0430 \u043e\u0442\u043c\u0435\u043d\u0435\u043d\u0430')\n</code></pre> <p>\u0421\u0435\u0440\u0432\u0435\u0440:</p> <pre><code>2025-07-16 ... (test_echo_ctx) \u042d\u0442\u043e \u0442\u0435\u0441\u0442\u043e\u0432\u0430\u044f \u0437\u0430\u0434\u0430\u0447\u0430!\n...\nUUID: ...\n\u0418\u043c\u044f: test_echo_ctx\n\u0422\u0435\u0433\u0438: ['test']\n...\n\u0417\u0430\u0434\u0430\u0447\u0430 ... \u0431\u044b\u043b\u0430 \u043e\u0442\u043c\u0435\u043d\u0435\u043d\u0430 \u043f\u043e \u043f\u0440\u0438\u0447\u0438\u043d\u0435: \u0422\u0435\u0441\u0442\u043e\u0432\u0430\u044f \u0437\u0430\u0434\u0430\u0447\u0430 \u043e\u0442\u043c\u0435\u043d\u0435\u043d\u0430\n</code></pre> <p>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 <code>self</code> \u0438 <code>self.ctx</code> \u0434\u0435\u043b\u0430\u0435\u0442 \u0437\u0430\u0434\u0430\u0447\u0443 \u043d\u0435 \u043f\u0440\u043e\u0441\u0442\u043e \u0444\u0443\u043d\u043a\u0446\u0438\u0435\u0439, \u0430 \u043f\u043e\u043b\u043d\u043e\u0446\u0435\u043d\u043d\u044b\u043c \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u043c, \u0441\u043f\u043e\u0441\u043e\u0431\u043d\u044b\u043c \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u043e\u0432\u0430\u0442\u044c \u0441 \u0441\u0438\u0441\u0442\u0435\u043c\u043e\u0439 QTasks \u043d\u0430 \u0432\u0441\u0435\u0445 \u0443\u0440\u043e\u0432\u043d\u044f\u0445.</p>"},{"location":"ru/examples/features/","title":"\u041e\u0441\u043e\u0431\u0435\u043d\u043d\u043e\u0441\u0442\u0438 \u0437\u0430\u0434\u0430\u0447 QTasks","text":"<p>\u0417\u0430\u0434\u0430\u0447\u0438 \u0432 QTasks \u2014 \u044d\u0442\u043e \u043d\u0435 \u043f\u0440\u043e\u0441\u0442\u043e \u0444\u0443\u043d\u043a\u0446\u0438\u0438. \u042d\u0442\u043e \u0440\u0430\u0441\u0448\u0438\u0440\u044f\u0435\u043c\u044b\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u044b \u0441 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u043e\u043c, \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u043c \u043f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u0435\u043c, \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u043e\u0439 middleware, retry-\u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c\u043e\u0432, generator-based \u043f\u0430\u0439\u043f\u043b\u0430\u0439\u043d\u043e\u0432 \u0438 \u0441\u0438\u0441\u0442\u0435\u043c\u043e\u0439 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0435\u0439. \u042d\u0442\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u0434\u0430\u0451\u0442 \u043e\u0431\u0437\u043e\u0440 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0435\u0439, \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u0447\u0435\u0440\u0435\u0437 \u0434\u0435\u043a\u043e\u0440\u0430\u0442\u043e\u0440\u044b <code>@app.task</code> \u0438 <code>@shared_task</code>.</p>"},{"location":"ru/examples/features/#shared_task","title":"\ud83d\udce6 shared_task \u2014 \u0437\u0430\u0434\u0430\u0447\u0438 \u0432\u043d\u0435 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f","text":"<p><code>shared_task</code> \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0438 \u0432\u043d\u0435 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f <code>QueueTasks</code> \u2014 \u0443\u0434\u043e\u0431\u043d\u043e \u0434\u043b\u044f \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a, reusable-\u043c\u043e\u0434\u0443\u043b\u0435\u0439 \u0438 \u043a\u043e\u0434\u0430, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0434\u043e\u043b\u0436\u0435\u043d \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u0432 \u0440\u0430\u0437\u043d\u044b\u0445 \u043f\u0440\u043e\u0435\u043a\u0442\u0430\u0445.</p> <pre><code>from qtasks import shared_task\n\n@shared_task()\ndef shared_func():\n    print(\"\u041e\u0431\u0449\u0430\u044f \u0437\u0430\u0434\u0430\u0447\u0430\")\n</code></pre>"},{"location":"ru/examples/features/#shared_task_1","title":"\u041f\u0440\u0435\u0432\u0440\u0430\u0449\u0435\u043d\u0438\u0435 shared_task \u0432 \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u0443\u044e \u0437\u0430\u0434\u0430\u0447\u0443","text":"<p>\u0415\u0441\u043b\u0438 \u0443\u043a\u0430\u0437\u0430\u0442\u044c <code>awaiting=True</code>, \u0437\u0430\u0434\u0430\u0447\u0430 \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 <code>AsyncTask</code>, \u0434\u0430\u0436\u0435 \u0435\u0441\u043b\u0438 \u0441\u0440\u0435\u0434\u0430 \u00ab\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u0430\u044f\u00bb:</p> <pre><code>@shared_task(awaiting=True)\nasync def async_shared():\n    print(\"async shared task\")\n</code></pre> <p><code>shared_task</code> \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 \u0432\u0441\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b <code>@app.task</code>:</p> <ul> <li><code>executor</code></li> <li><code>middlewares_before</code> / <code>middlewares_after</code></li> <li><code>generate_handler</code></li> <li><code>echo</code></li> <li><code>retry</code>, <code>retry_on_exc</code></li> <li><code>priority</code>, <code>tags</code>, <code>description</code></li> <li><code>decode</code></li> </ul>"},{"location":"ru/examples/features/#asyncrouter","title":"\ud83d\udd00 \u041c\u0430\u0440\u0448\u0440\u0443\u0442\u0438\u0437\u0430\u0446\u0438\u044f \u0437\u0430\u0434\u0430\u0447: (A)syncRouter","text":"<p>Router \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0442\u044c \u043d\u0430\u0431\u043e\u0440\u044b \u0437\u0430\u0434\u0430\u0447 \u043a \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044e, \u0440\u0430\u0437\u0434\u0435\u043b\u044f\u0442\u044c \u043b\u043e\u0433\u0438\u043a\u0443 \u043f\u043e \u043c\u043e\u0434\u0443\u043b\u044f\u043c \u0438 \u043f\u0435\u0440\u0435\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043a\u043e\u0434.</p> <pre><code>from qtasks import AsyncRouter\n\nrouter = AsyncRouter()\n\n@router.task()\nasync def example():\n    print(\"Router task\")\n</code></pre> <p>\u0412 \u0444\u0430\u0439\u043b\u0435 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f:</p> <pre><code>app.include_router(router)\n</code></pre> <p>Router \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u0443\u0435\u0442 \u0442\u043e\u043b\u044c\u043a\u043e \u0437\u0430\u0434\u0430\u0447\u0438 \u0438 \u043f\u0435\u0440\u0435\u0434\u0430\u0435\u0442 \u0438\u0445 \u0432 \u0440\u0435\u0435\u0441\u0442\u0440 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f.</p>"},{"location":"ru/examples/features/#echotrue-self-asynctask","title":"\ud83d\udce3 echo=True \u0438 \u0434\u043e\u0441\u0442\u0443\u043f \u043a self (A)SyncTask","text":"<p>\u0415\u0441\u043b\u0438 \u0443\u043a\u0430\u0437\u0430\u0442\u044c <code>echo=True</code>, \u0437\u0430\u0434\u0430\u0447\u0430 \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u043f\u0435\u0440\u0432\u044b\u043c \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u043e\u043c \u043e\u0431\u044a\u0435\u043a\u0442 \u0437\u0430\u0434\u0430\u0447\u0438:</p> <ul> <li><code>AsyncTask</code> \u0434\u043b\u044f async</li> <li><code>SyncTask</code> \u0434\u043b\u044f sync</li> </ul> <pre><code>@app.task(echo=True)\nasync def echo_task(self):\n    print(self.task_name)\n</code></pre>"},{"location":"ru/examples/features/#self","title":"\u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 <code>self</code>","text":"<p>\u041a\u0430\u0436\u0434\u0430\u044f \u0437\u0430\u0434\u0430\u0447\u0430 \u0438\u043c\u0435\u0435\u0442 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435 \u043f\u043e\u043b\u044f:</p> \u0410\u0442\u0440\u0438\u0431\u0443\u0442 \u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435 <code>self.task_name</code> \u0418\u043c\u044f \u0437\u0430\u0434\u0430\u0447\u0438 <code>self.priority</code> \u041f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442 (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e 0) <code>self.echo</code> \u041f\u0440\u0438\u0437\u043d\u0430\u043a echo-\u0440\u0435\u0436\u0438\u043c\u0430 <code>self.max_time</code> \u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u0432\u0440\u0435\u043c\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f <code>self.retry</code> \u041a\u043e\u043b-\u0432\u043e \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u044b\u0445 \u043f\u043e\u043f\u044b\u0442\u043e\u043a <code>self.retry_on_exc</code> \u0421\u043f\u0438\u0441\u043e\u043a \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439 \u0434\u043b\u044f retry <code>self.decode</code> \u0414\u0435\u043a\u043e\u0434\u0435\u0440 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430 <code>self.middlewares_before</code> \u041c\u0438\u0434\u0434\u043b\u0432\u0430\u0440\u0438 \u0434\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f <code>self.middlewares_after</code> \u041c\u0438\u0434\u0434\u043b\u0432\u0430\u0440\u0438 \u043f\u043e\u0441\u043b\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f <code>self.extra</code> \u041b\u044e\u0431\u044b\u0435 \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b <p>\u042d\u0442\u043e \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0440\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u0442\u044c \u0432\u043b\u043e\u0436\u0435\u043d\u043d\u044b\u0435 \u0437\u0430\u0434\u0430\u0447\u0438:</p> <pre><code>@app.task(echo=True)\nasync def main(self):\n    self.add_task(\"subtask\", 123)\n</code></pre>"},{"location":"ru/examples/features/#selfctx","title":"\ud83e\udde0 \u041a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 \u0437\u0430\u0434\u0430\u0447\u0438: self.ctx","text":"<p>\u041a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 \u2014 \u044d\u0442\u043e API \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u0437\u0430\u0434\u0430\u0447\u0438 \u0441 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u043e\u0439 QTasks.</p> <pre><code>@app.task(echo=True)\ndef show(self):\n    print(self.ctx.task_uuid)\n</code></pre>"},{"location":"ru/examples/features/#_1","title":"\u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0430","text":"\u041c\u0435\u0442\u043e\u0434 \u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 <code>self.ctx.task_uuid</code> UUID \u0437\u0430\u0434\u0430\u0447\u0438 <code>self.ctx.get_logger(name)</code> \u041b\u043e\u0433\u0433\u0435\u0440 \u0434\u043b\u044f \u0437\u0430\u0434\u0430\u0447\u0438 <code>self.ctx.get_config()</code> \u041a\u043e\u043d\u0444\u0438\u0433 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f <code>self.ctx.get_metadata(cache=True)</code> \u041c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0435 \u0437\u0430\u0434\u0430\u0447\u0438 (\u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 <code>app.get()</code>) <code>self.ctx.get_task(uuid)</code> \u041f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0434\u0440\u0443\u0433\u043e\u0439 \u0437\u0430\u0434\u0430\u0447\u0438 <code>self.ctx.sleep(sec)</code> \u0417\u0430\u0434\u0435\u0440\u0436\u043a\u0430 (async/ sync sleep) <code>self.ctx.cancel(reason)</code> \u041e\u0442\u043c\u0435\u043d\u0430 \u0437\u0430\u0434\u0430\u0447\u0438 (TaskCancelError) <code>self.ctx.plugin_error(**kwargs)</code> \u0418\u0441\u043a\u0443\u0441\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0439 \u0432\u044b\u0437\u043e\u0432 \u043e\u0448\u0438\u0431\u043a\u0438 \u043f\u043b\u0430\u0433\u0438\u043d\u0430 <code>self.ctx.get_component(name)</code> \u041f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430 (broker, storage, ...) <p>\u041a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0440\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u044b\u0432\u0430\u0442\u044c \u0441\u043b\u043e\u0436\u043d\u0443\u044e \u043b\u043e\u0433\u0438\u043a\u0443 \u0431\u0435\u0437 \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0445 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445 \u0438 singleton-\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440.</p>"},{"location":"ru/examples/features/#retry-retry_on_exc","title":"\ud83d\udd01 retry \u0438 retry_on_exc","text":"<p>\u041f\u043e\u0432\u0442\u043e\u0440\u043d\u043e\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447\u0438 \u043f\u0440\u0438 \u043e\u0448\u0438\u0431\u043a\u0435:</p> <pre><code>@app.task(retry=5, retry_on_exc=[ZeroDivisionError])\ndef risky():\n    return 1 / 0\n</code></pre> <ul> <li><code>retry=5</code> \u2014 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u043e\u0432\u0442\u043e\u0440\u0435\u043d\u0438\u0439</li> <li><code>retry_on_exc=[...]</code> \u2014 \u0441\u043f\u0438\u0441\u043e\u043a \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439, \u043f\u0440\u0438 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442 retry</li> </ul>"},{"location":"ru/examples/features/#executor","title":"\u2699\ufe0f executor \u2014 \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0439 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a \u0437\u0430\u0434\u0430\u0447","text":"<p>\u041f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0437\u0430\u043c\u0435\u043d\u0438\u0442\u044c \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0439 \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f:</p> <pre><code>class MyExec:\n    ...\n\n@app.task(executor=MyExec)\ndef task():\n    ...\n</code></pre> <p>Executor \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442:</p> <ul> <li>\u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435\u043c \u0437\u0430\u0434\u0430\u0447\u0438,</li> <li>middleware,</li> <li>\u0434\u0435\u043a\u043e\u0434\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435\u043c \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430,</li> <li>retry-\u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u043c,</li> <li>\u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u043e\u0439 \u043e\u0448\u0438\u0431\u043e\u043a.</li> </ul>"},{"location":"ru/examples/features/#middleware","title":"\ud83e\udde9 Middleware","text":"<p>Middleware \u0432\u044b\u0437\u044b\u0432\u0430\u044e\u0442\u0441\u044f \u0414\u041e \u0438 \u041f\u041e\u0421\u041b\u0415 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447\u0438.</p> <pre><code>@app.task(\n    middlewares_before=[MyBefore],\n    middlewares_after=[MyAfter]\n)\ndef example():\n    pass\n</code></pre> <p>\u0415\u0441\u043b\u0438 middleware \u043d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u044b \u2014 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f \u043f\u0443\u0441\u0442\u044b\u0435 \u0441\u043f\u0438\u0441\u043a\u0438.</p>"},{"location":"ru/examples/features/#yield-generate_handler","title":"\ud83d\udd01 \u041f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 yield \u0438 generate_handler","text":"<p>QTasks \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 generator-based \u0437\u0430\u0434\u0430\u0447\u0438.</p> <pre><code>@app.task(generate_handler=handler)\ndef mytask():\n    step = yield \"INIT\"\n    return step\n</code></pre> <p><code>handler(result)</code> \u0432\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u043d\u0430 \u043a\u0430\u0436\u0434\u043e\u043c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0438, \u043f\u0435\u0440\u0435\u0434\u0430\u043d\u043d\u043e\u043c \u0447\u0435\u0440\u0435\u0437 <code>yield</code>.</p> <p>\u042d\u0442\u043e \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0440\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u0442\u044c \u043f\u043e\u0442\u043e\u043a\u043e\u0432\u044b\u0435 \u043f\u0430\u0439\u043f\u043b\u0430\u0439\u043d\u044b:</p> <ul> <li>\u043f\u043e\u0448\u0430\u0433\u043e\u0432\u0430\u044f \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430,</li> <li>\u0441\u0442\u0440\u0438\u043c\u0438\u043d\u0433,</li> <li>\u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441\u0430,</li> <li>\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u043c\u0435\u0436\u0434\u0443 \u0432\u043e\u0440\u043a\u0435\u0440\u043e\u043c \u0438 \u0438\u0441\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u0435\u043c.</li> </ul>"},{"location":"ru/examples/features/#awaitingtrue-shared_task","title":"\ud83e\udea2 awaiting=True (\u0442\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f shared_task)","text":"<p>\u041e\u043f\u0446\u0438\u044f <code>awaiting=True</code> \u0437\u0430\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 shared-\u0437\u0430\u0434\u0430\u0447\u0443 \u0432\u0441\u0435\u0433\u0434\u0430 \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u043a\u0430\u043a \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u0443\u044e.</p> <pre><code>@shared_task(awaiting=True)\nasync def async_shared():\n    ...\n</code></pre> <p>\u042d\u0442\u0438 \u043e\u0441\u043e\u0431\u0435\u043d\u043d\u043e\u0441\u0442\u0438 \u0434\u0435\u043b\u0430\u044e\u0442 \u0437\u0430\u0434\u0430\u0447\u0438 QTasks \u043c\u043e\u0449\u043d\u044b\u043c \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u043e\u043c, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043c\u043e\u0436\u043d\u043e \u0430\u0434\u0430\u043f\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e\u0434 \u043b\u044e\u0431\u0443\u044e \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0443 \u0438 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u044b\u0439 \u0441\u0442\u0438\u043b\u044c.</p>"},{"location":"ru/examples/plugins/","title":"\u041f\u0440\u0438\u043c\u0435\u0440: \u041f\u043b\u0430\u0433\u0438\u043d\u044b","text":"<p>\u0423 <code>QTasks</code> \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432. \u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u0441\u0442\u0440\u043e\u0438\u0442\u0441\u044f \u043d\u0430 \u0432\u044b\u0437\u043e\u0432\u0435 \u0438\u043c\u0435\u043d\u043d\u044b\u0445 \u0438 \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0445 \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u043e\u0432. \u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435 \u043e \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u0430\u0445 \u0443\u043a\u0430\u0437\u0430\u043d\u043e \u0432 \u0421\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a\u0435 \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u043e\u0432 \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432.</p> <p>\u041f\u043e\u043c\u0438\u043c\u043e \u043e\u0441\u043d\u043e\u0432\u043d\u044b\u0445 \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u043e\u0432 \u0442\u0430\u043a\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 \u0442\u0440\u0438\u0433\u0433\u0435\u0440 \u043d\u0430 \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u0432\u043d\u0443\u0442\u0440\u0438 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u0437\u0430\u0434\u0430\u0447\u0438. \u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f: <code>TaskPluginTriggerError</code>. \u0415\u0433\u043e \u043c\u043e\u0436\u043d\u043e \u0432\u044b\u0437\u0432\u0430\u0442\u044c \u0442\u0430\u043a:</p> <pre><code>raise TaskPluginTriggerError(\"\u042d\u0442\u043e \u043f\u0440\u0438\u0447\u0438\u043d\u0430\")\n</code></pre> <p>\u0438\u043b\u0438 \u0447\u0435\u0440\u0435\u0437 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 \u0437\u0430\u0434\u0430\u0447\u0438:</p> <pre><code>self.ctx.plugin_error(\"\u042d\u0442\u043e \u043f\u0440\u0438\u0447\u0438\u043d\u0430\")\n</code></pre>"},{"location":"ru/examples/plugins/#_2","title":"\u2699\ufe0f \u041a\u0430\u043a \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0442 \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u044b?","text":"<ul> <li>\u0422\u0440\u0438\u0433\u0433\u0435\u0440\u044b \u0432\u044b\u0437\u044b\u0432\u0430\u044e\u0442 \u043c\u0435\u0442\u043e\u0434 <code>trigger()</code> \u0432\u043d\u0443\u0442\u0440\u0438 \u043f\u043b\u0430\u0433\u0438\u043d\u0430.</li> <li>\u0412\u044b\u0437\u043e\u0432 \u0437\u0430\u0432\u0438\u0441\u0438\u0442 \u043e\u0442 \u0442\u043e\u0433\u043e, \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0439 \u0438\u043b\u0438 \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0439 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 \u0438\u043d\u0438\u0446\u0438\u0438\u0440\u043e\u0432\u0430\u043b \u0441\u043e\u0431\u044b\u0442\u0438\u0435.</li> </ul>"},{"location":"ru/examples/plugins/#abc","title":"\ud83d\udcd0 \u0410\u0431\u0441\u0442\u0440\u0430\u043a\u0442\u043d\u044b\u0439 \u043a\u043b\u0430\u0441\u0441 \u043f\u043b\u0430\u0433\u0438\u043d\u0430 (ABC)","text":"<pre><code>\"\"\"Base Plugin.\"\"\"\n\nfrom abc import ABC, abstractmethod\nfrom typing import Any, Dict, Optional, Union\nfrom typing_extensions import Annotated, Doc\n\nclass BasePlugin(ABC):\n    \"\"\"\n    `BasePlugin` \u2014 \u0430\u0431\u0441\u0442\u0440\u0430\u043a\u0442\u043d\u044b\u0439 \u043a\u043b\u0430\u0441\u0441, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0444\u0443\u043d\u0434\u0430\u043c\u0435\u043d\u0442\u043e\u043c \u0434\u043b\u044f \u041f\u043b\u0430\u0433\u0438\u043d\u043e\u0432.\n\n    ## \u041f\u0440\u0438\u043c\u0435\u0440\n\n    ```python\n    from qtasks import QueueTasks\n    from qtasks.plugins.base import BasePlugin\n\n    class MyPlugin(BasePlugin):\n        def __init__(self, name: str = None):\n            super().__init__(name=name)\n            pass\n    ```\n    \"\"\"\n\n    def __init__(\n        self,\n        name: Annotated[\n            Optional[str],\n            Doc(\n                \"\"\"\n                    \u0418\u043c\u044f \u043f\u0440\u043e\u0435\u043a\u0442\u0430. \u042d\u0442\u043e \u0438\u043c\u044f \u043c\u043e\u0436\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0434\u043b\u044f \u0442\u0435\u0433\u043e\u0432 \u0434\u043b\u044f \u041f\u043b\u0430\u0433\u0438\u043d\u043e\u0432.\n\n                    \u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e: `None`.\n                    \"\"\"\n            ),\n        ] = None,\n    ):\n        self.name: Union[str, None] = name\n        pass\n\n    @abstractmethod\n    def trigger(self, name: str, *args, **kwargs) -&gt; Union[Dict[str, Any], None]:\n        \"\"\"\u0422\u0440\u0438\u0433\u0433\u0435\u0440 \u043f\u043b\u0430\u0433\u0438\u043d\u0430.\"\"\"\n        pass\n\n    @abstractmethod\n    def start(self, *args, **kwargs):\n        \"\"\"\u0417\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442 \u043f\u043b\u0430\u0433\u0438\u043d.\"\"\"\n        pass\n\n    @abstractmethod\n    def stop(self, *args, **kwargs):\n        \"\"\"\u041e\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442 \u043f\u043b\u0430\u0433\u0438\u043d.\"\"\"\n        pass\n</code></pre>"},{"location":"ru/examples/plugins/#_3","title":"\ud83d\udd27 \u041f\u0440\u0438\u043c\u0435\u0440 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u043e\u0433\u043e \u043f\u043b\u0430\u0433\u0438\u043d\u0430","text":"<pre><code>from qtasks.plugins.base import BasePlugin\n\nclass TestPlugin(BasePlugin):\n    def __init__(self, name=None):\n        super().__init__(name)\n        self.handlers = {\n            \"task_executor_run_task_trigger_error\": self.task_trigger_error\n        }\n\n    async def start(self, *args, **kwargs):\n        return super().start(*args, **kwargs)\n\n    async def stop(self, *args, **kwargs):\n        return super().stop(*args, **kwargs)\n\n    async def trigger(self, name, **kwargs):\n        handler = self.handlers.get(name)\n        if handler:\n            return handler(**kwargs)\n        return None\n\n    def task_trigger_error(self, **kwargs):\n        print(kwargs)\n        return None\n</code></pre>"},{"location":"ru/examples/plugins/#_4","title":"\u2705 \u0418\u0442\u043e\u0433\u0438","text":"<ul> <li>\u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432 \u0432 <code>QTasks</code> \u043e\u0441\u043d\u043e\u0432\u0430\u043d\u0430 \u043d\u0430 \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u0430\u0445.</li> <li>\u041f\u043b\u0430\u0433\u0438\u043d\u044b \u043c\u043e\u0433\u0443\u0442 \u0438\u0437\u043c\u0435\u043d\u044f\u0442\u044c \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u044b, \u0434\u0430\u043d\u043d\u044b\u0435, \u043c\u043e\u0434\u0435\u043b\u0438 \u0438 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447.</li> <li>\u0418\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u0447\u0435\u0440\u0435\u0437 <code>TaskPluginTriggerError</code> \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u044e\u0442 \u0437\u0430\u043c\u0435\u043d\u044f\u0442\u044c \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0437\u0430\u0434\u0430\u0447\u0438 \u0438/\u0438\u043b\u0438 \u0437\u0430\u0432\u0435\u0440\u0448\u0430\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0438 \u0441 \u043e\u0441\u043c\u044b\u0441\u043b\u0435\u043d\u043d\u043e\u0439 \u043f\u0440\u0438\u0447\u0438\u043d\u043e\u0439.</li> <li>\u0413\u0438\u0431\u043a\u043e\u0441\u0442\u044c \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0442\u044c \u043a\u0430\u043a \u0432\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0435 \u043f\u043b\u0430\u0433\u0438\u043d\u044b, \u0442\u0430\u043a \u0438 \u043f\u043b\u0430\u0433\u0438\u043d\u044b \u0441\u0442\u043e\u0440\u043e\u043d\u043d\u0438\u0445 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u043e\u0432.</li> </ul>"},{"location":"ru/examples/variables/","title":"\u041f\u0440\u0438\u043c\u0435\u0440 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445 \u0432 \u0444\u0443\u043d\u043a\u0446\u0438\u044f\u0445 \u0437\u0430\u0434\u0430\u0447","text":"<p><code>QTasks</code> \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 \u0434\u0432\u0430 \u0432\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0445 \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c\u0430 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u043b\u043e\u0433\u0438\u043a\u043e\u0439 \u0437\u0430\u0434\u0430\u0447:</p> <ul> <li>Depends \u2014 \u0432\u044b\u0437\u043e\u0432 \u0432\u043d\u0435\u0448\u043d\u0438\u0445 \u0444\u0443\u043d\u043a\u0446\u0438\u0439, \u0433\u0435\u043d\u0435\u0440\u0430\u0442\u043e\u0440\u043e\u0432 \u0438\u043b\u0438 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u043d\u044b\u0445 \u043c\u0435\u043d\u0435\u0434\u0436\u0435\u0440\u043e\u0432 \u043f\u0440\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0438 \u0437\u0430\u0434\u0430\u0447\u0438.</li> <li>State \u2014 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u0438 \u043e\u0431\u043c\u0435\u043d \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435\u043c \u043c\u0435\u0436\u0434\u0443 \u0437\u0430\u0434\u0430\u0447\u0430\u043c\u0438.</li> </ul>"},{"location":"ru/examples/variables/#1-depends","title":"\ud83d\udd27 \u041f\u0440\u0438\u043c\u0435\u0440 1: Depends (\u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438)","text":"<p><code>Depends</code> \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0442\u044c \u0440\u0435\u0441\u0443\u0440\u0441\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043d\u0443\u0436\u043d\u043e \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0438 \u0437\u0430\u043a\u0440\u044b\u0442\u044c \u043f\u043e \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u0438. \u0424\u0443\u043d\u043a\u0446\u0438\u044f \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0440\u043e\u0441\u0442\u043e\u0439, \u0433\u0435\u043d\u0435\u0440\u0430\u0442\u043e\u0440\u043d\u043e\u0439 \u0438\u043b\u0438 \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u043c \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u043d\u044b\u043c \u043c\u0435\u043d\u0435\u0434\u0436\u0435\u0440\u043e\u043c.</p> <pre><code>from qtasks.plugins import Depends\nfrom contextlib import asynccontextmanager\n\n@asynccontextmanager\nasync def get_db():\n    db = await connect_to_db()\n    yield db\n    print(\"close...\")\n    await db.disconnect()\n\n@app.task\nasync def test_depends(depends: Depends(get_db)):\n    depends.execute(...)\n    print(\"\u0412\u044b\u0437\u043e\u0432 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\")\n    return\n</code></pre> <p>\u0412\u044b\u0432\u043e\u0434 \u0432 \u043a\u043e\u043d\u0441\u043e\u043b\u044c:</p> <pre><code>&lt;\u0421\u0435\u0440\u0432\u0435\u0440 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442 \u0437\u0430\u0434\u0430\u0447\u0443&gt;\n\u0412\u044b\u0437\u043e\u0432 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\n&lt;\u0421\u0435\u0440\u0432\u0435\u0440 \u0437\u0430\u0432\u0435\u0440\u0448\u0430\u0435\u0442 \u0437\u0430\u0434\u0430\u0447\u0443&gt;\nclose...\n</code></pre> <p>\u0418\u0442\u043e\u0433: \u0437\u0430\u0434\u0430\u0447\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043a \u0411\u0414, \u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0437\u0430\u043a\u0440\u044b\u0432\u0430\u0435\u0442\u0441\u044f.</p>"},{"location":"ru/examples/variables/#2-state","title":"\ud83d\udd27 \u041f\u0440\u0438\u043c\u0435\u0440 2: State (\u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043c\u0435\u0436\u0434\u0443 \u0437\u0430\u0434\u0430\u0447\u0430\u043c\u0438)","text":"<p><code>State</code> \u2014 \u044d\u0442\u043e \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 \u0434\u0430\u043d\u043d\u044b\u0445, \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0435 \u0434\u043b\u044f \u043f\u043e\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0445 \u0448\u0430\u0433\u043e\u0432 \u043e\u0434\u043d\u043e\u0439 \u043b\u043e\u0433\u0438\u043a\u0438.</p> <pre><code>from qtasks.plugins import AsyncState\n\nclass MyState(AsyncState):\n    pass\n\n@app.task\nasync def step1(state: MyState):\n    await state.set(\"state\", \"await_phone\")\n    await state.update(step=1, prompt=\"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\")\n    return \"ok\"\n\n@app.task\nasync def step2(state: MyState):\n    print(await state.get_all())\n\n    cur = await state.get(\"state\")\n    if cur != \"await_phone\":\n        return \"error\"\n    await state.update(step=2)\n    await state.delete(\"state\")\n    await state.clear()\n    return \"ok\"\n</code></pre> <p>\u0412\u044b\u0432\u043e\u0434 \u0432 \u043a\u043e\u043d\u0441\u043e\u043b\u044c:</p> <pre><code>{\"state\": \"await_phone\", \"step\": 1, \"prompt\": \"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\"}\n</code></pre> <p>\u0418\u0442\u043e\u0433: \u043f\u0435\u0440\u0432\u044b\u0439 \u0448\u0430\u0433 \u0437\u0430\u043f\u0438\u0441\u0430\u043b \u0434\u0430\u043d\u043d\u044b\u0435 \u0432 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435, \u0432\u0442\u043e\u0440\u043e\u0439 \u0448\u0430\u0433 \u0438\u0445 \u043f\u0440\u043e\u0447\u0438\u0442\u0430\u043b, \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u043b \u0438 \u043e\u0447\u0438\u0441\u0442\u0438\u043b.</p>"},{"location":"ru/examples/variables/#qtasks","title":"\u2699\ufe0f \u041a\u0430\u043a \u044d\u0442\u043e \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u0432\u043d\u0443\u0442\u0440\u0438 <code>QTasks</code>?","text":"<ul> <li>Depends \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u043f\u0440\u0438 \u0432\u044b\u0437\u043e\u0432\u0435 \u0437\u0430\u0434\u0430\u0447\u0438 \u0438 \u0444\u0443\u043d\u043a\u0446\u0438\u044f \u0432\u043d\u0443\u0442\u0440\u0438 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442\u0441\u044f \u043f\u0440\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0438 TaskExecutor. \u042d\u0442\u043e \u0443\u0434\u043e\u0431\u043d\u043e \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a \u0411\u0414, API \u0438\u043b\u0438 \u0432\u043d\u0435\u0448\u043d\u0438\u043c \u0441\u0435\u0440\u0432\u0438\u0441\u0430\u043c.</li> <li>State \u0440\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d \u043a\u0430\u043a \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e\u0435 key-value \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435. \u041e\u043d\u043e \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 <code>set</code>, <code>update</code>, <code>get</code>, <code>delete</code>, <code>clear</code>, \u0430 \u0442\u0430\u043a\u0436\u0435 \u0447\u0442\u0435\u043d\u0438\u0435 \u0432\u0441\u0435\u0445 \u0434\u0430\u043d\u043d\u044b\u0445 \u0440\u0430\u0437\u043e\u043c (<code>get_all</code>).</li> </ul>"},{"location":"ru/examples/variables/#_2","title":"\ud83c\udfe2 \u041f\u0440\u0438\u043c\u0435\u0440 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u0432 \u043a\u043e\u043c\u043f\u0430\u043d\u0438\u0438","text":"<p>\u0414\u043e\u043f\u0443\u0441\u0442\u0438\u043c, \u0440\u0435\u0430\u043b\u0438\u0437\u0443\u0435\u0442\u0441\u044f \u043f\u043e\u0448\u0430\u0433\u043e\u0432\u0430\u044f \u0444\u043e\u0440\u043c\u0430 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438:</p> <ol> <li><code>step1</code> \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044e \u0437\u0430\u043f\u0440\u043e\u0441 \u043d\u0430 \u0432\u0432\u043e\u0434 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430.</li> <li><code>step2</code> \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442, \u0447\u0442\u043e \u0432\u0432\u0435\u0434\u0451\u043d \u0442\u0435\u043b\u0435\u0444\u043e\u043d, \u0438 \u0434\u0432\u0438\u0433\u0430\u0435\u0442 \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u0434\u0430\u043b\u044c\u0448\u0435.</li> </ol> <p>\u041f\u0440\u0438 \u044d\u0442\u043e\u043c <code>Depends</code> \u043c\u043e\u0436\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435\u043c \u043a \u0431\u0430\u0437\u0435, \u0430 <code>State</code> \u2014 \u0434\u043b\u044f \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u043f\u0440\u043e\u043c\u0435\u0436\u0443\u0442\u043e\u0447\u043d\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f.</p>"},{"location":"ru/examples/variables/#_3","title":"\u2705 \u0418\u0442\u043e\u0433\u0438","text":"<ul> <li>Depends \u2014 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0435\u0439 (\u0440\u0435\u0441\u0443\u0440\u0441\u044b, \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u044b, \u0441\u0435\u0440\u0432\u0438\u0441\u044b).</li> <li>State \u2014 \u0434\u043b\u044f \u043f\u043e\u0448\u0430\u0433\u043e\u0432\u043e\u0433\u043e \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445 \u043c\u0435\u0436\u0434\u0443 \u0437\u0430\u0434\u0430\u0447\u0430\u043c\u0438.</li> </ul> <p>\u0412\u043c\u0435\u0441\u0442\u0435 \u043e\u043d\u0438 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u044e\u0442 \u0441\u0442\u0440\u043e\u0438\u0442\u044c \u0433\u0438\u0431\u043a\u0438\u0435 \u043f\u0430\u0439\u043f\u043b\u0430\u0439\u043d\u044b: \u043e\u0442 \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0439 \u0441 \u0411\u0414 \u0434\u043e \u0447\u0430\u0442-\u0431\u043e\u0442\u043e\u0432 \u0438 \u0441\u043b\u043e\u0436\u043d\u044b\u0445 \u0431\u0438\u0437\u043d\u0435\u0441-\u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432.</p>"},{"location":"ru/examples/yield/","title":"\u041f\u0440\u0438\u043c\u0435\u0440: \u0417\u0430\u0434\u0430\u0447\u0430-\u0433\u0435\u043d\u0435\u0440\u0430\u0442\u043e\u0440 (yield)","text":"<p><code>QTasks</code> \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 \u0437\u0430\u0434\u0430\u0447\u0438 \u0441 <code>yield</code>, \u043a\u0430\u043a \u0432 \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e\u0439, \u0442\u0430\u043a \u0438 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e\u0439 \u0444\u043e\u0440\u043c\u0435. \u042d\u0442\u043e \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u043f\u043e \u043c\u0435\u0440\u0435 \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u0438, \u043f\u0440\u0438 \u044d\u0442\u043e\u043c \u0437\u0430\u0434\u0430\u0447\u0430 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u0430 \u0438\u0437 \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e\u0433\u043e \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f <code>QueueTasks</code>, \u043d\u0435\u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e \u043e\u0442 \u0442\u0438\u043f\u0430 \u0444\u0443\u043d\u043a\u0446\u0438\u0438.</p>"},{"location":"ru/examples/yield/#1","title":"\ud83d\udd27 \u041f\u0440\u0438\u043c\u0435\u0440 1: \u0410\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u0430\u044f \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f \u0441 \u043f\u0440\u043e\u043c\u0435\u0436\u0443\u0442\u043e\u0447\u043d\u043e\u0439 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u043e\u0439","text":"<pre><code>async def yield_func(result):\n    print(f\"\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u0430\u043d: {result}\")\n    return result + 2\n\n@app.task(generate_handler=yield_func, echo=True)\nasync def test_yield(n: int):\n    for _ in range(n):\n        n += 1\n        yield n\n</code></pre> <p>\u0412\u0445\u043e\u0434\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435: <code>5</code></p> <p>\u0412\u044b\u0432\u043e\u0434 \u0432 \u043a\u043e\u043d\u0441\u043e\u043b\u044c:</p> <pre><code>\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u0430\u043d: 6\n\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u0430\u043d: 7\n\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u0430\u043d: 8\n\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u0430\u043d: 9\n\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u0430\u043d: 10\n</code></pre> <p>\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0437\u0430\u0434\u0430\u0447\u0438: <code>[8, 9, 10, 11, 12]</code></p>"},{"location":"ru/examples/yield/#2","title":"\ud83d\udd27 \u041f\u0440\u0438\u043c\u0435\u0440 2: \u0421\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u0430\u044f \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f \u0441 \u043f\u043e\u0441\u0442\u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u043e\u0439","text":"<pre><code>def sync_handler(value):\n    print(\"SYNC:\", value)\n    return value * 2\n\n@app.task(generate_handler=sync_handler)\ndef sync_gen(n: int):\n    for i in range(n):\n        yield i + 1\n</code></pre> <p>\u0412\u0445\u043e\u0434\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435: <code>5</code></p> <p>\u0412\u044b\u0432\u043e\u0434 \u0432 \u043a\u043e\u043d\u0441\u043e\u043b\u044c:</p> <pre><code>SYNC: 1\nSYNC: 2\nSYNC: 3\nSYNC: 4\nSYNC: 5\n</code></pre> <p>\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0437\u0430\u0434\u0430\u0447\u0438: <code>[2, 4, 6, 8, 10]</code></p>"},{"location":"ru/examples/yield/#3-id","title":"\ud83d\udd27 \u041f\u0440\u0438\u043c\u0435\u0440 3: \u0413\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f \u0438 \u0441\u0431\u043e\u0440 ID \u0447\u0435\u0440\u0435\u0437 \u0432\u043d\u0435\u0448\u043d\u0438\u0439 \u0441\u0435\u0440\u0432\u0438\u0441","text":"<pre><code>async def save_to_db(value):\n    db.insert({\"value\": value})\n    return value\n\n@app.task(generate_handler=save_to_db)\ndef ids():\n    for id_ in range(5):\n        yield f\"user_{id_}\"\n</code></pre> <p>\u041f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u0435: \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u0437\u0430\u043f\u0438\u0441\u044c \u0432 \u0431\u0430\u0437\u0443 \u0434\u0430\u043d\u043d\u044b\u0445 \u0438 \u0432\u043e\u0437\u0432\u0440\u0430\u0442 \u0441\u043f\u0438\u0441\u043a\u0430 \u0437\u0430\u043f\u0438\u0441\u0435\u0439.</p>"},{"location":"ru/examples/yield/#generate_handler-qtasks","title":"\u2699\ufe0f \u041a\u0430\u043a \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 generate_handler \u0432\u043d\u0443\u0442\u0440\u0438 <code>QTasks</code>?","text":"<ul> <li>\u0410\u0440\u0433\u0443\u043c\u0435\u043d\u0442 <code>generate_handler</code> \u0432\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u043d\u0430 \u043a\u0430\u0436\u0434\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435, \u0441\u0433\u0435\u043d\u0435\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0435 <code>yield</code>.</li> <li>\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 <code>return</code> \u0438\u0437 handler'\u0430 \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0432 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0438\u0440\u0443\u044e\u0449\u0438\u0439 \u0441\u043f\u0438\u0441\u043e\u043a (<code>list</code>) \u0437\u0430\u0434\u0430\u0447\u0438.</li> <li>\u0415\u0441\u043b\u0438 <code>generate_handler</code> \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0451\u043d, \u0437\u0430\u0434\u0430\u0447\u0430 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f \u0447\u0435\u0440\u0435\u0437 <code>run_task_gen</code>, \u0438\u043d\u0430\u0447\u0435 \u2014 \u043e\u0431\u044b\u0447\u043d\u044b\u043c \u0441\u043f\u043e\u0441\u043e\u0431\u043e\u043c.</li> <li>\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 <code>generating</code> \u0432 <code>TaskExecSchema</code> \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435\u043c \u043d\u0430 \u0433\u0435\u043d\u0435\u0440\u0430\u0442\u043e\u0440\u043d\u044b\u0439 \u0440\u0435\u0436\u0438\u043c.</li> </ul>"},{"location":"ru/examples/yield/#_1","title":"\ud83c\udfe2 \u041f\u0440\u0438\u043c\u0435\u0440 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u0432 \u043a\u043e\u043c\u043f\u0430\u043d\u0438\u0438","text":"<p>\u0414\u043e\u043f\u0443\u0441\u0442\u0438\u043c, \u0443 \u0432\u0430\u0441 \u0435\u0441\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0430, \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u044e\u0449\u0430\u044f \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f \u0441\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a\u0430\u043c \u043f\u043e \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u044e:</p> <pre><code>async def log_notification(msg):\n    logger.info(\"\u041e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e:\", msg)\n    return msg\n\n@app.task(generate_handler=log_notification)\ndef send_notifications():\n    for employee in get_employees():\n        yield f\"\u041e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u0435: {employee.email}\"\n</code></pre> <p>\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442:</p> <ul> <li>\u0413\u0435\u043d\u0435\u0440\u0430\u0442\u043e\u0440 \u043f\u0435\u0440\u0435\u0431\u0438\u0440\u0430\u0435\u0442 \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a\u043e\u0432.</li> <li>\u041d\u0430 \u043a\u0430\u0436\u0434\u043e\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u0432\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f <code>generate_handler</code>, \u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u043b\u043e\u0433\u0438\u0440\u0443\u0435\u0442 \u0438\u043b\u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443.</li> <li>\u0412\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442\u0441\u044f \u0441\u043f\u0438\u0441\u043e\u043a \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u0439.</li> </ul> <p>\u0422\u0430\u043a\u043e\u0439 \u043f\u043e\u0434\u0445\u043e\u0434 \u0443\u0434\u043e\u0431\u0435\u043d \u0434\u043b\u044f:</p> <ul> <li>\u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0439 \u0441 \u0432\u043d\u0435\u0448\u043d\u0438\u043c\u0438 API</li> <li>\u041f\u043e\u0441\u0442\u0435\u043f\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u0442\u0440\u0438\u043c\u0438\u043d\u0433\u0430</li> <li>\u0417\u0430\u0434\u0430\u0447, \u0433\u0434\u0435 \u0432\u0430\u0436\u043d\u0430 \u0442\u0440\u0430\u043d\u0441\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u0438 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u0448\u0430\u0433\u0430</li> </ul>"},{"location":"ru/examples/yield/#_2","title":"\u2705 \u0418\u0442\u043e\u0433\u0438","text":"<p>\u0417\u0430\u0434\u0430\u0447\u0438 \u0441 <code>yield</code> + <code>generate_handler</code> \u2014 \u044d\u0442\u043e \u043c\u043e\u0449\u043d\u044b\u0439 \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442 \u0440\u0435\u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0439 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0434\u0435\u043b\u0430\u0435\u0442 QTasks \u0433\u0438\u0431\u043a\u0438\u043c \u0434\u043b\u044f real-time \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438, \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f, \u0441\u0442\u0440\u0438\u043c\u0438\u043d\u0433\u0430 \u0438 \u0431\u043e\u043b\u0435\u0435 \u0441\u043b\u043e\u0436\u043d\u044b\u0445 \u043f\u0430\u0439\u043f\u043b\u0430\u0439\u043d\u043e\u0432.</p> <p>\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 \u043a\u0430\u043a <code>async</code>, \u0442\u0430\u043a \u0438 <code>sync</code> \u0434\u0435\u043b\u0430\u0435\u0442 \u0435\u0433\u043e \u0443\u0434\u043e\u0431\u043d\u044b\u043c \u0432 \u043b\u044e\u0431\u043e\u043c \u0441\u0442\u0438\u043b\u0435 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0438.</p>"},{"location":"ru/examples/integrations/","title":"\u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438","text":"<p>\u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e <code>QTasks</code> \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043e\u0447\u0435\u043d\u044c \u043f\u0440\u043e\u0441\u0442\u043e\u0439 \u0434\u043b\u044f \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438 \u0441\u0438\u0441\u0442\u0435\u043c\u043e\u0439 \u0437\u0430 \u0441\u0447\u0451\u0442 \u0441\u0432\u043e\u0435\u0439 \u043e\u0431\u043b\u0435\u0433\u0447\u0451\u043d\u043d\u043e\u0439 \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u043f\u0430\u043c\u044f\u0442\u044c\u044e \u0438 \u043f\u043e\u0442\u043e\u043a\u0430\u043c\u0438. \u0415\u0451 \u043c\u043e\u0436\u043d\u043e \u0432\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u043f\u0440\u0430\u043a\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0432 \u043b\u044e\u0431\u043e\u0439 \u0444\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a, \u0438 \u0434\u043b\u044f \u044d\u0442\u043e\u0433\u043e \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b \u0440\u0430\u0437\u043d\u044b\u0435 \u0441\u043f\u043e\u0441\u043e\u0431\u044b:</p> <ul> <li>\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447 \u0447\u0435\u0440\u0435\u0437 <code>@app.task</code>, <code>@shared_task</code>, <code>@router.task</code></li> <li>\u0412\u044b\u0437\u043e\u0432 \u0437\u0430\u0434\u0430\u0447\u0438 \u0447\u0435\u0440\u0435\u0437 <code>app.add_task(...)</code> \u0438\u043b\u0438 <code>this_is_func.add_task(...)</code></li> <li>\u0417\u0430\u043f\u0443\u0441\u043a \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0444\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a\u0430 \u043a\u0430\u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u0447\u0435\u0440\u0435\u0437 <code>app.run_forever()</code>, \u043b\u0438\u0431\u043e \u0447\u0435\u0440\u0435\u0437 CLI:</li> </ul> <pre><code>qtasks -A file:app run\n</code></pre>"},{"location":"ru/examples/integrations/#_2","title":"\ud83d\udccc \u0422\u0435\u043a\u0443\u0449\u0438\u0435 \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438","text":"<p>\u041d\u0430 \u0434\u0430\u043d\u043d\u044b\u0439 \u043c\u043e\u043c\u0435\u043d\u0442 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 \u0433\u043e\u0442\u043e\u0432\u0430\u044f \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f: \u0441 Django. \u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435 \u0441\u043c. \u0440\u0430\u0437\u0434\u0435\u043b \u041f\u0440\u0438\u043c\u0435\u0440\u044b \u2192 \u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438 \u2192 Django.</p>"},{"location":"ru/examples/integrations/django/","title":"\u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f \u0441 Django","text":"<p>\u041d\u0430 \u0434\u0430\u043d\u043d\u044b\u0439 \u043c\u043e\u043c\u0435\u043d\u0442 \u0432 <code>QTasks</code> \u0440\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u0430 \u043e\u0434\u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u043d\u0430\u044f \u0444\u0443\u043d\u043a\u0446\u0438\u044f \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438 \u0441 Django: <code>autodiscover_tasks</code>.</p>"},{"location":"ru/examples/integrations/django/#autodiscover_tasks","title":"\ud83d\udccc \u0427\u0442\u043e \u0434\u0435\u043b\u0430\u0435\u0442 autodiscover_tasks?","text":"<p>\u042d\u0442\u0430 \u0444\u0443\u043d\u043a\u0446\u0438\u044f \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0438\u043c\u043f\u043e\u0440\u0442\u0438\u0440\u0443\u0435\u0442 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0435 \u043c\u043e\u0434\u0443\u043b\u0438 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, <code>tasks.py</code>) \u0438\u0437 \u0432\u0441\u0435\u0445 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439, \u043f\u0435\u0440\u0435\u0447\u0438\u0441\u043b\u0435\u043d\u043d\u044b\u0445 \u0432 <code>INSTALLED_APPS</code>. \u0422\u0430\u043a\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c \u0437\u0430\u0434\u0430\u0447\u0438 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u0443\u044e\u0442\u0441\u044f \u0432 QTasks \u0431\u0435\u0437 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438 \u0440\u0443\u0447\u043d\u043e\u0433\u043e \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f.</p> <p>\u0421\u0438\u0433\u043d\u0430\u0442\u0443\u0440\u0430 \u0444\u0443\u043d\u043a\u0446\u0438\u0438:</p> <pre><code>def autodiscover_tasks(app, modules: List[str] = [\"tasks\"]):\n    \"\"\"\u0410\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0438\u043c\u043f\u043e\u0440\u0442\u0438\u0440\u0443\u0435\u0442 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0435 \u043c\u043e\u0434\u0443\u043b\u0438 \u0438\u0437 \u0432\u0441\u0435\u0445 INSTALLED_APPS,\n    \u0447\u0442\u043e\u0431\u044b \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0438 \u0432 QTasks.\n\n    Args:\n        app (QueueTasks): \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435.\n        modules (List[str]): \u041c\u043e\u0434\u0443\u043b\u0438 \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u0434\u0438\u0441\u043a\u0430\u0432\u0435\u0440\u0438. \u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e: [\"tasks\"].\n    \"\"\"\n</code></pre> <p>\ud83d\udcd6 \u041f\u043e\u0434\u0440\u043e\u0431\u043d\u043e\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e \u0432 API \u2192 autodiscover_tasks.</p>"},{"location":"ru/examples/integrations/django/#_1","title":"\ud83d\udd27 \u041a\u0430\u043a \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c","text":"<p>\u0412 <code>settings.py</code>:</p> <pre><code>INSTALLED_APPS = [\n    \"django.contrib.admin\",\n    \"django.contrib.auth\",\n    \"myapp\",  # \u0437\u0434\u0435\u0441\u044c \u0431\u0443\u0434\u0435\u0442 tasks.py\n]\n</code></pre> <p>\u0412 <code>myapp/tasks.py</code>:</p> <pre><code>from qtasks import QueueTasks\n\napp = QueueTasks()\n\n@app.task\ndef hello(name: str):\n    return f\"Hello, {name}!\"\n</code></pre> <p>\u0412 <code>manage.py</code> \u0438\u043b\u0438 \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u043c \u043c\u043e\u0434\u0443\u043b\u0435 \u043f\u0440\u043e\u0435\u043a\u0442\u0430:</p> <pre><code>from qtasks.contrib.django import autodiscover_tasks\nfrom qtasks import QueueTasks\n\napp = QueueTasks()\nautodiscover_tasks(app)\n</code></pre> <p>\u041f\u043e\u0441\u043b\u0435 \u0432\u044b\u0437\u043e\u0432\u0430 <code>autodiscover_tasks(app)</code> \u0432\u0441\u0435 \u0437\u0430\u0434\u0430\u0447\u0438 \u0438\u0437 <code>tasks.py</code> \u0431\u0443\u0434\u0443\u0442 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b \u0438 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b \u0434\u043b\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f.</p>"},{"location":"ru/examples/integrations/django/#_2","title":"\u2705 \u0418\u0442\u043e\u0433\u0438","text":"<ul> <li><code>autodiscover_tasks</code> \u0438\u0449\u0435\u0442 <code>tasks.py</code> (\u0438\u043b\u0438 \u0434\u0440\u0443\u0433\u0438\u0435 \u043c\u043e\u0434\u0443\u043b\u0438, \u0435\u0441\u043b\u0438 \u0443\u043a\u0430\u0437\u0430\u043d\u044b) \u0432\u043e \u0432\u0441\u0435\u0445 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f\u0445 <code>INSTALLED_APPS</code>.</li> <li>\u042d\u0442\u043e \u0443\u043f\u0440\u043e\u0449\u0430\u0435\u0442 \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044e QTasks \u0432 \u043f\u0440\u043e\u0435\u043a\u0442\u044b Django.</li> <li>\u041d\u0435 \u043d\u0443\u0436\u043d\u043e \u0432\u0440\u0443\u0447\u043d\u0443\u044e \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0438 \u2014 \u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0438\u0445 \u0432 <code>tasks.py</code> \u0432\u043d\u0443\u0442\u0440\u0438 \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f.</li> </ul>"},{"location":"ru/examples/practice/freelancer/","title":"\u041f\u0440\u0438\u043c\u0435\u0440 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f QTasks \u0434\u043b\u044f \u0444\u0440\u0438\u043b\u0430\u043d\u0441\u0435\u0440\u0430","text":"<p>\u0424\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a QTasks \u043e\u0442\u043b\u0438\u0447\u043d\u043e \u043f\u043e\u0434\u0445\u043e\u0434\u0438\u0442 \u0434\u043b\u044f \u0444\u0440\u0438\u043b\u0430\u043d\u0441\u0435\u0440\u043e\u0432, \u043a\u043e\u0442\u043e\u0440\u044b\u043c \u0432\u0430\u0436\u043d\u043e \u0431\u044b\u0441\u0442\u0440\u043e \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0438, \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0442\u044c \u0441\u043e\u0431\u044b\u0442\u0438\u044f \u0438\u0437 \u0432\u043d\u0435\u0448\u043d\u0438\u0445 API \u0438 \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c \u043f\u043e\u0442\u043e\u043a\u0430\u043c\u0438 \u0434\u0430\u043d\u043d\u044b\u0445. \u041d\u0438\u0436\u0435 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d \u043f\u0440\u0438\u043c\u0435\u0440, \u043a\u0430\u043a \u0444\u0440\u0438\u043b\u0430\u043d\u0441\u0435\u0440 \u043c\u043e\u0436\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c QTasks \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u0439 \u0438 \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0439.</p>"},{"location":"ru/examples/practice/freelancer/#_1","title":"\ud83d\udcbc \u0421\u0446\u0435\u043d\u0430\u0440\u0438\u0439","text":"<p>\u0414\u043e\u043f\u0443\u0441\u0442\u0438\u043c, \u0432\u044b \u0444\u0440\u0438\u043b\u0430\u043d\u0441\u0435\u0440, \u0441\u043e\u0437\u0434\u0430\u044e\u0449\u0438\u0439 Telegram-\u0431\u043e\u0442\u0430 \u0434\u043b\u044f \u043a\u043b\u0438\u0435\u043d\u0442\u0430. \u0411\u043e\u0442 \u0434\u043e\u043b\u0436\u0435\u043d:</p> <ol> <li>\u041e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c \u043d\u0430\u043f\u043e\u043c\u0438\u043d\u0430\u043d\u0438\u044f \u043f\u043e \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u044e.</li> <li>\u041f\u0440\u043e\u0432\u0435\u0440\u044f\u0442\u044c \u0441\u0442\u0430\u0442\u0443\u0441\u044b \u0437\u0430\u043a\u0430\u0437\u043e\u0432 \u0441 API \u043a\u043b\u0438\u0435\u043d\u0442\u0430.</li> <li>\u041b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u043e\u0431\u044b\u0442\u0438\u044f \u0438 \u043e\u0448\u0438\u0431\u043a\u0438.</li> </ol> <p>\u0412\u044b \u0445\u043e\u0442\u0438\u0442\u0435 \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0442\u044c \u044d\u0442\u0438 \u0437\u0430\u0434\u0430\u0447\u0438 \u043d\u0435\u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e \u0438 \u0432 \u0444\u043e\u043d\u0435, \u0431\u0435\u0437 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0435\u0439 \u043e\u0442 \u0442\u044f\u0436\u0451\u043b\u044b\u0445 \u0440\u0435\u0448\u0435\u043d\u0438\u0439 \u0432\u0440\u043e\u0434\u0435 Celery.</p>"},{"location":"ru/examples/practice/freelancer/#_2","title":"\ud83d\ude80 \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f","text":"<pre><code>from qtasks.asyncio import QueueTasks\nfrom qtasks.registries import AsyncTask\nimport logging\n\napp = QueueTasks()\napp.config.logs_default_level = logging.INFO\n</code></pre>"},{"location":"ru/examples/practice/freelancer/#_3","title":"\u23f0 \u041d\u0430\u043f\u043e\u043c\u0438\u043d\u0430\u043d\u0438\u044f \u043f\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438","text":"<pre><code>@app.task(name=\"send_reminder\")\nasync def send_reminder(chat_id: int, text: str):\n    await telegram_api.send_message(chat_id, text)\n</code></pre> <p>\u041c\u043e\u0436\u043d\u043e \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0442\u044c \u044d\u0442\u0443 \u0437\u0430\u0434\u0430\u0447\u0443 \u043f\u043e \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u044e \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u0432\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0442\u0430\u0439\u043c\u0435\u0440\u043e\u0432:</p> <pre><code>from qtasks.timers import AsyncTimer\nfrom apscheduler.triggers.cron import CronTrigger\n\n# \u041f\u0440\u0435\u0434\u043f\u043e\u043b\u043e\u0436\u0438\u043c, \u0447\u0442\u043e app \u0443\u0436\u0435 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\n\ntimer = AsyncTimer(app=app)\ntimer.add_task(\"send_reminder\", trigger=CronTrigger(minute=\"*/1\"),\nargs=(123456789, \"\u041d\u0435 \u0437\u0430\u0431\u0443\u0434\u044c\u0442\u0435 \u043f\u0440\u043e \u0437\u0430\u043a\u0430\u0437!\"))\n\ntimer.run_forever()\n</code></pre>"},{"location":"ru/examples/practice/freelancer/#_4","title":"\ud83d\udce6 \u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0437\u0430\u043a\u0430\u0437\u043e\u0432","text":"<pre><code>@app.task(name=\"check_orders\", echo=True)\nasync def check_orders(self: AsyncTask):\n    orders = await external_api.get_orders()\n    for order in orders:\n        if order.status == \"delivered\":\n            await self.add_task(\n                \"send_reminder\",\n                order.user_id,\n                \"\u0412\u0430\u0448 \u0437\u0430\u043a\u0430\u0437 \u0434\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d!\"\n            )\n</code></pre>"},{"location":"ru/examples/practice/freelancer/#_5","title":"\ud83d\udccb \u041b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043e\u0448\u0438\u0431\u043e\u043a","text":"<pre><code>@app.task(name=\"error_logger\")\ndef error_logger(message: str):\n    with open(\"errors.log\", \"a\") as f:\n        f.write(message + \"\\n\")\n</code></pre> <p>\u0412\u043e \u0432\u0441\u0435\u0445 \u0437\u0430\u0434\u0430\u0447\u0430\u0445 \u043c\u043e\u0436\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c:</p> <pre><code>try:\n    ...\nexcept Exception as e:\n    await self.add_task(\"error_logger\", args=(str(e),))\n</code></pre>"},{"location":"ru/examples/practice/freelancer/#qtasks_1","title":"\ud83e\udde9 \u041f\u043e\u0447\u0435\u043c\u0443 QTasks \u0443\u0434\u043e\u0431\u0435\u043d \u0434\u043b\u044f \u0444\u0440\u0438\u043b\u0430\u043d\u0441\u0435\u0440\u0430?","text":"<ul> <li>\u041d\u0435 \u0442\u0440\u0435\u0431\u0443\u0435\u0442 Redis \u0438\u043b\u0438 RabbitMQ \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e.</li> <li>\u041c\u043e\u0436\u043d\u043e \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0442\u044c \u0447\u0435\u0440\u0435\u0437 <code>python main.py</code>, \u0431\u0435\u0437 \u0434\u043e\u043a\u0435\u0440\u043e\u0432 \u0438 \u043c\u0438\u0433\u0440\u0430\u0446\u0438\u0439.</li> <li>\u0413\u0438\u0431\u043a\u043e\u0441\u0442\u044c: \u043c\u043e\u0436\u043d\u043e \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0442\u044c retry, middleware, \u043a\u0430\u0441\u0442\u043e\u043c\u043d\u044b\u0435 executor'\u044b.</li> <li>\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 <code>yield</code>, <code>echo</code>, \u0432\u043b\u043e\u0436\u0435\u043d\u043d\u044b\u0445 \u0437\u0430\u0434\u0430\u0447 \u0438 \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f.</li> </ul>"},{"location":"ru/examples/practice/freelancer/#_6","title":"\u2705 \u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442","text":"<p>\u0412\u044b \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u0442\u0435 \u043c\u043e\u0449\u043d\u0443\u044e \u0441\u0438\u0441\u0442\u0435\u043c\u0443 \u0444\u043e\u043d\u043e\u0432\u044b\u0445 \u0437\u0430\u0434\u0430\u0447 \u0441 \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u043c \u043a\u043e\u0434\u043e\u043c \u0438 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u044f\u043c\u0438. \u0418\u0434\u0435\u0430\u043b\u044c\u043d\u043e \u043f\u043e\u0434\u0445\u043e\u0434\u0438\u0442 \u0434\u043b\u044f \u043c\u0438\u043a\u0440\u043e\u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432, \u0431\u043e\u0442\u043e\u0432 \u0438 API-\u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0439 \u2014 \u0442\u0438\u043f\u0438\u0447\u043d\u043e\u0439 \u0441\u0440\u0435\u0434\u044b \u0444\u0440\u0438\u043b\u0430\u043d\u0441\u0435\u0440\u0430.</p>"},{"location":"ru/examples/practice/large_business/","title":"\u041f\u0440\u0438\u043c\u0435\u0440 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f QTasks \u0432 \u043a\u0440\u0443\u043f\u043d\u043e\u043c \u0431\u0438\u0437\u043d\u0435\u0441\u0435","text":"<p>QTasks \u043c\u0430\u0441\u0448\u0442\u0430\u0431\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u0432 \u0432\u044b\u0441\u043e\u043a\u043e\u043d\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u043d\u044b\u0445 \u0441\u0438\u0441\u0442\u0435\u043c\u0430\u0445 \u0438 \u043f\u043e\u0434\u0445\u043e\u0434\u0438\u0442 \u0434\u043b\u044f \u043a\u043e\u0440\u043f\u043e\u0440\u0430\u0442\u0438\u0432\u043d\u043e\u0433\u043e \u0443\u0440\u043e\u0432\u043d\u044f \u0431\u043b\u0430\u0433\u043e\u0434\u0430\u0440\u044f \u043c\u043e\u0434\u0443\u043b\u044c\u043d\u043e\u0439 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0435, \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u044f \u0438 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044e \u0438\u0441\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447. \u042d\u0442\u0430 \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u043c\u043e\u0436\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0432 \u0440\u043e\u043b\u0438 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0438\u043d\u0433\u0430 \u0437\u0430\u0434\u0430\u0447 \u0432 \u043c\u0438\u043a\u0440\u043e\u0441\u0435\u0440\u0432\u0438\u0441\u043d\u043e\u0439 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0435, \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0437\u0430\u0446\u0438\u0438 \u0441\u043b\u043e\u0436\u043d\u044b\u0445 \u0446\u0435\u043f\u043e\u0447\u0435\u043a \u0438 \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438.</p>"},{"location":"ru/examples/practice/large_business/#_1","title":"\ud83c\udfe2 \u0421\u0446\u0435\u043d\u0430\u0440\u0438\u0439","text":"<p>\u041a\u0440\u0443\u043f\u043d\u0430\u044f \u043a\u043e\u043c\u043f\u0430\u043d\u0438\u044f \u0438\u043c\u0435\u0435\u0442 \u0434\u0435\u0441\u044f\u0442\u043a\u0438 \u043c\u0438\u043a\u0440\u043e\u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432:</p> <ol> <li>\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0441\u0432\u044f\u0437\u0430\u0442\u044c \u0438\u0445 \u0447\u0435\u0440\u0435\u0437 \u0444\u043e\u043d\u043e\u0432\u0443\u044e \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0443 \u0437\u0430\u0434\u0430\u0447.</li> <li>\u041e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0442\u044c \u043d\u0430\u0434\u0451\u0436\u043d\u043e\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u0438 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c.</li> <li>\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0442\u044c \u043c\u0430\u0441\u0448\u0442\u0430\u0431\u0438\u0440\u0443\u0435\u043c\u043e\u0441\u0442\u044c, \u043e\u0442\u043a\u0430\u0437\u043e\u0443\u0441\u0442\u043e\u0439\u0447\u0438\u0432\u043e\u0441\u0442\u044c \u0438 \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438 \u0441 \u0432\u043d\u0435\u0448\u043d\u0438\u043c\u0438 \u0441\u0438\u0441\u0442\u0435\u043c\u0430\u043c\u0438 (Kafka, Redis, PostgreSQL, REST, gRPC).</li> </ol>"},{"location":"ru/examples/practice/large_business/#_2","title":"\u2699\ufe0f \u0420\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0451\u043d\u043d\u0430\u044f \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u0437\u0430\u0434\u0430\u0447","text":"<p>\u0420\u0430\u0437\u0432\u0451\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 \u0432\u043e\u0440\u043a\u0435\u0440\u043e\u0432 \u043d\u0430 \u0440\u0430\u0437\u043d\u044b\u0445 \u0441\u0435\u0440\u0432\u0435\u0440\u0430\u0445/\u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430\u0445:</p> <pre><code>py -m qtasks -A myproject.qtasks_app run --worker-id node1\npy -m qtasks -A myproject.qtasks_app run --worker-id node2\n</code></pre> <p>\u041c\u043e\u0436\u043d\u043e \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0442\u044c \u0441 \u0440\u0430\u0437\u043d\u044b\u043c\u0438 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f\u043c\u0438 \u043f\u0440\u0438 \u043f\u043e\u043c\u043e\u0449\u0438 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f \u0438\u043b\u0438 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u043e\u0432 \u043a\u043e\u043c\u0430\u043d\u0434\u043d\u043e\u0439 \u0441\u0442\u0440\u043e\u043a\u0438.</p>"},{"location":"ru/examples/practice/large_business/#kafka","title":"\ud83d\udd00 \u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f \u0441 Kafka \u0438 \u0434\u0440\u0443\u0433\u0438\u043c\u0438 \u0431\u0440\u043e\u043a\u0435\u0440\u0430\u043c\u0438","text":"<pre><code>from my_kafka_broker import KafkaBroker\n\napp = QueueTasks(broker=KafkaBroker(...))\n</code></pre> <p>\u0422\u0430\u043a\u0436\u0435 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u044e\u0442\u0441\u044f \u043a\u0430\u0441\u0442\u043e\u043c\u043d\u044b\u0435 <code>Storage</code>, <code>GlobalConfig</code> \u0438 \u0434\u0440\u0443\u0433\u0438\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b.</p>"},{"location":"ru/examples/practice/large_business/#taskmanager","title":"\ud83e\udde9 TaskManager \u0434\u043b\u044f \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0441\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u044f\u043c\u0438 \u0437\u0430\u0434\u0430\u0447","text":"<pre><code>from qtasks.components.task_manager import TaskManager\n\nclass MyManager(TaskManager):\n    def mutate(self, task):\n        if task.name == \"heavy_task\":\n            task.timeout = 120\n        return task\n\napp.config.task_manager = MyManager()\n</code></pre>"},{"location":"ru/examples/practice/large_business/#bi","title":"\ud83d\udcca \u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f \u0441 BI \u0438 \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u043c\u0438 \u0441\u0435\u0440\u0432\u0438\u0441\u0430\u043c\u0438","text":"<p>\u0421 \u043f\u043e\u043c\u043e\u0449\u044c\u044e <code>generate_handler</code>, <code>yield</code>, <code>middlewares</code>, \u0437\u0430\u0434\u0430\u0447 \u043c\u043e\u0436\u043d\u043e \u0441\u0442\u0440\u043e\u0438\u0442\u044c \u0441\u043b\u043e\u0436\u043d\u044b\u0435 \u043f\u0430\u0439\u043f\u043b\u0430\u0439\u043d\u044b:</p> <pre><code>@app.task(generate_handler=send_to_bi)\ndef export_metrics():\n    for report in generate_big_reports():\n        yield report\n</code></pre>"},{"location":"ru/examples/practice/large_business/#_3","title":"\ud83e\udde0 \u041a\u043e\u043d\u0442\u0440\u043e\u043b\u044c \u0438 \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433","text":"<p>\u0412 \u0441\u0432\u044f\u0437\u043a\u0435 \u0441 QTasks WebView \u043c\u043e\u0436\u043d\u043e:</p> <ul> <li>\u043e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u0442\u044c \u0441\u0442\u0430\u0442\u0443\u0441 \u0437\u0430\u0434\u0430\u0447;</li> <li>\u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e \u0442\u0438\u043f\u0430\u043c/\u043e\u0448\u0438\u0431\u043a\u0430\u043c/\u0432\u0440\u0435\u043c\u0435\u043d\u0438;</li> <li>\u043e\u0442\u043c\u0435\u043d\u044f\u0442\u044c, \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0442\u044c, \u043f\u0440\u043e\u0441\u043c\u0430\u0442\u0440\u0438\u0432\u0430\u0442\u044c \u043b\u043e\u0433\u0438;</li> <li>\u0438\u043d\u0442\u0435\u0433\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432 \u043a\u043e\u0440\u043f\u043e\u0440\u0430\u0442\u0438\u0432\u043d\u044b\u0435 \u043f\u0430\u043d\u0435\u043b\u0438 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f.</li> </ul>"},{"location":"ru/examples/practice/large_business/#_4","title":"\u2705 \u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442","text":"<p>QTasks \u0432 \u043a\u0440\u0443\u043f\u043d\u043e\u0439 \u043a\u043e\u043c\u043f\u0430\u043d\u0438\u0438 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442:</p> <ul> <li>\u0433\u0438\u0431\u043a\u043e \u043d\u0430\u0441\u0442\u0440\u0430\u0438\u0432\u0430\u0442\u044c \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b (\u0431\u0440\u043e\u043a\u0435\u0440, storage, config);</li> <li>\u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0451\u043d\u043d\u043e\u0439 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u043e\u0439 \u0437\u0430\u0434\u0430\u0447;</li> <li>\u0440\u0430\u0441\u0448\u0438\u0440\u044f\u0442\u044c \u043f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447 \u0431\u0435\u0437 \u043f\u0435\u0440\u0435\u043f\u0438\u0441\u044b\u0432\u0430\u043d\u0438\u044f \u044f\u0434\u0440\u0430;</li> <li>\u0438\u043d\u0442\u0435\u0433\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0441 BI, \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u043e\u043c, \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435\u043c, Kafka, REST, gRPC \u0438 \u0434\u0440.</li> </ul> <p>\u042d\u0442\u043e \u043f\u0440\u0435\u0432\u0440\u0430\u0449\u0430\u0435\u0442 QTasks \u0432 \u043e\u0441\u043d\u043e\u0432\u0443 \u0444\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a\u0430 \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0437\u0430\u0446\u0438\u0438 \u0438 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0441\u043e\u0431\u044b\u0442\u0438\u0439 \u043a\u043e\u0440\u043f\u043e\u0440\u0430\u0442\u0438\u0432\u043d\u043e\u0433\u043e \u0443\u0440\u043e\u0432\u043d\u044f.</p>"},{"location":"ru/examples/practice/small_business/","title":"\u041f\u0440\u0438\u043c\u0435\u0440 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f QTasks \u0434\u043b\u044f \u043c\u0430\u043b\u043e\u0433\u043e \u0431\u0438\u0437\u043d\u0435\u0441\u0430","text":"<p>\u041c\u0430\u043b\u044b\u0439 \u0431\u0438\u0437\u043d\u0435\u0441 \u0447\u0430\u0441\u0442\u043e \u0441\u0442\u0430\u043b\u043a\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u0441 \u0437\u0430\u0434\u0430\u0447\u0430\u043c\u0438 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0437\u0430\u0446\u0438\u0438: \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f, \u043e\u0442\u0447\u0451\u0442\u044b, \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438 \u0441 CRM, \u043e\u0431\u043c\u0435\u043d \u0434\u0430\u043d\u043d\u044b\u043c\u0438 \u043c\u0435\u0436\u0434\u0443 \u0441\u0435\u0440\u0432\u0438\u0441\u0430\u043c\u0438. QTasks \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u043b\u0451\u0433\u043a\u0443\u044e, \u043d\u043e \u043c\u043e\u0449\u043d\u0443\u044e \u043f\u043b\u0430\u0442\u0444\u043e\u0440\u043c\u0443, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0441\u0442\u0440\u043e\u0438\u0442\u044c \u043d\u0430\u0434\u0451\u0436\u043d\u044b\u0435 \u0440\u0435\u0448\u0435\u043d\u0438\u044f \u0431\u0435\u0437 \u0442\u044f\u0436\u0451\u043b\u044b\u0445 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u043d\u044b\u0445 \u0437\u0430\u0442\u0440\u0430\u0442.</p>"},{"location":"ru/examples/practice/small_business/#_1","title":"\ud83c\udfea \u0421\u0446\u0435\u043d\u0430\u0440\u0438\u0439","text":"<p>\u0414\u043e\u043f\u0443\u0441\u0442\u0438\u043c, \u0443 \u0432\u0430\u0441 \u0435\u0441\u0442\u044c \u0438\u043d\u0442\u0435\u0440\u043d\u0435\u0442-\u043c\u0430\u0433\u0430\u0437\u0438\u043d. \u0412\u0430\u043c \u043d\u0443\u0436\u043d\u043e:</p> <ol> <li>\u0410\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u044f\u0442\u044c \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u0432 \u043e \u0441\u0442\u0430\u0442\u0443\u0441\u0435 \u0437\u0430\u043a\u0430\u0437\u0430.</li> <li>\u0421\u043e\u0431\u0438\u0440\u0430\u0442\u044c \u0435\u0436\u0435\u0434\u043d\u0435\u0432\u043d\u0443\u044e \u0430\u043d\u0430\u043b\u0438\u0442\u0438\u043a\u0443 \u043f\u043e \u043f\u0440\u043e\u0434\u0430\u0436\u0430\u043c.</li> <li>\u0418\u043d\u0442\u0435\u0433\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0441 \u0432\u043d\u0435\u0448\u043d\u0435\u0439 CRM.</li> </ol>"},{"location":"ru/examples/practice/small_business/#_2","title":"\ud83d\udce6 \u0423\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f \u043a\u043b\u0438\u0435\u043d\u0442\u0430\u043c","text":"<pre><code>@app.task(name=\"notify_status\")\nasync def notify_status(order_id: int):\n    order = await db.get_order(order_id)\n    await sms_api.send(order.phone, f\"\u0412\u0430\u0448 \u0437\u0430\u043a\u0430\u0437 {order.id} \u0441\u0435\u0439\u0447\u0430\u0441: {order.status}\")\n</code></pre>"},{"location":"ru/examples/practice/small_business/#_3","title":"\ud83d\udcca \u0415\u0436\u0435\u0434\u043d\u0435\u0432\u043d\u0430\u044f \u0430\u043d\u0430\u043b\u0438\u0442\u0438\u043a\u0430 \u0441 \u0442\u0430\u0439\u043c\u0435\u0440\u043e\u043c","text":"<pre><code>from qtasks.timers import AsyncTimer\nfrom apscheduler.triggers.cron import CronTrigger\n\ntimer = AsyncTimer(app=app)\n\ntimer.add_task(\"daily_report\", trigger=CronTrigger(hour=23, minute=59))\n\n@app.task(name=\"daily_report\")\nasync def daily_report():\n    stats = await db.get_today_stats()\n    await mailer.send(\"owner@shop.com\", \"\u0415\u0436\u0435\u0434\u043d\u0435\u0432\u043d\u044b\u0439 \u043e\u0442\u0447\u0451\u0442\", stats.format())\n</code></pre>"},{"location":"ru/examples/practice/small_business/#crm-yield-generate_handler","title":"\ud83d\udd17 \u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f \u0441 CRM \u0447\u0435\u0440\u0435\u0437 <code>yield</code> \u0438 <code>generate_handler</code>","text":"<pre><code>async def log_crm(result):\n    await crm_api.send_log(result)\n    return result\n\n@app.task(generate_handler=log_crm, echo=True)\nasync def export_orders():\n    for order in await db.get_exportable_orders():\n        yield order.to_dict()\n</code></pre>"},{"location":"ru/examples/practice/small_business/#_4","title":"\ud83d\udee0 \u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u043e\u0448\u0438\u0431\u043e\u043a \u0438 \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u043a \u0437\u0430\u0434\u0430\u0447","text":"<pre><code>@app.task(retry=3, retry_on_exc=[ConnectionError])\nasync def sync_with_crm():\n    await crm_api.sync()\n</code></pre>"},{"location":"ru/examples/practice/small_business/#qtasks_1","title":"\ud83d\udcc8 \u041f\u0440\u0435\u0438\u043c\u0443\u0449\u0435\u0441\u0442\u0432\u0430 QTasks \u0434\u043b\u044f \u0431\u0438\u0437\u043d\u0435\u0441\u0430","text":"<ul> <li>\u0410\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0437\u0430\u0446\u0438\u044f \u0431\u0435\u0437 \u0432\u043d\u0435\u0448\u043d\u0438\u0445 \u043e\u0447\u0435\u0440\u0435\u0434\u0435\u0439 (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e)</li> <li>\u0423\u0434\u043e\u0431\u043d\u044b\u0435 \u0442\u0430\u0439\u043c\u0435\u0440\u044b \u0434\u043b\u044f \u0435\u0436\u0435\u0434\u043d\u0435\u0432\u043d\u044b\u0445 \u0438 \u0435\u0436\u0435\u043d\u0435\u0434\u0435\u043b\u044c\u043d\u044b\u0445 \u0437\u0430\u0434\u0430\u0447</li> <li>\u0412\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u0430\u044f \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u043e\u0448\u0438\u0431\u043e\u043a \u0438 \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u043a\u043e\u0432</li> <li>\u0413\u0438\u0431\u043a\u0430\u044f \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430: \u043c\u043e\u0436\u043d\u043e \u0440\u0430\u0441\u0448\u0438\u0440\u044f\u0442\u044c \u043f\u043e\u0434 \u043d\u0443\u0436\u0434\u044b CRM, BI, \u0441\u043a\u043b\u0430\u0434\u043e\u0432 \u0438 \u043b\u043e\u0433\u0438\u0441\u0442\u0438\u043a\u0438</li> </ul>"},{"location":"ru/examples/practice/small_business/#_5","title":"\u2705 \u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442","text":"<p>\u0421 \u043f\u043e\u043c\u043e\u0449\u044c\u044e QTasks \u043c\u0430\u043b\u044b\u0439 \u0431\u0438\u0437\u043d\u0435\u0441 \u043c\u043e\u0436\u0435\u0442 \u0432\u044b\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u0443\u044e \u0441\u0438\u0441\u0442\u0435\u043c\u0443 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0434\u0430\u043d\u043d\u044b\u0445, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u0431\u0443\u0434\u0435\u0442 \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u0441\u0442\u0430\u0431\u0438\u043b\u044c\u043d\u043e, \u043c\u0430\u0441\u0448\u0442\u0430\u0431\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u043f\u043e \u043c\u0435\u0440\u0435 \u0440\u043e\u0441\u0442\u0430 \u0438 \u043d\u0435 \u043f\u043e\u0442\u0440\u0435\u0431\u0443\u0435\u0442 \u043e\u0442 \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u0441\u043b\u043e\u0436\u043d\u043e\u0439 DevOps-\u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b.</p>"},{"location":"ru/features/","title":"\u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 QTasks","text":"<p>QTasks \u2014 \u044d\u0442\u043e \u0441\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0439 \u0444\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a \u0434\u043b\u044f \u043e\u0447\u0435\u0440\u0435\u0434\u0435\u0439 \u0437\u0430\u0434\u0430\u0447, \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0439 \u0432\u043e\u043a\u0440\u0443\u0433 \u0438\u0434\u0435\u0438 \u043f\u043e\u043b\u043d\u043e\u0439 \u0440\u0430\u0441\u0448\u0438\u0440\u044f\u0435\u043c\u043e\u0441\u0442\u0438, \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u0438\u0441\u0442\u0438\u0447\u043d\u043e\u0439 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u044b \u0438 \u0443\u0434\u043e\u0431\u0441\u0442\u0432\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f. \u041e\u043d \u043e\u0434\u0438\u043d\u0430\u043a\u043e\u0432\u043e \u0445\u043e\u0440\u043e\u0448\u043e \u043f\u043e\u0434\u0445\u043e\u0434\u0438\u0442 \u0434\u043b\u044f \u043d\u0435\u0431\u043e\u043b\u044c\u0448\u0438\u0445 \u043f\u0440\u043e\u0435\u043a\u0442\u043e\u0432 \u0438 \u043a\u0440\u0443\u043f\u043d\u043e\u0439 \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0451\u043d\u043d\u043e\u0439 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b.</p> <p>\u042d\u0442\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043e\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442 \u043a\u043b\u044e\u0447\u0435\u0432\u044b\u0435 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u0444\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a\u0430, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0435\u0433\u043e \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0435 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u044b\u0435 \u043e\u0441\u043e\u0431\u0435\u043d\u043d\u043e\u0441\u0442\u0438.</p>"},{"location":"ru/features/#_1","title":"\u041f\u0440\u043e\u0441\u0442\u0430\u044f \u0438 \u0431\u044b\u0441\u0442\u0440\u0430\u044f \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430","text":"<ul> <li>\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u0437\u0430\u0434\u0430\u0447 \u0447\u0435\u0440\u0435\u0437 <code>@app.task</code> \u2014 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0445 \u0438 \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0445.</li> <li>\u041d\u0430\u0442\u0438\u0432\u043d\u0430\u044f \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 <code>asyncio</code> \u0431\u0435\u0437 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0439 GIL.</li> <li>\u041b\u0451\u0433\u043a\u043e\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0447\u0435\u0440\u0435\u0437 CLI: <code>qtasks -A app:app run</code>.</li> <li>\u0413\u0438\u0431\u043a\u0430\u044f \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f: \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0438\u043b\u0438 \u043a\u0430\u0441\u0442\u043e\u043c\u043d\u044b\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b.</li> </ul>"},{"location":"ru/features/#_2","title":"\u0423\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0435 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u044b\u0435 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438","text":""},{"location":"ru/features/#_3","title":"\ud83d\udd27 \u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043d\u0430\u044f \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430","text":"<p>\u041a\u0430\u0436\u0434\u044b\u0439 \u044d\u043b\u0435\u043c\u0435\u043d\u0442 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u043c\u043e\u0436\u043d\u043e \u0437\u0430\u043c\u0435\u043d\u0438\u0442\u044c:</p> <ul> <li>Broker</li> <li>Worker</li> <li>Storage</li> <li>GlobalConfig</li> <li>Starter</li> <li>TaskExecutor</li> </ul> <p>\u042d\u0442\u043e \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0430\u0434\u0430\u043f\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c QTasks \u043f\u043e\u0434 \u043b\u044e\u0431\u044b\u0435 \u0441\u0446\u0435\u043d\u0430\u0440\u0438\u0438: in-memory \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435, \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0451\u043d\u043d\u044b\u0435 \u0441\u0438\u0441\u0442\u0435\u043c\u044b, \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0435 \u0431\u0440\u043e\u043a\u0435\u0440\u044b, \u0430\u043b\u044c\u0442\u0435\u0440\u043d\u0430\u0442\u0438\u0432\u043d\u044b\u0435 executors.</p>"},{"location":"ru/features/#taskexecutor","title":"\u2699\ufe0f \u041f\u043e\u043b\u043d\u043e\u0441\u0442\u044c\u044e \u0437\u0430\u043c\u0435\u043d\u044f\u0435\u043c\u044b\u0439 TaskExecutor","text":"<p>\u041b\u043e\u0433\u0438\u043a\u0430 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447 \u0438\u0437\u043e\u043b\u0438\u0440\u043e\u0432\u0430\u043d\u0430 \u0432 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u043e\u043c \u043a\u043b\u0430\u0441\u0441\u0435. \u0415\u0433\u043e \u043c\u043e\u0436\u043d\u043e \u0437\u0430\u043c\u0435\u043d\u0438\u0442\u044c \u0447\u0435\u0440\u0435\u0437:</p> <pre><code>@app.task(executor=MyTaskExecutor)\n</code></pre> <p>\u042d\u0442\u043e \u0434\u0430\u0451\u0442 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c \u043d\u0430\u0434:</p> <ul> <li>\u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u043e\u0439 \u043e\u0448\u0438\u0431\u043e\u043a,</li> <li>retry-\u0441\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u044f\u043c\u0438,</li> <li>middleware,</li> <li>\u043a\u0430\u0441\u0442\u043e\u043c\u043d\u044b\u043c\u0438 \u043f\u0430\u0439\u043f\u043b\u0430\u0439\u043d\u0430\u043c\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f.</li> </ul>"},{"location":"ru/features/#_4","title":"\u0420\u0430\u0431\u043e\u0442\u0430 \u0441 \u0437\u0430\u0434\u0430\u0447\u0430\u043c\u0438","text":""},{"location":"ru/features/#yield","title":"\u2714\ufe0f \u041f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 <code>yield</code> \u0432 \u0437\u0430\u0434\u0430\u0447\u0430\u0445","text":"<p>QTasks \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0433\u0435\u043d\u0435\u0440\u0430\u0442\u043e\u0440\u044b \u0432 \u0437\u0430\u0434\u0430\u0447\u0430\u0445.</p> <pre><code>@app.task(generate_handler=gen_handler)\ndef mytask():\n    value = yield \"step1\"\n    return value\n</code></pre> <p><code>gen_handler(result)</code> \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0435\u0442 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435, \u043f\u0435\u0440\u0435\u0434\u0430\u043d\u043d\u043e\u0435 \u0447\u0435\u0440\u0435\u0437 yield, \u0430 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 <code>return</code> \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442\u0441\u044f \u0432 \u0437\u0430\u0434\u0430\u0447\u0443.</p> <p>\u042d\u0442\u043e \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0441\u0442\u0440\u043e\u0438\u0442\u044c \u043f\u043e\u044d\u0442\u0430\u043f\u043d\u044b\u0435 \u0441\u0446\u0435\u043d\u0430\u0440\u0438\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447.</p>"},{"location":"ru/features/#depends","title":"\u2714\ufe0f \u041f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 Depends","text":"<p>\u041f\u043b\u0430\u0433\u0438\u043d Depends \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0432\u043d\u0435\u0434\u0440\u044f\u0442\u044c \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u0432 \u0437\u0430\u0434\u0430\u0447\u0438.</p> <pre><code>@app.task\ndef process(data: int, db=Depends(get_db, scope=\"worker\")):\n    return db.save(data)\n</code></pre> <p>Scopes:</p> <ul> <li><code>task</code></li> <li><code>worker</code></li> <li><code>broker</code></li> <li><code>storage</code></li> <li><code>global_config</code></li> </ul> <p>\u0424\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0441\u043e\u0437\u0434\u0430\u0451\u0442 \u0438 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e \u0437\u0430\u043a\u0440\u044b\u0432\u0430\u0435\u0442 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438.</p>"},{"location":"ru/features/#state","title":"\u2714\ufe0f \u041f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 State","text":"<p>\u041f\u043e\u0442\u043e\u043a\u043e\u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u044b\u0439 \u0441\u043f\u043e\u0441\u043e\u0431 \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u043c\u0435\u0436\u0434\u0443 \u0437\u0430\u0434\u0430\u0447\u0430\u043c\u0438.</p> <pre><code>from qtasks.plugins import AsyncState\n\nclass MyState(AsyncState):\n    pass\n\n@app.task\ndef sample(state: MyState):\n    ...\n</code></pre> <p>State \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0437\u0430\u0434\u0430\u0447\u0435 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e \u043f\u0435\u0440\u0435\u0434\u0430\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u043c\u0435\u0436\u0443\u0442\u043e\u0447\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u043e\u044d\u0442\u0430\u043f\u043d\u043e.</p>"},{"location":"ru/features/#_5","title":"\u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f \u0441 \u0431\u0440\u043e\u043a\u0435\u0440\u0430\u043c\u0438 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439","text":"<ul> <li>Redis \u2014 \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u043c\u044b\u0439 \u0431\u0440\u043e\u043a\u0435\u0440.</li> <li>RabbitMQ \u2014 \u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d \u0447\u0435\u0440\u0435\u0437 \u0434\u043e\u043f. \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0443.</li> <li>Kafka \u2014 \u0442\u0430\u043a\u0436\u0435 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442\u0441\u044f.</li> </ul> <p>\u0411\u0440\u043e\u043a\u0435\u0440\u044b \u043b\u0435\u0433\u043a\u043e \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u044e\u0442\u0441\u044f:</p> <pre><code>app = QueueTasks(broker_url=\"redis://localhost:6379/0\")\n</code></pre> <p>\u041f\u0440\u0438 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438 \u043c\u043e\u0436\u043d\u043e \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u0443\u044e \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044e \u0431\u0440\u043e\u043a\u0435\u0440\u0430.</p>"},{"location":"ru/features/#_6","title":"\u0420\u0430\u0441\u0448\u0438\u0440\u044f\u0435\u043c\u043e\u0441\u0442\u044c \u0438 \u043f\u043b\u0430\u0433\u0438\u043d\u044b","text":"<p>QTasks \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u043c\u043d\u043e\u0433\u043e\u0443\u0440\u043e\u0432\u043d\u0435\u0432\u0443\u044e \u0441\u0438\u0441\u0442\u0435\u043c\u0443 \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u043e\u0432:</p> <ul> <li>\u043d\u0430 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447,</li> <li>\u043d\u0430 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u043e\u0432,</li> <li>\u043d\u0430 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430,</li> <li>\u043d\u0430 \u0441\u043e\u0431\u044b\u0442\u0438\u044f \u0432\u043d\u0443\u0442\u0440\u0438 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432.</li> </ul> <p>\u041f\u043b\u0430\u0433\u0438\u043d \u043b\u0435\u0433\u043a\u043e \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c:</p> <pre><code>app.add_plugin(MyPlugin(), trigger_names=[\"task_executor_args_replace\"], component=\"worker\")\n</code></pre> <p>\u0424\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0445 \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u043e\u0432: gRPC-\u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0430 \u0437\u0430\u0434\u0430\u0447, \u0443\u043d\u0438\u0444\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0435 middleware, Depends, State.</p>"},{"location":"ru/features/#_7","title":"\u041c\u0430\u0441\u0448\u0442\u0430\u0431\u0438\u0440\u0443\u0435\u043c\u043e\u0441\u0442\u044c","text":"<p>QTasks \u043c\u0430\u0441\u0448\u0442\u0430\u0431\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0433\u043e\u0440\u0438\u0437\u043e\u043d\u0442\u0430\u043b\u044c\u043d\u043e \u0431\u043b\u0430\u0433\u043e\u0434\u0430\u0440\u044f \u043f\u0440\u043e\u0441\u0442\u043e\u0439, \u043d\u0430\u0434\u0451\u0436\u043d\u043e\u0439 \u043c\u043e\u0434\u0435\u043b\u0438:</p> <p>\u00ab\u041a\u0442\u043e \u043f\u0435\u0440\u0432\u044b\u0439 \u0432\u0437\u044f\u043b \u0437\u0430\u0434\u0430\u0447\u0443, \u0442\u043e\u0442 \u0438 \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0435\u0442\u00bb.</p> <p>\u042d\u0442\u043e \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442:</p> <ul> <li>\u0440\u0430\u0431\u043e\u0442\u0443 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 \u0432\u043e\u0440\u043a\u0435\u0440\u043e\u0432 \u043e\u0434\u043d\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e;</li> <li>\u0435\u0441\u0442\u0435\u0441\u0442\u0432\u0435\u043d\u043d\u0443\u044e \u0431\u0430\u043b\u0430\u043d\u0441\u0438\u0440\u043e\u0432\u043a\u0443 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438;</li> <li>\u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0451\u043d\u043d\u043e\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447 \u0431\u0435\u0437 \u0441\u043b\u043e\u0436\u043d\u044b\u0445 \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c\u043e\u0432.</li> </ul>"},{"location":"ru/features/#_8","title":"\u0410\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u0430\u044f \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u0437\u0430\u0434\u0430\u0447","text":"<p>\u0410\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0439 \u0440\u0435\u0436\u0438\u043c \u0438\u043c\u0435\u0435\u0442 \u043f\u0440\u0435\u0438\u043c\u0443\u0449\u0435\u0441\u0442\u0432\u0430:</p> <ul> <li>\u0432\u044b\u0441\u043e\u043a\u0430\u044f \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c;</li> <li>\u043f\u043e\u0442\u043e\u043a\u043e\u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c (\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f Semaphore \u0438 PriorityQueue);</li> <li>\u0438\u043d\u043a\u0430\u043f\u0441\u0443\u043b\u044f\u0446\u0438\u044f \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0430 \u0437\u0430\u0434\u0430\u0447;</li> <li>\u043b\u0435\u0433\u043a\u043e \u0432\u043d\u0435\u0434\u0440\u044f\u0435\u0442\u0441\u044f \u0432\u043d\u0443\u0442\u0440\u044c \u0434\u0440\u0443\u0433\u0438\u0445 \u0444\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a\u043e\u0432.</li> </ul> <p>\u0410\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0435 \u0437\u0430\u0434\u0430\u0447\u0438 \u043e\u0431\u044a\u044f\u0432\u043b\u044f\u044e\u0442\u0441\u044f \u043a\u0430\u043a:</p> <pre><code>@app.task\nasync def handler(x: int):\n    return x * 2\n</code></pre>"},{"location":"ru/features/#_9","title":"\u041c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433 \u0438 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430","text":"<p>(\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0430\u043d\u0430\u043b\u0438\u0442\u0438\u043a\u0438 \u2014 \u043d\u0430 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435.)</p> <p>\u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u0432\u043a\u043b\u044e\u0447\u0430\u044e\u0442:</p> <ul> <li><code>(A)syncStats</code> \u0434\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0438 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439 \u0438 \u0437\u0430\u0434\u0430\u0447;</li> <li>\u0432\u044b\u0432\u043e\u0434 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0438 \u0447\u0435\u0440\u0435\u0437 CLI: <code>qtasks stats inspect ...</code>.</li> </ul> <p>\u042d\u0442\u0438 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u0434\u0435\u043b\u0430\u044e\u0442 QTasks \u043d\u0435 \u043f\u0440\u043e\u0441\u0442\u043e \u043e\u0447\u0435\u0440\u0435\u0434\u044c\u044e \u0437\u0430\u0434\u0430\u0447, \u0430 \u0433\u0438\u0431\u043a\u0438\u043c \u0438 \u0440\u0430\u0441\u0448\u0438\u0440\u044f\u0435\u043c\u044b\u043c \u0444\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a\u043e\u043c, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043b\u0435\u0433\u043a\u043e \u0430\u0434\u0430\u043f\u0442\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u043f\u043e\u0434 \u0440\u0435\u0430\u043b\u044c\u043d\u044b\u0435 \u0431\u0438\u0437\u043d\u0435\u0441-\u0441\u0446\u0435\u043d\u0430\u0440\u0438\u0438.</p>"},{"location":"ru/features/contexts/","title":"Contexts \u2014 \u041a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u044b \u0437\u0430\u0434\u0430\u0447","text":"<p>\u041a\u0430\u0436\u0434\u0430\u044f \u0437\u0430\u0434\u0430\u0447\u0430 QTasks \u0432\u043e \u0432\u0440\u0435\u043c\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0443 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u2014 \u043e\u0431\u044a\u0435\u043a\u0442\u0443 (A)syncContext. \u041a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u044b\u0439 \u0438 \u0443\u043d\u0438\u0444\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0439 \u0441\u043f\u043e\u0441\u043e\u0431 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u0437\u0430\u0434\u0430\u0447\u0438 \u0441 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u0435\u043c \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f, \u0432\u043e\u0440\u043a\u0435\u0440\u043e\u043c, \u043f\u043b\u0430\u0433\u0438\u043d\u0430\u043c\u0438 \u0438 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u043c\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f.</p> <p>\u041a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d \u0447\u0435\u0440\u0435\u0437 <code>self.ctx</code> \u0432\u043d\u0443\u0442\u0440\u0438 \u043e\u0431\u044a\u0435\u043a\u0442\u0430 <code>(A)syncTask</code>.</p>"},{"location":"ru/features/contexts/#_1","title":"\u041f\u0435\u0440\u0435\u0434\u0430\u0447\u0430 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0430 \u0432 \u0444\u0443\u043d\u043a\u0446\u0438\u044e \u0437\u0430\u0434\u0430\u0447\u0438","text":"<p>\u041a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0435\u0440\u0435\u0434\u0430\u043d \u043d\u0430\u043f\u0440\u044f\u043c\u0443\u044e \u0432 \u0444\u0443\u043d\u043a\u0446\u0438\u044e \u0437\u0430\u0434\u0430\u0447\u0438 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430 <code>echo=True</code> \u0432 \u0434\u0435\u043a\u043e\u0440\u0430\u0442\u043e\u0440\u0435 <code>@app.task</code>.</p> <pre><code>@app.task(echo=True)\nasync def my_task(self):\n    print(self.ctx.task_name)\n</code></pre> <p>\u0412 \u044d\u0442\u043e\u043c \u0441\u043b\u0443\u0447\u0430\u0435:</p> <ul> <li>\u043f\u0435\u0440\u0432\u044b\u043c \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u043e\u043c \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u043f\u0435\u0440\u0435\u0434\u0430\u0451\u0442\u0441\u044f \u0434\u0443\u0431\u043b\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0439 (A)syncContext;</li> <li>\u0438\u043c\u044f \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043b\u044e\u0431\u044b\u043c;</li> <li>\u0434\u043b\u044f \u0443\u0434\u043e\u0431\u0441\u0442\u0432\u0430 \u0438 \u0435\u0434\u0438\u043d\u043e\u043e\u0431\u0440\u0430\u0437\u0438\u044f \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0443\u0435\u0442\u0441\u044f \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0438\u043c\u044f <code>self</code>.</li> </ul> <p>\u041a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043d\u0430 \u044d\u0442\u0430\u043f\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447\u0438 \u0438 \u043d\u0435 \u0432\u043b\u0438\u044f\u0435\u0442 \u043d\u0430 \u0435\u0451 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044e.</p>"},{"location":"ru/features/contexts/#_2","title":"\u041d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0430","text":"<p>(A)syncContext \u043f\u0440\u0435\u0434\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d \u0434\u043b\u044f:</p> <ul> <li>\u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u0434\u0430\u043d\u043d\u044b\u043c \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u0437\u0430\u0434\u0430\u0447\u0438;</li> <li>\u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u0441 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435\u043c (<code>QueueTasks</code>);</li> <li>\u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435\u043c;</li> <li>\u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435\u043c (sleep, cancel);</li> <li>\u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u0441 \u043f\u043b\u0430\u0433\u0438\u043d\u0430\u043c\u0438 \u0438 \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u0430\u043c\u0438;</li> <li>\u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0445 \u0438 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438.</li> </ul> <p>\u041a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 \u043d\u0435 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0431\u0438\u0437\u043d\u0435\u0441-\u043b\u043e\u0433\u0438\u043a\u0438 \u0438 \u0441\u043b\u0443\u0436\u0438\u0442 \u0438\u0441\u043a\u043b\u044e\u0447\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u043e\u043c \u0441\u0440\u0435\u0434\u044b \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f.</p>"},{"location":"ru/features/contexts/#_3","title":"\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u0441\u0432\u043e\u0439\u0441\u0442\u0432\u0430 \u0438 \u043c\u0435\u0442\u043e\u0434\u044b","text":""},{"location":"ru/features/contexts/#_4","title":"\u0418\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f \u0437\u0430\u0434\u0430\u0447\u0438","text":"<ul> <li><code>self.ctx.task_name</code> \u2014 \u0438\u043c\u044f \u0437\u0430\u0434\u0430\u0447\u0438.</li> <li><code>self.ctx.task_uuid</code> \u2014 UUID \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u043c\u043e\u0439 \u0437\u0430\u0434\u0430\u0447\u0438.</li> </ul>"},{"location":"ru/features/contexts/#yield","title":"\u0413\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f \u0437\u0430\u0434\u0430\u0447 (yield)","text":"<ul> <li><code>self.ctx.generate_handler</code> \u2014 \u0444\u0443\u043d\u043a\u0446\u0438\u044f-\u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u0438 \u0434\u043b\u044f yield-\u0437\u0430\u0434\u0430\u0447.</li> </ul> <p>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0441\u043e\u0432\u043c\u0435\u0441\u0442\u043d\u043e \u0441 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u043c \u0434\u0435\u043a\u043e\u0440\u0430\u0442\u043e\u0440\u0430:</p> <pre><code>@app.task(generate_handler=gen_func)\n</code></pre>"},{"location":"ru/features/contexts/#_5","title":"\u041b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435","text":"<pre><code>self.ctx.get_logger(name: str | None = None)\n</code></pre> <p>\u0412\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440 <code>qtasks.logs.Logger</code>, \u043f\u0440\u0438\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0439 \u043a \u0437\u0430\u0434\u0430\u0447\u0435.</p> <ul> <li>\u0435\u0441\u043b\u0438 <code>name</code> \u043d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d \u2014 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f <code>task_name</code>;</li> <li>\u0435\u0441\u043b\u0438 \u0438\u043c\u044f \u0437\u0430\u0434\u0430\u0447\u0438 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u2014 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f <code>(A)syncContext</code>.</li> </ul>"},{"location":"ru/features/contexts/#_6","title":"\u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u0438 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0435","text":"<ul> <li> <p><code>self.ctx.get_config()</code> \u2014 \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 <code>app.config</code>.</p> </li> <li> <p><code>self.ctx.get_metadata(cache: bool = True)</code> \u2014 \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0435 \u0437\u0430\u0434\u0430\u0447\u0438 \u0447\u0435\u0440\u0435\u0437 <code>app.get(self.ctx.task_uuid)</code>.</p> </li> </ul> <p>\u041f\u0440\u0438 <code>cache=True</code> \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u043a\u0435\u0448\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0432\u043d\u0443\u0442\u0440\u0438 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0430 \u0438 \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u044b\u0435 \u0432\u044b\u0437\u043e\u0432\u044b \u043d\u0435 \u043e\u0431\u0440\u0430\u0449\u0430\u044e\u0442\u0441\u044f \u043a \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0443.</p>"},{"location":"ru/features/contexts/#_7","title":"\u0420\u0430\u0431\u043e\u0442\u0430 \u0441 \u0437\u0430\u0434\u0430\u0447\u0430\u043c\u0438","text":"<ul> <li><code>self.ctx.get_task(uuid: UUID | str)</code> \u2014 \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u0437\u0430\u0434\u0430\u0447\u0443 \u0447\u0435\u0440\u0435\u0437 <code>app.get(uuid)</code>.</li> </ul>"},{"location":"ru/features/contexts/#_8","title":"\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435\u043c","text":"<ul> <li> <p><code>self.ctx.sleep(seconds: float)</code> \u2014 \u0432\u044b\u0437\u044b\u0432\u0430\u0435\u0442 <code>time.sleep</code> \u0438\u043b\u0438 <code>asyncio.sleep</code> \u0432 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442 \u0442\u0438\u043f\u0430 \u0437\u0430\u0434\u0430\u0447\u0438.</p> </li> <li> <p><code>self.ctx.cancel(reason: str = \"\")</code> \u2014 \u0438\u043d\u0438\u0446\u0438\u0438\u0440\u0443\u0435\u0442 \u043e\u0442\u043c\u0435\u043d\u0443 \u0437\u0430\u0434\u0430\u0447\u0438 \u043f\u0443\u0442\u0451\u043c \u0432\u044b\u0431\u0440\u043e\u0441\u0430:</p> </li> </ul> <pre><code>raise TaskCancelError(reason or f\"{self.ctx.task_name}.cancel\")\n</code></pre> <p>\u041e\u0442\u043c\u0435\u043d\u0430 \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u0432\u043e\u0440\u043a\u0435\u0440\u043e\u043c \u043a\u0430\u043a \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e\u0435 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447\u0438.</p>"},{"location":"ru/features/contexts/#_9","title":"\u0412\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u0441 \u043f\u043b\u0430\u0433\u0438\u043d\u0430\u043c\u0438","text":"<ul> <li><code>self.ctx.plugin_error(**kwargs)</code> \u2014 \u0432\u044b\u0431\u0440\u0430\u0441\u044b\u0432\u0430\u0435\u0442 <code>TaskPluginTriggerError(**kwargs)</code>.</li> </ul> <p>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432, \u0438\u043c\u0435\u044e\u0449\u0438\u0445 \u0442\u0440\u0438\u0433\u0433\u0435\u0440:</p> <pre><code>task_executor_run_task_trigger_error\n</code></pre>"},{"location":"ru/features/contexts/#_10","title":"\u0414\u043e\u0441\u0442\u0443\u043f \u043a \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430\u043c \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f","text":"<ul> <li><code>self.ctx.get_component(name: str)</code> \u2014 \u044d\u043a\u0432\u0438\u0432\u0430\u043b\u0435\u043d\u0442\u0435\u043d <code>getattr(app, name, None)</code>.</li> </ul> <p>\u041f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u043b\u044e\u0431\u043e\u043c\u0443 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u043c\u0443 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0443 QTasks.</p>"},{"location":"ru/features/contexts/#app","title":"\u0418\u0441\u0442\u043e\u0447\u043d\u0438\u043a app","text":"<p>\u042d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440 <code>app</code> \u043f\u043e\u043f\u0430\u0434\u0430\u0435\u0442 \u0432 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 \u043e\u0434\u043d\u0438\u043c \u0438\u0437 \u0441\u043f\u043e\u0441\u043e\u0431\u043e\u0432:</p> <ul> <li>\u043d\u0430 \u044d\u0442\u0430\u043f\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447\u0438 \u0447\u0435\u0440\u0435\u0437 <code>TaskExecutor</code>, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0434\u043e\u043f\u043e\u043b\u043d\u044f\u0435\u0442 <code>(A)syncTask</code> \u0438 \u0435\u0433\u043e <code>ctx</code>;</li> <li>\u0447\u0435\u0440\u0435\u0437 \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u0443\u044e \u0441\u0441\u044b\u043b\u043a\u0443 <code>qtasks._state.app_main</code>, \u0435\u0441\u043b\u0438 \u0437\u0430\u0434\u0430\u0447\u0430 \u0431\u044b\u043b\u0430 \u0432\u044b\u0437\u0432\u0430\u043d\u0430 \u0432\u043d\u0435 \u044f\u0432\u043d\u043e\u0433\u043e \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0430.</li> </ul> <p>\u042d\u0442\u043e \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442 \u0435\u0434\u0438\u043d\u044b\u0439 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044e \u043d\u0435\u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e \u043e\u0442 \u0441\u0446\u0435\u043d\u0430\u0440\u0438\u044f \u0437\u0430\u043f\u0443\u0441\u043a\u0430.</p>"},{"location":"ru/features/contexts/#_11","title":"\u0418\u0442\u043e\u0433","text":"<p>(A)syncContext:</p> <ul> <li>\u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u043e\u043c \u0441\u0440\u0435\u0434\u044b \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447\u0438;</li> <li>\u0438\u0437\u043e\u043b\u0438\u0440\u0443\u0435\u0442 \u0431\u0438\u0437\u043d\u0435\u0441-\u043b\u043e\u0433\u0438\u043a\u0443 \u043e\u0442 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b;</li> <li>\u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438, \u043b\u043e\u0433\u0430\u043c \u0438 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u043c;</li> <li>\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0436\u0438\u0437\u043d\u0435\u043d\u043d\u044b\u043c \u0446\u0438\u043a\u043b\u043e\u043c \u0437\u0430\u0434\u0430\u0447\u0438;</li> <li>\u0441\u043b\u0443\u0436\u0438\u0442 \u0442\u043e\u0447\u043a\u043e\u0439 \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438 \u0441 \u043f\u043b\u0430\u0433\u0438\u043d\u0430\u043c\u0438 \u0438 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430\u043c\u0438.</li> </ul> <p>\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043e\u0444\u043e\u0440\u043c\u043b\u0435\u043d\u0430 \u043a\u0430\u043a \u0445\u043e\u043b\u0441\u0442 \u0438 \u043c\u043e\u0436\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u043a\u0430\u043a \u0431\u0430\u0437\u043e\u0432\u0430\u044f \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f \u0434\u043b\u044f \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0430, echo-\u0437\u0430\u0434\u0430\u0447 \u0438 \u043f\u043b\u0430\u0433\u0438\u043d\u043d\u044b\u0445 \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c\u043e\u0432 QTasks.</p>"},{"location":"ru/features/depends/","title":"Depends","text":"<p>QTasks \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u043c\u044b\u0435 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u0434\u043b\u044f \u0437\u0430\u0434\u0430\u0447 \u0447\u0435\u0440\u0435\u0437 \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c <code>Depends</code>. \u041e\u043d \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043e\u0431\u044a\u044f\u0432\u043b\u044f\u0442\u044c \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0437\u0430\u0434\u0430\u0447\u0438 \u0442\u0430\u043a, \u0447\u0442\u043e\u0431\u044b \u0438\u0445 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0441\u043e\u0437\u0434\u0430\u0432\u0430\u043b\u0438\u0441\u044c \u0438 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e \u043e\u0447\u0438\u0449\u0430\u043b\u0438\u0441\u044c \u0432 \u043d\u0443\u0436\u043d\u043e\u043c \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0435.</p>"},{"location":"ru/features/depends/#depends_1","title":"\u041f\u0440\u0438\u043c\u0435\u0440 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f Depends","text":"<pre><code>from typing import Annotated\nfrom contextlib import asynccontextmanager\n\nfrom qtasks.plugins.depends import Depends, ScopeEnum\n\n\n@asynccontextmanager\nasync def test_dep():\n    print(\"Open\")\n    yield 123\n    print(\"Close\")\n\n\n@app.task\nasync def test(dep: Annotated[int, Depends(test_dep, scope=ScopeEnum.TASK)]):\n    print(dep)\n</code></pre> <p>\u041f\u0440\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0438 \u0437\u0430\u0434\u0430\u0447\u0438 \u0432\u044b\u0432\u043e\u0434 \u0431\u0443\u0434\u0435\u0442 \u0442\u0430\u043a\u0438\u043c:</p> <pre><code>Open\n123\nClose\n</code></pre> <p>\u0427\u0442\u043e \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442:</p> <ul> <li>\u043f\u0440\u0438 \u0441\u0442\u0430\u0440\u0442\u0435 \u0437\u0430\u0434\u0430\u0447\u0438 \u043e\u0442\u043a\u0440\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 <code>test_dep()</code>;</li> <li>\u0432 \u0442\u0435\u043b\u043e \u0437\u0430\u0434\u0430\u0447\u0438 \u043f\u043e\u043f\u0430\u0434\u0430\u0435\u0442 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 <code>123</code>;</li> <li>\u043f\u0440\u0438 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u0438 \u0437\u0430\u0434\u0430\u0447\u0438 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 \u0437\u0430\u043a\u0440\u044b\u0432\u0430\u0435\u0442\u0441\u044f, \u0438 \u043f\u0435\u0447\u0430\u0442\u0430\u0435\u0442\u0441\u044f <code>Close</code>.</li> </ul>"},{"location":"ru/features/depends/#depends_2","title":"\u041a\u0430\u043a \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 Depends \"\u043f\u043e\u0434 \u043a\u0430\u043f\u043e\u0442\u043e\u043c\"","text":"<p>\u041c\u0435\u0445\u0430\u043d\u0438\u0437\u043c Depends \u0440\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d \u0432\u043e \u0432\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u043e\u043c \u043f\u043b\u0430\u0433\u0438\u043d\u0435 \u0432\u043e\u0440\u043a\u0435\u0440\u0430 \u2014 <code>(A)syncDependsPlugin</code>. \u041d\u0438\u0436\u0435 \u2014 \u0443\u043f\u0440\u043e\u0449\u0451\u043d\u043d\u043e\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0448\u0430\u0433\u043e\u0432.</p>"},{"location":"ru/features/depends/#1-depends","title":"1. \u041f\u043e\u0438\u0441\u043a Depends \u0432 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u0445 \u0437\u0430\u0434\u0430\u0447\u0438","text":"<p>\u041f\u0440\u0438 \u043f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0435 \u043a \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044e \u0437\u0430\u0434\u0430\u0447\u0438 \u043f\u043b\u0430\u0433\u0438\u043d:</p> <ul> <li>\u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442 \u043d\u0430\u043b\u0438\u0447\u0438\u0435 <code>Depends</code> \u043a\u0430\u043a \u044f\u0432\u043d\u043e\u0433\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430 (<code>dep = Depends(...)</code>);</li> <li>\u043b\u0438\u0431\u043e \u0438\u0449\u0435\u0442 \u0435\u0433\u043e \u0432\u043d\u0443\u0442\u0440\u0438 <code>Annotated[..., Depends(...)]</code> (\u0431\u0435\u0440\u0451\u0442 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0439 \u044d\u043b\u0435\u043c\u0435\u043d\u0442 <code>Annotated</code>).</li> </ul> <p>\u0415\u0441\u043b\u0438 <code>Depends</code> \u043d\u0430\u0439\u0434\u0435\u043d, \u0437\u0430\u0434\u0430\u0447\u0430 \u043f\u043e\u043c\u0435\u0447\u0430\u0435\u0442\u0441\u044f \u043a\u0430\u043a \u0438\u043c\u0435\u044e\u0449\u0430\u044f \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u044c.</p>"},{"location":"ru/features/depends/#2-asyncexitstack","title":"2. \u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0430 \u0447\u0435\u0440\u0435\u0437 (Async)ExitStack","text":"<p>\u0414\u043b\u044f \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0436\u0438\u0437\u043d\u0435\u043d\u043d\u044b\u043c \u0446\u0438\u043a\u043b\u043e\u043c \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f <code>AsyncExitStack</code> (\u0438\u043b\u0438 <code>ExitStack</code> \u0434\u043b\u044f \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0445 \u0437\u0430\u0434\u0430\u0447):</p> <ol> <li>\u041f\u043b\u0430\u0433\u0438\u043d \u0432\u0445\u043e\u0434\u0438\u0442 \u0432 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 <code>test_dep()</code> \u0447\u0435\u0440\u0435\u0437 \u0441\u0442\u0435\u043a \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u043d\u044b\u0445 \u043c\u0435\u043d\u0435\u0434\u0436\u0435\u0440\u043e\u0432.</li> <li>\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u043d\u043e\u0435 \u0438\u0437 <code>yield</code> \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 (\u0432 \u043f\u0440\u0438\u043c\u0435\u0440\u0435 \u2014 <code>123</code>) \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u0442\u0441\u044f \u043a\u0430\u043a \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430.</li> </ol>"},{"location":"ru/features/depends/#3-scope","title":"3. \u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 scope (\u043e\u0431\u043b\u0430\u0441\u0442\u0438 \u0436\u0438\u0437\u043d\u0438 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438)","text":"<p>\u0417\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u044c \u0436\u0438\u0432\u0451\u0442 \u0432 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0451\u043d\u043d\u043e\u0439 \"\u043e\u0431\u043b\u0430\u0441\u0442\u0438\" (scope), \u0437\u0430\u0434\u0430\u0432\u0430\u0435\u043c\u043e\u0439 <code>ScopeEnum</code>:</p> <pre><code>class ScopeEnum(Enum):\n    TASK = \"task\"\n    WORKER = \"worker\"\n    BROKER = \"broker\"\n    STORAGE = \"storage\"\n    GLOBAL_CONFIG = \"global_config\"\n</code></pre> <p>\u041b\u043e\u0433\u0438\u043a\u0430:</p> <ul> <li><code>TASK</code> \u2014 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 \u043e\u0442\u043a\u0440\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u043f\u0440\u0438 \u0441\u0442\u0430\u0440\u0442\u0435 \u0437\u0430\u0434\u0430\u0447\u0438 \u0438 \u0437\u0430\u043a\u0440\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u043f\u0440\u0438 \u0435\u0451 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u0438.</li> <li>\u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0435 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u044b (<code>WORKER</code>, <code>BROKER</code>, <code>STORAGE</code>, <code>GLOBAL_CONFIG</code>) \u043f\u0440\u0438\u0432\u044f\u0437\u044b\u0432\u0430\u044e\u0442 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 \u043a \u0440\u0435\u0441\u0443\u0440\u0441\u0443 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430.</li> </ul> <p>\u0422\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u0438 \u044d\u0442\u043e \u0440\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u043e \u0447\u0435\u0440\u0435\u0437 \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u044b:</p> <ul> <li><code>TASK</code> \u2014 \u0437\u0430\u043a\u0440\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u043d\u0430 \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u0435 <code>task_executor_task_close</code>;</li> <li>\u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0435 \u2014 \u043d\u0430 \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u0430\u0445 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u044f \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430: <code>\"{component}_stop\"</code>.</li> </ul>"},{"location":"ru/features/depends/#4","title":"4. \u041f\u043e\u0434\u043c\u0435\u043d\u0430 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u0430 \u0437\u0430\u0434\u0430\u0447\u0438","text":"<p>\u041f\u043e\u0441\u043b\u0435 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0438\u0437 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043f\u043b\u0430\u0433\u0438\u043d:</p> <ul> <li>\u0437\u0430\u043c\u0435\u043d\u044f\u0435\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 \u0437\u0430\u0434\u0430\u0447\u0438 (<code>dep</code>) \u043d\u0430 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 <code>test_dep()</code>;</li> <li>\u0437\u0430\u0434\u0430\u0447\u0430 \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0443\u0436\u0435 \u0433\u043e\u0442\u043e\u0432\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u043e\u0442\u043a\u0440\u044b\u0442\u043e\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435, \u043e\u0431\u044a\u0435\u043a\u0442 \u0441\u0435\u0441\u0441\u0438\u0438, \u0447\u0438\u0441\u043b\u043e, \u043a\u043e\u043d\u0444\u0438\u0433 \u0438 \u0442.\u0434.).</li> </ul>"},{"location":"ru/features/depends/#depends_3","title":"\u0417\u0430\u0447\u0435\u043c \u043d\u0443\u0436\u0435\u043d Depends","text":"<p>Depends \u0440\u0435\u0448\u0430\u0435\u0442 \u0437\u0430\u0434\u0430\u0447\u0443 \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u043c\u044b\u0445 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0435\u0439:</p> <ul> <li>\u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0438 \u0437\u0430\u043a\u0440\u044b\u0442\u0438\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 \u0432 \u043d\u0443\u0436\u043d\u043e\u043c \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0435 (\u043d\u0430 \u0443\u0440\u043e\u0432\u043d\u0435 \u0437\u0430\u0434\u0430\u0447\u0438 \u0438\u043b\u0438 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430);</li> <li>\u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0438\u0435 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438 \u0432\u0440\u0443\u0447\u043d\u0443\u044e \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u0441 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u043d\u044b\u043c\u0438 \u043c\u0435\u043d\u0435\u0434\u0436\u0435\u0440\u0430\u043c\u0438 \u0432\u043d\u0443\u0442\u0440\u0438 \u0442\u0435\u043b\u0430 \u0437\u0430\u0434\u0430\u0447;</li> <li>\u0435\u0434\u0438\u043d\u0430\u044f \u0442\u043e\u0447\u043a\u0430 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u044f \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0435\u0439 \u0434\u043b\u044f \u0440\u0430\u0437\u043d\u044b\u0445 \u0437\u0430\u0434\u0430\u0447.</li> </ul> <p>\u042d\u0442\u043e \u0443\u0434\u043e\u0431\u043d\u044b\u0439 \u0441\u043f\u043e\u0441\u043e\u0431 \u0432\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043a \u0411\u0414, \u043a\u043b\u0438\u0435\u043d\u0442 \u0432\u043d\u0435\u0448\u043d\u0435\u0433\u043e \u0441\u0435\u0440\u0432\u0438\u0441\u0430, \u043a\u0435\u0448, \u043a\u043e\u043d\u0444\u0438\u0433 \u0438 \u0434\u0440\u0443\u0433\u0438\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u044b \u0432 \u0437\u0430\u0434\u0430\u0447\u0438 QTasks \u0442\u0430\u043a, \u0447\u0442\u043e\u0431\u044b \u0438\u0445 \u0436\u0438\u0437\u043d\u0435\u043d\u043d\u044b\u0439 \u0446\u0438\u043a\u043b \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u0438\u0440\u043e\u0432\u0430\u043b\u0441\u044f \u0444\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a\u043e\u043c.</p>"},{"location":"ru/features/pydantic/","title":"Pydantic","text":"<p>\u0421\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 \u0432\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0439 \u0432 Worker \u043f\u043b\u0430\u0433\u0438\u043d (A)syncPydanticWrapperPlugin, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u0443\u0435\u0442 \u0432\u0445\u043e\u0434\u043d\u044b\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0437\u0430\u0434\u0430\u0447\u0438 \u0432 Pydantic-\u043c\u043e\u0434\u0435\u043b\u0438. \u041e\u043d \u0434\u0435\u043b\u0430\u0435\u0442 \u0440\u0430\u0431\u043e\u0442\u0443 \u0441 \u0442\u0438\u043f\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u043c\u0438 \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430\u043c\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u0435\u0441\u0442\u0435\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0439 \u0438 \u043f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u043e\u0439: \u043c\u043e\u0434\u0435\u043b\u044c \u0441\u043e\u0431\u0438\u0440\u0430\u0435\u0442\u0441\u044f \u043f\u0440\u044f\u043c\u043e \u043f\u0435\u0440\u0435\u0434 \u0432\u044b\u0437\u043e\u0432\u043e\u043c \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u0437\u0430\u0434\u0430\u0447\u0438, \u0430 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0443\u0436\u0435 \u0433\u043e\u0442\u043e\u0432\u044b\u0439 \u0432\u0430\u043b\u0438\u0434\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0439 \u043e\u0431\u044a\u0435\u043a\u0442.</p> <p>\u041f\u043b\u0430\u0433\u0438\u043d \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u0431\u0435\u0437 \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0439 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438. \u041b\u044e\u0431\u0430\u044f \u0437\u0430\u0434\u0430\u0447\u0430, \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u044e\u0449\u0430\u044f \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440-\u043c\u043e\u0434\u0435\u043b\u044c, \u0431\u0443\u0434\u0435\u0442 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0442\u044c \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0443\u044e \u0441\u0431\u043e\u0440\u043a\u0443.</p>"},{"location":"ru/features/pydantic/#_1","title":"\u041f\u0440\u0438\u043c\u0435\u0440 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f","text":"<pre><code>import pydantic\nfrom qtasks.asyncio import QueueTasks\n\napp = QueueTasks()\n\nclass Item(pydantic.BaseModel):\n    name: str\n    value: int\n\n@app.task(\n    description=\"\u0422\u0435\u0441\u0442\u043e\u0432\u0430\u044f \u0437\u0430\u0434\u0430\u0447\u0430 \u0441 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c Pydantic.\",\n    tags=[\"example\"],\n)\nasync def example_pydantic(item: Item):\n    return f\"Hello, {item.name}!\"\n</code></pre> <p>\u0412\u0441\u0435 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u044b \u0431\u0443\u0434\u0443\u0442 \u044d\u043a\u0432\u0438\u0432\u0430\u043b\u0435\u043d\u0442\u043d\u044b \u2014 QTasks \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e \u0441\u043e\u0431\u0435\u0440\u0451\u0442 \u043c\u043e\u0434\u0435\u043b\u044c:</p> <pre><code>task = await example_pydantic.add_task(\"Test\", value=42, timeout=50)\ntask = await example_pydantic.add_task(\"Test\", 42, timeout=50)\ntask = await example_pydantic.add_task(name=\"Test\", value=42, timeout=50)\n</code></pre> <p>\u041a\u0430\u0436\u0434\u044b\u0439 \u0438\u0437 \u043d\u0438\u0445 \u043f\u0440\u0438\u0432\u0435\u0434\u0451\u0442 \u043a \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044e \u043e\u0434\u043d\u043e\u0439 \u0438 \u0442\u043e\u0439 \u0436\u0435 \u043c\u043e\u0434\u0435\u043b\u0438:</p> <pre><code>Item(name=\"Test\", value=42)\n</code></pre>"},{"location":"ru/features/pydantic/#_2","title":"\u041f\u043e\u0434 \u043a\u0430\u043f\u043e\u0442\u043e\u043c","text":"<p>\u0420\u0430\u0431\u043e\u0442\u0430 \u043f\u043b\u0430\u0433\u0438\u043d\u0430 \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442 \u043f\u043e\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u043d\u043e.</p>"},{"location":"ru/features/pydantic/#1","title":"1. \u0421\u0431\u043e\u0440\u043a\u0430 \u043c\u043e\u0434\u0435\u043b\u0438","text":"<p>\u041f\u043b\u0430\u0433\u0438\u043d:</p> <ol> <li>\u0410\u043d\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u0442 \u0441\u0438\u0433\u043d\u0430\u0442\u0443\u0440\u0443 \u0437\u0430\u0434\u0430\u0447\u0438.</li> <li>\u041d\u0430\u0445\u043e\u0434\u0438\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b, \u044f\u0432\u043b\u044f\u044e\u0449\u0438\u0435\u0441\u044f \u043d\u0430\u0441\u043b\u0435\u0434\u043d\u0438\u043a\u0430\u043c\u0438 <code>pydantic.BaseModel</code>.</li> <li>\u0418\u0437\u0432\u043b\u0435\u043a\u0430\u0435\u0442 \u043f\u043e\u0434\u0445\u043e\u0434\u044f\u0449\u0438\u0435 <code>kwargs</code>.</li> <li>\u041f\u0440\u0438 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u044b\u0435 \u043f\u043e\u0437\u0438\u0446\u0438\u043e\u043d\u043d\u044b\u0435 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u044b <code>args</code>.</li> <li>\u0421\u043e\u0431\u0438\u0440\u0430\u0435\u0442 \u043c\u043e\u0434\u0435\u043b\u044c:</li> </ol> <pre><code>model = Item(*args_from_task, **kwargs_from_task)\n</code></pre>"},{"location":"ru/features/pydantic/#2","title":"2. \u041e\u0447\u0438\u0441\u0442\u043a\u0430 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u043e\u0432","text":"<p>\u0412\u0441\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u043f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u043c\u043e\u0434\u0435\u043b\u0438, \u0443\u0434\u0430\u043b\u044f\u044e\u0442\u0441\u044f \u0438\u0437 \u0444\u0430\u043a\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u043e\u0432. \u041e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0435 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u044b \u043f\u0435\u0440\u0435\u0434\u0430\u044e\u0442\u0441\u044f \u0432 \u0437\u0430\u0434\u0430\u0447\u0443 \u0431\u0435\u0437 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0439.</p> <p>\u042d\u0442\u043e \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0433\u0438\u0431\u043a\u043e \u043a\u043e\u043c\u0431\u0438\u043d\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043c\u043e\u0434\u0435\u043b\u044c \u0441 \u0434\u0440\u0443\u0433\u0438\u043c\u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c\u0438:</p> <pre><code>@app.task\nasync def task_with_mix(item: Item, retries: int = 3):\n    ...\n</code></pre>"},{"location":"ru/features/pydantic/#_3","title":"\u0412\u043e\u0437\u0432\u0440\u0430\u0442 \u043c\u043e\u0434\u0435\u043b\u0435\u0439","text":"<p>\u0415\u0441\u043b\u0438 \u0437\u0430\u0434\u0430\u0447\u0430 \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u043e\u0431\u044a\u0435\u043a\u0442 <code>BaseModel</code>, QTasks \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u0443\u0435\u0442 \u0435\u0433\u043e \u0432 \u0441\u0435\u0440\u0438\u0430\u043b\u0438\u0437\u0443\u0435\u043c\u044b\u0439 \u0441\u043b\u043e\u0432\u0430\u0440\u044c \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e:</p> <pre><code>model.model_dump()\n</code></pre> <p>\u041f\u0440\u0438\u043c\u0435\u0440:</p> <pre><code>@app.task\nasync def create_item() -&gt; Item:\n    return Item(name=\"Generated\", value=10)\n</code></pre> <p>\u0424\u0430\u043a\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0435:</p> <pre><code>{\"name\": \"Generated\", \"value\": 10}\n</code></pre>"},{"location":"ru/features/pydantic/#_4","title":"\u041e\u0441\u043e\u0431\u0435\u043d\u043d\u043e\u0441\u0442\u0438","text":"<ul> <li>\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u044e\u0442\u0441\u044f \u043b\u044e\u0431\u044b\u0435 \u043d\u0430\u0441\u043b\u0435\u0434\u043d\u0438\u043a\u0438 <code>BaseModel</code>.</li> <li>\u0421\u0431\u043e\u0440\u043a\u0430 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f \u043d\u0430 \u0441\u0442\u043e\u0440\u043e\u043d\u0435 Worker \u043f\u0435\u0440\u0435\u0434 \u0432\u044b\u0437\u043e\u0432\u043e\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u043e\u0439 \u0444\u0443\u043d\u043a\u0446\u0438\u0438.</li> <li>\u041f\u043b\u0430\u0433\u0438\u043d \u043d\u0435 \u043c\u0435\u043d\u044f\u0435\u0442 \u0441\u0438\u0433\u043d\u0430\u0442\u0443\u0440\u0443 \u0437\u0430\u0434\u0430\u0447\u0438.</li> <li>\u041c\u043e\u0434\u0435\u043b\u0438 \u043c\u043e\u0436\u043d\u043e \u043a\u043e\u043c\u0431\u0438\u043d\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441 \u043f\u043e\u0437\u0438\u0446\u0438\u043e\u043d\u043d\u044b\u043c\u0438 \u0438 \u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u043d\u044b\u043c\u0438 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u0430\u043c\u0438.</li> <li>\u041c\u043e\u0434\u0435\u043b\u0438 \u0432 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0435 \u0437\u0430\u0434\u0430\u0447\u0438 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0441\u0435\u0440\u0438\u0430\u043b\u0438\u0437\u0443\u044e\u0442\u0441\u044f.</li> </ul>"},{"location":"ru/features/pydantic/#_5","title":"\u0418\u0442\u043e\u0433","text":"<p>(A)syncPydanticWrapperPlugin \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442:</p> <ul> <li>\u043f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u0443\u044e \u0440\u0430\u0431\u043e\u0442\u0443 \u0441 \u0442\u0438\u043f\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u043c\u0438 \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430\u043c\u0438;</li> <li>\u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0443\u044e \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u044e \u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0445 \u0434\u0430\u043d\u043d\u044b\u0445;</li> <li>\u0443\u0434\u043e\u0431\u043d\u0443\u044e \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044e \u043c\u043e\u0434\u0435\u043b\u0435\u0439 \u0432 \u0441\u0438\u0433\u043d\u0430\u0442\u0443\u0440\u0443 \u0437\u0430\u0434\u0430\u0447;</li> <li>\u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 \u0432\u043e\u0437\u0432\u0440\u0430\u0442\u0430 \u0434\u0430\u043d\u043d\u044b\u0445.</li> </ul>"},{"location":"ru/features/states/","title":"States","text":"<p>\u041c\u0435\u0445\u0430\u043d\u0438\u0437\u043c <code>State</code> \u0432 QTasks \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e \u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0438 \u043f\u0435\u0440\u0435\u0434\u0430\u0432\u0430\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u043c\u0435\u0436\u0434\u0443 \u0437\u0430\u0434\u0430\u0447\u0430\u043c\u0438. \u041e\u043d \u0440\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d \u0432\u043e \u0432\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u043e\u043c \u043f\u043b\u0430\u0433\u0438\u043d\u0435 \u0432\u043e\u0440\u043a\u0435\u0440\u0430 <code>(A)StatePlugin</code> \u0438 \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0443\u0434\u043e\u0431\u043d\u044b\u0439 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441 \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435\u043c.</p>"},{"location":"ru/features/states/#state","title":"\u041f\u0440\u0438\u043c\u0435\u0440 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f State","text":"<pre><code>from qtasks.plugins.states import AsyncState\n\n\nclass MyState(AsyncState):\n    pass\n\n\n@app.task\nasync def step1(state: MyState):\n    await state.set(\"state\", \"await_phone\")\n    await state.update(step=1, prompt=\"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\")\n    return \"ok\"\n\n\n@app.task\nasync def step2(state: MyState):\n    print(await state.get_all())\n\n    cur = await state.get(\"state\")\n    if cur != \"await_phone\":\n        return \"error\"\n\n    await state.update(step=2)\n    await state.delete(\"state\")\n    await state.clear()\n    return \"ok\"\n</code></pre> <p>\u0412\u044b\u0432\u043e\u0434 <code>print(await state.get_all())</code>:</p> <pre><code>{'state': 'await_phone', 'step': 1, 'prompt': '\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043b\u0435\u0444\u043e\u043d'}\n</code></pre> <p>\u0421\u0446\u0435\u043d\u0430\u0440\u0438\u0439:</p> <ul> <li><code>step1</code> \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u0442 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0438 \u0437\u0430\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439.</li> <li><code>step2</code> \u0447\u0438\u0442\u0430\u0435\u0442 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435, \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442 \u0435\u0433\u043e, \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u0442 \u0438 \u043e\u0447\u0438\u0449\u0430\u0435\u0442.</li> </ul> <p>\u0422\u0430\u043a\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c, \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0437\u0430\u0434\u0430\u0447 \u043c\u043e\u0433\u0443\u0442 \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u0441 \u043e\u0431\u0449\u0438\u043c \u043f\u043e\u0442\u043e\u043a\u043e\u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u044b\u043c \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435\u043c.</p>"},{"location":"ru/features/states/#_1","title":"\u041a\u0430\u043a \u044d\u0442\u043e \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \"\u043f\u043e\u0434 \u043a\u0430\u043f\u043e\u0442\u043e\u043c\"","text":"<p>\u041d\u0438\u0436\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0430 \u0443\u043f\u0440\u043e\u0449\u0451\u043d\u043d\u0430\u044f \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u044f\u044f \u043b\u043e\u0433\u0438\u043a\u0430 <code>(A)StatePlugin</code>.</p>"},{"location":"ru/features/states/#1-state","title":"1. \u041f\u043e\u0438\u0441\u043a State \u0432 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u0445 \u0437\u0430\u0434\u0430\u0447\u0438","text":"<p>\u041f\u043b\u0430\u0433\u0438\u043d \u0430\u043d\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u0442 \u0441\u0438\u0433\u043d\u0430\u0442\u0443\u0440\u0443 \u0437\u0430\u0434\u0430\u0447\u0438 \u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442, \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043b\u0438 \u0442\u0438\u043f \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430 \u043d\u0430\u0441\u043b\u0435\u0434\u043d\u0438\u043a\u043e\u043c <code>AsyncState</code> \u0438\u043b\u0438 <code>State</code>:</p> <pre><code>issubclass(MyState, (AsyncState, State))\n</code></pre> <p>\u0415\u0441\u043b\u0438 \u0442\u0430\u043a\u043e\u0439 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 \u043d\u0430\u0439\u0434\u0435\u043d, \u0437\u0430\u0434\u0430\u0447\u0430 \u0432\u043e\u0441\u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0435\u0442\u0441\u044f \u043a\u0430\u043a \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0449\u0430\u044f \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435.</p>"},{"location":"ru/features/states/#2-state-stateregistry","title":"2. \u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f State \u0438 StateRegistry","text":"<p>\u0415\u0441\u043b\u0438 \u0434\u043b\u044f <code>MyState</code> \u0435\u0449\u0451 \u043d\u0435 \u0431\u044b\u043b \u0432\u044b\u0437\u0432\u0430\u043d <code>__init__</code>, \u043f\u043b\u0430\u0433\u0438\u043d:</p> <ul> <li>\u0441\u043e\u0437\u0434\u0430\u0451\u0442 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440 \u043a\u043b\u0430\u0441\u0441\u0430 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f (<code>MyState()</code>),</li> <li>\u0441\u0432\u044f\u0437\u044b\u0432\u0430\u0435\u0442 \u0435\u0433\u043e \u0441 \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u043c \u0440\u0435\u0435\u0441\u0442\u0440\u043e\u043c <code>(A)syncStateRegistry</code>.</li> </ul> <p>\u0420\u0435\u0435\u0441\u0442\u0440 \u043e\u0442\u0432\u0435\u0447\u0430\u0435\u0442 \u0437\u0430 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439 \"\u0432\u043d\u0443\u0442\u0440\u0438\" \u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0438:</p> <ul> <li><code>asyncio.Lock()</code> \u2014 \u0434\u043b\u044f \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0445 \u0437\u0430\u0434\u0430\u0447,</li> <li><code>threading.Lock()</code> \u2014 \u0434\u043b\u044f \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0445 \u0437\u0430\u0434\u0430\u0447.</li> </ul> <p>\u042d\u0442\u043e \u0433\u0430\u0440\u0430\u043d\u0442\u0438\u0440\u0443\u0435\u0442, \u0447\u0442\u043e \u043f\u0430\u0440\u0430\u043b\u043b\u0435\u043b\u044c\u043d\u044b\u0435 \u0437\u0430\u0434\u0430\u0447\u0438 \u043d\u0435 \u0441\u043c\u043e\u0433\u0443\u0442 \u043e\u0434\u043d\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e \u0438\u0437\u043c\u0435\u043d\u044f\u0442\u044c \u043e\u0434\u043d\u0438 \u0438 \u0442\u0435 \u0436\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0432 \u043d\u0435\u043a\u043e\u043d\u0441\u0438\u0441\u0442\u0435\u043d\u0442\u043d\u043e\u043c \u0432\u0438\u0434\u0435.</p>"},{"location":"ru/features/states/#3","title":"3. \u041f\u043e\u0434\u043c\u0435\u043d\u0430 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430 \u0432 \u0437\u0430\u0434\u0430\u0447\u0435","text":"<p>\u041f\u043e\u0441\u043b\u0435 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043f\u043b\u0430\u0433\u0438\u043d \u0437\u0430\u043c\u0435\u043d\u044f\u0435\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u0437\u0430\u0434\u0430\u0447\u0438 \u043d\u0430 \u0433\u043e\u0442\u043e\u0432\u044b\u0439 \u043e\u0431\u044a\u0435\u043a\u0442 <code>MyState</code>. \u0412\u043d\u0443\u0442\u0440\u0438 \u0442\u0435\u043b\u0430 \u0437\u0430\u0434\u0430\u0447\u0438 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u0443\u0436\u0435 \u0441 \u043f\u043e\u043b\u043d\u043e\u0446\u0435\u043d\u043d\u044b\u043c API \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f.</p>"},{"location":"ru/features/states/#api-state-asyncstate","title":"API <code>State</code> / <code>AsyncState</code>","text":"<p>\u041d\u0438\u0436\u0435 \u043f\u0440\u0438\u0432\u0435\u0434\u0435\u043d\u044b \u043e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u043c\u0435\u0442\u043e\u0434\u044b \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f.</p>"},{"location":"ru/features/states/#get","title":"<code>get</code>","text":"<pre><code>value = await state.get(\"key\", default=None)\n</code></pre> <ul> <li><code>key</code> \u2014 \u043a\u043b\u044e\u0447 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f (\u0435\u0441\u043b\u0438 <code>None</code>, \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u044e\u0442\u0441\u044f \u0432\u0441\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f).</li> <li><code>default</code> \u2014 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e, \u0435\u0441\u043b\u0438 \u043a\u043b\u044e\u0447 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d.</li> </ul>"},{"location":"ru/features/states/#get_all","title":"<code>get_all</code>","text":"<pre><code>data = await state.get_all()\n</code></pre> <p>\u0412\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u0441\u043b\u043e\u0432\u0430\u0440\u044c \u0432\u0441\u0435\u0445 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f.</p>"},{"location":"ru/features/states/#set","title":"<code>set</code>","text":"<pre><code>await state.set(\"key\", value)\n</code></pre> <p>\u0423\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u043f\u043e \u043a\u043b\u044e\u0447\u0443.</p>"},{"location":"ru/features/states/#update","title":"<code>update</code>","text":"<pre><code>data = await state.update(step=1, prompt=\"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\")\n</code></pre> <p>\u041e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u0442 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439 \u0441\u0440\u0430\u0437\u0443 \u0438 \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u043e\u0431\u043d\u043e\u0432\u043b\u0451\u043d\u043d\u044b\u0439 \u0441\u043b\u043e\u0432\u0430\u0440\u044c.</p>"},{"location":"ru/features/states/#delete","title":"<code>delete</code>","text":"<pre><code>await state.delete(\"key\")\n</code></pre> <p>\u0423\u0434\u0430\u043b\u044f\u0435\u0442 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043f\u043e \u043a\u043b\u044e\u0447\u0443.</p>"},{"location":"ru/features/states/#clear","title":"<code>clear</code>","text":"<pre><code>await state.clear()\n</code></pre> <p>\u041e\u0447\u0438\u0449\u0430\u0435\u0442 \u0432\u0441\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f.</p>"},{"location":"ru/features/states/#state_1","title":"\u0417\u0430\u0434\u0430\u0447\u0430 \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c\u0430 State","text":"<p>\u041c\u0435\u0445\u0430\u043d\u0438\u0437\u043c <code>State</code> \u0440\u0435\u0448\u0430\u0435\u0442 \u0437\u0430\u0434\u0430\u0447\u0443 \u043f\u043e\u0442\u043e\u043a\u043e\u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0439 \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u043c\u0435\u0436\u0434\u0443 \u0437\u0430\u0434\u0430\u0447\u0430\u043c\u0438:</p> <ul> <li>\u043e\u0431\u0449\u0430\u044f \u043f\u0430\u043c\u044f\u0442\u044c \u0434\u043b\u044f \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u0437\u0430\u0434\u0430\u0447 (\u0448\u0430\u0433\u0438 \u0441\u0446\u0435\u043d\u0430\u0440\u0438\u044f, \u0446\u0435\u043f\u043e\u0447\u043a\u0438, \u0434\u0438\u0430\u043b\u043e\u0433\u0438);</li> <li>\u0437\u0430\u0449\u0438\u0442\u0430 \u043e\u0442 \u0433\u043e\u043d\u043e\u043a \u043f\u0440\u0438 \u043f\u0430\u0440\u0430\u043b\u043b\u0435\u043b\u044c\u043d\u043e\u043c \u0434\u043e\u0441\u0442\u0443\u043f\u0435 \u043a \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044e;</li> <li>\u0435\u0434\u0438\u043d\u044b\u0439 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441 \u0434\u043b\u044f \u0447\u0442\u0435\u043d\u0438\u044f, \u0437\u0430\u043f\u0438\u0441\u0438 \u0438 \u043e\u0447\u0438\u0441\u0442\u043a\u0438 \u0434\u0430\u043d\u043d\u044b\u0445.</li> </ul> <p>\u042d\u0442\u043e \u0443\u0434\u043e\u0431\u043d\u044b\u0439 \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442 \u0434\u043b\u044f \u043f\u043e\u0441\u0442\u0440\u043e\u0435\u043d\u0438\u044f \u0441\u043b\u043e\u0436\u043d\u044b\u0445 \u043f\u043e\u0448\u0430\u0433\u043e\u0432\u044b\u0445 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432 \u0438 \u0441\u0446\u0435\u043d\u0430\u0440\u0438\u0435\u0432, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0442\u0440\u0435\u0431\u0443\u044e\u0442 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0430 \u043c\u0435\u0436\u0434\u0443 \u0437\u0430\u0434\u0430\u0447\u0430\u043c\u0438.</p>"},{"location":"ru/features/stats/","title":"Stats","text":"<p>\u0421\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 \u0432\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0439 \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 (A)syncStats, \u043f\u0440\u0435\u0434\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u043d\u044b\u0439 \u0434\u043b\u044f \u0430\u043d\u0430\u043b\u0438\u0442\u0438\u043a\u0438 \u0438 \u0438\u043d\u0441\u043f\u0435\u043a\u0446\u0438\u0438 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f QTasks. \u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0441 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u043c <code>app=app</code> \u0438 \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u043c \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0438 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u0437\u0430\u0434\u0430\u0447 \u0431\u0435\u0437 \u0438\u0445 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f.</p> <p>Stats \u043e\u0440\u0438\u0435\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d \u043d\u0430 \u0434\u0438\u0430\u0433\u043d\u043e\u0441\u0442\u0438\u043a\u0443, \u043e\u0442\u043b\u0430\u0434\u043a\u0443, \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u0438 \u043f\u043e\u0441\u0442\u0440\u043e\u0435\u043d\u0438\u0435 \u0432\u043d\u0435\u0448\u043d\u0438\u0445 \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u043e\u0432 (CLI, WebView, \u043f\u0430\u043d\u0435\u043b\u0438 \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f).</p>"},{"location":"ru/features/stats/#_1","title":"\u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438","text":"<p>\u041d\u0430 \u0442\u0435\u043a\u0443\u0449\u0438\u0439 \u043c\u043e\u043c\u0435\u043d\u0442 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0438\u043d\u0441\u043f\u0435\u043a\u0446\u0438\u043e\u043d\u043d\u044b\u0435 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u0447\u0435\u0440\u0435\u0437 \u043e\u0431\u044a\u0435\u043a\u0442 InspectStats.</p>"},{"location":"ru/features/stats/#inspectstatsinspect","title":"InspectStats.inspect","text":"<p><code>(A)syncStats.inspect \u2192 InspectStats</code></p> <p>\u0412\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u043e\u0431\u044a\u0435\u043a\u0442 \u0438\u043d\u0441\u043f\u0435\u043a\u0446\u0438\u0438, \u0447\u0435\u0440\u0435\u0437 \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b \u043c\u0435\u0442\u043e\u0434\u044b \u0430\u043d\u0430\u043b\u0438\u0442\u0438\u043a\u0438.</p>"},{"location":"ru/features/stats/#_2","title":"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0438","text":""},{"location":"ru/features/stats/#inspectstatsappjson-bool-false","title":"InspectStats.app(json: bool = False)","text":"<p>\u041f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043f\u043e\u043b\u043d\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0442\u0435\u043a\u0443\u0449\u0435\u043c \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0435 QTasks.</p> <p>\u041f\u0440\u0438\u043c\u0435\u0440 \u0442\u0435\u043a\u0441\u0442\u043e\u0432\u043e\u0433\u043e \u0432\u044b\u0432\u043e\u0434\u0430:</p> <pre><code>\u0418\u043c\u044f                       : QueueTasks\n\u041c\u0435\u0442\u043e\u0434                     : async\n\u0412\u0435\u0440\u0441\u0438\u044f                    : 1.7.0\n\u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f              : QueueConfig(max_tasks_process=10, running_older_tasks=True,\ndelete_finished_tasks=False, task_default_priority=0, task_default_decode=None,\nlogs_default_level_server=10, logs_default_level_client=20, logs_format='%(asctime)s\n[%(name)s: %(levelname)s] (%(subname)s) %(message)s', result_time_interval=0.1,\nresult_statuses_end=['success', 'error', 'cancel'])\n\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0437\u0430\u0434\u0430\u0447          : 14\n\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0440\u043e\u0443\u0442\u0435\u0440\u043e\u0432       : 1\n\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432       : 16\n\u0411\u0440\u043e\u043a\u0435\u0440                    : AsyncRedisBroker\n\u0412\u043e\u0440\u043a\u0435\u0440                    : AsyncWorker\n\u0421\u0442\u0430\u0440\u0442\u0435\u0440                   : AsyncStarter\n\u0425\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435                 : AsyncRedisStorage\nGlobalConfig              : AsyncRedisGlobalConfig\n\u041b\u043e\u0433                       : Logger\n\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0439  : 0\n--------------------------------------------------\n</code></pre> <p>\u041f\u0440\u0438 <code>json=True</code> \u043c\u0435\u0442\u043e\u0434 \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0439 \u0441\u043b\u043e\u0432\u0430\u0440\u044c, \u043f\u0440\u0438\u0433\u043e\u0434\u043d\u044b\u0439 \u0434\u043b\u044f \u0441\u0435\u0440\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0438 \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 \u0432\u043e \u0432\u043d\u0435\u0448\u043d\u0438\u0435 \u0441\u0438\u0441\u0442\u0435\u043c\u044b.</p>"},{"location":"ru/features/stats/#_3","title":"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0437\u0430\u0434\u0430\u0447\u0430\u0445","text":""},{"location":"ru/features/stats/#inspectstatstaskstasks-tuplestr-json-bool-false","title":"InspectStats.tasks(*tasks: tuple[str], json: bool = False)","text":"<p>\u0412\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u0437\u0430\u0434\u0430\u0447\u0430\u0445.</p> <ul> <li>\u0411\u0435\u0437 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u043e\u0432 \u2014 \u043f\u043e \u0432\u0441\u0435\u043c \u0437\u0430\u0434\u0430\u0447\u0430\u043c.</li> <li>\u0421 \u0443\u043a\u0430\u0437\u0430\u043d\u0438\u0435\u043c \u0438\u043c\u0451\u043d \u0437\u0430\u0434\u0430\u0447 \u2014 \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u043e \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u043c.</li> </ul> <p>\u041f\u0440\u0438\u043c\u0435\u0440 (\u0441\u043e\u043a\u0440\u0430\u0449\u0451\u043d\u043d\u044b\u0439 \u0432\u044b\u0432\u043e\u0434 \u0434\u043b\u044f \u0434\u0432\u0443\u0445 \u0437\u0430\u0434\u0430\u0447):</p> <pre><code>\u0418\u043c\u044f \u0437\u0430\u0434\u0430\u0447\u0438                : sync_test\n\u041f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442                 : 0\n\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435                  : \u0422\u0435\u0441\u0442\u043e\u0432\u0430\u044f \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u0430\u044f \u0437\u0430\u0434\u0430\u0447\u0430 \u0441 \u0434\u0435\u043a\u043e\u0440\u0430\u0442\u043e\u0440\u043e\u043c.\n\u0422\u0435\u0433\u0438                      : \u2014\n\u0410\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e\u0441\u0442\u044c             : False\n\u0413\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f                 : sync\nSelf \u043f\u0435\u0440\u0435\u0434 \u0437\u0430\u0434\u0430\u0447\u0435\u0439        : True\nArgs                      : self: SyncTask\nKwargs                    : \u2014\n\u041c\u0438\u0434\u043b\u0432\u0430\u0440\u0438 \u043f\u043e\u0441\u043b\u0435            : [&lt;class 'libs.task_middleware.MyTaskMiddleware'&gt;]\n--------------------------------------------------\n\u0418\u043c\u044f \u0437\u0430\u0434\u0430\u0447\u0438                : async_test\n\u041f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442                 : 0\n\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435                  : \u0422\u0435\u0441\u0442\u043e\u0432\u0430\u044f \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u0430\u044f \u0437\u0430\u0434\u0430\u0447\u0430.\n\u0422\u0435\u0433\u0438                      : \u2014\n\u0410\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e\u0441\u0442\u044c             : True\n\u0413\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f                 : False\nSelf \u043f\u0435\u0440\u0435\u0434 \u0437\u0430\u0434\u0430\u0447\u0435\u0439        : False\nArgs                      : \u2014\nKwargs                    : \u2014\n--------------------------------------------------\n</code></pre> <p>\u041f\u0440\u0438 <code>json=True</code> \u0434\u0430\u043d\u043d\u044b\u0435 \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u044e\u0442\u0441\u044f \u0432 \u0432\u0438\u0434\u0435 \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e \u0441\u043b\u043e\u0432\u0430\u0440\u044f.</p>"},{"location":"ru/features/stats/#_4","title":"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e\u0431 \u043e\u0434\u043d\u043e\u0439 \u0437\u0430\u0434\u0430\u0447\u0435","text":""},{"location":"ru/features/stats/#inspectstatstasktask_name-str-json-bool-false","title":"InspectStats.task(task_name: str, json: bool = False)","text":"<p>\u0412\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e\u0431 \u043e\u0434\u043d\u043e\u0439 \u0437\u0430\u0434\u0430\u0447\u0435. \u041f\u043e \u0444\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u043e\u0441\u0442\u0438 \u044d\u043a\u0432\u0438\u0432\u0430\u043b\u0435\u043d\u0442\u0435\u043d <code>tasks</code>, \u043d\u043e \u043f\u0440\u0435\u0434\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d \u0434\u043b\u044f \u0442\u043e\u0447\u0435\u0447\u043d\u043e\u0433\u043e \u0437\u0430\u043f\u0440\u043e\u0441\u0430.</p>"},{"location":"ru/features/stats/#cli","title":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0447\u0435\u0440\u0435\u0437 CLI","text":"<p>\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 Stats \u0438\u043d\u0442\u0435\u0433\u0440\u0438\u0440\u043e\u0432\u0430\u043d \u0432 CLI (\u043d\u0430 \u0434\u0430\u043d\u043d\u044b\u0439 \u043c\u043e\u043c\u0435\u043d\u0442 \u0432 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e\u043c \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u0435).</p>"},{"location":"ru/features/stats/#_5","title":"\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u0430\u044f \u043a\u043e\u043c\u0430\u043d\u0434\u0430 \u0438\u043d\u0441\u043f\u0435\u043a\u0446\u0438\u0438","text":"<pre><code>qtasks -A app:app stats inspect\n</code></pre> <p>\u041a\u043e\u043c\u0430\u043d\u0434\u0430 \u0432\u044b\u0432\u043e\u0434\u0438\u0442 \u0431\u0430\u0437\u043e\u0432\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u0438 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u043c\u0435\u0442\u043e\u0434\u044b \u0438\u043d\u0441\u043f\u0435\u043a\u0446\u0438\u0438.</p>"},{"location":"ru/features/stats/#inspectstats-cli","title":"\u0412\u044b\u0437\u043e\u0432 \u043c\u0435\u0442\u043e\u0434\u043e\u0432 InspectStats \u0447\u0435\u0440\u0435\u0437 CLI","text":"<pre><code>qtasks -A app:app stats inspect &lt;method&gt; &lt;params&gt;\n</code></pre> <p>\u0412\u044b\u0437\u043e\u0432 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f \u0447\u0435\u0440\u0435\u0437 <code>getattr</code>, \u0447\u0442\u043e \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043e\u0431\u0440\u0430\u0449\u0430\u0442\u044c\u0441\u044f \u043a \u043b\u044e\u0431\u043e\u043c\u0443 \u043c\u0435\u0442\u043e\u0434\u0443 <code>InspectStats</code>.</p> <p>\u041f\u0440\u0438\u043c\u0435\u0440:</p> <pre><code>qtasks -A app:app stats inspect tasks task1 task2 json=True\n</code></pre>"},{"location":"ru/features/stats/#_6","title":"\u041e\u0441\u043e\u0431\u0435\u043d\u043d\u043e\u0441\u0442\u0438","text":"<ul> <li>Stats \u043d\u0435 \u0438\u043d\u0438\u0446\u0438\u0438\u0440\u0443\u0435\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447.</li> <li>\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u0442\u043e\u043b\u044c\u043a\u043e \u0441 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u043c\u0438 \u0438 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0435\u0439.</li> <li>\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u0442\u0435\u043a\u0441\u0442\u043e\u0432\u044b\u0439 \u0438 JSON-\u0444\u043e\u0440\u043c\u0430\u0442 \u0432\u044b\u0432\u043e\u0434\u0430.</li> <li>\u041f\u0440\u0435\u0434\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d \u0434\u043b\u044f CLI, WebView \u0438 \u0432\u043d\u0435\u0448\u043d\u0438\u0445 \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u043e\u0432 \u0430\u043d\u0430\u043b\u0438\u0442\u0438\u043a\u0438.</li> </ul>"},{"location":"ru/features/stats/#_7","title":"\u0418\u0442\u043e\u0433","text":"<p>(A)syncStats \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442:</p> <ul> <li>\u0446\u0435\u043d\u0442\u0440\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u0443\u044e \u0438\u043d\u0441\u043f\u0435\u043a\u0446\u0438\u044e \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f;</li> <li>\u0434\u043e\u0441\u0442\u0443\u043f \u043a \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u043c \u0437\u0430\u0434\u0430\u0447 \u0438 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438;</li> <li>\u043e\u0441\u043d\u043e\u0432\u0443 \u0434\u043b\u044f \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u0430 \u0438 \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f;</li> <li>\u0440\u0430\u0441\u0448\u0438\u0440\u044f\u0435\u043c\u044b\u0439 API \u0434\u043b\u044f \u0431\u0443\u0434\u0443\u0449\u0435\u0439 \u0430\u043d\u0430\u043b\u0438\u0442\u0438\u043a\u0438.</li> </ul> <p>\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043e\u0444\u043e\u0440\u043c\u043b\u0435\u043d\u0430 \u043a\u0430\u043a \u0445\u043e\u043b\u0441\u0442 \u0438 \u043c\u043e\u0436\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u043a\u0430\u043a \u0448\u0430\u0431\u043b\u043e\u043d \u0434\u043b\u044f \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438 \u0430\u043d\u0430\u043b\u0438\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u0438 \u0438\u043d\u0441\u043f\u0435\u043a\u0446\u0438\u043e\u043d\u043d\u044b\u0445 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432 QTasks.</p>"},{"location":"ru/features/task/","title":"\u0414\u0435\u043a\u043e\u0440\u0430\u0442\u043e\u0440 \u0437\u0430\u0434\u0430\u0447\u0438","text":"<p>\u0414\u0435\u043a\u043e\u0440\u0430\u0442\u043e\u0440 <code>@app.task</code> \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043a\u043b\u044e\u0447\u0435\u0432\u043e\u0439 \u0442\u043e\u0447\u043a\u043e\u0439 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438 \u0437\u0430\u0434\u0430\u0447 \u0432 QTasks. \u0412 \u043c\u043e\u043c\u0435\u043d\u0442 \u043f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0434\u0435\u043a\u043e\u0440\u0430\u0442\u043e\u0440\u0430 \u0444\u0443\u043d\u043a\u0446\u0438\u044f \u0437\u0430\u0434\u0430\u0447\u0438 \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u0443\u0435\u0442\u0441\u044f \u0432 \u043e\u0431\u044a\u0435\u043a\u0442 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0445\u0440\u0430\u043d\u0438\u0442 \u043a\u0430\u043a \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0435 \u0437\u0430\u0434\u0430\u0447\u0438, \u0442\u0430\u043a \u0438 \u043c\u0435\u0442\u043e\u0434\u044b \u0434\u043b\u044f \u0435\u0451 \u0432\u044b\u0437\u043e\u0432\u0430 \u0438 \u0438\u0441\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f.</p> <p>\u041f\u0440\u0438 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438 \u0437\u0430\u0434\u0430\u0447\u0438 \u0444\u043e\u0440\u043c\u0438\u0440\u0443\u044e\u0442\u0441\u044f \u0434\u0432\u0430 \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u044f:</p> <ul> <li>(A)syncTask \u2014 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u0439 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441 \u0437\u0430\u0434\u0430\u0447\u0438, \u0447\u0435\u0440\u0435\u0437 \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u044e\u0442\u0441\u044f \u0432\u044b\u0437\u043e\u0432\u044b <code>add_task</code> \u0438 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435\u043c.</li> <li>TaskExecSchema \u2014 dataclass, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0439 \u0432\u043d\u0443\u0442\u0440\u0438 <code>app.tasks</code> \u0438 <code>app.worker.tasks</code> \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 \u0438 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0438\u0441\u043f\u043e\u043b\u043d\u044f\u0435\u043c\u043e\u0439 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u0437\u0430\u0434\u0430\u0447\u0435, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0441\u0430\u043c\u0443 \u0444\u0443\u043d\u043a\u0446\u0438\u044e.</li> </ul> <p>\u041e\u0431\u0430 \u043e\u0431\u044a\u0435\u043a\u0442\u0430 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442 \u0441\u043e\u0433\u043b\u0430\u0441\u043e\u0432\u0430\u043d\u043d\u044b\u0439 \u043d\u0430\u0431\u043e\u0440 \u0434\u0430\u043d\u043d\u044b\u0445, \u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f \u043d\u0430 \u0440\u0430\u0437\u043d\u044b\u0445 \u0443\u0440\u043e\u0432\u043d\u044f\u0445 \u0441\u0438\u0441\u0442\u0435\u043c\u044b.</p>"},{"location":"ru/features/task/#_2","title":"\u041e\u0431\u0449\u0430\u044f \u043c\u043e\u0434\u0435\u043b\u044c","text":"<p>\u0414\u043b\u044f \u0434\u0430\u043b\u044c\u043d\u0435\u0439\u0448\u0435\u0433\u043e \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u044f \u0431\u0443\u0434\u0435\u043c \u0441\u0447\u0438\u0442\u0430\u0442\u044c, \u0447\u0442\u043e <code>task_func</code> \u2014 \u044d\u0442\u043e \u0444\u0443\u043d\u043a\u0446\u0438\u044f, \u043e\u0431\u0451\u0440\u043d\u0443\u0442\u0430\u044f \u0434\u0435\u043a\u043e\u0440\u0430\u0442\u043e\u0440\u043e\u043c <code>@app.task()</code>.</p> <pre><code>@app.task()\nasync def task_func(...):\n    ...\n</code></pre> <p>\u041f\u043e\u0441\u043b\u0435 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438 <code>task_func</code> \u043f\u0435\u0440\u0435\u0441\u0442\u0430\u0451\u0442 \u0431\u044b\u0442\u044c \u043e\u0431\u044b\u0447\u043d\u043e\u0439 \u0444\u0443\u043d\u043a\u0446\u0438\u0435\u0439 \u0438 \u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0441\u044f \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u043e\u043c (A)syncTask.</p>"},{"location":"ru/features/task/#_3","title":"\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0437\u0430\u0434\u0430\u0447\u0438","text":"<p>\u0414\u0435\u043a\u043e\u0440\u0430\u0442\u043e\u0440 <code>@app.task</code> \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0435\u0442 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u0437\u0430\u0434\u0430\u0447\u0438:</p> \u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 \u0422\u0438\u043f \u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 <code>name</code> <code>str, optional</code> \u0418\u043c\u044f \u0437\u0430\u0434\u0430\u0447\u0438. \u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e: <code>func.__name__</code>. <code>priority</code> <code>int, optional</code> \u041f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442 \u0437\u0430\u0434\u0430\u0447\u0438. \u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e: <code>config.task_default_priority</code>. <code>echo</code> <code>bool, optional</code> \u0414\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442 AsyncTask \u043f\u0435\u0440\u0432\u044b\u043c \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u043c. \u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e: <code>False</code>. <code>max_time</code> <code>float, optional</code> \u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u0432\u0440\u0435\u043c\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447\u0438 \u0432 \u0441\u0435\u043a\u0443\u043d\u0434\u0430\u0445. \u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e: <code>None</code>. <code>retry</code> <code>int, optional</code> \u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u043e\u043f\u044b\u0442\u043e\u043a \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e\u0433\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447\u0438. \u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e: <code>None</code>. <code>retry_on_exc</code> <code>List[Type[Exception]], optional</code> \u0418\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u043f\u0440\u0438 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u0437\u0430\u0434\u0430\u0447\u0430 \u0431\u0443\u0434\u0435\u0442 \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0430. \u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e: <code>None</code>. <code>decode</code> <code>Callable, optional</code> \u0414\u0435\u043a\u043e\u0434\u0435\u0440 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430 \u0437\u0430\u0434\u0430\u0447\u0438. \u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e: <code>None</code>. <code>tags</code> <code>List[str], optional</code> \u0422\u0435\u0433\u0438 \u0437\u0430\u0434\u0430\u0447\u0438. \u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e: <code>None</code>. <code>description</code> <code>str, optional</code> \u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447\u0438. \u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e: <code>None</code>. <code>generate_handler</code> <code>Callable, optional</code> \u0413\u0435\u043d\u0435\u0440\u0430\u0442\u043e\u0440 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u0430. \u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e: <code>None</code>. <code>executor</code> <code>Type[\"BaseTaskExecutor\"], optional</code> \u041a\u043b\u0430\u0441\u0441 <code>BaseTaskExecutor</code>. \u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e: <code>AsyncTaskExecutor</code>. <code>middlewares_before</code> <code>List[Type[\"TaskMiddleware\"]], optional</code> \u041c\u0438\u0434\u043b\u0432\u0430\u0440\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0431\u0443\u0434\u0443\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u044b \u0434\u043e \u0437\u0430\u0434\u0430\u0447\u0438. \u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e: <code>\u041f\u0443\u0441\u0442\u043e\u0439 \u043c\u0430\u0441\u0441\u0438\u0432</code>. <code>middlewares_after</code> <code>List[Type[\"TaskMiddleware\"]], optional</code> \u041c\u0438\u0434\u043b\u0432\u0430\u0440\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0431\u0443\u0434\u0443\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u044b \u043f\u043e\u0441\u043b\u0435 \u0437\u0430\u0434\u0430\u0447\u0438. \u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e: <code>\u041f\u0443\u0441\u0442\u043e\u0439 \u043c\u0430\u0441\u0441\u0438\u0432</code>. <code>**kwargs</code> - \u0414\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0437\u0430\u0434\u0430\u0447\u0438. \u041f\u0435\u0440\u0435\u0434\u0430\u0451\u0442\u0441\u044f \u043a\u0430\u043a extra \u0432 <code>(A)syncTask</code> \u0438 <code>TaskExecSchema</code>."},{"location":"ru/features/task/#asynctask","title":"(A)syncTask","text":"<p>(A)syncTask \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u043c-\u043e\u0431\u0451\u0440\u0442\u043a\u043e\u0439 \u043d\u0430\u0434 \u0437\u0430\u0434\u0430\u0447\u0435\u0439 \u0438 \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 API \u0434\u043b\u044f \u0435\u0451 \u0432\u044b\u0437\u043e\u0432\u0430 \u0438 \u043f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0439 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438.</p>"},{"location":"ru/features/task/#_4","title":"\u041f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u0430\u044f \u0441\u0431\u043e\u0440\u043a\u0430 \u0437\u0430\u0434\u0430\u0447\u0438","text":"<pre><code>cls = task_func(*args, **kwargs, priority=0, timeout=None)\n</code></pre> <p>\u0412 \u044d\u0442\u043e\u043c \u0441\u043b\u0443\u0447\u0430\u0435:</p> <ul> <li>\u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u044b \u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u044e\u0442\u0441\u044f \u0437\u0430\u0440\u0430\u043d\u0435\u0435;</li> <li>\u0441\u043e\u0437\u0434\u0430\u0451\u0442\u0441\u044f \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440 (A)syncTaskCls (\u043d\u0430\u0441\u043b\u0435\u0434\u043d\u0438\u043a <code>BaseTaskCls</code>);</li> <li>\u043e\u0431\u044a\u0435\u043a\u0442 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f dataclass \u0438 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0432\u0441\u0435 \u0434\u0430\u043d\u043d\u044b\u0435, \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b\u0435 \u0434\u043b\u044f \u043f\u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u0437\u0430\u0434\u0430\u0447\u0438 \u0432 \u043e\u0447\u0435\u0440\u0435\u0434\u044c.</li> </ul> <p>\u0422\u0430\u043a\u043e\u0439 \u043e\u0431\u044a\u0435\u043a\u0442 \u043c\u043e\u0436\u043d\u043e \u043f\u0435\u0440\u0435\u0434\u0430\u0432\u0430\u0442\u044c, \u043c\u043e\u0434\u0438\u0444\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0438\u043b\u0438 \u0432\u044b\u0437\u044b\u0432\u0430\u0442\u044c \u043f\u043e\u0437\u0436\u0435.</p>"},{"location":"ru/features/task/#_5","title":"\u0412\u044b\u0437\u043e\u0432 \u0437\u0430\u0434\u0430\u0447\u0438","text":"<p>\u0417\u0430\u0434\u0430\u0447\u0443 \u043c\u043e\u0436\u043d\u043e \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0434\u0432\u0443\u043c\u044f \u044d\u043a\u0432\u0438\u0432\u0430\u043b\u0435\u043d\u0442\u043d\u044b\u043c\u0438 \u0441\u043f\u043e\u0441\u043e\u0431\u0430\u043c\u0438:</p> <pre><code>task_func.add_task(*args, **kwargs, priority=0, timeout=None)\n</code></pre> <p>\u0438\u043b\u0438</p> <pre><code>cls.add_task()\n</code></pre> <p>\u0412 \u043e\u0431\u043e\u0438\u0445 \u0441\u043b\u0443\u0447\u0430\u044f\u0445 \u0432\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f <code>app.add_task</code>:</p> <ul> <li>\u043b\u0438\u0431\u043e \u0447\u0435\u0440\u0435\u0437 <code>app</code>, \u043f\u0435\u0440\u0435\u0434\u0430\u043d\u043d\u044b\u0439 \u0432 \u043c\u043e\u043c\u0435\u043d\u0442 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f <code>(A)syncTask</code>;</li> <li>\u043b\u0438\u0431\u043e \u0447\u0435\u0440\u0435\u0437 <code>qtasks._state.app_main</code>, \u0435\u0441\u043b\u0438 \u0437\u0430\u0434\u0430\u0447\u0430 \u0431\u044b\u043b\u0430 \u0432\u044b\u0437\u0432\u0430\u043d\u0430 \u0432\u043d\u0435 \u044f\u0432\u043d\u043e\u0433\u043e \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0430 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f.</li> </ul> <p>\u042d\u0442\u043e \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0438 \u043a\u0430\u043a \u0432\u043d\u0443\u0442\u0440\u0438 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f, \u0442\u0430\u043a \u0438 \u0432 \u0438\u0437\u043e\u043b\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u043c\u043e\u0434\u0443\u043b\u044f\u0445.</p>"},{"location":"ru/features/task/#timeout","title":"\u041e\u0436\u0438\u0434\u0430\u043d\u0438\u0435 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430 (timeout)","text":"<p>\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 <code>timeout: float | None</code> \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442 \u043f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u0435 \u0432\u044b\u0437\u043e\u0432\u0430 \u0437\u0430\u0434\u0430\u0447\u0438.</p> <ul> <li>\u0415\u0441\u043b\u0438 <code>timeout is None</code> \u2014 <code>add_task</code> \u043d\u0435\u043c\u0435\u0434\u043b\u0435\u043d\u043d\u043e \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u043e\u0431\u044a\u0435\u043a\u0442 <code>Task</code> \u0441\u043e \u0441\u0442\u0430\u0442\u0443\u0441\u043e\u043c <code>new</code>.</li> <li>\u0415\u0441\u043b\u0438 <code>timeout</code> \u0443\u043a\u0430\u0437\u0430\u043d \u2014 \u0432\u044b\u0437\u043e\u0432 \u0431\u043b\u043e\u043a\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0434\u043e \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430 \u0438 \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u043e\u0431\u044a\u0435\u043a\u0442 <code>(A)syncResult</code>.</li> </ul> <p>\u041e\u0436\u0438\u0434\u0430\u043d\u0438\u0435 \u0437\u0430\u0432\u0435\u0440\u0448\u0430\u0435\u0442\u0441\u044f \u043f\u0440\u0438 \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u0438 \u043e\u0434\u043d\u043e\u0433\u043e \u0438\u0437 \u043a\u043e\u043d\u0435\u0447\u043d\u044b\u0445 \u0441\u0442\u0430\u0442\u0443\u0441\u043e\u0432, \u0437\u0430\u0434\u0430\u043d\u043d\u044b\u0445 \u0432 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f:</p> <pre><code>app.config.result_statuses_end = [\n    TaskStatusEnum.SUCCESS.value,\n    TaskStatusEnum.ERROR.value,\n    TaskStatusEnum.CANCEL.value,\n]\n</code></pre>"},{"location":"ru/features/task/#taskexecschema","title":"TaskExecSchema","text":"<p><code>TaskExecSchema</code> \u2014 \u044d\u0442\u043e dataclass, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 \u0437\u0430\u0434\u0430\u0447\u0438 \u043c\u0435\u0436\u0434\u0443 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430\u043c\u0438 QTasks.</p> <p>\u041e\u043d \u0445\u0440\u0430\u043d\u0438\u0442:</p> <ul> <li>\u0438\u043c\u044f \u0437\u0430\u0434\u0430\u0447\u0438;</li> <li>\u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442;</li> <li>\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f;</li> <li>\u0441\u0441\u044b\u043b\u043a\u0443 \u043d\u0430 \u0444\u0443\u043d\u043a\u0446\u0438\u044e \u0437\u0430\u0434\u0430\u0447\u0438;</li> <li>\u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0435.</li> </ul> <p>\u042d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u044b <code>TaskExecSchema</code> \u0444\u043e\u0440\u043c\u0438\u0440\u0443\u044e\u0442\u0441\u044f \u043f\u0440\u0438 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438 \u0437\u0430\u0434\u0430\u0447\u0438 \u0438 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b \u0432:</p> <ul> <li><code>app.tasks</code>;</li> <li><code>app.worker.tasks</code>.</li> </ul> <p>Worker \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u0438\u043c\u0435\u043d\u043d\u043e <code>TaskExecSchema</code> \u0434\u043b\u044f \u0444\u0430\u043a\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u0438\u0441\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447\u0438.</p>"},{"location":"ru/features/task/#_6","title":"\u0420\u0430\u0437\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0441\u0442\u0438","text":"<p>\u0422\u0430\u043a\u043e\u0435 \u0440\u0430\u0437\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442:</p> <ul> <li>\u0438\u0437\u043e\u043b\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u0439 API \u043e\u0442 \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0435\u0433\u043e \u0438\u0441\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f;</li> <li>\u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e \u043f\u0435\u0440\u0435\u0434\u0430\u0432\u0430\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0438 \u043c\u0435\u0436\u0434\u0443 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430\u043c\u0438;</li> <li>\u0440\u0430\u0441\u0448\u0438\u0440\u044f\u0442\u044c \u043c\u043e\u0434\u0435\u043b\u044c \u0437\u0430\u0434\u0430\u0447\u0438 \u0447\u0435\u0440\u0435\u0437 \u043f\u043b\u0430\u0433\u0438\u043d\u044b \u0438 \u0441\u0445\u0435\u043c\u044b;</li> <li>\u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0442\u044c \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0439 \u0438 \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0439 \u0440\u0435\u0436\u0438\u043c\u044b \u0431\u0435\u0437 \u0434\u0443\u0431\u043b\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u043b\u043e\u0433\u0438\u043a\u0438.</li> </ul>"},{"location":"ru/features/task/#_7","title":"\u0418\u0442\u043e\u0433","text":"<p>\u0414\u0435\u043a\u043e\u0440\u0430\u0442\u043e\u0440 <code>@app.task</code>:</p> <ul> <li>\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u0443\u0435\u0442 \u0444\u0443\u043d\u043a\u0446\u0438\u044e \u043a\u0430\u043a \u0437\u0430\u0434\u0430\u0447\u0443 QTasks;</li> <li>\u0441\u043e\u0437\u0434\u0430\u0451\u0442 \u043e\u0431\u044a\u0435\u043a\u0442 <code>(A)syncTask</code> \u0434\u043b\u044f \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0432\u044b\u0437\u043e\u0432\u0430\u043c\u0438;</li> <li>\u0444\u043e\u0440\u043c\u0438\u0440\u0443\u0435\u0442 <code>TaskExecSchema</code> \u0434\u043b\u044f \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0435\u0433\u043e \u0438\u0441\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f;</li> <li>\u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442 \u0433\u0438\u0431\u043a\u0438\u0439 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u0438 \u043e\u0436\u0438\u0434\u0430\u043d\u0438\u044f \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430.</li> </ul> <p>\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043e\u0444\u043e\u0440\u043c\u043b\u0435\u043d\u0430 \u043a\u0430\u043a \u0445\u043e\u043b\u0441\u0442 \u0438 \u043c\u043e\u0436\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u043a\u0430\u043a \u0431\u0430\u0437\u043e\u0432\u044b\u0439 \u043c\u0430\u0442\u0435\u0440\u0438\u0430\u043b \u0434\u043b\u044f \u0440\u0430\u0437\u0434\u0435\u043b\u043e\u0432 \u043e \u0437\u0430\u0434\u0430\u0447\u0430\u0445, \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0435 \u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0438.</p>"},{"location":"ru/features/timer/","title":"Timer","text":"<p>\u0421\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 \u0432\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0439 \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 (A)syncTimer, \u043f\u0440\u0435\u0434\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u043d\u044b\u0439 \u0434\u043b\u044f \u043f\u0435\u0440\u0438\u043e\u0434\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u0437\u0430\u0434\u0430\u0447 QTasks. \u0422\u0430\u0439\u043c\u0435\u0440 \u0438\u043d\u0442\u0435\u0433\u0440\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u043d\u0430\u043f\u0440\u044f\u043c\u0443\u044e \u0441 <code>QueueTasks</code> \u0447\u0435\u0440\u0435\u0437 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 <code>app</code> \u0438 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u0441 \u0437\u0430\u0434\u0430\u0447\u0430\u043c\u0438 \u043a\u0430\u043a \u0441 \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u0435\u043c, \u0430 \u043d\u0435 \u0441 \u0435\u0434\u0438\u043d\u0438\u0447\u043d\u044b\u043c\u0438 \u0432\u044b\u0437\u043e\u0432\u0430\u043c\u0438.</p> <p>(A)syncTimer \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0432\u044b\u043d\u043e\u0441\u0438\u0442\u044c \u043b\u043e\u0433\u0438\u043a\u0443 \u043f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0438\u0437 \u0431\u0438\u0437\u043d\u0435\u0441-\u043a\u043e\u0434\u0430 \u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0434\u0435\u043a\u043b\u0430\u0440\u0430\u0442\u0438\u0432\u043d\u044b\u0435 \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u044b \u0434\u043b\u044f \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u0437\u0430\u0434\u0430\u0447 \u043f\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438.</p>"},{"location":"ru/features/timer/#_1","title":"\u041f\u0440\u0438\u043d\u0446\u0438\u043f \u0440\u0430\u0431\u043e\u0442\u044b","text":"<p>Timer \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u043c \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u043c, \u043a\u043e\u0442\u043e\u0440\u044b\u0439:</p> <ul> <li>\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u0443\u0435\u0442 \u043f\u0435\u0440\u0438\u043e\u0434\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0437\u0430\u0434\u0430\u0447\u0438;</li> <li>\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u0432\u043d\u0435\u0448\u043d\u0438\u0435 \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u044b (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, cron);</li> <li>\u0438\u043d\u0438\u0446\u0438\u0438\u0440\u0443\u0435\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447 \u0447\u0435\u0440\u0435\u0437 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0439 \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c QTasks;</li> <li>\u043d\u0435 \u0438\u0437\u043c\u0435\u043d\u044f\u0435\u0442 \u043b\u043e\u0433\u0438\u043a\u0443 \u0441\u0430\u043c\u0438\u0445 \u0437\u0430\u0434\u0430\u0447.</li> </ul> <p>\u0417\u0430\u0434\u0430\u0447\u0430, \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u043c\u0430\u044f \u0447\u0435\u0440\u0435\u0437 Timer, \u043e\u0441\u0442\u0430\u0451\u0442\u0441\u044f \u043e\u0431\u044b\u0447\u043d\u043e\u0439 \u0437\u0430\u0434\u0430\u0447\u0435\u0439 QTasks \u0438 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0432\u044b\u0437\u0432\u0430\u043d\u0430 \u0432\u0440\u0443\u0447\u043d\u0443\u044e, \u0447\u0435\u0440\u0435\u0437 API \u0438\u043b\u0438 \u0434\u0440\u0443\u0433\u0438\u043c\u0438 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430\u043c\u0438.</p>"},{"location":"ru/features/timer/#_2","title":"\u041f\u0440\u0438\u043c\u0435\u0440 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f","text":"<pre><code>from qtasks.timers import AsyncTimer\nfrom apscheduler.triggers.cron import CronTrigger\n\ntimer = AsyncTimer(app=app)\n\ntimer.add_task(\n    \"daily_report\",\n    trigger=CronTrigger(hour=23, minute=59),\n)\n\n@app.task(name=\"daily_report\")\nasync def daily_report():\n    stats = await db.get_today_stats()\n    await mailer.send(\n        \"owner@shop.com\",\n        \"\u0415\u0436\u0435\u0434\u043d\u0435\u0432\u043d\u044b\u0439 \u043e\u0442\u0447\u0451\u0442\",\n        stats.format(),\n    )\n</code></pre> <p>\u0412 \u0434\u0430\u043d\u043d\u043e\u043c \u043f\u0440\u0438\u043c\u0435\u0440\u0435 \u0437\u0430\u0434\u0430\u0447\u0430 <code>daily_report</code> \u0431\u0443\u0434\u0435\u0442 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0442\u044c\u0441\u044f \u043a\u0430\u0436\u0434\u044b\u0439 \u0434\u0435\u043d\u044c \u0432 23:59.</p>"},{"location":"ru/features/timer/#_3","title":"\u041f\u043e\u0434 \u043a\u0430\u043f\u043e\u0442\u043e\u043c","text":"<p>\u0420\u0430\u0431\u043e\u0442\u0430 Timer \u0441\u043e\u0441\u0442\u043e\u0438\u0442 \u0438\u0437 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0445 \u044d\u0442\u0430\u043f\u043e\u0432:</p> <ol> <li>Timer \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0441 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u043e\u043c <code>QueueTasks</code>.</li> <li> <p>\u041f\u0440\u0438 \u0432\u044b\u0437\u043e\u0432\u0435 <code>add_task</code>:</p> </li> <li> <p>\u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u0442\u0441\u044f \u0438\u043c\u044f \u0437\u0430\u0434\u0430\u0447\u0438;</p> </li> <li>\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0442\u0440\u0438\u0433\u0433\u0435\u0440 \u0437\u0430\u043f\u0443\u0441\u043a\u0430;</li> <li>\u0444\u043e\u0440\u043c\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0441\u0432\u044f\u0437\u043a\u0430 \u00ab\u0442\u0440\u0438\u0433\u0433\u0435\u0440 \u2192 \u0437\u0430\u0434\u0430\u0447\u0430\u00bb.</li> <li> <p>\u041f\u0440\u0438 \u0441\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u043d\u0438\u0438 \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u0430:</p> </li> <li> <p>Timer \u0441\u043e\u0437\u0434\u0430\u0451\u0442 \u043e\u0431\u044b\u0447\u043d\u044b\u0439 \u0432\u044b\u0437\u043e\u0432 \u0437\u0430\u0434\u0430\u0447\u0438 \u0447\u0435\u0440\u0435\u0437 <code>add_task</code>;</p> </li> <li>\u0437\u0430\u0434\u0430\u0447\u0430 \u043f\u043e\u043f\u0430\u0434\u0430\u0435\u0442 \u0432 Broker \u0438 \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0435\u0442\u0441\u044f Worker \u043a\u0430\u043a \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u0430\u044f.</li> </ol> <p>\u0422\u0430\u043a\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c, Timer \u043d\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442 \u0437\u0430\u0434\u0430\u0447\u0443 \u043d\u0430\u043f\u0440\u044f\u043c\u0443\u044e \u0438 \u043d\u0435 \u043e\u0431\u0445\u043e\u0434\u0438\u0442 \u043e\u0447\u0435\u0440\u0435\u0434\u044c.</p>"},{"location":"ru/features/timer/#_4","title":"\u0422\u0440\u0438\u0433\u0433\u0435\u0440\u044b","text":"<p>(A)syncTimer \u043d\u0435 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u0432\u0430\u0435\u0442 \u0442\u0438\u043f \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u0430. \u041d\u0430 \u043f\u0440\u0430\u043a\u0442\u0438\u043a\u0435 \u0447\u0430\u0449\u0435 \u0432\u0441\u0435\u0433\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u044b \u0438\u0437 <code>apscheduler</code>, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440:</p> <ul> <li><code>CronTrigger</code> \u2014 cron-\u0440\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u0435;</li> <li><code>IntervalTrigger</code> \u2014 \u0437\u0430\u043f\u0443\u0441\u043a \u0441 \u0444\u0438\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u043c \u0438\u043d\u0442\u0435\u0440\u0432\u0430\u043b\u043e\u043c;</li> <li><code>DateTrigger</code> \u2014 \u043e\u0434\u043d\u043e\u043a\u0440\u0430\u0442\u043d\u044b\u0439 \u0437\u0430\u043f\u0443\u0441\u043a \u0432 \u0437\u0430\u0434\u0430\u043d\u043d\u043e\u0435 \u0432\u0440\u0435\u043c\u044f.</li> </ul> <p>\u042d\u0442\u043e \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0433\u0438\u0431\u043a\u043e \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u0435\u043c \u0431\u0435\u0437 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u043a\u043e\u0434\u0430 \u0437\u0430\u0434\u0430\u0447.</p>"},{"location":"ru/features/timer/#_5","title":"\u041e\u0441\u043e\u0431\u0435\u043d\u043d\u043e\u0441\u0442\u0438","text":"<ul> <li>Timer \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u043c \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u043c \u0438 \u043d\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u0435\u043d \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b QTasks.</li> <li>\u0422\u0430\u0439\u043c\u0435\u0440 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u0441 \u0437\u0430\u0434\u0430\u0447\u0430\u043c\u0438 \u043f\u043e \u0438\u043c\u0435\u043d\u0438, \u0430 \u043d\u0435 \u043f\u043e \u0441\u0441\u044b\u043b\u043a\u0435 \u043d\u0430 \u0444\u0443\u043d\u043a\u0446\u0438\u044e.</li> <li>\u0417\u0430\u0434\u0430\u0447\u0438, \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u0432 Timer, \u043f\u043e\u043b\u043d\u043e\u0441\u0442\u044c\u044e \u0441\u043e\u0432\u043c\u0435\u0441\u0442\u0438\u043c\u044b \u0441 retry, priority, middlewares \u0438 \u043f\u043b\u0430\u0433\u0438\u043d\u0430\u043c\u0438.</li> <li>Timer \u043d\u0435 \u0445\u0440\u0430\u043d\u0438\u0442 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447 \u2014 \u044d\u0442\u0438\u043c \u0437\u0430\u043d\u0438\u043c\u0430\u0435\u0442\u0441\u044f \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u043e\u0435 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 QTasks.</li> </ul>"},{"location":"ru/features/timer/#_6","title":"\u0418\u0442\u043e\u0433","text":"<p>(A)syncTimer \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442:</p> <ul> <li>\u0434\u0435\u043a\u043b\u0430\u0440\u0430\u0442\u0438\u0432\u043d\u043e\u0435 \u043f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447;</li> <li>\u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044e \u0441 \u0432\u043d\u0435\u0448\u043d\u0438\u043c\u0438 \u0441\u0438\u0441\u0442\u0435\u043c\u0430\u043c\u0438 \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u0439;</li> <li>\u0435\u0434\u0438\u043d\u044b\u0439 \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u0437\u0430\u0434\u0430\u0447 \u0447\u0435\u0440\u0435\u0437 \u043e\u0447\u0435\u0440\u0435\u0434\u044c;</li> <li>\u0447\u0438\u0441\u0442\u043e\u0435 \u0440\u0430\u0437\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u0431\u0438\u0437\u043d\u0435\u0441-\u043b\u043e\u0433\u0438\u043a\u0438 \u0438 \u043b\u043e\u0433\u0438\u043a\u0438 \u043f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f.</li> </ul> <p>\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043e\u0444\u043e\u0440\u043c\u043b\u0435\u043d\u0430 \u043a\u0430\u043a \u0445\u043e\u043b\u0441\u0442 \u0438 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0430 \u043a\u0430\u043a \u0448\u0430\u0431\u043b\u043e\u043d \u0434\u043b\u044f \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438 \u0434\u0440\u0443\u0433\u0438\u0445 \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0445 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432 QTasks.</p>"},{"location":"ru/features/uniqueness/","title":"\u0423\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u043e\u0441\u0442\u044c QTasks","text":"<p>QTasks \u2014 \u044d\u0442\u043e \u043d\u0435 \u043f\u0440\u043e\u0441\u0442\u043e \u0430\u043b\u044c\u0442\u0435\u0440\u043d\u0430\u0442\u0438\u0432\u0430 Celery \u0438\u043b\u0438 RQ. \u042d\u0442\u043e \u0444\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a \u0441 \u0438\u043d\u044b\u043c \u0432\u0437\u0433\u043b\u044f\u0434\u043e\u043c \u043d\u0430 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0443 \u043e\u0447\u0435\u0440\u0435\u0434\u0435\u0439 \u0437\u0430\u0434\u0430\u0447: \u0433\u0438\u0431\u043a\u0438\u043c, \u043c\u043e\u0434\u0443\u043b\u044c\u043d\u044b\u043c \u0438 \u043e\u0440\u0438\u0435\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u043c \u043d\u0430 \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u0435. \u041d\u0438\u0436\u0435 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u044b \u043a\u043b\u044e\u0447\u0435\u0432\u044b\u0435 \u043e\u0441\u043e\u0431\u0435\u043d\u043d\u043e\u0441\u0442\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0444\u043e\u0440\u043c\u0438\u0440\u0443\u044e\u0442 \u0435\u0433\u043e \u043e\u0442\u043b\u0438\u0447\u0438\u044f.</p>"},{"location":"ru/features/uniqueness/#_1","title":"\ud83e\uddec \u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043d\u0430\u044f \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430","text":"<ul> <li>\u0412\u0441\u0435 \u043a\u043b\u044e\u0447\u0435\u0432\u044b\u0435 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u044b (Broker, Worker, Storage, GlobalConfig, Starter, TaskExecutor \u0438 \u0434\u0440.)\u043f\u043e\u043b\u043d\u043e\u0441\u0442\u044c\u044e \u0437\u0430\u043c\u0435\u043d\u044f\u0435\u043c\u044b.</li> <li>\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b \u043c\u043e\u0436\u043d\u043e \u043f\u0435\u0440\u0435\u043f\u0438\u0441\u0430\u0442\u044c \u043f\u043e\u0434 \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u0443\u044e \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0443 \u0431\u0435\u0437 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u044f\u0434\u0440\u0430.</li> <li>\u0420\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u044e\u0442\u0441\u044f \u0447\u0435\u0440\u0435\u0437 \u043f\u043b\u0430\u0433\u0438\u043d\u044b \u0438 \u0441\u0442\u0430\u0440\u0442\u0435\u0440\u044b.</li> </ul> <p>\ud83c\udd9a Celery: \u043c\u043e\u043d\u043e\u043b\u0438\u0442\u043d\u0430\u044f \u0441\u0432\u044f\u0437\u043a\u0430. QTasks: \u043d\u0435\u0437\u0430\u0432\u0438\u0441\u0438\u043c\u044b\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b \u0441 plug\u2011and\u2011play \u043f\u043e\u0434\u0445\u043e\u0434\u043e\u043c.</p>"},{"location":"ru/features/uniqueness/#yield","title":"\ud83d\udd01 \u041f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 <code>yield</code> \u0432 \u0437\u0430\u0434\u0430\u0447\u0430\u0445","text":"<p>\u041f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0441\u0442\u0440\u043e\u0438\u0442\u044c \u043f\u043e\u044d\u0442\u0430\u043f\u043d\u044b\u0435, \u043f\u043e\u0442\u043e\u043a\u043e\u0432\u044b\u0435 \u0441\u0446\u0435\u043d\u0430\u0440\u0438\u0438.</p> <ul> <li>\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 \u0433\u0435\u043d\u0435\u0440\u0430\u0442\u043e\u0440\u043e\u0432 \u0432 \u0437\u0430\u0434\u0430\u0447\u0430\u0445.</li> <li>\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u0432 <code>yield</code> \u0447\u0435\u0440\u0435\u0437 <code>generate_handler</code>.</li> <li>\u0418\u0442\u043e\u0433\u043e\u0432\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 <code>return</code> \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442\u0441\u044f \u043a\u0430\u043a \u043e\u0431\u044b\u0447\u043d\u044b\u0439 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0437\u0430\u0434\u0430\u0447\u0438.</li> </ul> <pre><code>@app.task(generate_handler=handler)\ndef task():\n    step = yield \"INIT\"\n    return step\n</code></pre> <p>\ud83c\udd9a \u0411\u043e\u043b\u044c\u0448\u0438\u043d\u0441\u0442\u0432\u043e \u0444\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a\u043e\u0432 \u043d\u0435 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 generator\u2011based \u0437\u0430\u0434\u0430\u0447\u0438.</p>"},{"location":"ru/features/uniqueness/#echo-self","title":"\ud83e\udde0 Echo \u0438 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0437\u0430\u0434\u0430\u0447\u0435 \u0447\u0435\u0440\u0435\u0437 <code>self</code>","text":"<p>\u041f\u0440\u0438 \u0432\u043a\u043b\u044e\u0447\u0451\u043d\u043d\u043e\u043c <code>echo=True</code> \u0437\u0430\u0434\u0430\u0447\u0430 \u043f\u0440\u0435\u0432\u0440\u0430\u0449\u0430\u0435\u0442\u0441\u044f \u0432 \u043e\u0431\u044a\u0435\u043a\u0442 <code>Task</code> (Async/Sync), \u0447\u0442\u043e \u043e\u0442\u043a\u0440\u044b\u0432\u0430\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0435:</p> <ul> <li><code>self.add_task()</code> \u2014 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0432\u043b\u043e\u0436\u0435\u043d\u043d\u044b\u0445 \u0437\u0430\u0434\u0430\u0447</li> <li><code>self.ctx.get_logger()</code> \u2014 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u043d\u044b\u0439 \u043b\u043e\u0433\u0433\u0435\u0440</li> <li><code>self.ctx.cancel()</code> \u2014 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447\u0438 \u0437\u0430\u0440\u0430\u043d\u0435\u0435</li> <li><code>self.ctx.get_task()</code> \u2014 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0434\u0440\u0443\u0433\u043e\u0439 \u0437\u0430\u0434\u0430\u0447\u0438 \u043f\u043e UUID</li> </ul> <p>\ud83c\udd9a \u0412 \u0434\u0440\u0443\u0433\u0438\u0445 \u0444\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a\u0430\u0445 \u0437\u0430\u0434\u0430\u0447\u0430 \u2014 \u043f\u0440\u043e\u0441\u0442\u0430\u044f \u0444\u0443\u043d\u043a\u0446\u0438\u044f \u0431\u0435\u0437 self\u2011\u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0430.</p>"},{"location":"ru/features/uniqueness/#ctx","title":"\u2699\ufe0f \u041a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f (ctx)","text":"<p>\u041a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 \u0437\u0430\u0434\u0430\u0447\u0438 \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442:</p> <ul> <li>UUID \u0437\u0430\u0434\u0430\u0447\u0438</li> <li>\u0434\u043e\u0441\u0442\u0443\u043f \u043a Broker, Storage, GlobalConfig</li> <li>\u0440\u0430\u0431\u043e\u0442\u0443 \u0441 metadata (<code>get_metadata()</code>)</li> <li>\u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u044b\u0439 sleep (<code>ctx.sleep()</code>)</li> <li>\u043e\u0442\u043c\u0435\u043d\u0443 \u0437\u0430\u0434\u0430\u0447 (<code>cancel()</code>)</li> </ul> <p>\u042d\u0442\u043e \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0441\u0442\u0440\u043e\u0438\u0442\u044c \u0441\u043b\u043e\u0436\u043d\u044b\u0435 \u0441\u0446\u0435\u043d\u0430\u0440\u0438\u0438 \u0431\u0435\u0437 \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0445 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445 \u0438 \u0441\u0442\u043e\u0440\u043e\u043d\u043d\u0438\u0445 \u0441\u0438\u043d\u0433\u043b\u0442\u043e\u043d\u043e\u0432.</p>"},{"location":"ru/features/uniqueness/#state-depends","title":"\ud83d\udd17 State \u0438 Depends","text":""},{"location":"ru/features/uniqueness/#state","title":"State","text":"<p>\u041f\u043e\u0442\u043e\u043a\u043e\u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0435 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u043f\u0440\u043e\u043c\u0435\u0436\u0443\u0442\u043e\u0447\u043d\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445 \u043c\u0435\u0436\u0434\u0443 \u0437\u0430\u0434\u0430\u0447\u0430\u043c\u0438.</p> <pre><code>from qtasks.plugins import AsyncState\n\nclass MyState(AsyncState):\n    pass\n\n@app.task\ndef sample(state: MyState):\n    ...\n</code></pre>"},{"location":"ru/features/uniqueness/#depends","title":"Depends","text":"<p>\u0418\u043d\u044a\u0435\u043a\u0446\u0438\u044f \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0435\u0439 \u0432 \u0437\u0430\u0434\u0430\u0447\u0438:</p> <pre><code>@app.task\ndef job(data: int, db=Depends(connect_db, scope=\"worker\")):\n    return db.save(data)\n</code></pre> <p>Scopes \u0432\u043a\u043b\u044e\u0447\u0430\u044e\u0442:</p> <ul> <li>task</li> <li>worker</li> <li>broker</li> <li>storage</li> <li>global_config</li> </ul> <p>QTasks \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0441\u043e\u0437\u0434\u0430\u0451\u0442 \u0438 \u0437\u0430\u0432\u0435\u0440\u0448\u0430\u0435\u0442 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043f\u043e \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u043c\u0443 scope.</p>"},{"location":"ru/features/uniqueness/#_2","title":"\ud83e\udde9 \u041f\u043b\u0430\u0433\u0438\u043d\u044b \u0438 \u0441\u0442\u0430\u0440\u0442\u0435\u0440\u044b","text":"<ul> <li>\u041f\u043b\u0430\u0433\u0438\u043d\u044b \u043c\u043e\u0436\u043d\u043e \u043f\u0440\u0438\u0432\u044f\u0437\u044b\u0432\u0430\u0442\u044c \u043a \u043b\u044e\u0431\u044b\u043c \u0441\u043e\u0431\u044b\u0442\u0438\u044f\u043c (\u0442\u0440\u0438\u0433\u0433\u0435\u0440\u0430\u043c) \u0432\u043d\u0443\u0442\u0440\u0438 \u0441\u0438\u0441\u0442\u0435\u043c\u044b.</li> <li>\u041c\u043e\u0436\u043d\u043e \u0440\u0430\u0441\u0448\u0438\u0440\u044f\u0442\u044c \u043f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u0435 Worker, Broker, Storage, TaskExecutor.</li> <li>\u0421\u0442\u0430\u0440\u0442\u0435\u0440 \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u0436\u0438\u0437\u043d\u0435\u043d\u043d\u044b\u043c \u0446\u0438\u043a\u043b\u043e\u043c \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432 \u0438 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0432\u043d\u0435\u0434\u0440\u044f\u0442\u044c \u043a\u0430\u0441\u0442\u043e\u043c\u043d\u044b\u0435 \u0441\u0446\u0435\u043d\u0430\u0440\u0438\u0438 \u043f\u043e\u0442\u043e\u043a\u043e\u0432.</li> </ul> <p>\ud83c\udd9a Celery \u0442\u0440\u0435\u0431\u0443\u0435\u0442 monkeypatch \u0438\u043b\u0438 \u0433\u043b\u0443\u0431\u043e\u043a\u0443\u044e \u043c\u043e\u0434\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044e.</p>"},{"location":"ru/features/uniqueness/#_3","title":"\u23f1 \u0422\u0430\u0439\u043c\u0435\u0440\u044b \u0431\u0435\u0437 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0432\u0438\u0441\u0430","text":"<p>\u0412\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0439 <code>AsyncTimer</code> \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442 \u0437\u0430\u0434\u0430\u0447\u0438 \u043f\u043e \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u044e:</p> <ul> <li>cron\u2011\u043b\u043e\u0433\u0438\u043a\u0430 \u0447\u0435\u0440\u0435\u0437 <code>apscheduler</code></li> <li>\u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f \u0441 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435\u043c \u0431\u0435\u0437 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 \u0442\u0438\u043f\u0430 Celery Beat</li> </ul>"},{"location":"ru/features/uniqueness/#_4","title":"\ud83d\udee0 \u041c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0435 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438, \u043b\u0451\u0433\u043a\u0438\u0439 \u0437\u0430\u043f\u0443\u0441\u043a","text":"<ul> <li>\u041c\u043e\u0436\u043d\u043e \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u0431\u0435\u0437 Redis \u0438 \u0431\u0440\u043e\u043a\u0435\u0440\u043e\u0432 \u2014 \u0447\u0435\u0440\u0435\u0437 in\u2011memory \u043e\u0447\u0435\u0440\u0435\u0434\u044c.</li> <li>\u0417\u0430\u043f\u0443\u0441\u043a:</li> </ul> <pre><code>python main.py\nqtasks -A app:app run\n</code></pre> <ul> <li>\u041f\u0440\u043e\u0441\u0442\u043e\u0442\u0430 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c QTasks \u0432 \u043c\u0438\u043a\u0440\u043e\u0441\u0435\u0440\u0432\u0438\u0441\u0430\u0445, \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0437\u0430\u0446\u0438\u0438, \u0444\u0440\u0438\u043b\u0430\u043d\u0441\u2011\u043f\u0440\u043e\u0435\u043a\u0442\u0430\u0445.</li> </ul>"},{"location":"ru/features/uniqueness/#_5","title":"\ud83d\ude80 \u041f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c","text":"<ul> <li>0.6\u20130.7 \u0441\u0435\u043a \u043d\u0430 \u0437\u0430\u0434\u0430\u0447\u0443 \u0441 Redis.</li> <li>\u0410\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u0430\u044f \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u0447\u0435\u0440\u0435\u0437 <code>PriorityQueue</code> \u0438 <code>anyio.Semaphore</code>.</li> <li>\u041d\u0438\u0437\u043a\u0438\u0435 \u043d\u0430\u043a\u043b\u0430\u0434\u043d\u044b\u0435 \u0440\u0430\u0441\u0445\u043e\u0434\u044b \u0434\u0430\u0436\u0435 \u043d\u0430 \u0431\u043e\u043b\u044c\u0448\u0438\u0445 \u043e\u0431\u044a\u0451\u043c\u0430\u0445 \u0437\u0430\u0434\u0430\u0447.</li> </ul>"},{"location":"ru/features/uniqueness/#_6","title":"\ud83e\uddea \u0418\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u0434\u043b\u044f \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f","text":"<ul> <li><code>SyncTestCase</code> \u0438 <code>AsyncTestCase</code> \u043f\u043e\u0434\u043c\u0435\u043d\u044f\u044e\u0442 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b \u0434\u043b\u044f \u0438\u0437\u043e\u043b\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f.</li> <li>\u0420\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u0431\u0435\u0437 \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u0432\u043e\u0440\u043a\u0435\u0440\u0430.</li> <li>\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 <code>pytest</code>, <code>unittest</code>, <code>pytest-asyncio</code>.</li> </ul>"},{"location":"ru/features/uniqueness/#_7","title":"\ud83d\udca1 \u041f\u043e\u0434\u0445\u043e\u0434\u0438\u0442 \u0434\u043b\u044f \u043b\u044e\u0431\u043e\u0433\u043e \u0443\u0440\u043e\u0432\u043d\u044f \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u0430","text":"<ul> <li>Junior: \u043f\u0440\u043e\u0441\u0442\u043e\u0442\u0430 API</li> <li>Middle: \u043f\u043b\u0430\u0433\u0438\u043d\u044b, middleware, TaskManager</li> <li>Senior: \u0437\u0430\u043c\u0435\u043d\u0430 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432, \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u043e\u043c, \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0435 executors</li> <li>Lead: \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433, \u043c\u0430\u0441\u0448\u0442\u0430\u0431\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435, \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430 \u0441\u0438\u0441\u0442\u0435\u043c \u043d\u0430 QTasks</li> </ul> <p>QTasks \u2014 \u044d\u0442\u043e \u043a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0442\u043e\u0440, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0441\u043e\u0431\u0438\u0440\u0430\u0442\u044c \u0444\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a \u043f\u043e\u0434 \u0441\u0432\u043e\u0438 \u0437\u0430\u0434\u0430\u0447\u0438: \u043e\u0442 \u043c\u0430\u043b\u0435\u043d\u044c\u043a\u043e\u0433\u043e \u0441\u043a\u0440\u0438\u043f\u0442\u0430 \u0434\u043e \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0451\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0432\u0438\u0441\u0430.</p>"},{"location":"ru/features/yield/","title":"\u0417\u0430\u0434\u0430\u0447\u0438 \u0441 <code>yield</code>","text":"<p>\u0412 QTasks \u0437\u0430\u0434\u0430\u0447\u0430 \u043c\u043e\u0436\u0435\u0442 \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0442\u044c \u043d\u0435 \u0442\u043e\u043b\u044c\u043a\u043e \u043e\u0434\u043d\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0447\u0435\u0440\u0435\u0437 <code>return</code>, \u043d\u043e \u0438 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439 \u0447\u0435\u0440\u0435\u0437 <code>yield</code>. \u0422\u0430\u043a\u0430\u044f \u0437\u0430\u0434\u0430\u0447\u0430 \u0440\u0430\u0441\u0441\u043c\u0430\u0442\u0440\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u043a\u0430\u043a \u0433\u0435\u043d\u0435\u0440\u0430\u0442\u043e\u0440: \u043e\u043d\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0432\u044b\u0434\u0430\u0451\u0442 \u043f\u0440\u043e\u043c\u0435\u0436\u0443\u0442\u043e\u0447\u043d\u044b\u0435 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043c\u043e\u0433\u0443\u0442 \u0431\u044b\u0442\u044c \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0430\u043d\u044b \u0438 \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u043d\u044b.</p>"},{"location":"ru/features/yield/#generate_handler","title":"\u041f\u0440\u0438\u043c\u0435\u0440: \u0433\u0435\u043d\u0435\u0440\u0430\u0442\u043e\u0440\u043d\u0430\u044f \u0437\u0430\u0434\u0430\u0447\u0430 \u0441 <code>generate_handler</code>","text":"<pre><code>async def yield_func(result: int) -&gt; int:\n    print(result)\n    return result + 2\n\n\n@app.task(\n    description=\"\u0422\u0435\u0441\u0442\u043e\u0432\u0430\u044f \u0437\u0430\u0434\u0430\u0447\u0430 \u0441 \u0433\u0435\u043d\u0435\u0440\u0430\u0442\u043e\u0440\u043e\u043c.\",\n    generate_handler=yield_func,\n)\nasync def test_yield(n: int):\n    for _ in range(n):\n        n += 1\n        yield n\n</code></pre> <p>\u0412\u044b\u0437\u043e\u0432 \u0437\u0430\u0434\u0430\u0447\u0438:</p> <pre><code>task = await test_yield.add_task(5, timeout=50)\nprint(task.returning)\n# \u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442: [8, 9, 10, 11, 12]\n</code></pre> <p>\u0427\u0442\u043e \u0437\u0434\u0435\u0441\u044c \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442:</p> <ul> <li>\u0424\u0443\u043d\u043a\u0446\u0438\u044f <code>test_yield</code> \u2014 \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u0439 \u0433\u0435\u043d\u0435\u0440\u0430\u0442\u043e\u0440: \u043e\u043d\u0430 \u0434\u0435\u043b\u0430\u0435\u0442 <code>yield n</code> \u0432\u043d\u0443\u0442\u0440\u0438 \u0446\u0438\u043a\u043b\u0430.</li> <li>\u0414\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f <code>n</code> \u0432\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f <code>yield_func(result)</code>, \u0438 \u0438\u043c\u0435\u043d\u043d\u043e \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 <code>yield_func</code> \u043f\u043e\u043f\u0430\u0434\u0430\u0435\u0442 \u0432 \u0438\u0442\u043e\u0433\u043e\u0432\u044b\u0439 \u0441\u043f\u0438\u0441\u043e\u043a.</li> <li>\u041f\u0440\u0438 <code>n = 5</code> \u0446\u0438\u043a\u043b \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f 5 \u0440\u0430\u0437, \u0432\u044b\u0434\u0430\u0432\u0430\u044f \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f <code>6, 7, 8, 9, 10</code>,   \u0430 <code>yield_func</code> \u043f\u0440\u0435\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u0438\u0445 \u0432 <code>8, 9, 10, 11, 12</code>.</li> </ul> <p>\u0418\u0442\u043e\u0433: <code>task.returning</code> \u2014 \u044d\u0442\u043e \u0441\u043f\u0438\u0441\u043e\u043a \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0432\u0435\u0440\u043d\u0443\u043b <code>generate_handler</code>.</p>"},{"location":"ru/features/yield/#_1","title":"\u041a\u0430\u043a \u044d\u0442\u043e \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \"\u043f\u043e\u0434 \u043a\u0430\u043f\u043e\u0442\u043e\u043c\"","text":"<p>\u041d\u0438\u0436\u0435 \u2014 \u0443\u043f\u0440\u043e\u0449\u0451\u043d\u043d\u043e\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0435\u0439 \u043b\u043e\u0433\u0438\u043a\u0438 \u0431\u0435\u0437 \u043b\u0438\u0448\u043d\u0438\u0445 \u0434\u0435\u0442\u0430\u043b\u0435\u0439.</p> <ol> <li>\u041e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435, \u0447\u0442\u043e \u0437\u0430\u0434\u0430\u0447\u0430 \u2014 \u0433\u0435\u043d\u0435\u0440\u0430\u0442\u043e\u0440    \u041f\u0440\u0438 \u043e\u0431\u044a\u044f\u0432\u043b\u0435\u043d\u0438\u0438 <code>@app.task</code> \u0434\u043b\u044f \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u0441\u043e\u0437\u0434\u0430\u0451\u0442\u0441\u044f \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u044f\u044f \u043c\u043e\u0434\u0435\u043b\u044c \u0437\u0430\u0434\u0430\u0447\u0438 <code>TaskExecSchema</code>.    \u0412 \u043d\u0435\u0439 \u0444\u043b\u0430\u0433 <code>generating</code> \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u0432 <code>True</code>, \u0435\u0441\u043b\u0438 \u0444\u0443\u043d\u043a\u0446\u0438\u044f \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0433\u0435\u043d\u0435\u0440\u0430\u0442\u043e\u0440\u043e\u043c:</li> </ol> <pre><code>inspect.isasyncgenfunction(func) or inspect.isgeneratorfunction(func)\n</code></pre> <ol> <li> <p>\u0412\u044b\u0431\u043e\u0440 \u043f\u0443\u0442\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0432 TaskExecutor    \u041a\u043e\u0433\u0434\u0430 <code>(A)syncTaskExecutor</code> \u043d\u0430\u0447\u0438\u043d\u0430\u0435\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0443 (<code>execute()</code>), \u043e\u043d \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442    <code>generating</code>:</p> </li> <li> <p>\u0435\u0441\u043b\u0438 <code>generating == True</code> \u2192 \u0432\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u044f\u044f \u0444\u0443\u043d\u043a\u0446\u0438\u044f <code>run_task_gen()</code>;</p> </li> <li> <p>\u0438\u043d\u0430\u0447\u0435 \u2192 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u043e\u0431\u044b\u0447\u043d\u044b\u0439 \u043f\u0443\u0442\u044c <code>run_task()</code>.</p> </li> <li> <p>\u0418\u0442\u0435\u0440\u0430\u0446\u0438\u044f \u043f\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f\u043c \u0433\u0435\u043d\u0435\u0440\u0430\u0442\u043e\u0440\u0430    \u0412\u043d\u0443\u0442\u0440\u0438 <code>run_task_gen()</code> \u0437\u0430\u0434\u0430\u0447\u0430 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f \u043a\u0430\u043a \u0433\u0435\u043d\u0435\u0440\u0430\u0442\u043e\u0440:</p> </li> <li> <p>\u0434\u043b\u044f <code>async def</code> \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f <code>async for result in func(...)</code>;</p> </li> <li> <p>\u0434\u043b\u044f \u043e\u0431\u044b\u0447\u043d\u043e\u0439 <code>def</code> \u2014 \u0446\u0438\u043a\u043b <code>while True</code> \u0441 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u043e\u0439 <code>StopIteration</code>.</p> </li> <li> <p>\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u0447\u0435\u0440\u0435\u0437 <code>generate_handler</code>    \u041d\u0430 \u043a\u0430\u0436\u0434\u044b\u0439 <code>result</code>, \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u043d\u044b\u0439 \u0438\u0437 <code>yield</code>, \u0432\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f <code>generate_handler(result)</code>    (\u0435\u0441\u043b\u0438 \u043e\u043d \u0437\u0430\u0434\u0430\u043d).    \u0412\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u043c\u044b\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f <code>generate_handler</code> \u0441\u043e\u0431\u0438\u0440\u0430\u044e\u0442\u0441\u044f \u0432 \u0441\u043f\u0438\u0441\u043e\u043a.</p> </li> <li> <p>\u0424\u0438\u043d\u0430\u043b\u044c\u043d\u044b\u0439 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0437\u0430\u0434\u0430\u0447\u0438    \u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e <code>(A)syncTaskExecutor</code> \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u0432,    \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u043d\u044b\u0445 \u0438\u0437 \u0433\u0435\u043d\u0435\u0440\u0430\u0442\u043e\u0440\u0430:</p> </li> <li> <p>\u043b\u0438\u0431\u043e \u043d\u0435\u043f\u043e\u0441\u0440\u0435\u0434\u0441\u0442\u0432\u0435\u043d\u043d\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439 <code>yield</code>,</p> </li> <li>\u043b\u0438\u0431\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439, \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u0447\u0435\u0440\u0435\u0437 <code>generate_handler</code>.</li> </ol> <p>\u0412\u0430\u0436\u043d\u043e: \u0438 <code>TaskExecSchema</code>, \u0438 <code>(A)syncTaskExecutor</code> \u043c\u043e\u0433\u0443\u0442 \u0431\u044b\u0442\u044c \u0437\u0430\u043c\u0435\u043d\u0435\u043d\u044b \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u043c \u2014 \u0432 \u0442\u043e\u043c \u0447\u0438\u0441\u043b\u0435 \u043d\u0430 \u044d\u0442\u0430\u043f\u0435 <code>@app.task(executor=NewTaskExecutor)</code>, \u0435\u0441\u043b\u0438 \u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0434\u0440\u0443\u0433\u043e\u0439 \u0441\u043f\u043e\u0441\u043e\u0431 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0433\u0435\u043d\u0435\u0440\u0430\u0442\u043e\u0440\u043e\u0432.</p>"},{"location":"ru/features/yield/#yield_1","title":"\u041a\u043e\u0433\u0434\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0438 \u0441 <code>yield</code>","text":"<p>\u0417\u0430\u0434\u0430\u0447\u0438-\u0433\u0435\u043d\u0435\u0440\u0430\u0442\u043e\u0440\u044b \u0443\u0434\u043e\u0431\u043d\u044b, \u043a\u043e\u0433\u0434\u0430 \u043d\u0443\u0436\u043d\u043e:</p> <ul> <li>\u043f\u043e\u043b\u0443\u0447\u0430\u0442\u044c \u043f\u043e\u0442\u043e\u043a \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u0432 \u0432\u043c\u0435\u0441\u0442\u043e \u043e\u0434\u043d\u043e\u0433\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f;</li> <li>\u043f\u043e\u044d\u0442\u0430\u043f\u043d\u043e \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u0447\u0430\u043d\u043a\u0438 \u0444\u0430\u0439\u043b\u043e\u0432, \u0431\u0430\u0442\u0447\u0438 \u0437\u0430\u043f\u0438\u0441\u0435\u0439);</li> <li>\u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0438\u043b\u0438 \u0430\u0433\u0440\u0435\u0433\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u043c\u0435\u0436\u0443\u0442\u043e\u0447\u043d\u044b\u0435 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u0447\u0435\u0440\u0435\u0437 <code>generate_handler</code>;</li> <li>\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0435 \u043c\u0438\u043d\u0438-\u043f\u0430\u0439\u043f\u043b\u0430\u0439\u043d\u044b \u0432\u043d\u0443\u0442\u0440\u0438 \u043e\u0434\u043d\u043e\u0439 \u0437\u0430\u0434\u0430\u0447\u0438.</li> </ul> <p>\u0412 \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0445 \u0441\u043b\u0443\u0447\u0430\u044f\u0445 \u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u043e\u0431\u044b\u0447\u043d\u043e\u0439 \u0437\u0430\u0434\u0430\u0447\u0438 \u0441 <code>return</code>.</p>"}]}